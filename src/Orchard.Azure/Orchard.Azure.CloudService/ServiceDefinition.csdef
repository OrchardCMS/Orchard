<?xml version="1.0" encoding="utf-8"?>
<ServiceDefinition name="OrchardCloudService" xmlns="http://schemas.microsoft.com/ServiceHosting/2008/10/ServiceDefinition" schemaVersion="2013-03.2.0">
	<WebRole name="Orchard.Azure.Web">
		<Sites>
			<Site name="Web">
				<Bindings>
					<Binding name="HttpIn" endpointName="HttpIn" />
				</Bindings>
			</Site>
		</Sites>
		<Imports>
			<Import moduleName="Diagnostics" />
			<Import moduleName="Caching" />
		</Imports>
		<ConfigurationSettings>
			<Setting name="Orchard.Azure.Settings.StorageConnectionString" />
			<Setting name="Orchard.Azure.Media.StorageConnectionString" />
			<Setting name="Orchard.Azure.OutputCache.HostIdentifier" />
			<Setting name="Orchard.Azure.OutputCache.CacheName" />
			<Setting name="Orchard.Azure.OutputCache.Hostname" />
			<Setting name="Orchard.Azure.OutputCache.Port" />
			<Setting name="Orchard.Azure.OutputCache.AuthorizationToken" />
			<Setting name="Orchard.Azure.OutputCache.IsSharedCaching" />
			<Setting name="Orchard.Azure.DatabaseCache.HostIdentifier" />
			<Setting name="Orchard.Azure.DatabaseCache.CacheName" />
			<Setting name="Orchard.Azure.DatabaseCache.Hostname" />
			<Setting name="Orchard.Azure.DatabaseCache.Port" />
			<Setting name="Orchard.Azure.DatabaseCache.AuthorizationToken" />
			<Setting name="Orchard.Azure.DatabaseCache.IsSharedCaching" />
		</ConfigurationSettings>
		<Endpoints>
			<InputEndpoint name="HttpIn" protocol="http" port="80" />
		</Endpoints>
		<Startup>
			<Task commandLine="Startup\SetIdleTimeout.cmd" executionContext="elevated" taskType="simple">
				<Environment>
					<!-- Create the environment variable that informs the startup task whether it is running 
			   in the compute emulator or in the cloud. -->
					<Variable name="ComputeEmulatorRunning">
						<RoleInstanceValue xpath="/RoleEnvironment/Deployment/@emulated" />
					</Variable>
				</Environment>
			</Task>
		</Startup>
		<LocalResources>
			<LocalStorage name="DiagnosticStore" sizeInMB="20000" cleanOnRoleRecycle="false" />
		</LocalResources>
	</WebRole>
</ServiceDefinition>