@model Orchard.Autoroute.Settings.AutorouteSettings
@using Orchard.Utility.Extensions;

@{
    Style.Require("AutorouteSettings");
    int patternCount = 0;
    int patternCultureCount = 0;
    int cultureCount = 0;
}
<fieldset>
    <div>
        @Html.CheckBoxFor(m => m.AllowCustomPattern)
        <label class="forcheckbox" for="@Html.FieldIdFor(m => m.AllowCustomPattern)">@T("Allow custom patterns")</label>
        <span class="hint">@T("Allow the user to change the pattern on each item")</span>
    </div>
</fieldset>
<fieldset>
    <div>
        @Html.CheckBoxFor(m => m.AutomaticAdjustmentOnEdit)
        <label class="forcheckbox" for="@Html.FieldIdFor(m => m.AutomaticAdjustmentOnEdit)">@T("Automatically regenerate when editing content")</label>
        <span class="hint">@T("This option will cause the Url to automatically be regenerated when you edit existing content and publish it again, otherwise it will always keep the old route, or you have to perform bulk update in the Autoroute admin.")</span>
    </div>
</fieldset>
@foreach (var culture in Model.SiteCultures) {
    <fieldset>
        <label>@T("Patterns") @culture :</label>
        <table class="items autoroute-settings-patterns">
            <tr>
                <th class="autoroute-settings-default">@T("Default")</th>
                <th class="autoroute-settings-name">@T("Name")<span class="hint">@T("Name of the pattern")</span></th>
                <th class="autoroute-settings-pat">@T("Pattern")<span class="hint">@T("The definition of the pattern")</span></th>
                <th class="autoroute-settings-desc">@T("Description")<span class="hint">@T("The description of the pattern, displayed in the editor")</span></th>
                <th class="autoroute-settings-actions">&nbsp;</th>
            </tr>
            @for (int index = 0; index < Model.Patterns.Where(x => x.Culture == culture).Count(); index++) {
                <tr>
                    <td>@Html.RadioButtonFor(m => m.DefaultPatterns[cultureCount].Culture, culture + "|" + patternCultureCount, patternCultureCount.ToString() == Model.DefaultPatterns[cultureCount].PatternIndex ? new { @checked = "checked" } : null)</td>
                    <td>@Html.TextBoxFor(m => m.Patterns[patternCount].Name, new { @class = "text" })</td>
                    <td>@Html.TextBoxFor(m => m.Patterns[patternCount].Pattern, new { @class = "tokenized text" })</td>
                    <td>@Html.TextBoxFor(m => m.Patterns[patternCount].Description, new { @class = "text" })</td>
                    <td>@Html.HiddenFor(m => m.Patterns[patternCount].Culture)&nbsp;</td>
                </tr>
                if (Model.Patterns[patternCount].Name != null) { patternCultureCount++; } else { patternCultureCount = 0; }
                patternCount++;
            }
            <tr></tr>
        </table>
    </fieldset>
            cultureCount++;
}
@Display.TokenHint()