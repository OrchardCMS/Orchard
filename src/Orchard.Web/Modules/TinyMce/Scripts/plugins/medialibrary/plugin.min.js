tinymce.create("tinymce.plugins.Orchard.MediaLibrary",{init:function(ed,url){ed.addCommand("mceMediaLibrary",(function(){ed.focus();var url=baseOrchardPath+"Admin/Orchard.MediaLibrary?dialog=true";$.colorbox({href:url,iframe:!0,reposition:!0,width:"90%",height:"90%",onLoad:function(){$("html, body").css("overflow","hidden")},onClosed:function(){$("html, body").css("overflow","");var selectedData=$.colorbox.selectedData;if(null!=selectedData){for(var newContent="",i=0;i<selectedData.length;i++){var renderMedia=baseOrchardPath+"/Admin/Orchard.MediaLibrary/MediaItem/"+selectedData[i].id+"?displayType=Raw";$.ajax({async:!1,type:"GET",url:renderMedia,success:function(data){newContent+=data}})}tinyMCE.execCommand("mceReplaceContent",!1,newContent)}}})})),ed.addButton("medialibrary",{icon:"image",title:"Insert media",cmd:"mceMediaLibrary"})},createControl:function(n,cm){return null},getInfo:function(){return{longname:"Orchard Media Library Plugin",author:"The Orchard Team",authorurl:"http://orchardproject.net",infourl:"http://orchardproject.net",version:"1.1"}}}),tinymce.PluginManager.add("medialibrary",tinymce.plugins.Orchard.MediaLibrary);