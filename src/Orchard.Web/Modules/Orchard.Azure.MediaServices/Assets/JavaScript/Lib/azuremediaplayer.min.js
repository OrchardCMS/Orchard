/* Azure Media Player v1.5.0 | (c) 2015 Microsoft Corporation */
function _handleMultipleEvents(n,t,i,r){vjs.arr.forEach(i,function(i){n(t,i,r)})}function _logType(n,t){var i,u,r;i=Array.prototype.slice.call(t);u=function(){};r=window.console||{log:u,warn:u,error:u};n?i.unshift(n.toUpperCase()+":"):n="log";vjs.log.history.push(i);i.unshift("VIDEOJS:");r[n].apply?r[n].apply(r,i):r[n](i.join(" "))}function ObjectIron(n){var t;for(t=[],i=0,len=n.length;i<len;i+=1)n[i].isRoot?t.push("root"):t.push(n[i].name);var e=function(n,t){var i;if(n!==null&&t!==null)for(i in n)n.hasOwnProperty(i)&&(t.hasOwnProperty(i)||(t[i]=n[i]))},u=function(n,t,i){var o,s,r,u,f;if(n!==null&&n.length!==0)for(o=0,s=n.length;o<s;o+=1)r=n[o],t.hasOwnProperty(r.name)&&(i.hasOwnProperty(r.name)?r.merge&&(u=t[r.name],f=i[r.name],typeof u=="object"&&typeof f=="object"?e(u,f):i[r.name]=r.mergeFunction!=null?r.mergeFunction(u,f):u+f):i[r.name]=t[r.name])},r=function(n,t){var f=n,o,c,s,l,h,i,e;if(f.children!==null&&f.children.length!==0)for(o=0,c=f.children.length;o<c;o+=1)if(i=f.children[o],t.hasOwnProperty(i.name))if(i.isArray)for(h=t[i.name+"_asArray"],s=0,l=h.length;s<l;s+=1)e=h[s],u(f.properties,t,e),r(i,e);else e=t[i.name],u(f.properties,t,e),r(i,e)},f=function(i){var u,h,c,e,o,s,l;if(i===null||typeof i!="object")return i;for(u=0,h=t.length;u<h;u+=1)t[u]==="root"&&(o=n[u],s=i,r(o,s));for(e in i)if(i.hasOwnProperty(e)){if(c=t.indexOf(e),c!==-1)if(o=n[c],o.isArray)for(l=i[e+"_asArray"],u=0,h=l.length;u<h;u+=1)s=l[u],r(o,s);else s=i[e],r(o,s);f(i[e])}return i};return{run:f}}function X2JS(n,t,i){function h(n){var t=n.localName;return t==null&&(t=n.baseName),(t==null||t=="")&&(t=n.nodeName),t}function w(n){return n.prefix}function c(n){return typeof n=="string"?n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):n}function b(n){return n.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/")}function f(u){var v,it,o,tt,y,c,s,rt,p,k,l,a,d,ut,g,nt;if(u.nodeType==r.DOCUMENT_NODE){for(c=u.firstChild,v=0,it=u.childNodes.length;v<it;v+=1)if(u.childNodes[v].nodeType!==r.COMMENT_NODE){c=u.childNodes[v];break}return i?o=f(c):(o={},s=h(c),o[s]=f(c)),o}if(u.nodeType==r.ELEMENT_NODE){for(o={},o.__cnt=0,tt=u.childNodes,y=0;y<tt.length;y++)if(c=tt.item(y),s=h(c),o.__cnt++,o[s]==null)o[s]=f(c),o[s+"_asArray"]=new Array(1),o[s+"_asArray"][0]=o[s];else{for(o[s]!=null&&(o[s]instanceof Array||(rt=o[s],o[s]=[],o[s][0]=rt,o[s+"_asArray"]=o[s])),p=0;o[s][p]!=null;)p++;o[s][p]=f(c)}for(k=0;k<u.attributes.length;k++){for(l=u.attributes.item(k),o.__cnt++,a=l.value,d=0,ut=n.length;d<ut;d++)g=n[d],g.test.call(this,l.value)&&(a=g.converter.call(this,l.value),o[t+l.name+g.suffix()]=a,a=null);a&&(o[t+l.name]=a)}return nt=w(u),nt!=null&&nt!=""&&(o.__cnt++,o.__prefix=nt),o.__cnt==1&&o["#text"]!=null&&(o=o["#text"]),o["#text"]!=null&&(o.__text=o["#text"],e&&(o.__text=b(o.__text)),delete o["#text"],delete o["#text_asArray"]),o["#cdata-section"]!=null&&(o.__cdata=o["#cdata-section"],delete o["#cdata-section"],delete o["#cdata-section_asArray"]),(o.__text!=null||o.__cdata!=null)&&(o.toString=function(){return(this.__text!=null?this.__text:"")+(this.__cdata!=null?this.__cdata:"")}),o}return u.nodeType==r.TEXT_NODE||u.nodeType==r.CDATA_SECTION_NODE?u.nodeValue:u.nodeType==r.COMMENT_NODE?null:void 0}function u(n,t,i,r){var e="<"+(n!=null&&n.__prefix!=null?n.__prefix+":":"")+t,u,f,o;if(i!=null)for(u=0;u<i.length;u++)f=i[u],o=n[f],e+=" "+f.substr(1)+"='"+o+"'";return e+(r?"/>":">")}function o(n,t){return"<\/"+(n.__prefix!=null?n.__prefix+":":"")+t+">"}function k(n,t){return n.indexOf(t,n.length-t.length)!==-1}function l(n,t){return k(t.toString(),"_asArray")||t.toString().indexOf("_")==0||n[t]instanceof Function?!0:!1}function a(n){var t=0,i;if(n instanceof Object)for(i in n)l(n,i)||t++;return t}function v(n){var i=[],t;if(n instanceof Object)for(t in n)t.toString().indexOf("__")==-1&&t.toString().indexOf("_")==0&&i.push(t);return i}function d(n){var t="";return n.__cdata!=null&&(t+="<![CDATA["+n.__cdata+"]\]>"),n.__text!=null&&(t+=e?c(n.__text):n.__text),t}function y(n){var t="";return n instanceof Object?t+=d(n):n!=null&&(t+=e?c(n):n),t}function g(n,t,i){var f="",r;if(n.length==0)f+=u(n,t,i,!0);else for(r=0;r<n.length;r++)f+=u(n[r],t,v(n[r]),!1),f+=s(n[r]),f+=o(n[r],t);return f}function s(n){var i="",h=a(n),r,t,f,e;if(h>0)for(r in n)l(n,r)||(t=n[r],f=v(t),t==null||t==undefined?i+=u(t,r,f,!0):t instanceof Object?t instanceof Array?i+=g(t,r,f):(e=a(t),e>0||t.__text!=null||t.__cdata!=null?(i+=u(t,r,f,!1),i+=s(t),i+=o(t,r)):i+=u(t,r,f,!0)):(i+=u(t,r,f,!1),i+=y(t),i+=o(t,r)));return i+y(n)}(t===null||t===undefined)&&(t="_");(i===null||i===undefined)&&(i=!1);var p="1.0.11",e=!1,r={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};this.parseXmlString=function(n){var t,i;return window.DOMParser?(i=new window.DOMParser,t=i.parseFromString(n,"text/xml")):(n.indexOf("<?")==0&&(n=n.substr(n.indexOf("?>")+2)),t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(n)),t};this.xml2json=function(n){return f(n)};this.xml_str2json=function(n){var t=this.parseXmlString(n);return this.xml2json(t)};this.json2xml_str=function(n){return s(n)};this.json2xml=function(n){var t=this.json2xml_str(n);return this.parseXmlString(t)};this.getVersion=function(){return p};this.escapeMode=function(n){e=n}}var vjs,videojs,hasOwnProp,errNum,Uint8ArrayUtil,__extends,AzureHtml5JS,org,AMP,UrlRewriter;for(document.createElement("video"),document.createElement("audio"),document.createElement("track"),vjs=function(n,t,i){var r;if(typeof n=="string"){if(n.indexOf("#")===0&&(n=n.slice(1)),vjs.players[n])return t&&vjs.log.warn('Player "'+n+'" is already initialised. Options will not be applied.'),i&&vjs.players[n].ready(i),vjs.players[n];r=vjs.el(n)}else r=n;if(!r||!r.nodeName)throw new TypeError("The element or ID supplied is not valid. (videojs)");return r.player||new vjs.Player(r,t,i)},videojs=window.videojs=vjs,vjs.CDN_VERSION="GENERATED_CDN_VSN",vjs.ACCESS_PROTOCOL="https:"==document.location.protocol?"https://":"http://",vjs.VERSION="GENERATED_FULL_VSN",vjs.options={techOrder:["html5","flash"],html5:{},flash:{},width:300,height:150,defaultVolume:0,playbackRates:[],inactivityTimeout:2e3,children:{mediaLoader:{},posterImage:{},loadingSpinner:{},textTrackDisplay:{},bigPlayButton:{},controlBar:{},errorDisplay:{},textTrackSettings:{}},language:document.getElementsByTagName("html")[0].getAttribute("lang")||navigator.languages&&navigator.languages[0]||navigator.userLanguage||navigator.language||"en",languages:{},notSupportedMessage:"SRC_PLAYER_MISMATCH"},vjs.addLanguage=function(n,t){return vjs.options.languages[n]=vjs.options.languages[n]!==undefined?vjs.util.mergeOptions(vjs.options.languages[n],t):t,vjs.options.languages},vjs.players={},typeof define=="function"&&define.amd?define("videojs",[],function(){return videojs}):typeof exports=="object"&&typeof module=="object"&&(module.exports=videojs),vjs.CoreObject=vjs.CoreObject=function(){},vjs.CoreObject.extend=function(n){var r,t,i;n=n||{};r=n.init||n.init||this.prototype.init||this.prototype.init||function(){};t=function(){r.apply(this,arguments)};t.prototype=vjs.obj.create(this.prototype);t.prototype.constructor=t;t.extend=vjs.CoreObject.extend;t.create=vjs.CoreObject.create;for(i in n)n.hasOwnProperty(i)&&(t.prototype[i]=n[i]);return t},vjs.CoreObject.create=function(){var n=vjs.obj.create(this.prototype);return this.apply(n,arguments),n},vjs.on=function(n,t,i){if(vjs.obj.isArray(t))return _handleMultipleEvents(vjs.on,n,t,i);var r=vjs.getData(n);r.handlers||(r.handlers={});r.handlers[t]||(r.handlers[t]=[]);i.guid||(i.guid=vjs.guid++);r.handlers[t].push(i);r.dispatcher||(r.disabled=!1,r.dispatcher=function(t){var u,f,i,e;if(!r.disabled&&(t=vjs.fixEvent(t),u=r.handlers[t.type],u))for(f=u.slice(0),i=0,e=f.length;i<e;i++)if(t.isImmediatePropagationStopped())break;else f[i].call(n,t)});r.handlers[t].length==1&&(n.addEventListener?n.addEventListener(t,r.dispatcher):n.attachEvent&&n.attachEvent("on"+t,r.dispatcher))},vjs.off=function(n,t,i){var r,e,o,u,f;if(vjs.hasData(n)&&(r=vjs.getData(n),r.handlers)){if(vjs.obj.isArray(t))return _handleMultipleEvents(vjs.off,n,t,i);if(e=function(t){r.handlers[t]=[];vjs.cleanUpEvents(n,t)},!t){for(o in r.handlers)e(o);return}if(u=r.handlers[t],u){if(!i){e(t);return}if(i.guid)for(f=0;f<u.length;f++)u[f].guid===i.guid&&u.splice(f--,1);vjs.cleanUpEvents(n,t)}}},vjs.cleanUpEvents=function(n,t){var i=vjs.getData(n);i.handlers[t].length===0&&(delete i.handlers[t],n.removeEventListener?n.removeEventListener(t,i.dispatcher,!1):n.detachEvent&&n.detachEvent("on"+t,i.dispatcher));vjs.isEmpty(i.handlers)&&(delete i.handlers,delete i.dispatcher,delete i.disabled);vjs.isEmpty(i)&&vjs.removeData(n)},vjs.fixEvent=function(n){function f(){return!0}function e(){return!1}var t,u,i,r;if(!n||!n.isPropagationStopped){t=n||window.event;n={};for(u in t)u!=="layerX"&&u!=="layerY"&&u!=="keyLocation"&&(u=="returnValue"&&t.preventDefault||(n[u]=t[u]));n.target||(n.target=n.srcElement||document);n.relatedTarget=n.fromElement===n.target?n.toElement:n.fromElement;n.preventDefault=function(){t.preventDefault&&t.preventDefault();n.returnValue=!1;n.isDefaultPrevented=f;n.defaultPrevented=!0};n.isDefaultPrevented=e;n.defaultPrevented=!1;n.stopPropagation=function(){t.stopPropagation&&t.stopPropagation();n.cancelBubble=!0;n.isPropagationStopped=f};n.isPropagationStopped=e;n.stopImmediatePropagation=function(){t.stopImmediatePropagation&&t.stopImmediatePropagation();n.isImmediatePropagationStopped=f;n.stopPropagation()};n.isImmediatePropagationStopped=e;n.clientX!=null&&(i=document.documentElement,r=document.body,n.pageX=n.clientX+(i&&i.scrollLeft||r&&r.scrollLeft||0)-(i&&i.clientLeft||r&&r.clientLeft||0),n.pageY=n.clientY+(i&&i.scrollTop||r&&r.scrollTop||0)-(i&&i.clientTop||r&&r.clientTop||0));n.which=n.charCode||n.keyCode;n.button!=null&&(n.button=n.button&1?0:n.button&4?1:n.button&2?2:0)}return n},vjs.trigger=function(n,t){var u=vjs.hasData(n)?vjs.getData(n):{},i=n.parentNode||n.ownerDocument,r;return typeof t=="string"&&(t={type:t,target:n}),t=vjs.fixEvent(t),u.dispatcher&&u.dispatcher.call(n,t),i&&!t.isPropagationStopped()&&t.bubbles!==!1?vjs.trigger(i,t):i||t.defaultPrevented||(r=vjs.getData(t.target),t.target[t.type]&&(r.disabled=!0,typeof t.target[t.type]=="function"&&t.target[t.type](),r.disabled=!1)),!t.defaultPrevented},vjs.one=function(n,t,i){if(vjs.obj.isArray(t))return _handleMultipleEvents(vjs.one,n,t,i);var r=function(){vjs.off(n,t,r);i.apply(this,arguments)};r.guid=i.guid=i.guid||vjs.guid++;vjs.on(n,t,r)},hasOwnProp=Object.prototype.hasOwnProperty,vjs.createEl=function(n,t){var i;return n=n||"div",t=t||{},i=document.createElement(n),vjs.obj.each(t,function(n,t){n.indexOf("aria-")!==-1||n=="role"?i.setAttribute(n,t):i[n]=t}),i},vjs.capitalize=function(n){return n.charAt(0).toUpperCase()+n.slice(1)},vjs.obj={},vjs.obj.create=Object.create||function(n){function t(){}return t.prototype=n,new t},vjs.obj.each=function(n,t,i){for(var r in n)hasOwnProp.call(n,r)&&t.call(i||this,r,n[r])},vjs.obj.merge=function(n,t){if(!t)return n;for(var i in t)hasOwnProp.call(t,i)&&(n[i]=t[i]);return n},vjs.obj.deepMerge=function(n,t){var i,r,u;n=vjs.obj.copy(n);for(i in t)hasOwnProp.call(t,i)&&(r=n[i],u=t[i],n[i]=vjs.obj.isPlain(r)&&vjs.obj.isPlain(u)?vjs.obj.deepMerge(r,u):t[i]);return n},vjs.obj.copy=function(n){return vjs.obj.merge({},n)},vjs.obj.isPlain=function(n){return!!n&&typeof n=="object"&&n.toString()==="[object Object]"&&n.constructor===Object},vjs.obj.isArray=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"},vjs.isNaN=function(n){return n!==n},vjs.bind=function(n,t,i){t.guid||(t.guid=vjs.guid++);var r=function(){return t.apply(n,arguments)};return r.guid=i?i+"_"+t.guid:t.guid,r},vjs.cache={},vjs.guid=1,vjs.expando="vdata"+(new Date).getTime(),vjs.getData=function(n){var t=n[vjs.expando];return t||(t=n[vjs.expando]=vjs.guid++),vjs.cache[t]||(vjs.cache[t]={}),vjs.cache[t]},vjs.hasData=function(n){var t=n[vjs.expando];return!(!t||vjs.isEmpty(vjs.cache[t]))},vjs.removeData=function(n){var t=n[vjs.expando];if(t){delete vjs.cache[t];try{delete n[vjs.expando]}catch(i){n.removeAttribute?n.removeAttribute(vjs.expando):n[vjs.expando]=null}}},vjs.isEmpty=function(n){for(var t in n)if(n[t]!==null)return!1;return!0},vjs.hasClass=function(n,t){return(" "+n.className+" ").indexOf(" "+t+" ")!==-1},vjs.addClass=function(n,t){vjs.hasClass(n,t)||(n.className=n.className===""?t:n.className+" "+t)},vjs.removeClass=function(n,t){var i,r;if(vjs.hasClass(n,t)){for(i=n.className.split(" "),r=i.length-1;r>=0;r--)i[r]===t&&i.splice(r,1);n.className=i.join(" ")}},vjs.TEST_VID=vjs.createEl("video"),function(){var n=document.createElement("track");n.kind="captions";n.srclang="en";n.label="English";vjs.TEST_VID.appendChild(n)}(),vjs.USER_AGENT=navigator.userAgent,vjs.IS_IPHONE=/iPhone/i.test(vjs.USER_AGENT),vjs.IS_IPAD=/iPad/i.test(vjs.USER_AGENT),vjs.IS_IPOD=/iPod/i.test(vjs.USER_AGENT),vjs.IS_IOS=vjs.IS_IPHONE||vjs.IS_IPAD||vjs.IS_IPOD,vjs.IOS_VERSION=function(){var n=vjs.USER_AGENT.match(/OS (\d+)_/i);if(n&&n[1])return n[1]}(),vjs.IS_ANDROID=/Android/i.test(vjs.USER_AGENT),vjs.ANDROID_VERSION=function(){var n=vjs.USER_AGENT.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i),t,i;return n?(t=n[1]&&parseFloat(n[1]),i=n[2]&&parseFloat(n[2]),t&&i?parseFloat(n[1]+"."+n[2]):t?t:null):null}(),vjs.IS_OLD_ANDROID=vjs.IS_ANDROID&&/webkit/i.test(vjs.USER_AGENT)&&vjs.ANDROID_VERSION<2.3,vjs.IS_FIREFOX=/Firefox/i.test(vjs.USER_AGENT),vjs.IS_CHROME=/Chrome/i.test(vjs.USER_AGENT),vjs.IS_IE8=/MSIE\s8\.0/.test(vjs.USER_AGENT),vjs.IS_IEMOBILE=/IEMobile\/([0-9.]*)/.test(vjs.USER_AGENT),vjs.IS_SAFARI=/Safari/i.test(vjs.USER_AGENT)&&!vjs.IS_CHROME&&!vjs.IS_IEMOBILE,vjs.TOUCH_ENABLED=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),vjs.BACKGROUND_SIZE_SUPPORTED=("backgroundSize"in vjs.TEST_VID.style),vjs.setElementAttributes=function(n,t){vjs.obj.each(t,function(t,i){i===null||typeof i=="undefined"||i===!1?n.removeAttribute(t):n.setAttribute(t,i===!0?"":i)})},vjs.getElementAttributes=function(n){var f,e,i,r,u,t;if(f={},e=",autoplay,controls,loop,muted,default,",n&&n.attributes&&n.attributes.length>0)for(i=n.attributes,t=i.length-1;t>=0;t--)r=i[t].name,u=i[t].value,(typeof n[r]=="boolean"||e.indexOf(","+r+",")!==-1)&&(u=u!==null?!0:!1),f[r]=u;return f},vjs.getComputedDimension=function(n,t){var i="";return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(n,"").getPropertyValue(t):n.currentStyle&&(i=n["client"+t.substr(0,1).toUpperCase()+t.substr(1)]+"px"),i},vjs.insertFirst=function(n,t){t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)},vjs.browser={},vjs.el=function(n){return n.indexOf("#")===0&&(n=n.slice(1)),document.getElementById(n)},vjs.formatTime=function(n,t){t=t||n;var i=Math.floor(n%60),r=Math.floor(n/60%60),u=Math.floor(n/3600),f=Math.floor(t/60%60),e=Math.floor(t/3600);return(isNaN(n)||n===Infinity)&&(u=r=i="-"),u=u>0||e>0?u+":":"",r=((u||f>=10)&&r<10?"0"+r:r)+":",i=i<10?"0"+i:i,u+r+i},vjs.blockTextSelection=function(){document.body.focus();document.onselectstart=function(){return!1}},vjs.unblockTextSelection=function(){document.onselectstart=function(){return!0}},vjs.trim=function(n){return(n+"").replace(/^\s+|\s+$/g,"")},vjs.round=function(n,t){return t||(t=0),Math.round(n*Math.pow(10,t))/Math.pow(10,t)},vjs.createTimeRange=function(n,t){return{length:1,start:function(){return n},end:function(){return t}}},vjs.setLocalStorage=function(n,t){try{var r=window.localStorage||!1;if(!r)return;r[n]=t}catch(i){i.code==22||i.code==1014?vjs.log("LocalStorage Full (VideoJS)",i):i.code==18?vjs.log("LocalStorage not allowed (VideoJS)",i):vjs.log("LocalStorage Error (VideoJS)",i)}},vjs.getAbsoluteURL=function(n){return n.match(/^https?:\/\//)||(n=vjs.createEl("div",{innerHTML:'<a href="'+encodeURI(n)+'">x<\/a>'}).firstChild.href),n},vjs.parseUrl=function(n){var i,r,e,f,t,u;for(n=encodeURI(n),f=["protocol","hostname","port","pathname","search","hash","host"],r=vjs.createEl("a",{href:n}),e=r.host===""&&r.protocol!=="file:",e&&(i=vjs.createEl("div"),i.innerHTML='<a href="'+n+'"><\/a>',r=i.firstChild,i.setAttribute("style","display:none; position:absolute;"),document.body.appendChild(i)),t={},u=0;u<f.length;u++)t[f[u]]=r[f[u]];return t.protocol==="http:"&&(t.host=t.host.replace(/:80$/,"")),t.protocol==="https:"&&(t.host=t.host.replace(/:443$/,"")),e&&document.body.removeChild(i),t},vjs.log=function(){_logType(null,arguments)},vjs.log.history=[],vjs.log.error=function(){_logType("error",arguments)},vjs.log.warn=function(){_logType("warn",arguments)},vjs.findPosition=function(n){var i,r,t,u,f,e,o,s,h;return(n.getBoundingClientRect&&n.parentNode&&(i=n.getBoundingClientRect()),!i)?{left:0,top:0}:(r=document.documentElement,t=document.body,u=r.clientLeft||t.clientLeft||0,f=window.pageXOffset||t.scrollLeft,e=i.left+f-u,o=r.clientTop||t.clientTop||0,s=window.pageYOffset||t.scrollTop,h=i.top+s-o,{left:vjs.round(e),top:vjs.round(h)})},vjs.arr={},vjs.arr.forEach=function(n,t,i){if(vjs.obj.isArray(n)&&t instanceof Function)for(var r=0,u=n.length;r<u;++r)t.call(i||vjs,n[r],r,n);return n},vjs.xhr=function(n,t){var u,i,f,e,h,c,o,s,r;typeof n=="string"&&(n={uri:n});videojs.util.mergeOptions({method:"GET",timeout:45e3},n);t=t||function(){};s=function(){window.clearTimeout(o);t(null,i,i.response||i.responseText)};r=function(n){window.clearTimeout(o);n&&typeof n!="string"||(n=new Error(n));t(n,i)};u=window.XMLHttpRequest;typeof u=="undefined"&&(u=function(){try{return new window.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(n){}try{return new window.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new window.ActiveXObject("Msxml2.XMLHTTP")}catch(i){}throw new Error("This browser does not support XMLHttpRequest.");});i=new u;i.uri=n.uri;f=vjs.parseUrl(n.uri);e=window.location;c=f.protocol+f.host!==e.protocol+e.host;!c||!window.XDomainRequest||"withCredentials"in i?(h=f.protocol=="file:"||e.protocol=="file:",i.onreadystatechange=function(){if(i.readyState===4){if(i.timedout)return r("timeout");i.status===200||h&&i.status===0?s():r()}},n.timeout&&(o=window.setTimeout(function(){i.readyState!==4&&(i.timedout=!0,i.abort())},n.timeout))):(i=new window.XDomainRequest,i.onload=s,i.onerror=r,i.onprogress=function(){},i.ontimeout=function(){});try{i.open(n.method||"GET",n.uri,!0)}catch(l){return r(l)}n.withCredentials&&(i.withCredentials=!0);n.responseType&&(i.responseType=n.responseType);try{i.send()}catch(l){return r(l)}return i},vjs.util={},vjs.util.mergeOptions=function(n,t){var i,r,u;n=vjs.obj.copy(n);for(i in t)t.hasOwnProperty(i)&&(r=n[i],u=t[i],n[i]=vjs.obj.isPlain(r)&&vjs.obj.isPlain(u)?vjs.util.mergeOptions(r,u):t[i]);return n},vjs.util.htmlEncode=function(n){var i,r;if(!n)return"";var u=new String(n),f=u.length,t=[];for(i=0;i<f;i++){r=u.charAt(i);switch(r){case"<":t.push("&lt;");break;case">":t.push("&gt;");break;case"&":t.push("&amp;");break;case'"':t.push("&quot;");break;case"'":t.push("&#39;");break;default:t.push(r)}}return t.join("")},vjs.Component=vjs.CoreObject.extend({init:function(n,t,i){this.player_=n;this.options_=vjs.obj.copy(this.options_);t=this.options(t);this.id_=t.id||t.el&&t.el.id;this.id_||(this.id_=(n.id&&n.id()||"no_player")+"_component_"+vjs.guid++);this.name_=t.name||null;this.el_=t.el||this.createEl();this.children_=[];this.childIndex_={};this.childNameIndex_={};this.initChildren();this.ready(i);t.reportTouchActivity!==!1&&this.enableTouchActivity()}}),vjs.Component.prototype.dispose=function(){if(this.trigger({type:"dispose",bubbles:!1}),this.children_)for(var n=this.children_.length-1;n>=0;n--)this.children_[n].dispose&&this.children_[n].dispose();this.children_=null;this.childIndex_=null;this.childNameIndex_=null;this.off();this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_);vjs.removeData(this.el_);this.el_=null},vjs.Component.prototype.player_=!0,vjs.Component.prototype.player=function(){return this.player_},vjs.Component.prototype.options_,vjs.Component.prototype.options=function(n){return n===undefined?this.options_:this.options_=vjs.util.mergeOptions(this.options_,n)},vjs.Component.prototype.el_,vjs.Component.prototype.createEl=function(n,t){return vjs.createEl(n,t)},vjs.Component.prototype.localize=function(n){var t=this.player_.language(),i=this.player_.languages(),r;return!t||!i?n:(t=t.toLowerCase(),i[t]||(r=t.split("-"),t=r.length===2&&r[0]===r[1]?r[0]:"en"),i[t]&&i[t][n])?i[t][n]:n},vjs.Component.prototype.el=function(){return this.el_},vjs.Component.prototype.contentEl_,vjs.Component.prototype.contentEl=function(){return this.contentEl_||this.el_},vjs.Component.prototype.id_,vjs.Component.prototype.id=function(){return this.id_},vjs.Component.prototype.name_,vjs.Component.prototype.name=function(){return this.name_},vjs.Component.prototype.children_,vjs.Component.prototype.children=function(){return this.children_},vjs.Component.prototype.childIndex_,vjs.Component.prototype.getChildById=function(n){return this.childIndex_[n]},vjs.Component.prototype.childNameIndex_,vjs.Component.prototype.getChild=function(n){return this.childNameIndex_[n]},vjs.Component.prototype.addChild=function(n,t){var i,u,r;return typeof n=="string"?(r=n,t=t||{},u=t.componentClass||vjs.capitalize(r),t.name=r,i=new window.videojs[u](this.player_||this,t)):i=n,this.children_.push(i),typeof i.id=="function"&&(this.childIndex_[i.id()]=i),r=r||i.name&&i.name(),r&&(this.childNameIndex_[r]=i),typeof i.el=="function"&&i.el()&&this.contentEl().appendChild(i.el()),i},vjs.Component.prototype.removeChild=function(n){var i,t,r;if(typeof n=="string"&&(n=this.getChild(n)),n&&this.children_){for(i=!1,t=this.children_.length-1;t>=0;t--)if(this.children_[t]===n){i=!0;this.children_.splice(t,1);break}i&&(this.childIndex_[n.id()]=null,this.childNameIndex_[n.name()]=null,r=n.el(),r&&r.parentNode===this.contentEl()&&this.contentEl().removeChild(n.el()))}},vjs.Component.prototype.initChildren=function(){var i,r,n,t,f,e,o,u;if(i=this,r=i.options(),n=r.children,n)if(o=function(n,t){(r[n]!==undefined&&(t=r[n]),t!==!1)&&(i[n]=i.addChild(n,t))},vjs.obj.isArray(n))for(u=0;u<n.length;u++)t=n[u],typeof t=="string"?(f=t,e={}):(f=t.name,e=t),o(f,e);else vjs.obj.each(n,o)},vjs.Component.prototype.buildCSSClass=function(){return""},vjs.Component.prototype.on=function(n,t,i){var r,f,u,e,o,s;if(typeof n=="string"||vjs.obj.isArray(n))vjs.on(this.el_,n,vjs.bind(this,t));else{r=n;f=t;u=vjs.bind(this,i);s=this;e=function(){s.off(r,f,u)};e.guid=u.guid;this.on("dispose",e);if(o=function(){s.off("dispose",e)},o.guid=u.guid,n.nodeName){vjs.on(r,f,u);vjs.on(r,"dispose",o)}else if(typeof n.on=="function"){r.on(f,u);r.on("dispose",o)}}return this},vjs.Component.prototype.off=function(n,t,i){var u,f,r;return!n||typeof n=="string"||vjs.obj.isArray(n)?vjs.off(this.el_,n,t):(u=n,f=t,r=vjs.bind(this,i),this.off("dispose",r),n.nodeName?(vjs.off(u,f,r),vjs.off(u,"dispose",r)):(u.off(f,r),u.off("dispose",r))),this},vjs.Component.prototype.one=function(n,t,i){var u,f,e,o,r;if(typeof n=="string"||vjs.obj.isArray(n))vjs.one(this.el_,n,vjs.bind(this,t));else{u=n;f=t;e=vjs.bind(this,i);o=this;r=function(){o.off(u,f,r);e.apply(this,arguments)};r.guid=e.guid;this.on(u,f,r)}return this},vjs.Component.prototype.trigger=function(n){return vjs.trigger(this.el_,n),this},vjs.Component.prototype.isReady_,vjs.Component.prototype.isReadyOnInitFinish_=!0,vjs.Component.prototype.readyQueue_,vjs.Component.prototype.ready=function(n){return n&&(this.isReady_?n.call(this):(this.readyQueue_===undefined&&(this.readyQueue_=[]),this.readyQueue_.push(n))),this},vjs.Component.prototype.triggerReady=function(){var n,t,i;if(this.isReady_=!0,n=this.readyQueue_,n&&n.length>0){for(t=0,i=n.length;t<i;t++)n[t].call(this);this.readyQueue_=[];this.trigger("ready")}},vjs.Component.prototype.hasClass=function(n){return vjs.hasClass(this.el_,n)},vjs.Component.prototype.addClass=function(n){return vjs.addClass(this.el_,n),this},vjs.Component.prototype.removeClass=function(n){return vjs.removeClass(this.el_,n),this},vjs.Component.prototype.show=function(){return this.removeClass("vjs-hidden"),this},vjs.Component.prototype.hide=function(){return this.addClass("vjs-hidden"),this},vjs.Component.prototype.lockShowing=function(){return this.addClass("vjs-lock-showing"),this},vjs.Component.prototype.unlockShowing=function(){return this.removeClass("vjs-lock-showing"),this},vjs.Component.prototype.disable=function(){this.hide();this.show=function(){}},vjs.Component.prototype.width=function(n,t){return this.dimension("width",n,t)},vjs.Component.prototype.height=function(n,t){return this.dimension("height",n,t)},vjs.Component.prototype.dimensions=function(n,t){return this.width(n,!0).height(t)},vjs.Component.prototype.dimension=function(n,t,i){if(t!==undefined)return(t===null||vjs.isNaN(t))&&(t=0),this.el_.style[n]=(""+t).indexOf("%")!==-1||(""+t).indexOf("px")!==-1?t:t==="auto"?"":t+"px",i||this.trigger("resize"),this;if(!this.el_)return 0;var r=this.el_.style[n],u=r.indexOf("px");return u!==-1?parseInt(r.slice(0,u),10):parseInt(this.el_["offset"+vjs.capitalize(n)],10)},vjs.Component.prototype.onResize,vjs.Component.prototype.emitTapEvents=function(){var i,n,e,t,r,u,f,o,s,h;i=0;n=null;s=10;h=200;this.on("touchstart",function(r){r.touches.length===1&&(n=vjs.obj.copy(r.touches[0]),i=(new Date).getTime(),t=!0)});this.on("touchmove",function(i){i.touches.length>1?t=!1:n&&(u=i.touches[0].pageX-n.pageX,f=i.touches[0].pageY-n.pageY,o=Math.sqrt(u*u+f*f),o>s&&(t=!1))});r=function(){t=!1};this.on("touchleave",r);this.on("touchcancel",r);this.on("touchend",function(r){n=null;t===!0&&(e=(new Date).getTime()-i,e<h&&(r.preventDefault(),this.trigger("tap")))})},vjs.Component.prototype.enableTouchActivity=function(){var n,t,i;if(this.player().reportUserActivity){n=vjs.bind(this.player(),this.player().reportUserActivity);this.on("touchstart",function(){n();this.clearInterval(t);t=this.setInterval(n,250)});i=function(){n();this.clearInterval(t)};this.on("touchmove",n);this.on("touchend",i);this.on("touchcancel",i)}},vjs.Component.prototype.setTimeout=function(n,t){n=vjs.bind(this,n);var i=setTimeout(n,t),r=function(){this.clearTimeout(i)};r.guid="vjs-timeout-"+i;this.on("dispose",r);return i},vjs.Component.prototype.clearTimeout=function(n){clearTimeout(n);var t=function(){};return t.guid="vjs-timeout-"+n,this.off("dispose",t),n},vjs.Component.prototype.setInterval=function(n,t){n=vjs.bind(this,n);var i=setInterval(n,t),r=function(){this.clearInterval(i)};r.guid="vjs-interval-"+i;this.on("dispose",r);return i},vjs.Component.prototype.clearInterval=function(n){clearInterval(n);var t=function(){};return t.guid="vjs-interval-"+n,this.off("dispose",t),n},vjs.Button=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t);this.emitTapEvents();this.on("tap",this.onClick);this.on("click",this.onClick);this.on("focus",this.onFocus);this.on("blur",this.onBlur)}}),vjs.Button.prototype.createEl=function(n,t){var i;return t=vjs.obj.merge({className:this.buildCSSClass(),role:"button","aria-live":"polite",tabIndex:0},t),i=vjs.Component.prototype.createEl.call(this,n,t),t.innerHTML||(this.contentEl_=vjs.createEl("div",{className:"vjs-control-content"}),this.controlText_=vjs.createEl("span",{className:"vjs-control-text",innerHTML:vjs.util.htmlEncode(this.localize(this.buttonText))||"Need Text"}),this.contentEl_.appendChild(this.controlText_),i.appendChild(this.contentEl_)),i},vjs.Button.prototype.buildCSSClass=function(){return"vjs-control "+vjs.Component.prototype.buildCSSClass.call(this)},vjs.Button.prototype.onClick=function(){},vjs.Button.prototype.onFocus=function(){vjs.on(document,"keydown",vjs.bind(this,this.onKeyPress))},vjs.Button.prototype.onKeyPress=function(n){if(n.which==32||n.which==13){n.preventDefault();this.onClick(n)}},vjs.Button.prototype.onBlur=function(){vjs.off(document,"keydown",vjs.bind(this,this.onKeyPress))},vjs.Slider=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t);this.bar=this.getChild(this.options_.barName);this.handle=this.getChild(this.options_.handleName);this.on("mousedown",this.onMouseDown);this.on("touchstart",this.onMouseDown);this.on("focus",this.onFocus);this.on("blur",this.onBlur);this.on("click",this.onClick);this.on(n,"controlsvisible",this.update);this.on(n,this.playerEvent,this.update)}}),vjs.Slider.prototype.createEl=function(n,t){return t=t||{},t.className=t.className+" vjs-slider",t=vjs.obj.merge({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},t),vjs.Component.prototype.createEl.call(this,n,t)},vjs.Slider.prototype.onMouseDown=function(n){n.preventDefault();vjs.blockTextSelection();this.addClass("vjs-sliding");this.on(document,"mousemove",this.onMouseMove);this.on(document,"mouseup",this.onMouseUp);this.on(document,"touchmove",this.onMouseMove);this.on(document,"touchend",this.onMouseUp);this.onMouseMove(n)},vjs.Slider.prototype.onMouseMove=function(){},vjs.Slider.prototype.onMouseUp=function(){vjs.unblockTextSelection();this.removeClass("vjs-sliding");this.off(document,"mousemove",this.onMouseMove);this.off(document,"mouseup",this.onMouseUp);this.off(document,"touchmove",this.onMouseMove);this.off(document,"touchend",this.onMouseUp);this.update()},vjs.Slider.prototype.update=function(){if(this.el_){var t,n=this.getPercent(),i=this.handle,r=this.bar;if((typeof n!="number"||n!==n||n<0||n===Infinity)&&(n=0),t=n,i){var o=this.el_,s=o.offsetWidth,u=i.el().offsetWidth,f=u?u/s:0,h=1-f,e=n*h;t=e+f/2;i.el().style.left=vjs.round(e*100,2)+"%"}r&&(r.el().style.width=vjs.round(t*100,2)+"%")}},vjs.Slider.prototype.calculateDistance=function(n){var r,o,u,f,e,i,t,c,l,s,h;return r=this.el_,o=vjs.findPosition(r),e=i=Math.max(r.offsetWidth,r.clientWidth),t=this.handle,this.options().vertical?(f=o.top,l=n.changedTouches?n.changedTouches[0].pageY:n.pageY,t&&(s=Math.max(t.el().offsetHeight,t.el().clientHeight),f=f+s/2,i=i-s),Math.max(0,Math.min(1,(f-l+i)/i))):(u=o.left,c=n.changedTouches?n.changedTouches[0].pageX:n.pageX,t&&(h=Math.max(t.el().offsetWidth,t.el().clientWidth),u=u+h/2,e=e-h),Math.max(0,Math.min(1,(c-u)/e)))},vjs.Slider.prototype.onFocus=function(){this.on(document,"keydown",this.onKeyPress)},vjs.Slider.prototype.onKeyPress=function(n){n.which==37||n.which==40?(n.preventDefault(),this.stepBack()):(n.which==38||n.which==39)&&(n.preventDefault(),this.stepForward())},vjs.Slider.prototype.onBlur=function(){this.off(document,"keydown",this.onKeyPress)},vjs.Slider.prototype.onClick=function(n){n.stopImmediatePropagation();n.preventDefault()},vjs.SliderHandle=vjs.Component.extend(),vjs.SliderHandle.prototype.defaultValue=0,vjs.SliderHandle.prototype.createEl=function(n,t){return t=t||{},t.className=t.className+" vjs-slider-handle",t=vjs.obj.merge({innerHTML:'<span class="vjs-control-text">'+vjs.util.htmlEncode(this.defaultValue)+"<\/span>"},t),vjs.Component.prototype.createEl.call(this,"div",t)},vjs.Menu=vjs.Component.extend(),vjs.Menu.prototype.addItem=function(n){this.addChild(n);n.on("click",vjs.bind(this,function(){this.unlockShowing()}))},vjs.Menu.prototype.createEl=function(){var t=this.options().contentElType||"ul",n;this.contentEl_=vjs.createEl(t,{className:"vjs-menu-content"});n=vjs.Component.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});n.appendChild(this.contentEl_);vjs.on(n,"click",function(n){n.preventDefault();n.stopImmediatePropagation()});return n},vjs.MenuItem=vjs.Button.extend({init:function(n,t){vjs.Button.call(this,n,t);this.selected(t.selected)}}),vjs.MenuItem.prototype.createEl=function(n,t){return vjs.Button.prototype.createEl.call(this,"li",vjs.obj.merge({className:"vjs-menu-item",innerHTML:vjs.util.htmlEncode(this.localize(this.options_.label))},t))},vjs.MenuItem.prototype.onClick=function(n){n.stopImmediatePropagation();this.selected(!0)},vjs.MenuItem.prototype.selected=function(n){n?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-selected",!0)):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-selected",!1))},vjs.MenuButton=vjs.Button.extend({init:function(n,t){vjs.Button.call(this,n,t);this.update();this.on("keydown",this.onKeyPress);this.on("mouseover",this.onMouseOver);this.on("mouseout",this.onMouseOut);this.el_.setAttribute("aria-haspopup",!0);this.el_.setAttribute("role","button")}}),vjs.MenuButton.prototype.update=function(){var n=this.createMenu();this.menu&&this.removeChild(this.menu);this.menu=n;this.addChild(n);this.items&&this.items.length===0?this.hide():this.items&&this.items.length>1&&this.show()},vjs.MenuButton.prototype.buttonPressed_=!1,vjs.MenuButton.prototype.createMenu=function(){var t=new vjs.Menu(this.player_),n;if(this.options().title&&t.contentEl().appendChild(vjs.createEl("li",{className:"vjs-menu-title",innerHTML:vjs.util.htmlEncode(vjs.capitalize(this.options().title)),tabindex:-1})),this.items=this.createItems(),this.items)for(n=0;n<this.items.length;n++)t.addItem(this.items[n]);return t},vjs.MenuButton.prototype.createItems=function(){},vjs.MenuButton.prototype.buildCSSClass=function(){return this.className+" vjs-menu-button "+vjs.Button.prototype.buildCSSClass.call(this)},vjs.MenuButton.prototype.onFocus=function(){},vjs.MenuButton.prototype.onBlur=function(){},vjs.MenuButton.prototype.onMouseOver=function(){this.clearOtherMenus();this.buttonPressed_||this.pressButton()},vjs.MenuButton.prototype.onMouseOut=function(){this.unpressButton()},vjs.MenuButton.prototype.onClick=function(n){if(n.type=="keydown"){this.onKeyPress(n);return}this.clearOtherMenus();this.player_.one("userinactive",vjs.bind(this,function(){this.unpressButton();this.el_.blur()}));this.buttonPressed_||this.pressButton()},vjs.MenuButton.prototype.onKeyPress=function(n){n.which==32||n.which==13?(this.clearOtherMenus(),this.buttonPressed_?this.unpressButton():this.pressButton(),n.preventDefault()):n.which==27&&(this.buttonPressed_&&this.unpressButton(),n.preventDefault())},vjs.MenuButton.prototype.pressButton=function(){this.buttonPressed_=!0;this.menu.lockShowing();this.el_.setAttribute("aria-pressed",!0);this.items&&this.items.length>0&&this.items[0].el().focus()},vjs.MenuButton.prototype.unpressButton=function(){this.buttonPressed_=!1;this.menu.unlockShowing();this.el_.setAttribute("aria-pressed",!1)},vjs.MenuButton.prototype.clearOtherMenus=function(){var t=this,n=this.player_.controlBar;n&&Object.getOwnPropertyNames(n).forEach(function(i){n[i]!==t&&n[i].el_&&n[i].el_.className&&n[i].el_.className.indexOf("vjs-menu-button")!==-1&&n[i].buttonPressed_&&n[i].unpressButton()})},vjs.MediaError=function(n){typeof n=="number"?this.code=n:typeof n=="string"?this.message=n:typeof n=="object"&&vjs.obj.merge(this,n);this.message||(this.message=vjs.MediaError.errorTypes[this.code]||"")},vjs.MediaError.prototype.code=0,vjs.MediaError.prototype.message="",vjs.MediaError.prototype.status=null,vjs.MediaError.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],errNum=0;errNum<vjs.MediaError.errorTypes.length;errNum++)vjs.MediaError[vjs.MediaError.errorTypes[errNum]]=errNum,vjs.MediaError.prototype[vjs.MediaError.errorTypes[errNum]]=errNum;if(function(){var t,r,i,n;for(vjs.browser.fullscreenAPI,t=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=t[0],n=0;n<t.length;n++)if(t[n][1]in document){i=t[n];break}if(i)for(vjs.browser.fullscreenAPI={},n=0;n<i.length;n++)vjs.browser.fullscreenAPI[r[n]]=i[n]}(),vjs.Player=vjs.Component.extend({init:function(n,t,i){this.tag=n;n.id=n.id||"vjs_video_"+vjs.guid++;this.tagAttributes=n&&vjs.getElementAttributes(n);t=vjs.obj.merge(this.getTagSettings(n),t);t.autoplay===undefined&&(t.autoplay=!1);this.language_=t.language||vjs.options.language;this.languages_=t.languages||vjs.options.languages;this.cache_={};t.muted&&(this.cache_.muted=!0);this.cache_.volume=1;this.poster_=t.poster||"";this.controls_=!!t.controls;n.controls=!1;t.reportTouchActivity=!1;this.isAudio(this.tag.nodeName.toLowerCase()==="audio");vjs.Component.call(this,this,t,i);this.controls()?this.addClass("vjs-controls-enabled"):this.addClass("vjs-controls-disabled");this.isAudio()&&this.addClass("vjs-audio");vjs.players[this.id_]=this;this.options_.plugins&&vjs.obj.each(this.options_.plugins,function(n,t){this[n]&&this[n](t)},this);this.listenForUserActivity()}}),vjs.Player.prototype.language_,vjs.Player.prototype.language=function(n){return n===undefined?this.language_:(this.language_=n,this)},vjs.Player.prototype.languages_,vjs.Player.prototype.languages=function(){return this.languages_},vjs.Player.prototype.options_=vjs.options,vjs.Player.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.trigger("dispose"),this.off("dispose"),vjs.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech&&this.unloadTech(),vjs.Component.prototype.dispose.call(this))},vjs.Player.prototype.getTagSettings=function(n){var i,e,r={sources:[],tracks:[]},o,u,s,f,h,t;if(i=vjs.getElementAttributes(n),e=i["data-setup"],e!==null&&vjs.obj.merge(i,vjs.JSON.safeParseTuple(e||"{}")[1]),vjs.obj.merge(r,i),n.hasChildNodes())for(o=n.childNodes,f=0,h=o.length;f<h;f++)u=o[f],s=u.nodeName.toLowerCase(),s==="source"?(t=vjs.getElementAttributes(u),t=vjs.obj.merge(t,vjs.JSON.safeParseTuple(t["data-setup"]||"{}")[1]),r.sources.push(t)):s==="track"&&r.tracks.push(vjs.getElementAttributes(u));return r},vjs.Player.prototype.createEl=function(){var t=this.el_=vjs.Component.prototype.createEl.call(this,"div"),n=this.tag,i;n.removeAttribute("width");n.removeAttribute("height");i=vjs.getElementAttributes(n);vjs.obj.each(i,function(n){n=="class"?t.className=i[n]:t.setAttribute(n,i[n])});n.id+="_html5_api";n.className="vjs-tech";n.player=t.player=this;this.addClass("vjs-paused");this.width(this.options_.width,!0);this.height(this.options_.height,!0);n.initNetworkState_=n.networkState;n.parentNode&&n.parentNode.insertBefore(t,n);vjs.insertFirst(n,t);this.el_=t;this.on("loadstart",this.onLoadStart);this.on("waiting",this.onWaiting);this.on(["canplay","canplaythrough","playing","ended","error","seeked"],this.onWaitEnd);this.on("seeking",this.onSeeking);this.on("seeked",this.onSeeked);this.on("ended",this.onEnded);this.on("play",this.onPlay);this.on("firstplay",this.onFirstPlay);this.on("pause",this.onPause);this.on("progress",this.onProgress);this.on("durationchange",this.onDurationChange);this.on("fullscreenchange",this.onFullscreenChange);return t},vjs.Player.prototype.loadTech=function(n,t){this.showPlayerLoad();this.tech&&this.unloadTech();n!=="Html5"&&this.tag&&(vjs.Html5.disposeMediaElement(this.tag),this.tag=null);this.techName=n;this.isReady_=!1;var r=function(){this.player_.muted(this.player_.cache_.muted);this.player_.triggerReady()},i=vjs.obj.merge({source:t,parentEl:this.el_},this.options_[n.toLowerCase()]);t&&(this.currentType_=t.type,t.src==this.cache_.src&&this.cache_.currentTime>0&&(i.startTime=this.cache_.currentTime),this.cache_.src=t.src);this.tech=new window.videojs[n](this,i);this.tech.ready(r)},vjs.Player.prototype.unloadTech=function(){this.isReady_=!1;this.tech.dispose();this.tech=!1},vjs.Player.prototype.showPlayerLoad=function(){this.removeClass("vjs-waiting");this.removeClass("vjs-seeking");this.removeClass("vjs-paused");this.removeClass("vjs-playing");this.addClass("vjs-loading")},vjs.Player.prototype.onLoadStart=function(){if(this.removeClass("vjs-ended"),this.error(null),this.paused())this.one("canplaythrough",function(){this.options_.autoplay||this.techName==="Html5"||this.hasStarted(!1)});else this.trigger("firstplay");this.techName==="Html5"&&this.hasStarted(!1)},vjs.Player.prototype.hasStarted_=!1,vjs.Player.prototype.hasStarted=function(n){return n!==undefined?(this.hasStarted_!==n&&(this.hasStarted_=n,n?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started")),this):this.hasStarted_},vjs.Player.prototype.onLoadedMetaData,vjs.Player.prototype.onLoadedData,vjs.Player.prototype.onLoadedAllData,vjs.Player.prototype.onPlay=function(){this.removeClass("vjs-ended");this.removeClass("vjs-paused");this.addClass("vjs-playing");this.hasStarted(!0)},vjs.Player.prototype.onWaiting=function(){this.addClass("vjs-waiting")},vjs.Player.prototype.onWaitEnd=function(){this.removeClass("vjs-loading");this.removeClass("vjs-waiting")},vjs.Player.prototype.onSeeking=function(){this.addClass("vjs-seeking")},vjs.Player.prototype.onSeeked=function(){this.removeClass("vjs-seeking")},vjs.Player.prototype.onFirstPlay=function(){this.options_.starttime&&this.currentTime(this.options_.starttime);this.addClass("vjs-has-started")},vjs.Player.prototype.onPause=function(){this.removeClass("vjs-playing");this.addClass("vjs-paused")},vjs.Player.prototype.onTimeUpdate,vjs.Player.prototype.onProgress=function(){this.bufferedPercent()==1&&this.trigger("loadedalldata")},vjs.Player.prototype.onEnded=function(){this.addClass("vjs-ended");this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause()},vjs.Player.prototype.onDurationChange=function(){var n=this.techGet("duration");n&&(n<0&&(n=Infinity),this.duration(n),n===Infinity?this.addClass("vjs-live"):this.removeClass("vjs-live"))},vjs.Player.prototype.onVolumeChange,vjs.Player.prototype.onFullscreenChange=function(){this.isFullscreen()?(this.addClass("vjs-fullscreen"),vjs.IS_ANDROID&&(this.el_.style.position="relative")):this.removeClass("vjs-fullscreen")},vjs.Player.prototype.onError,vjs.Player.prototype.cache_,vjs.Player.prototype.getCache=function(){return this.cache_},vjs.Player.prototype.techCall=function(n,t){if(this.tech&&!this.tech.isReady_)this.tech.ready(function(){this[n](t)});else try{this.tech[n](t)}catch(i){vjs.log(i);throw i;}},vjs.Player.prototype.techGet=function(n){if(this.tech&&this.tech.isReady_)try{return this.tech[n]()}catch(t){this.tech[n]===undefined?vjs.log("Video.js: "+n+" method not defined for "+this.techName+" playback technology.",t):t.name=="TypeError"?(vjs.log("Video.js: "+n+" unavailable on "+this.techName+" playback technology element.",t),this.tech.isReady_=!1):vjs.log(t);throw t;}return},vjs.Player.prototype.play=function(){return this.techCall("play"),this},vjs.Player.prototype.pause=function(){return this.techCall("pause"),this},vjs.Player.prototype.paused=function(){return this.techGet("paused")===!1?!1:!0},vjs.Player.prototype.currentTime=function(n){return n!==undefined?(this.techCall("setCurrentTime",n),this):this.cache_.currentTime=this.techGet("currentTime")||0},vjs.Player.prototype.duration=function(n){return n!==undefined?(this.cache_.duration=parseFloat(n),this):(this.cache_.duration===undefined&&this.onDurationChange(),this.cache_.duration||0)},vjs.Player.prototype.remainingTime=function(){return this.duration()-this.currentTime()},vjs.Player.prototype.buffered=function(){var n=this.techGet("buffered");return n&&n.length||(n=vjs.createTimeRange(0,0)),n},vjs.Player.prototype.bufferedPercent=function(){var t=this.duration(),r=this.buffered(),u=0,f,i,n;if(!t)return 0;for(n=0;n<r.length;n++)f=r.start(n),i=r.end(n),i>t&&(i=t),u+=i-f;return u/t},vjs.Player.prototype.bufferedEnd=function(){var t=this.buffered(),i=this.duration(),n=t.end(t.length-1);return n>i&&(n=i),n},vjs.Player.prototype.volume=function(n){var t;return n!==undefined?(t=Math.max(0,Math.min(1,parseFloat(n))),this.cache_.volume=t,this.techCall("setVolume",t),vjs.setLocalStorage("volume",t),this):(t=parseFloat(this.techGet("volume")),isNaN(t)?1:t)},vjs.Player.prototype.muted=function(n){return n!==undefined?(n?this.cache_.muted=!0:(this.cache_.muted=!1,this.cache_.volume!==undefined&&this.volume(this.cache_.volume)),this.techCall("setMuted",n),this):this.techGet("muted")||!1},vjs.Player.prototype.supportsFullScreen=function(){return this.techGet("supportsFullScreen")||!1},vjs.Player.prototype.isFullscreen_=!1,vjs.Player.prototype.isFullscreen=function(n){return n!==undefined?(this.isFullscreen_=!!n,this):this.isFullscreen_},vjs.Player.prototype.isFullScreen=function(n){return vjs.log.warn('player.isFullScreen() has been deprecated, use player.isFullscreen() with a lowercase "s")'),this.isFullscreen(n)},vjs.Player.prototype.requestFullscreen=function(){var n=vjs.browser.fullscreenAPI;if(this.isFullscreen(!0),n){vjs.on(document,n.fullscreenchange,vjs.bind(this,function(t){this.isFullscreen(document[n.fullscreenElement]);this.isFullscreen()===!1&&vjs.off(document,n.fullscreenchange,arguments.callee);t.currentTarget&&t.currentTarget.nodeType==t.currentTarget.DOCUMENT_NODE&&this.trigger("fullscreenchange")}));this.el_[n.requestFullscreen]()}else this.tech.supportsFullScreen()?this.techCall("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange"));return this},vjs.Player.prototype.requestFullScreen=function(){return vjs.log.warn('player.requestFullScreen() has been deprecated, use player.requestFullscreen() with a lowercase "s")'),this.requestFullscreen()},vjs.Player.prototype.exitFullscreen=function(){var n=vjs.browser.fullscreenAPI;return this.isFullscreen(!1),n?document[n.exitFullscreen]():this.tech.supportsFullScreen()?this.techCall("exitFullScreen"):(this.exitFullWindow(),this.trigger("fullscreenchange")),this},vjs.Player.prototype.cancelFullScreen=function(){return vjs.log.warn("player.cancelFullScreen() has been deprecated, use player.exitFullscreen()"),this.exitFullscreen()},vjs.Player.prototype.enterFullWindow=function(){this.isFullWindow=!0;this.docOrigOverflow=document.documentElement.style.overflow;vjs.on(document,"keydown",vjs.bind(this,this.fullWindowOnEscKey));document.documentElement.style.overflow="hidden";vjs.addClass(document.body,"vjs-full-window");this.trigger("enterFullWindow")},vjs.Player.prototype.fullWindowOnEscKey=function(n){n.keyCode===27&&(this.isFullscreen()===!0?this.exitFullscreen():this.exitFullWindow())},vjs.Player.prototype.exitFullWindow=function(){this.isFullWindow=!1;vjs.off(document,"keydown",this.fullWindowOnEscKey);document.documentElement.style.overflow=this.docOrigOverflow;vjs.removeClass(document.body,"vjs-full-window");this.trigger("exitFullWindow")},vjs.Player.prototype.selectSource=function(n){for(var i,r,u,e,o,t=0,f=this.options_.techOrder;t<f.length;t++){if(i=vjs.capitalize(f[t]),r=window.videojs[i],!r){vjs.log.error('The "'+i+'" tech is undefined. Skipped browser support check for that tech.');continue}if(r.isSupported())for(u=0,e=n;u<e.length;u++)if(o=e[u],r.canPlaySource(o))return{source:o,tech:i}}return!1},vjs.Player.prototype.src=function(n){return n===undefined?this.techGet("src"):(vjs.obj.isArray(n)?this.sourceList_(n):typeof n=="string"?this.src({src:n}):n instanceof Object&&(n.type&&!window.videojs[this.techName].canPlaySource(n)?this.sourceList_([n]):(this.cache_.src=n.src,this.currentType_=n.type||"",this.ready(function(){window.videojs[this.techName].prototype.hasOwnProperty("setSource")?this.techCall("setSource",n):this.techCall("src",n.src);this.options_.preload=="auto"&&this.load();this.options_.autoplay&&this.play()}))),this)},vjs.Player.prototype.sourceList_=function(n){var t=this.selectSource(n);t?t.tech===this.techName?this.src(t.source):this.loadTech(t.tech,t.source):(this.setTimeout(function(){this.error({code:4,message:this.localize(this.options().notSupportedMessage)})},0),this.triggerReady())},vjs.Player.prototype.load=function(){return this.techCall("load"),this},vjs.Player.prototype.currentSrc=function(){return this.techGet("currentSrc")||this.cache_.src||""},vjs.Player.prototype.currentType=function(){return this.currentType_||""},vjs.Player.prototype.preload=function(n){return n!==undefined?(this.techCall("setPreload",n),this.options_.preload=n,this):this.techGet("preload")},vjs.Player.prototype.autoplay=function(n){return n!==undefined?(this.techCall("setAutoplay",n),this.options_.autoplay=n,this):this.techGet("autoplay",n)},vjs.Player.prototype.loop=function(n){return n!==undefined?(this.techCall("setLoop",n),this.options_.loop=n,this):this.techGet("loop")},vjs.Player.prototype.poster_,vjs.Player.prototype.poster=function(n){return n===undefined?this.poster_:(n||(n=""),this.poster_=n,this.techCall("setPoster",n),this.trigger("posterchange"),this)},vjs.Player.prototype.controls_,vjs.Player.prototype.controls=function(n){return n!==undefined?(n=!!n,this.controls_!==n&&(this.controls_=n,n?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled")):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"))),this):this.controls_},vjs.Player.prototype.usingNativeControls_,vjs.Player.prototype.usingNativeControls=function(n){return n!==undefined?(n=!!n,this.usingNativeControls_!==n&&(this.usingNativeControls_=n,n?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols"))),this):this.usingNativeControls_},vjs.Player.prototype.error_=null,vjs.Player.prototype.error=function(n){return n===undefined?this.error_:(this.tech&&vjs.MediaTechController.prototype.stopTracking.call(this.tech),n===null)?(this.error_=n,this.removeClass("vjs-error"),this):(this.error_=n instanceof vjs.MediaError?n:new vjs.MediaError(n),this.trigger("error"),this.addClass("vjs-error"),vjs.log.error("(CODE:"+this.error_.code+" "+vjs.MediaError.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this)},vjs.Player.prototype.ended=function(){return this.techGet("ended")},vjs.Player.prototype.seeking=function(){return this.techGet("seeking")},vjs.Player.prototype.userActivity_=!0,vjs.Player.prototype.reportUserActivity=function(){this.userActivity_=!0},vjs.Player.prototype.userActive_=!0,vjs.Player.prototype.userActive=function(n){if(n!==undefined){if(n=!!n,n!==this.userActive_)if(this.userActive_=n,n)this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive");else{if(this.userActivity_=!1,this.tech)this.tech.one("mousemove",function(n){n.stopPropagation();n.preventDefault()});this.removeClass("vjs-user-active");this.addClass("vjs-user-inactive");this.trigger("userinactive")}return this}return this.userActive_},vjs.Player.prototype.listenForUserActivity=function(){var n,i,r,t,u,s,f,e,o;n=vjs.bind(this,this.reportUserActivity);i=function(t){(t.screenX!=e||t.screenY!=o)&&(e=t.screenX,o=t.screenY,n())};r=function(){n();this.clearInterval(t);t=this.setInterval(n,250)};u=function(){n();this.clearInterval(t)};this.on("mousedown",r);this.on("mousemove",i);this.on("mouseup",u);this.on("keydown",n);this.on("keyup",n);s=this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1;this.userActive(!0);this.clearTimeout(f);var n=this.options().inactivityTimeout;n>0&&(f=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},n))}},250)},vjs.Player.prototype.playbackRate=function(n){return n!==undefined?(this.techCall("setPlaybackRate",n),this):this.tech&&this.tech.featuresPlaybackRate?this.techGet("playbackRate"):1},vjs.Player.prototype.isAudio_=!1,vjs.Player.prototype.isAudio=function(n){return n!==undefined?(this.isAudio_=!!n,this):this.isAudio_},vjs.Player.prototype.networkState=function(){return this.techGet("networkState")},vjs.Player.prototype.readyState=function(){return this.techGet("readyState")},vjs.Player.prototype.textTracks=function(){return this.tech&&this.tech.textTracks()},vjs.Player.prototype.remoteTextTracks=function(){return this.tech&&this.tech.remoteTextTracks()},vjs.Player.prototype.addTextTrack=function(n,t,i){return this.tech&&this.tech.addTextTrack(n,t,i)},vjs.Player.prototype.addRemoteTextTrack=function(n){return this.tech&&this.tech.addRemoteTextTrack(n)},vjs.Player.prototype.removeRemoteTextTrack=function(n){this.tech&&this.tech.removeRemoteTextTrack(n)},vjs.ControlBar=vjs.Component.extend(),vjs.ControlBar.prototype.options_={loadEvent:"play",children:{playToggle:{},currentTimeDisplay:{},timeDivider:{},durationDisplay:{},remainingTimeDisplay:{},liveDisplay:{},progressControl:{},fullscreenToggle:{},volumeControl:{},muteToggle:{},playbackRateMenuButton:{},subtitlesButton:{},captionsButton:{},chaptersButton:{}}},vjs.ControlBar.prototype.createEl=function(){return vjs.createEl("div",{className:"vjs-control-bar"})},vjs.LiveDisplay=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t)}}),vjs.LiveDisplay.prototype.createEl=function(){var n=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-live-controls vjs-control",tabIndex:0});return this.contentEl_=vjs.createEl("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+vjs.util.htmlEncode(this.localize("Stream Type"))+"<\/span>"+vjs.util.htmlEncode(this.localize("LIVE")),"aria-live":"off"}),n.appendChild(this.contentEl_),n},vjs.PlayToggle=vjs.Button.extend({init:function(n,t){vjs.Button.call(this,n,t);this.on(n,"play",this.onPlay);this.on(n,"pause",this.onPause)}}),vjs.PlayToggle.prototype.buttonText="Play",vjs.PlayToggle.prototype.buildCSSClass=function(){return"vjs-play-control "+vjs.Button.prototype.buildCSSClass.call(this)},vjs.PlayToggle.prototype.onClick=function(){this.player_.paused()?this.player_.play():this.player_.pause()},vjs.PlayToggle.prototype.onPlay=function(){this.removeClass("vjs-paused");this.addClass("vjs-playing");this.el_.children[0].children[0].innerHTML=vjs.util.htmlEncode(this.localize("Pause"))},vjs.PlayToggle.prototype.onPause=function(){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.el_.children[0].children[0].innerHTML=vjs.util.htmlEncode(this.localize("Play"))},vjs.CurrentTimeDisplay=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t);this.on(n,"timeupdate",this.updateContent)}}),vjs.CurrentTimeDisplay.prototype.createEl=function(){var n=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-current-time vjs-time-controls vjs-control"});return this.contentEl_=vjs.createEl("div",{className:"vjs-current-time-display",innerHTML:'<span class="vjs-control-text">'+vjs.util.htmlEncode(this.localize("Current Time"))+" <\/span>0:00","aria-live":"off"}),n.appendChild(this.contentEl_),n},vjs.CurrentTimeDisplay.prototype.updateContent=function(){var n=this.player_.scrubbing?this.player_.getCache().currentTime:this.player_.currentTime();this.contentEl_.innerHTML='<span class="vjs-control-text">'+vjs.util.htmlEncode(this.localize("Current Time"))+"<\/span> "+vjs.formatTime(n,this.player_.duration())},vjs.DurationDisplay=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t);this.on(n,"timeupdate",this.updateContent)}}),vjs.DurationDisplay.prototype.createEl=function(){var n=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-duration vjs-time-controls vjs-control"});return this.contentEl_=vjs.createEl("div",{className:"vjs-duration-display",innerHTML:'<span class="vjs-control-text">'+vjs.util.htmlEncode(this.localize("Duration Time"))+"<\/span> 0:00","aria-live":"off"}),n.appendChild(this.contentEl_),n},vjs.DurationDisplay.prototype.updateContent=function(){var n=this.player_.duration();n&&(this.contentEl_.innerHTML='<span class="vjs-control-text">'+vjs.util.htmlEncode(this.localize("Duration Time"))+"<\/span> "+vjs.formatTime(n))},vjs.TimeDivider=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t)}}),vjs.TimeDivider.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-time-divider",innerHTML:"<div><span>/<\/span><\/div>"})},vjs.RemainingTimeDisplay=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t);this.on(n,"timeupdate",this.updateContent)}}),vjs.RemainingTimeDisplay.prototype.createEl=function(){var n=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-remaining-time vjs-time-controls vjs-control"});return this.contentEl_=vjs.createEl("div",{className:"vjs-remaining-time-display",innerHTML:'<span class="vjs-control-text">'+vjs.util.htmlEncode(this.localize("Remaining Time"))+"<\/span> -0:00","aria-live":"off"}),n.appendChild(this.contentEl_),n},vjs.RemainingTimeDisplay.prototype.updateContent=function(){this.player_.duration()&&(this.contentEl_.innerHTML='<span class="vjs-control-text">'+vjs.util.htmlEncode(this.localize("Remaining Time"))+"<\/span> -"+vjs.formatTime(this.player_.remainingTime()))},vjs.FullscreenToggle=vjs.Button.extend({init:function(n,t){vjs.Button.call(this,n,t)}}),vjs.FullscreenToggle.prototype.buttonText="Fullscreen",vjs.FullscreenToggle.prototype.buildCSSClass=function(){return"vjs-fullscreen-control "+vjs.Button.prototype.buildCSSClass.call(this)},vjs.FullscreenToggle.prototype.onClick=function(){this.player_.isFullscreen()?(this.player_.exitFullscreen(),this.controlText_.innerHTML=vjs.util.htmlEncode(this.localize("Fullscreen"))):(this.player_.requestFullscreen(),this.controlText_.innerHTML=vjs.util.htmlEncode(this.localize("Non-Fullscreen")))},vjs.ProgressControl=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t)}}),vjs.ProgressControl.prototype.options_={children:{seekBar:{}}},vjs.ProgressControl.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control",tabIndex:0})},vjs.SeekBar=vjs.Slider.extend({init:function(n,t){vjs.Slider.call(this,n,t);this.on(n,"timeupdate",this.updateARIAAttributes);n.ready(vjs.bind(this,this.updateARIAAttributes))}}),vjs.SeekBar.prototype.options_={children:{loadProgressBar:{},playProgressBar:{},seekHandle:{}},barName:"playProgressBar",handleName:"seekHandle"},vjs.SeekBar.prototype.playerEvent="timeupdate",vjs.SeekBar.prototype.createEl=function(){return vjs.Slider.prototype.createEl.call(this,"div",{className:"vjs-progress-holder","aria-label":"video progress bar"})},vjs.SeekBar.prototype.updateARIAAttributes=function(){var n=this.player_.scrubbing?this.player_.getCache().currentTime:this.player_.currentTime();this.el_.setAttribute("aria-valuenow",vjs.round(this.getPercent()*100,2));this.el_.setAttribute("aria-valuetext",vjs.formatTime(n,this.player_.duration()))},vjs.SeekBar.prototype.getPercent=function(){return this.player_.currentTime()>this.player_.duration()?1:this.player_.currentTime()/this.player_.duration()},vjs.SeekBar.prototype.onMouseDown=function(n){this.player_.scrubbing=!0;this.player_.addClass("vjs-scrubbing");this.videoWasPlaying=!this.player_.paused();this.player_.pause();vjs.Slider.prototype.onMouseDown.call(this,n)},vjs.SeekBar.prototype.onMouseMove=function(n){var t=this.calculateDistance(n)*this.player_.duration();t==this.player_.duration()&&(t=t-.1);this.player_.currentTime(t)},vjs.SeekBar.prototype.onMouseUp=function(n){vjs.Slider.prototype.onMouseUp.call(this,n);this.player_.scrubbing=!1;this.player_.removeClass("vjs-scrubbing");this.videoWasPlaying&&this.player_.play()},vjs.SeekBar.prototype.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)},vjs.SeekBar.prototype.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)},vjs.LoadProgressBar=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t);this.on(n,"progress",this.update)}}),vjs.LoadProgressBar.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+vjs.util.htmlEncode(this.localize("Loaded"))+"<\/span>: 0%<\/span>"})},vjs.LoadProgressBar.prototype.update=function(){var n,r,o,t,i=this.player_.buffered(),s=this.player_.duration(),u=this.player_.bufferedEnd(),f=this.el_.children,e=function(n,t){var i=n/t||0;return i*100+"%"};for(this.el_.style.width=e(u,s),n=0;n<i.length;n++)r=i.start(n),o=i.end(n),t=f[n],t||(t=this.el_.appendChild(vjs.createEl())),t.style.left=e(r,u),t.style.width=e(o-r,u);for(n=f.length;n>i.length;n--)this.el_.removeChild(f[n-1])},vjs.PlayProgressBar=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t)}}),vjs.PlayProgressBar.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-play-progress",innerHTML:'<span class="vjs-control-text"><span>'+vjs.util.htmlEncode(this.localize("Progress"))+"<\/span>: 0%<\/span>"})},vjs.SeekHandle=vjs.SliderHandle.extend({init:function(n,t){vjs.SliderHandle.call(this,n,t);this.on(n,"timeupdate",this.updateContent)}}),vjs.SeekHandle.prototype.defaultValue="00:00",vjs.SeekHandle.prototype.createEl=function(){return vjs.SliderHandle.prototype.createEl.call(this,"div",{className:"vjs-seek-handle","aria-live":"off"})},vjs.SeekHandle.prototype.updateContent=function(){var n=this.player_.scrubbing?this.player_.getCache().currentTime:this.player_.currentTime();this.el_.innerHTML='<span class="vjs-control-text">'+vjs.formatTime(n,this.player_.duration())+"<\/span>"},vjs.VolumeControl=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t);n.tech&&n.tech.featuresVolumeControl===!1&&this.addClass("vjs-hidden");this.on(n,"loadstart",function(){n.tech.featuresVolumeControl===!1?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")})}}),vjs.VolumeControl.prototype.options_={children:{volumeBar:{}}},vjs.VolumeControl.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control",tabIndex:0})},vjs.VolumeBar=vjs.Slider.extend({init:function(n,t){vjs.Slider.call(this,n,t);this.on(n,"volumechange",this.updateARIAAttributes);n.ready(vjs.bind(this,this.updateARIAAttributes))}}),vjs.VolumeBar.prototype.updateARIAAttributes=function(){this.el_.setAttribute("aria-valuenow",vjs.round(this.player_.volume()*100,2));this.el_.setAttribute("aria-valuetext",vjs.round(this.player_.volume()*100,2)+"%")},vjs.VolumeBar.prototype.options_={children:{volumeLevel:{},volumeHandle:{}},barName:"volumeLevel",handleName:"volumeHandle"},vjs.VolumeBar.prototype.playerEvent="volumechange",vjs.VolumeBar.prototype.createEl=function(){return vjs.Slider.prototype.createEl.call(this,"div",{className:"vjs-volume-bar","aria-label":"volume level"})},vjs.VolumeBar.prototype.onMouseMove=function(n){this.player_.muted()&&this.player_.muted(!1);this.player_.volume(this.calculateDistance(n))},vjs.VolumeBar.prototype.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},vjs.VolumeBar.prototype.stepForward=function(){this.player_.volume(this.player_.volume()+.1)},vjs.VolumeBar.prototype.stepBack=function(){this.player_.volume(this.player_.volume()-.1)},vjs.VolumeLevel=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t)}}),vjs.VolumeLevel.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"><\/span>'})},vjs.VolumeHandle=vjs.SliderHandle.extend(),vjs.VolumeHandle.prototype.defaultValue="00:00",vjs.VolumeHandle.prototype.createEl=function(){return vjs.SliderHandle.prototype.createEl.call(this,"div",{className:"vjs-volume-handle"})},vjs.MuteToggle=vjs.Button.extend({init:function(n,t){vjs.Button.call(this,n,t);this.on(n,"volumechange",this.update);n.tech&&n.tech.featuresVolumeControl===!1&&this.addClass("vjs-hidden");this.on(n,"loadstart",function(){n.tech.featuresVolumeControl===!1?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")})}}),vjs.MuteToggle.prototype.createEl=function(){return vjs.Button.prototype.createEl.call(this,"div",{className:"vjs-mute-control vjs-control",innerHTML:'<div><span class="vjs-control-text">'+vjs.util.htmlEncode(this.localize("Mute"))+"<\/span><\/div>",tabIndex:0})},vjs.MuteToggle.prototype.onClick=function(){this.player_.muted(this.player_.muted()?!1:!0)},vjs.MuteToggle.prototype.update=function(){var i=this.player_.volume(),n=3,t;for(i===0||this.player_.muted()?n=0:i<.33?n=1:i<.67&&(n=2),this.player_.muted()?this.el_.children[0].children[0].innerHTML!=vjs.util.htmlEncode(this.localize("Unmute"))&&(this.el_.children[0].children[0].innerHTML=vjs.util.htmlEncode(this.localize("Unmute"))):this.el_.children[0].children[0].innerHTML!=vjs.util.htmlEncode(this.localize("Mute"))&&(this.el_.children[0].children[0].innerHTML=vjs.util.htmlEncode(this.localize("Mute"))),t=0;t<4;t++)vjs.removeClass(this.el_,"vjs-vol-"+t);vjs.addClass(this.el_,"vjs-vol-"+n)},vjs.VolumeMenuButton=vjs.MenuButton.extend({init:function(n,t){vjs.MenuButton.call(this,n,t);this.on(n,"volumechange",this.volumeUpdate);n.tech&&n.tech.featuresVolumeControl===!1&&this.addClass("vjs-hidden");this.on(n,"loadstart",function(){n.tech.featuresVolumeControl===!1?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")});this.addClass("vjs-menu-button")}}),vjs.VolumeMenuButton.prototype.createMenu=function(){var n=new vjs.Menu(this.player_,{contentElType:"div"}),t=new vjs.VolumeBar(this.player_,this.options_.volumeBar);t.on("focus",function(){n.lockShowing()});t.on("blur",function(){n.unlockShowing()});return n.addChild(t),n},vjs.VolumeMenuButton.prototype.onClick=function(n){vjs.MuteToggle.prototype.onClick.call(this,n);vjs.MenuButton.prototype.onClick.call(this,n)},vjs.VolumeMenuButton.prototype.createEl=function(){return vjs.Button.prototype.createEl.call(this,"div",{className:"vjs-volume-menu-button vjs-menu-button vjs-control",innerHTML:'<div><span class="vjs-control-text">'+vjs.util.htmlEncode(this.localize("Mute"))+"<\/span><\/div>"})},vjs.VolumeMenuButton.prototype.volumeUpdate=vjs.MuteToggle.prototype.update,vjs.PlaybackRateMenuButton=vjs.MenuButton.extend({init:function(n,t){vjs.MenuButton.call(this,n,t);this.updateVisibility();this.updateLabel();this.on(n,"loadstart",this.updateVisibility);this.on(n,"ratechange",this.updateLabel)}}),vjs.PlaybackRateMenuButton.prototype.buttonText="Playback Rate",vjs.PlaybackRateMenuButton.prototype.className="vjs-playback-rate",vjs.PlaybackRateMenuButton.prototype.createEl=function(){var n=vjs.MenuButton.prototype.createEl.call(this);return this.labelEl_=vjs.createEl("div",{className:"vjs-playback-rate-value",innerHTML:1}),n.appendChild(this.labelEl_),n},vjs.PlaybackRateMenuButton.prototype.createMenu=function(){var i=new vjs.Menu(this.player()),t=this.player().options().playbackRates,n;if(t)for(n=t.length-1;n>=0;n--)i.addChild(new vjs.PlaybackRateMenuItem(this.player(),{rate:t[n]+"x"}));return i},vjs.PlaybackRateMenuButton.prototype.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},vjs.PlaybackRateMenuButton.prototype.onClick=function(){for(var r=this.player().playbackRate(),n=this.player().options().playbackRates,i=n[0],t=0;t<n.length;t++)if(n[t]>r){i=n[t];break}this.player().playbackRate(i)},vjs.PlaybackRateMenuButton.prototype.playbackRateSupported=function(){return this.player().tech&&this.player().tech.featuresPlaybackRate&&this.player().options().playbackRates&&this.player().options().playbackRates.length>0},vjs.PlaybackRateMenuButton.prototype.updateVisibility=function(){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},vjs.PlaybackRateMenuButton.prototype.updateLabel=function(){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},vjs.PlaybackRateMenuItem=vjs.MenuItem.extend({contentElType:"button",init:function(n,t){var i=this.label=t.rate,r=this.rate=parseFloat(i,10);t.label=i;t.selected=r===1;vjs.MenuItem.call(this,n,t);this.on(n,"ratechange",this.update)}}),vjs.PlaybackRateMenuItem.prototype.onClick=function(){vjs.MenuItem.prototype.onClick.call(this);this.player().playbackRate(this.rate)},vjs.PlaybackRateMenuItem.prototype.update=function(){this.selected(this.player().playbackRate()==this.rate)},vjs.PosterImage=vjs.Button.extend({init:function(n,t){vjs.Button.call(this,n,t);this.update();n.on("posterchange",vjs.bind(this,this.update))}}),vjs.PosterImage.prototype.dispose=function(){this.player().off("posterchange",this.update);vjs.Button.prototype.dispose.call(this)},vjs.PosterImage.prototype.createEl=function(){var n=vjs.createEl("div",{className:"vjs-poster",tabIndex:-1});return vjs.BACKGROUND_SIZE_SUPPORTED||(this.fallbackImg_=vjs.createEl("img"),n.appendChild(this.fallbackImg_)),n},vjs.PosterImage.prototype.update=function(){var n=this.player().poster();this.setSrc(n);n?this.show():this.hide()},vjs.PosterImage.prototype.setSrc=function(n){var t;n.search(/^(https?:)?\/\//i)!==-1?n=encodeURI(n):(vjs.log.warn("ignoring invalid poster URL"),n="");this.fallbackImg_?this.fallbackImg_.src=n:(t="",n&&(t='url("'+n+'")'),this.el_.style.backgroundImage=t)},vjs.PosterImage.prototype.onClick=function(){this.player_.play()},vjs.LoadingSpinner=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t)}}),vjs.LoadingSpinner.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",tabIndex:-1})},vjs.BigPlayButton=vjs.Button.extend(),vjs.BigPlayButton.prototype.createEl=function(){return vjs.Button.prototype.createEl.call(this,"div",{className:"vjs-big-play-button",innerHTML:'<span aria-hidden="true"><\/span>',"aria-label":"play video"})},vjs.BigPlayButton.prototype.onClick=function(){this.player_.play()},vjs.ErrorDisplay=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t);this.update();this.on(n,"error",this.update);this.on(n,"fullscreenchange",this.onResize);this.on(n,"resize",this.onResize)}}),vjs.ErrorDisplay.prototype.createEl=function(){var n=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-error-display",tabIndex:0});return this.contentEl_=vjs.createEl("div"),n.appendChild(this.contentEl_),n},vjs.ErrorDisplay.prototype.update=function(){this.player().error()&&(this.contentEl_.innerHTML=vjs.util.htmlEncode(this.localize(this.player().error().message)))},vjs.ErrorDisplay.prototype.onResize=function(){var n=Math.max(this.player_.el_.clientWidth*.02,8);this.contentEl_.style.fontSize=parseInt(n)+"px"},vjs.EventEmitter=function(){},vjs.EventEmitter.prototype.allowedEvents_={},vjs.EventEmitter.prototype.on=function(n,t){var i=this.addEventListener;this.addEventListener=Function.prototype;vjs.on(this,n,t);this.addEventListener=i},vjs.EventEmitter.prototype.addEventListener=vjs.EventEmitter.prototype.on,vjs.EventEmitter.prototype.off=function(n,t){vjs.off(this,n,t)},vjs.EventEmitter.prototype.removeEventListener=vjs.EventEmitter.prototype.off,vjs.EventEmitter.prototype.one=function(n,t){vjs.one(this,n,t)},vjs.EventEmitter.prototype.trigger=function(n){var t=n.type||n;typeof n=="string"&&(n={type:t});n=vjs.fixEvent(n);this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](n);vjs.trigger(this,n)},vjs.EventEmitter.prototype.dispatchEvent=vjs.EventEmitter.prototype.trigger,function(){var n;vjs.MediaTechController=vjs.Component.extend({init:function(n,t,i){t=t||{};t.reportTouchActivity=!1;vjs.Component.call(this,n,t,i);this.featuresProgressEvents||this.manualProgressOn();this.featuresTimeupdateEvents||this.manualTimeUpdatesOn();this.initControlsListeners();this.featuresNativeTextTracks||this.emulateTextTracks();this.initTextTrackListeners()}});vjs.MediaTechController.prototype.initControlsListeners=function(){var n=this.player();this.ready(this.activateControls);this.on(n,"controlsenabled",this.activateControls);this.on(n,"controlsdisabled",this.removeControlsListeners);this.ready(function(){this.networkState&&this.networkState()>0&&this.player().trigger("loadstart")})};vjs.MediaTechController.prototype.removeControls=function(){var n=this.player();this.off(n,"controlsenabled",this.activateControls);this.off(n,"controlsdisabled",this.removeControlsListeners)};vjs.MediaTechController.prototype.addControlsListeners=function(){var n;this.on("mousedown",this.onClick);this.on("touchstart",function(){n=this.player_.userActive()});this.on("touchmove",function(){n&&this.player().reportUserActivity()});this.on("touchend",function(n){n.preventDefault()});this.emitTapEvents();this.on("tap",this.onTap)};vjs.MediaTechController.prototype.activateControls=function(){var n=this.player();n.controls()&&!n.usingNativeControls()&&this.addControlsListeners()};vjs.MediaTechController.prototype.removeControlsListeners=function(){this.off("tap");this.off("touchstart");this.off("touchmove");this.off("touchleave");this.off("touchcancel");this.off("touchend");this.off("click");this.off("mousedown")};vjs.MediaTechController.prototype.onClick=function(n){n.button===0&&this.player().controls()&&(this.player().paused()?this.player().play():this.player().pause())};vjs.MediaTechController.prototype.onTap=function(){this.player().userActive(!this.player().userActive())};vjs.MediaTechController.prototype.manualProgressOn=function(){this.manualProgress=!0;this.trackProgress()};vjs.MediaTechController.prototype.manualProgressOff=function(){this.manualProgress=!1;this.stopTrackingProgress()};vjs.MediaTechController.prototype.trackProgress=function(){this.progressInterval=this.setInterval(function(){var n=this.player().bufferedPercent();this.bufferedPercent_!=n&&this.player().trigger("progress");this.bufferedPercent_=n;n===1&&this.stopTrackingProgress()},500)};vjs.MediaTechController.prototype.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)};vjs.MediaTechController.prototype.manualTimeUpdatesOn=function(){var n=this.player_;this.manualTimeUpdates=!0;this.on(n,"play",this.trackCurrentTime);this.on(n,"pause",this.stopTrackingCurrentTime);this.one("timeupdate",function(){this.featuresTimeupdateEvents=!0;this.manualTimeUpdatesOff()})};vjs.MediaTechController.prototype.manualTimeUpdatesOff=function(){var n=this.player_;this.manualTimeUpdates=!1;this.stopTrackingCurrentTime();this.off(n,"play",this.trackCurrentTime);this.off(n,"pause",this.stopTrackingCurrentTime)};vjs.MediaTechController.prototype.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime();this.currentTimeInterval=this.setInterval(function(){this.player().trigger("timeupdate")},250)};vjs.MediaTechController.prototype.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval);this.player().trigger("timeupdate")};vjs.MediaTechController.prototype.stopTracking=function(){this.manualProgress&&this.manualProgressOff();this.manualTimeUpdates&&this.manualTimeUpdatesOff()};vjs.MediaTechController.prototype.dispose=function(){this.stopTracking();this.removeControls();vjs.Component.prototype.dispose.call(this)};vjs.MediaTechController.prototype.setCurrentTime=function(){this.manualTimeUpdates&&this.player().trigger("timeupdate")};vjs.MediaTechController.prototype.initTextTrackListeners=function(){var i=this.player_,n,t=function(){var n=i.getChild("textTrackDisplay");n&&n.updateDisplay()};if(n=this.textTracks(),n){n.addEventListener("removetrack",t);n.addEventListener("addtrack",t);this.on("dispose",vjs.bind(this,function(){n.removeEventListener("removetrack",t);n.removeEventListener("addtrack",t)}))}};vjs.MediaTechController.prototype.emulateTextTracks=function(){var i=this.player_,t,n;if(n=this.textTracks(),n){t=function(){var t,r,n;for(n=i.getChild("textTrackDisplay"),n.updateDisplay(),t=0;t<this.length;t++)r=this[t],r.removeEventListener("cuechange",vjs.bind(n,n.updateDisplay)),r.mode==="showing"&&r.addEventListener("cuechange",vjs.bind(n,n.updateDisplay))};n.addEventListener("change",t);this.on("dispose",vjs.bind(this,function(){n.removeEventListener("change",t)}))}};vjs.MediaTechController.prototype.textTracks_;vjs.MediaTechController.prototype.textTracks=function(){return this.player_.textTracks_=this.player_.textTracks_||new vjs.TextTrackList,this.player_.textTracks_};vjs.MediaTechController.prototype.remoteTextTracks=function(){return this.player_.remoteTextTracks_=this.player_.remoteTextTracks_||new vjs.TextTrackList,this.player_.remoteTextTracks_};n=function(n,t,i,r,u){var e=n.textTracks(),f;return u=u||{},u.kind=t,i&&(u.label=i),r&&(u.language=r),u.player=n.player_,f=new vjs.TextTrack(u),e.addTrack_(f),f};vjs.MediaTechController.prototype.addTextTrack=function(t,i,r){if(!t)throw new Error("TextTrack kind is required but was not provided");return n(this,t,i,r)};vjs.MediaTechController.prototype.addRemoteTextTrack=function(t){var i=n(this,t.kind,t.label,t.language,t);return this.remoteTextTracks().addTrack_(i),{track:i}};vjs.MediaTechController.prototype.removeRemoteTextTrack=function(n){this.textTracks().removeTrack_(n);this.remoteTextTracks().removeTrack_(n)};vjs.MediaTechController.prototype.setPoster=function(){};vjs.MediaTechController.prototype.featuresVolumeControl=!0;vjs.MediaTechController.prototype.featuresFullscreenResize=!1;vjs.MediaTechController.prototype.featuresPlaybackRate=!1;vjs.MediaTechController.prototype.featuresProgressEvents=!1;vjs.MediaTechController.prototype.featuresTimeupdateEvents=!1;vjs.MediaTechController.prototype.featuresNativeTextTracks=!1;vjs.MediaTechController.withSourceHandlers=function(n){n.registerSourceHandler=function(t,i){var r=n.sourceHandlers;r||(r=n.sourceHandlers=[]);i===undefined&&(i=r.length);r.splice(i,0,t)};n.selectSourceHandler=function(t){for(var r=n.sourceHandlers||[],u,i=0;i<r.length;i++)if(u=r[i].canHandleSource(t),u)return r[i];return null};n.canPlaySource=function(t){var i=n.selectSourceHandler(t);return i?i.canHandleSource(t):""};n.prototype.setSource=function(t){var i=n.selectSourceHandler(t);i||(n.nativeSourceHandler?i=n.nativeSourceHandler:vjs.log.error("No source hander found for the current source."));this.disposeSourceHandler();this.off("dispose",this.disposeSourceHandler);this.currentSource_=t;this.sourceHandler_=i.handleSource(t,this);this.on("dispose",this.disposeSourceHandler);return this};n.prototype.disposeSourceHandler=function(){this.sourceHandler_&&this.sourceHandler_.dispose&&this.sourceHandler_.dispose()}};vjs.media={}}(),vjs.Html5=vjs.MediaTechController.extend({init:function(n,t,i){var o,s,r,u,h,f,e;if((t.nativeCaptions===!1||t.nativeTextTracks===!1||vjs.IS_IOS&&vjs.IS_SAFARI)&&(this.featuresNativeTextTracks=!1),vjs.MediaTechController.call(this,n,t,i),this.setupTriggers(),e=t.source,e&&(this.el_.currentSrc!==e.src||n.tag&&n.tag.initNetworkState_===3)&&this.setSource(e),this.el_.hasChildNodes()){for(o=this.el_.childNodes,s=o.length,f=[];s--;)u=o[s],h=u.nodeName.toLowerCase(),h==="track"&&(this.featuresNativeTextTracks?this.remoteTextTracks().addTrack_(u.track):f.push(u));for(r=0;r<f.length;r++)this.el_.removeChild(f[r])}if(this.featuresNativeTextTracks)this.on("loadstart",vjs.bind(this,this.hideCaptions));vjs.TOUCH_ENABLED&&n.options().nativeControlsForTouch===!0&&this.useNativeControls();this.triggerReady()}}),vjs.Html5.prototype.dispose=function(){vjs.Html5.disposeMediaElement(this.el_);vjs.MediaTechController.prototype.dispose.call(this)},vjs.Html5.prototype.createEl=function(){var t=this.player_,u,r,i,n=t.tag,e,h,o,f,s;if(n&&this.movingMediaElementInDOM!==!1)n.parentNode!==t.el()&&vjs.insertFirst(n,t.el());else{if(n?(h=n.cloneNode(!1),vjs.Html5.disposeMediaElement(n),n=h,t.tag=null):(n=vjs.createEl("video"),e=videojs.util.mergeOptions({},t.tagAttributes),vjs.TOUCH_ENABLED&&t.options().nativeControlsForTouch===!0||delete e.controls,vjs.setElementAttributes(n,vjs.obj.merge(e,{id:t.id()+"_html5_api","class":"vjs-tech"}))),n.player=t,t.options_.tracks)for(i=0;i<t.options_.tracks.length;i++)u=t.options_.tracks[i],r=document.createElement("track"),r.kind=u.kind,r.label=u.label,r.srclang=u.srclang,r.src=u.src,"default"in u&&r.setAttribute("default","default"),n.appendChild(r);vjs.insertFirst(n,t.el())}for(vjs.setElementAttributes(n,{oncontextmenu:"return false;",preload:"none"}),o=["autoplay","preload","loop","muted"],i=o.length-1;i>=0;i--)f=o[i],s={},typeof t.options_[f]!="undefined"&&(s[f]=t.options_[f]),vjs.setElementAttributes(n,s);return n},vjs.Html5.prototype.hideCaptions=function(){for(var t=this.el_.querySelectorAll("track"),n,i=t.length,r={captions:1,subtitles:1};i--;)n=t[i].track,n&&n.kind in r&&!t[i]["default"]&&(n.mode="disabled")},vjs.Html5.prototype.setupTriggers=function(){for(var n=vjs.Html5.Events.length-1;n>=0;n--)this.on(vjs.Html5.Events[n],this.eventHandler)},vjs.Html5.prototype.eventHandler=function(n){n.type=="error"&&this.error()?amp.Player.raiseError.call(this.player(),"html5",this.error().code<<20):(n.bubbles=!1,this.player().trigger(n),n.type=="canplaythrough"&&this.tag&&this.options_.autoplay&&this.paused()&&(delete this.tag.poster,this.play()))},vjs.Html5.prototype.useNativeControls=function(){var t,n,i,r,u;t=this;n=this.player();t.setControls(n.controls());i=function(){t.setControls(!0)};r=function(){t.setControls(!1)};n.on("controlsenabled",i);n.on("controlsdisabled",r);u=function(){n.off("controlsenabled",i);n.off("controlsdisabled",r)};t.on("dispose",u);n.on("usingcustomcontrols",u);n.usingNativeControls(!0)},vjs.Html5.prototype.play=function(){this.el_.play()},vjs.Html5.prototype.pause=function(){this.el_.pause()},vjs.Html5.prototype.paused=function(){return this.el_.paused},vjs.Html5.prototype.currentTime=function(){return this.el_.currentTime},vjs.Html5.prototype.currentAbsoluteTime=function(){return undefined},vjs.Html5.prototype.setCurrentTime=function(n){try{this.el_.currentTime=n}catch(t){vjs.log(t,"Video is not ready. (Video.js)")}},vjs.Html5.prototype.currentVideoStreamList=function(){return undefined},vjs.Html5.prototype.currentAudioStreamList=function(){return undefined},vjs.Html5.prototype.videoBufferData=function(){return undefined},vjs.Html5.prototype.audioBufferData=function(){return undefined},vjs.Html5.prototype.currentDownloadBitrate=function(){return undefined},vjs.Html5.prototype.currentPlaybackBitrate=function(){return undefined},vjs.Html5.prototype.duration=function(){return this.el_.duration||0},vjs.Html5.prototype.buffered=function(){return this.el_.buffered},vjs.Html5.prototype.isLive=function(){return this.duration()===Infinity||this.duration()===Number.MAX_VALUE?!0:!1},vjs.Html5.prototype.volume=function(){return this.el_.volume},vjs.Html5.prototype.setVolume=function(n){this.el_.volume=n},vjs.Html5.prototype.muted=function(){return this.el_.muted},vjs.Html5.prototype.setMuted=function(n){this.el_.muted=n},vjs.Html5.prototype.width=function(){return this.el_.offsetWidth},vjs.Html5.prototype.height=function(){return this.el_.offsetHeight},vjs.Html5.prototype.videoWidth=function(){return this.player().width()},vjs.Html5.prototype.videoHeight=function(){return this.player().height()},vjs.Html5.prototype.supportsFullScreen=function(){return typeof this.el_.webkitEnterFullScreen=="function"&&(/Android/.test(vjs.USER_AGENT)||!/Chrome|Mac OS X 10.5/.test(vjs.USER_AGENT))?!0:!1},vjs.Html5.prototype.enterFullScreen=function(){var n=this.el_;if("webkitDisplayingFullscreen"in n)this.one("webkitbeginfullscreen",function(){this.player_.isFullscreen(!0);this.one("webkitendfullscreen",function(){this.player_.isFullscreen(!1);this.player_.trigger("fullscreenchange")});this.player_.trigger("fullscreenchange")});n.paused&&n.networkState<=n.HAVE_METADATA?(this.el_.play(),this.setTimeout(function(){n.pause();n.webkitEnterFullScreen()},0)):n.webkitEnterFullScreen()},vjs.Html5.prototype.exitFullScreen=function(){this.el_.webkitExitFullScreen()},vjs.Html5.prototype.src=function(n){if(n===undefined)return this.el_.src;this.setSrc(n)},vjs.Html5.prototype.setSrc=function(n){this.setAutoplay(this.player().options_.autoplay);this.el_.src=n},vjs.Html5.prototype.load=function(){this.el_.load()},vjs.Html5.prototype.currentSrc=function(){return this.el_.currentSrc},vjs.Html5.prototype.poster=function(){return this.el_.poster},vjs.Html5.prototype.setPoster=function(n){this.el_.poster=n},vjs.Html5.prototype.preload=function(){return this.el_.preload},vjs.Html5.prototype.setPreload=function(n){this.el_.preload=n},vjs.Html5.prototype.autoplay=function(){return this.el_.autoplay},vjs.Html5.prototype.setAutoplay=function(n){this.el_.autoplay=n},vjs.Html5.prototype.controls=function(){return this.el_.controls},vjs.Html5.prototype.setControls=function(n){this.el_.controls=!!n},vjs.Html5.prototype.loop=function(){return this.el_.loop},vjs.Html5.prototype.setLoop=function(n){this.el_.loop=n},vjs.Html5.prototype.error=function(){return this.el_.error},vjs.Html5.prototype.seeking=function(){return this.el_.seeking},vjs.Html5.prototype.ended=function(){return this.el_.ended},vjs.Html5.prototype.defaultMuted=function(){return this.el_.defaultMuted},vjs.Html5.prototype.playbackRate=function(){return this.el_.playbackRate},vjs.Html5.prototype.setPlaybackRate=function(n){this.el_.playbackRate=n},vjs.Html5.prototype.networkState=function(){return this.el_.networkState},vjs.Html5.prototype.readyState=function(){return this.el_.readyState},vjs.Html5.prototype.textTracks=function(){return this.featuresNativeTextTracks?this.el_.textTracks:vjs.MediaTechController.prototype.textTracks.call(this)},vjs.Html5.prototype.addTextTrack=function(n,t,i){return this.featuresNativeTextTracks?this.el_.addTextTrack(n,t,i):vjs.MediaTechController.prototype.addTextTrack.call(this,n,t,i)},vjs.Html5.prototype.addRemoteTextTrack=function(n){if(!vjs.IS_IOS||!vjs.IS_SAFARI){if(!this.featuresNativeTextTracks)return vjs.MediaTechController.prototype.addRemoteTextTrack.call(this,n);var t=document.createElement("track");return n=n||{},n.kind&&(t.kind=n.kind),n.label&&(t.label=n.label),(n.language||n.srclang)&&(t.srclang=n.language||n.srclang),n["default"]&&(t["default"]=n["default"]),n.id&&(t.id=n.id),n.src&&(t.src=n.src),this.el().appendChild(t),t.track.mode=t.track.kind==="metadata"?"hidden":"disabled",t.onload=function(){var n=t.track;t.readyState>=2&&(n.kind==="metadata"&&n.mode!=="hidden"?n.mode="hidden":n.kind!=="metadata"&&n.mode!=="disabled"&&(n.mode="disabled"),t.onload=null)},this.remoteTextTracks().addTrack_(t.track),t}},vjs.Html5.prototype.removeRemoteTextTrack=function(n){if(!this.featuresNativeTextTracks)return vjs.MediaTechController.prototype.removeRemoteTextTrack.call(this,n);var i,t;for(this.remoteTextTracks().removeTrack_(n),i=this.el().querySelectorAll("track"),t=0;t<i.length;t++)if(i[t]===n||i[t].track===n){i[t].parentNode.removeChild(i[t]);break}},vjs.Html5.isSupported=function(){try{vjs.TEST_VID.volume=.5}catch(n){return!1}return!!vjs.TEST_VID.canPlayType},vjs.MediaTechController.withSourceHandlers(vjs.Html5),vjs.Html5.nativeSourceHandler={},vjs.Html5.nativeSourceHandler.canHandleSource=function(n){function u(n){try{return vjs.TEST_VID.canPlayType(n)}catch(t){return""}}var i,r,t;if(n.protectionInfo&&n.protectionInfo.length>0)for(t=0;t<n.protectionInfo.length;t++)if(n.protectionInfo[t].type==="PlayReady"||n.protectionInfo[t].type==="Widevine")return"";return n.type?u(n.type):n.src?(i=n.src.match(/\.([^.\/\?]+)(\?[^\/]+)?$/i),r=i&&i[1],u("video/"+r)):""},vjs.Html5.nativeSourceHandler.handleSource=function(n,t){t.setSrc(n.src)},vjs.Html5.nativeSourceHandler.dispose=function(){},vjs.Html5.registerSourceHandler(vjs.Html5.nativeSourceHandler),vjs.Html5.canControlVolume=function(){try{var n=vjs.TEST_VID.volume;return vjs.TEST_VID.volume=n/2+.1,n!==vjs.TEST_VID.volume}catch(t){return!1}},vjs.Html5.canControlPlaybackRate=function(){try{var n=vjs.TEST_VID.playbackRate;return vjs.TEST_VID.playbackRate=n/2+.1,n!==vjs.TEST_VID.playbackRate}catch(t){return!1}},vjs.Html5.supportsNativeTextTracks=function(){var n;return n=!!vjs.TEST_VID.textTracks,n&&vjs.TEST_VID.textTracks.length>0&&(n=typeof vjs.TEST_VID.textTracks[0].mode!="number"),n&&vjs.IS_FIREFOX&&(n=!1),n},vjs.Html5.prototype.featuresVolumeControl=vjs.Html5.canControlVolume(),vjs.Html5.prototype.featuresPlaybackRate=vjs.Html5.canControlPlaybackRate(),vjs.Html5.prototype.movingMediaElementInDOM=!vjs.IS_IOS,vjs.Html5.prototype.featuresFullscreenResize=!0,vjs.Html5.prototype.featuresProgressEvents=!0,vjs.Html5.prototype.featuresNativeTextTracks=vjs.Html5.supportsNativeTextTracks(),function(){var n,t=/^application\/(?:x-|vnd\.apple\.)mpegurl/i,i=/^video\/mp4/i;vjs.Html5.patchCanPlayType=function(){vjs.ANDROID_VERSION>=4&&(n||(n=vjs.TEST_VID.constructor.prototype.canPlayType),vjs.TEST_VID.constructor.prototype.canPlayType=function(i){return i&&t.test(i)?"maybe":n.call(this,i)});vjs.IS_OLD_ANDROID&&(n||(n=vjs.TEST_VID.constructor.prototype.canPlayType),vjs.TEST_VID.constructor.prototype.canPlayType=function(t){return t&&i.test(t)?"maybe":n.call(this,t)})};vjs.Html5.unpatchCanPlayType=function(){var t=vjs.TEST_VID.constructor.prototype.canPlayType;return vjs.TEST_VID.constructor.prototype.canPlayType=n,n=null,t};vjs.Html5.patchCanPlayType()}(),vjs.Html5.Events="loadstart,suspend,abort,error,emptied,stalled,loadedmetadata,loadeddata,canplay,canplaythrough,playing,waiting,seeking,seeked,ended,durationchange,timeupdate,progress,play,pause,ratechange,volumechange".split(","),vjs.Html5.disposeMediaElement=function(n){if(n){for(n.player=null,n.parentNode&&n.parentNode.removeChild(n);n.hasChildNodes();)n.removeChild(n.firstChild);n.removeAttribute("src");typeof n.load=="function"&&function(){try{n.load()}catch(t){}}()}},vjs.Flash=vjs.MediaTechController.extend({init:function(n,t,i){vjs.MediaTechController.call(this,n,t,i);var u=t.source,o=t.parentEl,f=this.el_=vjs.createEl("div",{id:n.id()+"_temp_flash"}),e=n.id()+"_flash_api",r=n.options_,s=vjs.obj.merge({readyFunction:"videojs.Flash.onReady",eventProxyFunction:"videojs.Flash.onEvent",errorEventProxyFunction:"videojs.Flash.onError",autoplay:r.autoplay,preload:r.preload,loop:r.loop,muted:r.muted},t.flashVars),h=vjs.obj.merge({wmode:"opaque",bgcolor:"#000000"},t.params),c=vjs.obj.merge({id:e,name:e,"class":"vjs-tech"},t.attributes);u&&this.ready(function(){this.setSource(u)});vjs.insertFirst(f,o);t.startTime&&this.ready(function(){this.load();this.play();this.currentTime(t.startTime)});vjs.IS_FIREFOX&&this.ready(function(){this.on("mousemove",function(){this.player().trigger({type:"mousemove",bubbles:!1})})});n.on("stageclick",n.reportUserActivity);this.el_=vjs.Flash.embed(t.swf,f,s,h,c)}}),vjs.Flash.prototype.dispose=function(){vjs.MediaTechController.prototype.dispose.call(this)},vjs.Flash.prototype.play=function(){this.el_.vjs_play()},vjs.Flash.prototype.pause=function(){this.el_.vjs_pause()},vjs.Flash.prototype.src=function(n){return n===undefined?this.currentSrc():this.setSrc(n)},vjs.Flash.prototype.setSrc=function(n){if(n=vjs.getAbsoluteURL(n),this.el_.vjs_src(n),this.player_.autoplay()){var t=this;this.setTimeout(function(){t.play()},0)}},vjs.Flash.prototype.setCurrentTime=function(n){this.lastSeekTarget_=n;this.el_.vjs_setProperty("currentTime",n);vjs.MediaTechController.prototype.setCurrentTime.call(this)},vjs.Flash.prototype.currentTime=function(){return this.seeking()?this.lastSeekTarget_||0:this.el_.vjs_getProperty("currentTime")},vjs.Flash.prototype.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.vjs_getProperty("currentSrc")},vjs.Flash.prototype.load=function(){this.el_.vjs_load()},vjs.Flash.prototype.poster=function(){this.el_.vjs_getProperty("poster")},vjs.Flash.prototype.setPoster=function(){},vjs.Flash.prototype.buffered=function(){return vjs.createTimeRange(0,this.el_.vjs_getProperty("buffered"))},vjs.Flash.prototype.supportsFullScreen=function(){return!1},vjs.Flash.prototype.enterFullScreen=function(){return!1},function(){function f(n){var t=n.charAt(0).toUpperCase()+n.slice(1);i["set"+t]=function(t){return this.el_.vjs_setProperty(n,t)}}function u(n){i[n]=function(){return this.el_.vjs_getProperty(n)}}for(var i=vjs.Flash.prototype,t="rtmpConnection,rtmpStream,preload,defaultPlaybackRate,playbackRate,autoplay,loop,mediaGroup,controller,controls,volume,muted,defaultMuted".split(","),r="error,networkState,readyState,seeking,initialTime,duration,startOffsetTime,paused,played,seekable,ended,videoTracks,audioTracks,videoWidth,videoHeight".split(","),n=0;n<t.length;n++)u(t[n]),f(t[n]);for(n=0;n<r.length;n++)u(r[n])}(),vjs.Flash.isSupported=function(){return vjs.Flash.version()[0]>=10},vjs.MediaTechController.withSourceHandlers(vjs.Flash),vjs.Flash.nativeSourceHandler={},vjs.Flash.nativeSourceHandler.canHandleSource=function(n){var t;return n.type?(t=n.type.replace(/;.*/,"").toLowerCase(),t in vjs.Flash.formats)?"maybe":"":""},vjs.Flash.nativeSourceHandler.handleSource=function(n,t){t.setSrc(n.src)},vjs.Flash.nativeSourceHandler.dispose=function(){},vjs.Flash.registerSourceHandler(vjs.Flash.nativeSourceHandler),vjs.Flash.formats={"video/flv":"FLV","video/x-flv":"FLV","video/mp4":"MP4","video/m4v":"MP4"},vjs.Flash.onReady=function(n){var t,i;t=vjs.el(n);i=t&&t.parentNode&&t.parentNode.player;i&&(t.player=i,vjs.Flash.checkReady(i.tech))},vjs.Flash.checkReady=function(n){n.el()&&(n.el().vjs_getProperty?n.triggerReady():this.setTimeout(function(){vjs.Flash.checkReady(n)},50))},vjs.Flash.onEvent=function(n,t){var i=vjs.el(n).player;i.trigger(t)},vjs.Flash.onError=function(n,t){var i=vjs.el(n).player,r="FLASH: "+t;t=="srcnotfound"?i.error({code:4,message:r}):i.error(r)},vjs.Flash.version=function(){var n="0,0,0";try{n=new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(t){try{navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin&&(n=(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1])}catch(i){}}return n.split(",")},vjs.Flash.embed=function(n,t,i,r,u){var o=vjs.Flash.getEmbedCode(n,i,r,u),f=vjs.createEl("div",{innerHTML:o}).childNodes[0],s=t.parentNode,e;return t.parentNode.replaceChild(f,t),e=s.childNodes[0],setTimeout(function(){e.style.display="block"},1e3),f},vjs.Flash.getEmbedCode=function(n,t,i,r){var u="",f="",e="";return t&&vjs.obj.each(t,function(n,t){u+=encodeURIComponent(n)+"="+encodeURIComponent(t)+"&amp;"}),delete i.flashvars,i=vjs.obj.merge({movie:n,flashvars:u,allowScriptAccess:"always",allowNetworking:"all"},i),vjs.obj.each(i,function(n,t){f+='<param name="'+encodeURIComponent(n)+'" value="'+(n!=="flashvars"?encodeURI(t):t)+'" />'}),r=vjs.obj.merge({data:n,width:"100%",height:"100%"},r),vjs.obj.each(r,function(n,t){e+=encodeURIComponent(n)+'="'+encodeURI(t)+'" '}),'<object type="application/x-shockwave-flash" '+e+">"+f+"<\/object>"},vjs.Flash.streamingFormats={"rtmp/mp4":"MP4","rtmp/flv":"FLV"},vjs.Flash.streamFromParts=function(n,t){return n+"&"+t},vjs.Flash.streamToParts=function(n){var i={connection:"",stream:""},t,r;return n?(t=n.indexOf("&"),t!==-1?r=t+1:(t=r=n.lastIndexOf("/")+1,t===0&&(t=r=n.length)),i.connection=n.substring(0,t),i.stream=n.substring(r,n.length),i):i},vjs.Flash.isStreamingType=function(n){return n in vjs.Flash.streamingFormats},vjs.Flash.RTMP_RE=/^rtmp[set]?:\/\//i,vjs.Flash.isStreamingSrc=function(n){return vjs.Flash.RTMP_RE.test(n)},vjs.Flash.rtmpSourceHandler={},vjs.Flash.rtmpSourceHandler.canHandleSource=function(n){return vjs.Flash.isStreamingType(n.type)||vjs.Flash.isStreamingSrc(n.src)?"maybe":""},vjs.Flash.rtmpSourceHandler.handleSource=function(n,t){var i=vjs.Flash.streamToParts(n.src);t.setRtmpConnection(i.connection);t.setRtmpStream(i.stream)},vjs.Flash.registerSourceHandler(vjs.Flash.rtmpSourceHandler),vjs.MediaLoader=vjs.Component.extend({init:function(n,t,i){var r,u,f,e;if(vjs.Component.call(this,n,t,i),n.options_.sources&&n.options_.sources.length!==0)n.src(n.options_.sources);else for(r=0,u=n.options_.techOrder;r<u.length;r++)if(f=vjs.capitalize(u[r]),e=window.videojs[f],e&&e.isSupported()){n.loadTech(f);break}}}),function(){"use strict";vjs.TextTrackDisplay=vjs.Component.extend({init:function(n,t,i){vjs.Component.call(this,n,t,i);n.on("loadstart",vjs.bind(this,this.toggleDisplay));n.ready(vjs.bind(this,function(){if(n.tech&&n.tech.featuresNativeTextTracks){this.hide();return}var t,i,r;n.on("fullscreenchange",vjs.bind(this,this.updateDisplay));for(i=n.options_.tracks||[],t=0;t<i.length;t++)r=i[t],this.player_.addRemoteTextTrack(r);n.options_.tracks.length=0}))}});vjs.TextTrackDisplay.prototype.toggleDisplay=function(){this.player_.tech&&this.player_.tech.featuresNativeTextTracks?this.hide():this.show()};vjs.TextTrackDisplay.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"})};vjs.TextTrackDisplay.prototype.clearDisplay=function(){typeof WebVTT=="function"&&window.WebVTT.processCues(window,[],this.el_)};var t=function(n,t){return"rgba("+parseInt(n[1]+n[1],16)+","+parseInt(n[2]+n[2],16)+","+parseInt(n[3]+n[3],16)+","+t+")"},n="#222",r="#ccc",u={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'},i=function(n,t,i){try{n.style[t]=i}catch(r){}};vjs.TextTrackDisplay.prototype.updateDisplay=function(){var n=this.player_.textTracks(),t=0,i;if(this.clearDisplay(),n)for(;t<n.length;t++)i=n[t],i.mode==="showing"&&this.updateForTrack(i)};vjs.TextTrackDisplay.prototype.updateForTrack=function(f){if(typeof WebVTT=="function"&&f.activeCues){for(var s=0,o,e=this.player_.textTrackSettings.getValues(),c,h=[];s<f.activeCues.length;s++)h.push(f.activeCues[s]);for(window.WebVTT.processCues(window,f.activeCues,this.el_),s=h.length;s--;)o=h[s].displayState,e.color&&(o.firstChild.style.color=e.color),e.textOpacity&&i(o.firstChild,"color",t(e.color||"#fff",e.textOpacity)),e.backgroundColor&&(o.firstChild.style.backgroundColor=e.backgroundColor),e.backgroundOpacity&&i(o.firstChild,"backgroundColor",t(e.backgroundColor||"#000",e.backgroundOpacity)),e.windowColor&&(e.windowOpacity?i(o,"backgroundColor",t(e.windowColor,e.windowOpacity)):o.style.backgroundColor=e.windowColor),e.edgeStyle&&(e.edgeStyle==="dropshadow"?o.firstChild.style.textShadow="2px 2px 3px "+n+", 2px 2px 4px "+n+", 2px 2px 5px "+n:e.edgeStyle==="raised"?o.firstChild.style.textShadow="1px 1px "+n+", 2px 2px "+n+", 3px 3px "+n:e.edgeStyle==="depressed"?o.firstChild.style.textShadow="1px 1px "+r+", 0 1px "+r+", -1px -1px "+n+", 0 -1px "+n:e.edgeStyle==="uniform"&&(o.firstChild.style.textShadow="0 0 4px "+n+", 0 0 4px "+n+", 0 0 4px "+n+", 0 0 4px "+n)),e.fontPercent&&e.fontPercent!==1&&(c=window.parseFloat(o.style.fontSize),o.style.fontSize=c*e.fontPercent+"px",o.style.height="auto",o.style.top="auto",o.style.bottom="2px"),e.fontFamily&&e.fontFamily!=="default"&&(e.fontFamily==="small-caps"?o.firstChild.style.fontVariant="small-caps":o.firstChild.style.fontFamily=u[e.fontFamily])}};vjs.TextTrackMenuItem=vjs.MenuItem.extend({init:function(n,t){function e(n){var t=vjs.getIsoLangs();return!n||!t||!t[n]?null:t[n].nativeName}var u=this.track=t.track,i=n.textTracks(),f,r;if(i){f=vjs.bind(this,function(){var t=this.track.mode==="showing",r,n,u;if(this instanceof vjs.OffTextTrackMenuItem)for(t=!0,n=0,u=i.length;n<u;n++)if(r=i[n],r.kind===this.track.kind&&r.mode==="showing"){t=!1;break}this.selected(t)});i.addEventListener("change",f);n.on("dispose",function(){i.removeEventListener("change",f)})}if(t.label=u.label||e(u.language)||"Unknown",t.selected=u["default"]||u.mode==="showing",vjs.MenuItem.call(this,n,t),i&&i.onchange===undefined)this.on(["tap","click"],function(){if(typeof Event!="object")try{r=new window.Event("change")}catch(n){}r||(r=document.createEvent("Event"),r.initEvent("change",!0,!0));i.dispatchEvent(r)})}});vjs.TextTrackMenuItem.prototype.onClick=function(n){var u=this.track.kind,i=this.player_.textTracks(),t,r=0;if(vjs.MenuItem.prototype.onClick.call(this,n),i)for(;r<i.length;r++)(t=i[r],t.kind===u)&&(t.mode=t===this.track?"showing":"disabled")};vjs.OffTextTrackMenuItem=vjs.TextTrackMenuItem.extend({init:function(n,t){t.track={kind:t.kind,player:n,label:t.kind+" off","default":!1,mode:"disabled"};vjs.TextTrackMenuItem.call(this,n,t);this.selected(!0)}});vjs.CaptionSettingsMenuItem=vjs.TextTrackMenuItem.extend({init:function(n,t){t.track={kind:t.kind,player:n,label:"Settings","default":!1,mode:"disabled"};vjs.TextTrackMenuItem.call(this,n,t);this.addClass("vjs-texttrack-settings")}});vjs.CaptionSettingsMenuItem.prototype.onClick=function(){this.player().getChild("textTrackSettings").show()};vjs.TextTrackButton=vjs.MenuButton.extend({init:function(n,t){var i,r;if(vjs.MenuButton.call(this,n,t),i=this.player_.textTracks(),this.items.length<=1&&this.hide(),i){r=vjs.bind(this,this.update);i.addEventListener("removetrack",r);i.addEventListener("addtrack",r);this.player_.on("dispose",function(){i.removeEventListener("removetrack",r);i.removeEventListener("addtrack",r)})}}});vjs.TextTrackButton.prototype.createItems=function(){var n=[],r,t,i;if(this instanceof vjs.CaptionsButton&&!(this.player().tech&&this.player().tech.featuresNativeTextTracks)&&n.push(new vjs.CaptionSettingsMenuItem(this.player_,{kind:this.kind_})),n.push(new vjs.OffTextTrackMenuItem(this.player_,{kind:this.kind_})),t=this.player_.textTracks(),!t)return n;for(i=0;i<t.length;i++)r=t[i],r.kind===this.kind_&&n.push(new vjs.TextTrackMenuItem(this.player_,{track:r}));return n};vjs.CaptionsButton=vjs.TextTrackButton.extend({init:function(n,t,i){vjs.TextTrackButton.call(this,n,t,i);this.el_.setAttribute("aria-label","Captions Menu")}});vjs.CaptionsButton.prototype.kind_="captions";vjs.CaptionsButton.prototype.buttonText="Captions";vjs.CaptionsButton.prototype.className="vjs-captions-button";vjs.CaptionsButton.prototype.update=function(){var n=2;vjs.MenuButton.prototype.update.call(this);this.player().tech&&this.player().tech.featuresNativeTextTracks&&(n=1);this.items&&this.items.length>n?this.show():this.hide()};vjs.SubtitlesButton=vjs.TextTrackButton.extend({init:function(n,t,i){vjs.TextTrackButton.call(this,n,t,i);this.el_.setAttribute("aria-label","Subtitles Menu")}});vjs.SubtitlesButton.prototype.kind_="subtitles";vjs.SubtitlesButton.prototype.buttonText="Subtitles";vjs.SubtitlesButton.prototype.className="vjs-subtitles-button";vjs.SubtitlesButton.prototype.update=function(){vjs.MenuButton.prototype.update.call(this);this.items&&this.items.length>1?this.show():this.hide()};vjs.ChaptersButton=vjs.TextTrackButton.extend({init:function(n,t,i){vjs.TextTrackButton.call(this,n,t,i);this.el_.setAttribute("aria-label","Chapters Menu")}});vjs.ChaptersButton.prototype.kind_="chapters";vjs.ChaptersButton.prototype.buttonText="Chapters";vjs.ChaptersButton.prototype.className="vjs-chapters-button";vjs.ChaptersButton.prototype.createItems=function(){var i=[],r,n,t;if(n=this.player_.textTracks(),!n)return i;for(t=0;t<n.length;t++)r=n[t],r.kind===this.kind_&&i.push(new vjs.TextTrackMenuItem(this.player_,{track:r}));return i};vjs.ChaptersButton.prototype.createMenu=function(){for(var o=this.player_.textTracks()||[],n=0,u=o.length,i,r,h=this.items=[],t,f,s,e;n<u;n++)if(i=o[n],i.kind==this.kind_)if(i.cues){r=i;break}else i.mode="hidden",window.setTimeout(vjs.bind(this,function(){this.createMenu()}),100);if(t=this.menu,t===undefined&&(t=new vjs.Menu(this.player_),t.contentEl().appendChild(vjs.createEl("li",{className:"vjs-menu-title",innerHTML:vjs.util.htmlEncode(vjs.capitalize(this.kind_)),tabindex:-1}))),r){for(f=r.cues,n=0,u=f.length;n<u;n++)s=f[n],e=new vjs.ChaptersTrackMenuItem(this.player_,{track:r,cue:s}),h.push(e),t.addChild(e);this.addChild(t)}return this.items.length>0&&this.show(),t};vjs.ChaptersTrackMenuItem=vjs.MenuItem.extend({init:function(n,t){var u=this.track=t.track,i=this.cue=t.cue,r=n.currentTime();t.label=i.text;t.selected=i.startTime<=r&&r<i.endTime;vjs.MenuItem.call(this,n,t);u.addEventListener("cuechange",vjs.bind(this,this.update))}});vjs.ChaptersTrackMenuItem.prototype.onClick=function(){vjs.MenuItem.prototype.onClick.call(this);this.player_.currentTime(this.cue.startTime);this.update(this.cue.startTime)};vjs.ChaptersTrackMenuItem.prototype.update=function(){var n=this.cue,t=this.player_.currentTime();this.selected(n.startTime<=t&&t<n.endTime)}}(),vjs.TextTrackCueList=function(n){var t=this,i;if(vjs.IS_IE8){t=document.createElement("custom");for(i in vjs.TextTrackCueList.prototype)t[i]=vjs.TextTrackCueList.prototype[i]}return vjs.TextTrackCueList.prototype.setCues_.call(t,n),Object.defineProperty(t,"length",{get:function(){return this.length_}}),vjs.IS_IE8?t:void 0},vjs.TextTrackCueList.prototype.setCues_=function(n){var i=this.length||0,t=0,r=n.length,u;if(this.cues_=n,this.length_=n.length,u=function(n){""+n in this||Object.defineProperty(this,""+n,{get:function(){return this.cues_[n]}})},i<r)for(t=i;t<r;t++)u.call(this,t)},vjs.TextTrackCueList.prototype.getCueById=function(n){for(var t=0,u=this.length,r=null,i;t<u;t++)if(i=this[t],i.id===n){r=i;break}return r},vjs.TextTrackMode={disabled:"disabled",hidden:"hidden",showing:"showing"},vjs.TextTrackKind={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},vjs.TextTrackList=function(n){var t=this,i,r=0;if(vjs.IS_IE8){t=document.createElement("custom");for(i in vjs.TextTrackList.prototype)t[i]=vjs.TextTrackList.prototype[i]}for(n=n||[],t.tracks_=[],Object.defineProperty(t,"length",{get:function(){return this.tracks_.length}});r<n.length;r++)t.addTrack_(n[r]);if(vjs.IS_IE8)return t},vjs.TextTrackList.prototype=vjs.obj.create(vjs.EventEmitter.prototype),vjs.TextTrackList.prototype.constructor=vjs.TextTrackList,vjs.TextTrackList.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"},function(){for(var n in vjs.TextTrackList.prototype.allowedEvents_)vjs.TextTrackList.prototype["on"+n]=null}(),vjs.TextTrackList.prototype.addTrack_=function(n){var t=this.tracks_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.tracks_[t]}});n.addEventListener("modechange",vjs.bind(this,function(){this.trigger("change")}));this.tracks_.push(n);this.trigger({type:"addtrack",track:n})},vjs.TextTrackList.prototype.removeTrack_=function(n){for(var t=0,r=this.length,i;t<r;t++)if(i=this[t],i===n){this.tracks_.splice(t,1);break}this.trigger({type:"removetrack",track:n})},vjs.TextTrackList.prototype.getTrackById=function(n){for(var t=0,u=this.length,r=null,i;t<u;t++)if(i=this[t],i.id===n){r=i;break}return r},function(){"use strict";function n(n){var t;return n.selectedOptions?t=n.selectedOptions[0]:n.options&&(t=n.options[n.options.selectedIndex]),t.value}function t(n,t){var i,r;if(t){for(i=0;i<n.options.length;i++)if(r=n.options[i],r.value===t)break;n.selectedIndex=i}}function i(){return'<div class="vjs-tracksettings"><div class="vjs-tracksettings-colors"><div class="vjs-fg-color vjs-tracksetting"><label class="vjs-label">Foreground<\/label><select><option value="">---<\/option><option value="#FFF">White<\/option><option value="#000">Black<\/option><option value="#F00">Red<\/option><option value="#0F0">Green<\/option><option value="#00F">Blue<\/option><option value="#FF0">Yellow<\/option><option value="#F0F">Magenta<\/option><option value="#0FF">Cyan<\/option><\/select><span class="vjs-text-opacity vjs-opacity"><select><option value="">---<\/option><option value="1">Opaque<\/option><option value="0.5">Semi-Opaque<\/option><\/select><\/span><\/div><div class="vjs-bg-color vjs-tracksetting"><label class="vjs-label">Background<\/label><select><option value="">---<\/option><option value="#FFF">White<\/option><option value="#000">Black<\/option><option value="#F00">Red<\/option><option value="#0F0">Green<\/option><option value="#00F">Blue<\/option><option value="#FF0">Yellow<\/option><option value="#F0F">Magenta<\/option><option value="#0FF">Cyan<\/option><\/select><span class="vjs-bg-opacity vjs-opacity"><select><option value="">---<\/option><option value="1">Opaque<\/option><option value="0.5">Semi-Transparent<\/option><option value="0">Transparent<\/option><\/select><\/span><\/div><div class="window-color vjs-tracksetting"><label class="vjs-label">Window<\/label><select><option value="">---<\/option><option value="#FFF">White<\/option><option value="#000">Black<\/option><option value="#F00">Red<\/option><option value="#0F0">Green<\/option><option value="#00F">Blue<\/option><option value="#FF0">Yellow<\/option><option value="#F0F">Magenta<\/option><option value="#0FF">Cyan<\/option><\/select><span class="vjs-window-opacity vjs-opacity"><select><option value="">---<\/option><option value="1">Opaque<\/option><option value="0.5">Semi-Transparent<\/option><option value="0">Transparent<\/option><\/select><\/span><\/div><\/div><div class="vjs-tracksettings-font"><div class="vjs-font-percent vjs-tracksetting"><label class="vjs-label">Font Size<\/label><select><option value="0.50">50%<\/option><option value="0.75">75%<\/option><option value="1.00" selected>100%<\/option><option value="1.25">125%<\/option><option value="1.50">150%<\/option><option value="1.75">175%<\/option><option value="2.00">200%<\/option><option value="3.00">300%<\/option><option value="4.00">400%<\/option><\/select><\/div><div class="vjs-edge-style vjs-tracksetting"><label class="vjs-label">Text Edge Style<\/label><select><option value="none">None<\/option><option value="raised">Raised<\/option><option value="depressed">Depressed<\/option><option value="uniform">Uniform<\/option><option value="dropshadow">Dropshadow<\/option><\/select><\/div><div class="vjs-font-family vjs-tracksetting"><label class="vjs-label">Font Family<\/label><select><option value="">Default<\/option><option value="monospaceSerif">Monospace Serif<\/option><option value="proportionalSerif">Proportional Serif<\/option><option value="monospaceSansSerif">Monospace Sans-Serif<\/option><option value="proportionalSansSerif">Proportional Sans-Serif<\/option><option value="casual">Casual<\/option><option value="script">Script<\/option><option value="small-caps">Small Caps<\/option><\/select><\/div><\/div><\/div><div class="vjs-tracksettings-controls"><button class="vjs-default-button">Defaults<\/button><button class="vjs-done-button">Done<\/button><\/div>'}vjs.TextTrackSettings=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t);this.hide();vjs.on(this.el().querySelector(".vjs-done-button"),"click",vjs.bind(this,function(){this.saveSettings();this.hide()}));vjs.on(this.el().querySelector(".vjs-default-button"),"click",vjs.bind(this,function(){this.el().querySelector(".vjs-fg-color > select").selectedIndex=0;this.el().querySelector(".vjs-bg-color > select").selectedIndex=0;this.el().querySelector(".window-color > select").selectedIndex=0;this.el().querySelector(".vjs-text-opacity > select").selectedIndex=0;this.el().querySelector(".vjs-bg-opacity > select").selectedIndex=0;this.el().querySelector(".vjs-window-opacity > select").selectedIndex=0;this.el().querySelector(".vjs-edge-style select").selectedIndex=0;this.el().querySelector(".vjs-font-family select").selectedIndex=0;this.el().querySelector(".vjs-font-percent select").selectedIndex=2;this.updateDisplay()}));vjs.on(this.el().querySelector(".vjs-fg-color > select"),"change",vjs.bind(this,this.updateDisplay));vjs.on(this.el().querySelector(".vjs-bg-color > select"),"change",vjs.bind(this,this.updateDisplay));vjs.on(this.el().querySelector(".window-color > select"),"change",vjs.bind(this,this.updateDisplay));vjs.on(this.el().querySelector(".vjs-text-opacity > select"),"change",vjs.bind(this,this.updateDisplay));vjs.on(this.el().querySelector(".vjs-bg-opacity > select"),"change",vjs.bind(this,this.updateDisplay));vjs.on(this.el().querySelector(".vjs-window-opacity > select"),"change",vjs.bind(this,this.updateDisplay));vjs.on(this.el().querySelector(".vjs-font-percent select"),"change",vjs.bind(this,this.updateDisplay));vjs.on(this.el().querySelector(".vjs-edge-style select"),"change",vjs.bind(this,this.updateDisplay));vjs.on(this.el().querySelector(".vjs-font-family select"),"change",vjs.bind(this,this.updateDisplay));n.options().persistTextTrackSettings&&this.restoreSettings()}});vjs.TextTrackSettings.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-caption-settings vjs-modal-overlay",innerHTML:i()})};vjs.TextTrackSettings.prototype.getValues=function(){var t,u,f,e,o,s,h,c,l,i,r,a;t=this.el();o=n(t.querySelector(".vjs-edge-style select"));s=n(t.querySelector(".vjs-font-family select"));h=n(t.querySelector(".vjs-fg-color > select"));f=n(t.querySelector(".vjs-text-opacity > select"));c=n(t.querySelector(".vjs-bg-color > select"));u=n(t.querySelector(".vjs-bg-opacity > select"));l=n(t.querySelector(".window-color > select"));e=n(t.querySelector(".vjs-window-opacity > select"));a=window.parseFloat(n(t.querySelector(".vjs-font-percent > select")));i={backgroundOpacity:u,textOpacity:f,windowOpacity:e,edgeStyle:o,fontFamily:s,color:h,backgroundColor:c,windowColor:l,fontPercent:a};for(r in i)(i[r]===""||i[r]==="none"||r==="fontPercent"&&i[r]===1)&&delete i[r];return i};vjs.TextTrackSettings.prototype.setValues=function(n){var i=this.el(),r;t(i.querySelector(".vjs-edge-style select"),n.edgeStyle);t(i.querySelector(".vjs-font-family select"),n.fontFamily);t(i.querySelector(".vjs-fg-color > select"),n.color);t(i.querySelector(".vjs-text-opacity > select"),n.textOpacity);t(i.querySelector(".vjs-bg-color > select"),n.backgroundColor);t(i.querySelector(".vjs-bg-opacity > select"),n.backgroundOpacity);t(i.querySelector(".window-color > select"),n.windowColor);t(i.querySelector(".vjs-window-opacity > select"),n.windowOpacity);r=n.fontPercent;r&&(r=r.toFixed(2));t(i.querySelector(".vjs-font-percent > select"),r)};vjs.TextTrackSettings.prototype.restoreSettings=function(){var n=vjs.JSON.safeParseTuple(window.localStorage.getItem("vjs-text-track-settings"))[1];n&&this.setValues(n)};vjs.TextTrackSettings.prototype.saveSettings=function(){var n;if(this.player_.options().persistTextTrackSettings){n=this.getValues();try{vjs.isEmpty(n)?window.localStorage.removeItem("vjs-text-track-settings"):window.localStorage.setItem("vjs-text-track-settings",JSON.stringify(n))}catch(t){}}};vjs.TextTrackSettings.prototype.updateDisplay=function(){var n=this.player_.getChild("textTrackDisplay");n&&n.updateDisplay()}}(),function(){vjs.TextTrack=function(n){var r,c,u,e,l,a,v,o,s,f,h;if(n=n||{},!n.player)throw new Error("A player was not provided.");if(r=this,vjs.IS_IE8){r=document.createElement("custom");for(h in vjs.TextTrack.prototype)r[h]=vjs.TextTrack.prototype[h]}if(r.player_=n.player,u=vjs.TextTrackMode[n.mode]||"disabled",e=vjs.TextTrackKind[n.kind]||"subtitles",l=n.label||"",a=n.language||n.srclang||"",c=n.id||"vjs_text_track_"+vjs.guid++,(e==="metadata"||e==="chapters")&&(u="hidden"),r.cues_=[],r.activeCues_=[],v=new vjs.TextTrackCueList(r.cues_),o=new vjs.TextTrackCueList(r.activeCues_),f=!1,s=vjs.bind(r,function(){this.activeCues;f&&(this.trigger("cuechange"),f=!1)}),u!=="disabled")r.player_.on("timeupdate",s);return Object.defineProperty(r,"kind",{get:function(){return e},set:Function.prototype}),Object.defineProperty(r,"label",{get:function(){return l},set:Function.prototype}),Object.defineProperty(r,"language",{get:function(){return a},set:Function.prototype}),Object.defineProperty(r,"id",{get:function(){return c},set:Function.prototype}),Object.defineProperty(r,"mode",{get:function(){return u},set:function(n){if(vjs.TextTrackMode[n]){if(u=n,u==="showing")this.player_.on("timeupdate",s);this.trigger("modechange")}}}),Object.defineProperty(r,"cues",{get:function(){return this.loaded_?v:null},set:Function.prototype}),Object.defineProperty(r,"activeCues",{get:function(){var t,e,r,u,n;if(!this.loaded_)return null;if(this.cues.length===0)return o;for(u=this.player_.currentTime(),t=0,e=this.cues.length,r=[];t<e;t++)n=this.cues[t],n.startTime<=u&&n.endTime>=u?r.push(n):n.startTime===n.endTime&&n.startTime<=u&&n.startTime+.5>=u&&r.push(n);if(f=!1,r.length!==this.activeCues_.length)f=!0;else for(t=0;t<r.length;t++)i.call(this.activeCues_,r[t])===-1&&(f=!0);return this.activeCues_=r,o.setCues_(this.activeCues_),o},set:Function.prototype}),n.src?t(n.src,r):r.loaded_=!0,vjs.IS_IE8?r:void 0};vjs.TextTrack.prototype=vjs.obj.create(vjs.EventEmitter.prototype);vjs.TextTrack.prototype.constructor=vjs.TextTrack;vjs.TextTrack.prototype.allowedEvents_={cuechange:"cuechange"};vjs.TextTrack.prototype.addCue=function(n){var t=this.player_.textTracks(),i=0;if(t)for(;i<t.length;i++)t[i]!==this&&t[i].removeCue(n);this.cues_.push(n);this.cues.setCues_(this.cues_)};vjs.TextTrack.prototype.removeCue=function(n){for(var t=0,u=this.cues_.length,i,r=!1;t<u;t++)i=this.cues_[t],i===n&&(this.cues_.splice(t,1),r=!0);r&&this.cues.setCues_(this.cues_)};var t,n,i;t=function(t,i){vjs.xhr(t,vjs.bind(this,function(t,r,u){if(t)return vjs.log.error(t);i.loaded_=!0;n(u,i)}))};n=function(t,i){if(typeof WebVTT!="function")return window.setTimeout(function(){n(t,i)},25);var r=new window.WebVTT.Parser(window,window.vttjs,window.WebVTT.StringDecoder());r.oncue=function(n){i.addCue(n)};r.onparsingerror=function(n){vjs.log.error(n)};r.parse(t);r.flush()};i=function(n,t){var r,f,u,i;if(this==null)throw new TypeError('"this" is null or not defined');if((f=Object(this),u=f.length>>>0,u===0)||(i=+t||0,Math.abs(i)===Infinity&&(i=0),i>=u))return-1;for(r=Math.max(i>=0?i:u-Math.abs(i),0);r<u;){if(r in f&&f[r]===n)return r;r++}return-1}}(),function(n){var t=n.vttjs={},i=t.VTTCue,r=t.VTTRegion,u=n.VTTCue,f=n.VTTRegion;t.shim=function(){t.VTTCue=i;t.VTTRegion=r};t.restore=function(){t.VTTCue=u;t.VTTRegion=f}}(this),function(n,t){function s(n){if(typeof n!="string")return!1;var t=e[n.toLowerCase()];return t?n.toLowerCase():!1}function r(n){if(typeof n!="string")return!1;var t=o[n.toLowerCase()];return t?n.toLowerCase():!1}function i(n){for(var t=1,i,r;t<arguments.length;t++){i=arguments[t];for(r in i)n[r]=i[r]}return n}function u(n,t,u){var e=this,h=/MSIE\s8\.0/.test(navigator.userAgent),o={};h?e=document.createElement("custom"):o.enumerable=!0;e.hasBeenReset=!1;var c="",l=!1,a=n,v=t,y=u,p=null,w="",b=!0,k="auto",d="start",g=50,nt="middle",tt=50,it="middle";return Object.defineProperty(e,"id",i({},o,{get:function(){return c},set:function(n){c=""+n}})),Object.defineProperty(e,"pauseOnExit",i({},o,{get:function(){return l},set:function(n){l=!!n}})),Object.defineProperty(e,"startTime",i({},o,{get:function(){return a},set:function(n){if(typeof n!="number")throw new TypeError("Start time must be set to a number.");a=n;this.hasBeenReset=!0}})),Object.defineProperty(e,"endTime",i({},o,{get:function(){return v},set:function(n){if(typeof n!="number")throw new TypeError("End time must be set to a number.");v=n;this.hasBeenReset=!0}})),Object.defineProperty(e,"text",i({},o,{get:function(){return y},set:function(n){y=""+n;this.hasBeenReset=!0}})),Object.defineProperty(e,"region",i({},o,{get:function(){return p},set:function(n){p=n;this.hasBeenReset=!0}})),Object.defineProperty(e,"vertical",i({},o,{get:function(){return w},set:function(n){var t=s(n);if(t===!1)throw new SyntaxError("An invalid or illegal string was specified.");w=t;this.hasBeenReset=!0}})),Object.defineProperty(e,"snapToLines",i({},o,{get:function(){return b},set:function(n){b=!!n;this.hasBeenReset=!0}})),Object.defineProperty(e,"line",i({},o,{get:function(){return k},set:function(n){if(typeof n!="number"&&n!==f)throw new SyntaxError("An invalid number or illegal string was specified.");k=n;this.hasBeenReset=!0}})),Object.defineProperty(e,"lineAlign",i({},o,{get:function(){return d},set:function(n){var t=r(n);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");d=t;this.hasBeenReset=!0}})),Object.defineProperty(e,"position",i({},o,{get:function(){return g},set:function(n){if(n<0||n>100)throw new Error("Position must be between 0 and 100.");g=n;this.hasBeenReset=!0}})),Object.defineProperty(e,"positionAlign",i({},o,{get:function(){return nt},set:function(n){var t=r(n);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");nt=t;this.hasBeenReset=!0}})),Object.defineProperty(e,"size",i({},o,{get:function(){return tt},set:function(n){if(n<0||n>100)throw new Error("Size must be between 0 and 100.");tt=n;this.hasBeenReset=!0}})),Object.defineProperty(e,"align",i({},o,{get:function(){return it},set:function(n){var t=r(n);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");it=t;this.hasBeenReset=!0}})),e.displayState=undefined,h?e:void 0}var f="auto",e={"":!0,lr:!0,rl:!0},o={start:!0,middle:!0,end:!0,left:!0,right:!0};u.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};n.VTTCue=n.VTTCue||u;t.VTTCue=u}(this,this.vttjs||{}),function(n,t){function f(n){if(typeof n!="string")return!1;var t=u[n.toLowerCase()];return t?n.toLowerCase():!1}function i(n){return typeof n=="number"&&n>=0&&n<=100}function r(){var n=100,t=3,r=0,u=100,e=0,o=100,s="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return n},set:function(t){if(!i(t))throw new Error("Width must be between 0 and 100.");n=t}},lines:{enumerable:!0,get:function(){return t},set:function(n){if(typeof n!="number")throw new TypeError("Lines must be set to a number.");t=n}},regionAnchorY:{enumerable:!0,get:function(){return u},set:function(n){if(!i(n))throw new Error("RegionAnchorX must be between 0 and 100.");u=n}},regionAnchorX:{enumerable:!0,get:function(){return r},set:function(n){if(!i(n))throw new Error("RegionAnchorY must be between 0 and 100.");r=n}},viewportAnchorY:{enumerable:!0,get:function(){return o},set:function(n){if(!i(n))throw new Error("ViewportAnchorY must be between 0 and 100.");o=n}},viewportAnchorX:{enumerable:!0,get:function(){return e},set:function(n){if(!i(n))throw new Error("ViewportAnchorX must be between 0 and 100.");e=n}},scroll:{enumerable:!0,get:function(){return s},set:function(n){var t=f(n);if(t===!1)throw new SyntaxError("An invalid or illegal string was specified.");s=t}}})}var u={"":!0,up:!0};n.VTTRegion=n.VTTRegion||r;t.VTTRegion=r}(this,this.vttjs||{}),function(n){function i(n,t){this.name="ParsingError";this.code=n.code;this.message=t||n.message}function c(n){function i(n,t,i,r){return(n|0)*3600+(t|0)*60+(i|0)+(r|0)/1e3}var t=n.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return t?t[3]?i(t[1],t[2],t[3].replace(":",""),t[4]):t[1]>59?i(t[1],t[2],0,t[4]):i(0,t[1],t[2],t[4]):null}function u(){this.values=o(null)}function s(n,t,i,r){var f=r?n.split(r):[n],e,u,o,s;for(e in f)typeof f[e]=="string"&&(u=f[e].split(i),u.length===2)&&(o=u[0],s=u[1],t(o,s))}function v(n,t,r){function o(){var t=c(n);if(t===null)throw new i(i.Errors.BadTimeStamp,"Malformed timestamp: "+e);return n=n.replace(/^[^\sa-zA-Z-]+/,""),t}function h(n,t){var i=new u;s(n,function(n,t){var f,u,e;switch(n){case"region":for(f=r.length-1;f>=0;f--)if(r[f].id===t){i.set(n,r[f].region);break}break;case"vertical":i.alt(n,t,["rl","lr"]);break;case"line":u=t.split(",");e=u[0];i.integer(n,e);i.percent(n,e)?i.set("snapToLines",!1):null;i.alt(n,e,["auto"]);u.length===2&&i.alt("lineAlign",u[1],["start","middle","end"]);break;case"position":u=t.split(",");i.percent(n,u[0]);u.length===2&&i.alt("positionAlign",u[1],["start","middle","end"]);break;case"size":i.percent(n,t);break;case"align":i.alt(n,t,["start","middle","end","left","right"])}},/:/,/\s/);t.region=i.get("region",null);t.vertical=i.get("vertical","");t.line=i.get("line","auto");t.lineAlign=i.get("lineAlign","start");t.snapToLines=i.get("snapToLines",!0);t.size=i.get("size",100);t.align=i.get("align","middle");t.position=i.get("position",{start:0,left:0,middle:50,end:100,right:100},t.align);t.positionAlign=i.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},t.align)}function f(){n=n.replace(/^\s+/,"")}var e=n;if(f(),t.startTime=o(),f(),n.substr(0,3)!=="-->")throw new i(i.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+e);n=n.substr(3);f();t.endTime=o();f();h(n,t)}function a(n,t){function h(){function i(n){return t=t.substr(n.length),n}if(!t)return null;var n=t.match(/^([^<]*)(<[^>]+>?)?/);return i(n[1]?n[1]:n[2])}function a(n){return y[n]}function v(n){while(i=n.match(/&(amp|lt|gt|lrm|rlm|nbsp);/))n=n.replace(i[0],a);return n}function b(n,t){return!l[t.localName]||l[t.localName]===n.localName}function k(t,i){var u=p[t],r,f;return u?(r=n.document.createElement(u),r.localName=u,f=w[t],f&&i&&(r[f]=i.trim()),r):null}for(var s=n.document.createElement("div"),f=s,r,e=[],o,u,i;(r=h())!==null;){if(r[0]==="<"){if(r[1]==="/"){e.length&&e[e.length-1]===r.substr(2).replace(">","")&&(e.pop(),f=f.parentNode);continue}if(o=c(r.substr(1,r.length-2)),o){u=n.document.createProcessingInstruction("timestamp",o);f.appendChild(u);continue}if(i=r.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/),!i)continue;if(u=k(i[1],i[3]),!u)continue;if(!b(f,u))continue;i[2]&&(u.className=i[2].substr(1).replace("."," "));e.push(i[1]);f.appendChild(u);f=u;continue}f.appendChild(n.document.createTextNode(v(r)))}return s}function b(n){function o(n,t){for(var i=t.childNodes.length-1;i>=0;i--)n.push(t.childNodes[i])}function u(n){var t,i,r;return!n||!n.length?null:(t=n.pop(),i=t.textContent||t.innerText,i)?(r=i.match(/^.*(\n|\r)/),r)?(n.length=0,r[0]):i:t.tagName==="ruby"?u(n):t.childNodes?(o(n,t),u(n)):void 0}var f=[],r="",e,t,i;if(!n||!n.childNodes)return"ltr";for(o(f,n);r=u(f);)for(t=0;t<r.length;t++)for(e=r.charCodeAt(t),i=0;i<h.length;i++)if(h[i]===e)return"rtl";return"ltr"}function k(n){var t;if(typeof n.line=="number"&&(n.snapToLines||n.line>=0&&n.line<=100))return n.line;if(!n.track||!n.track.textTrackList||!n.track.textTrackList.mediaElement)return-1;var r=n.track,i=r.textTrackList,u=0;for(t=0;t<i.length&&i[t]!==r;t++)i[t].mode==="showing"&&u++;return++u*-1}function f(){}function e(n,t,i){var e=/MSIE\s8\.0/.test(navigator.userAgent),o="rgba(255, 255, 255, 1)",s="rgba(0, 0, 0, 0.8)",r,u;e&&(o="rgb(255, 255, 255)",s="rgb(0, 0, 0)");f.call(this);this.cue=t;this.cueDiv=a(n,t.text);r={color:o,backgroundColor:s,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"};e||(r.writingMode=t.vertical===""?"horizontal-tb":t.vertical==="lr"?"vertical-lr":"vertical-rl",r.unicodeBidi="plaintext");this.applyStyles(r,this.cueDiv);this.div=n.document.createElement("div");r={textAlign:t.align==="middle"?"center":t.align,font:i.font,whiteSpace:"pre-line",position:"absolute"};e||(r.direction=b(this.cueDiv),r.writingMode=t.vertical===""?"horizontal-tb":t.vertical==="lr"?"vertical-lr":"vertical-rl".stylesunicodeBidi="plaintext");this.applyStyles(r);this.div.appendChild(this.cueDiv);u=0;switch(t.positionAlign){case"start":u=t.position;break;case"middle":u=t.position-t.size/2;break;case"end":u=t.position-t.size}t.vertical===""?this.applyStyles({left:this.formatStyle(u,"%"),width:this.formatStyle(t.size,"%")}):this.applyStyles({top:this.formatStyle(u,"%"),height:this.formatStyle(t.size,"%")});this.move=function(n){this.applyStyles({top:this.formatStyle(n.top,"px"),bottom:this.formatStyle(n.bottom,"px"),left:this.formatStyle(n.left,"px"),right:this.formatStyle(n.right,"px"),height:this.formatStyle(n.height,"px"),width:this.formatStyle(n.width,"px")})}}function t(n){var e=/MSIE\s8\.0/.test(navigator.userAgent),i,r,f,u,t;n.div&&(r=n.div.offsetHeight,f=n.div.offsetWidth,u=n.div.offsetTop,t=(t=n.div.childNodes)&&(t=t[0])&&t.getClientRects&&t.getClientRects(),n=n.div.getBoundingClientRect(),i=t?Math.max(t[0]&&t[0].height||0,n.height/t.length):0);this.left=n.left;this.right=n.right;this.top=n.top||u;this.height=n.height||r;this.bottom=n.bottom||u+(n.height||r);this.width=n.width||f;this.lineHeight=i!==undefined?i:n.lineHeight;e&&!this.lineHeight&&(this.lineHeight=13)}function d(n,i,r,u){function p(n,i){for(var e,o,s=new t(n),h=1,f=0;f<i.length;f++){while(n.overlapsOppositeAxis(r,i[f])||n.within(r)&&n.overlapsAny(u))n.move(i[f]);if(n.within(r))return n;e=n.intersectPercentage(r);h>e&&(o=new t(n),h=e);n=new t(s)}return o||s}var s=new t(i),o=i.cue,e=k(o),f=[],c,a,y;if(o.snapToLines){switch(o.vertical){case"":f=["+y","-y"];c="height";break;case"rl":f=["+x","-x"];c="width";break;case"lr":f=["-x","+x"];c="width"}var l=s.lineHeight,h=l*Math.round(e),v=r[c]+l,w=f[0];Math.abs(h)>v&&(h=(h<0?-1:1)*Math.ceil(v/l)*l);e<0&&(h+=o.vertical===""?r.height:r.width,f=f.reverse());s.move(w,h)}else{a=s.lineHeight/r.height*100;switch(o.lineAlign){case"middle":e-=a/2;break;case"end":e-=a}switch(o.vertical){case"":i.applyStyles({top:i.formatStyle(e,"%")});break;case"rl":i.applyStyles({left:i.formatStyle(e,"%")});break;case"lr":i.applyStyles({right:i.formatStyle(e,"%")})}f=["+y","-x","+x","-y"];s=new t(i)}y=p(s,f);i.move(y.toCSSCompatValues(r))}function r(){}var o=Object.create||function(){function n(){}return function(t){if(arguments.length!==1)throw new Error("Object.create shim only accepts one parameter.");return n.prototype=t,new n}}(),h;i.prototype=o(Error.prototype);i.prototype.constructor=i;i.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};u.prototype={set:function(n,t){this.get(n)||t===""||(this.values[n]=t)},get:function(n,t,i){return i?this.has(n)?this.values[n]:t[i]:this.has(n)?this.values[n]:t},has:function(n){return n in this.values},alt:function(n,t,i){for(var r=0;r<i.length;++r)if(t===i[r]){this.set(n,t);break}},integer:function(n,t){/^-?\d+$/.test(t)&&this.set(n,parseInt(t,10))},percent:function(n,t){var i;return(i=t.match(/^([\d]{1,3})(\.[\d]*)?%$/))&&(t=parseFloat(t),t>=0&&t<=100)?(this.set(n,t),!0):!1}};var y={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"‎","&rlm;":"‏","&nbsp;":" "},p={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},w={v:"title",lang:"lang"},l={rt:"ruby"};h=[1470,1472,1475,1478,1488,1489,1490,1491,1492,1493,1494,1495,1496,1497,1498,1499,1500,1501,1502,1503,1504,1505,1506,1507,1508,1509,1510,1511,1512,1513,1514,1520,1521,1522,1523,1524,1544,1547,1549,1563,1566,1567,1568,1569,1570,1571,1572,1573,1574,1575,1576,1577,1578,1579,1580,1581,1582,1583,1584,1585,1586,1587,1588,1589,1590,1591,1592,1593,1594,1595,1596,1597,1598,1599,1600,1601,1602,1603,1604,1605,1606,1607,1608,1609,1610,1645,1646,1647,1649,1650,1651,1652,1653,1654,1655,1656,1657,1658,1659,1660,1661,1662,1663,1664,1665,1666,1667,1668,1669,1670,1671,1672,1673,1674,1675,1676,1677,1678,1679,1680,1681,1682,1683,1684,1685,1686,1687,1688,1689,1690,1691,1692,1693,1694,1695,1696,1697,1698,1699,1700,1701,1702,1703,1704,1705,1706,1707,1708,1709,1710,1711,1712,1713,1714,1715,1716,1717,1718,1719,1720,1721,1722,1723,1724,1725,1726,1727,1728,1729,1730,1731,1732,1733,1734,1735,1736,1737,1738,1739,1740,1741,1742,1743,1744,1745,1746,1747,1748,1749,1765,1766,1774,1775,1786,1787,1788,1789,1790,1791,1792,1793,1794,1795,1796,1797,1798,1799,1800,1801,1802,1803,1804,1805,1807,1808,1810,1811,1812,1813,1814,1815,1816,1817,1818,1819,1820,1821,1822,1823,1824,1825,1826,1827,1828,1829,1830,1831,1832,1833,1834,1835,1836,1837,1838,1839,1869,1870,1871,1872,1873,1874,1875,1876,1877,1878,1879,1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1969,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2e3,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024,2025,2026,2036,2037,2042,2048,2049,2050,2051,2052,2053,2054,2055,2056,2057,2058,2059,2060,2061,2062,2063,2064,2065,2066,2067,2068,2069,2074,2084,2088,2096,2097,2098,2099,2100,2101,2102,2103,2104,2105,2106,2107,2108,2109,2110,2112,2113,2114,2115,2116,2117,2118,2119,2120,2121,2122,2123,2124,2125,2126,2127,2128,2129,2130,2131,2132,2133,2134,2135,2136,2142,2208,2210,2211,2212,2213,2214,2215,2216,2217,2218,2219,2220,8207,64285,64287,64288,64289,64290,64291,64292,64293,64294,64295,64296,64298,64299,64300,64301,64302,64303,64304,64305,64306,64307,64308,64309,64310,64312,64313,64314,64315,64316,64318,64320,64321,64323,64324,64326,64327,64328,64329,64330,64331,64332,64333,64334,64335,64336,64337,64338,64339,64340,64341,64342,64343,64344,64345,64346,64347,64348,64349,64350,64351,64352,64353,64354,64355,64356,64357,64358,64359,64360,64361,64362,64363,64364,64365,64366,64367,64368,64369,64370,64371,64372,64373,64374,64375,64376,64377,64378,64379,64380,64381,64382,64383,64384,64385,64386,64387,64388,64389,64390,64391,64392,64393,64394,64395,64396,64397,64398,64399,64400,64401,64402,64403,64404,64405,64406,64407,64408,64409,64410,64411,64412,64413,64414,64415,64416,64417,64418,64419,64420,64421,64422,64423,64424,64425,64426,64427,64428,64429,64430,64431,64432,64433,64434,64435,64436,64437,64438,64439,64440,64441,64442,64443,64444,64445,64446,64447,64448,64449,64467,64468,64469,64470,64471,64472,64473,64474,64475,64476,64477,64478,64479,64480,64481,64482,64483,64484,64485,64486,64487,64488,64489,64490,64491,64492,64493,64494,64495,64496,64497,64498,64499,64500,64501,64502,64503,64504,64505,64506,64507,64508,64509,64510,64511,64512,64513,64514,64515,64516,64517,64518,64519,64520,64521,64522,64523,64524,64525,64526,64527,64528,64529,64530,64531,64532,64533,64534,64535,64536,64537,64538,64539,64540,64541,64542,64543,64544,64545,64546,64547,64548,64549,64550,64551,64552,64553,64554,64555,64556,64557,64558,64559,64560,64561,64562,64563,64564,64565,64566,64567,64568,64569,64570,64571,64572,64573,64574,64575,64576,64577,64578,64579,64580,64581,64582,64583,64584,64585,64586,64587,64588,64589,64590,64591,64592,64593,64594,64595,64596,64597,64598,64599,64600,64601,64602,64603,64604,64605,64606,64607,64608,64609,64610,64611,64612,64613,64614,64615,64616,64617,64618,64619,64620,64621,64622,64623,64624,64625,64626,64627,64628,64629,64630,64631,64632,64633,64634,64635,64636,64637,64638,64639,64640,64641,64642,64643,64644,64645,64646,64647,64648,64649,64650,64651,64652,64653,64654,64655,64656,64657,64658,64659,64660,64661,64662,64663,64664,64665,64666,64667,64668,64669,64670,64671,64672,64673,64674,64675,64676,64677,64678,64679,64680,64681,64682,64683,64684,64685,64686,64687,64688,64689,64690,64691,64692,64693,64694,64695,64696,64697,64698,64699,64700,64701,64702,64703,64704,64705,64706,64707,64708,64709,64710,64711,64712,64713,64714,64715,64716,64717,64718,64719,64720,64721,64722,64723,64724,64725,64726,64727,64728,64729,64730,64731,64732,64733,64734,64735,64736,64737,64738,64739,64740,64741,64742,64743,64744,64745,64746,64747,64748,64749,64750,64751,64752,64753,64754,64755,64756,64757,64758,64759,64760,64761,64762,64763,64764,64765,64766,64767,64768,64769,64770,64771,64772,64773,64774,64775,64776,64777,64778,64779,64780,64781,64782,64783,64784,64785,64786,64787,64788,64789,64790,64791,64792,64793,64794,64795,64796,64797,64798,64799,64800,64801,64802,64803,64804,64805,64806,64807,64808,64809,64810,64811,64812,64813,64814,64815,64816,64817,64818,64819,64820,64821,64822,64823,64824,64825,64826,64827,64828,64829,64848,64849,64850,64851,64852,64853,64854,64855,64856,64857,64858,64859,64860,64861,64862,64863,64864,64865,64866,64867,64868,64869,64870,64871,64872,64873,64874,64875,64876,64877,64878,64879,64880,64881,64882,64883,64884,64885,64886,64887,64888,64889,64890,64891,64892,64893,64894,64895,64896,64897,64898,64899,64900,64901,64902,64903,64904,64905,64906,64907,64908,64909,64910,64911,64914,64915,64916,64917,64918,64919,64920,64921,64922,64923,64924,64925,64926,64927,64928,64929,64930,64931,64932,64933,64934,64935,64936,64937,64938,64939,64940,64941,64942,64943,64944,64945,64946,64947,64948,64949,64950,64951,64952,64953,64954,64955,64956,64957,64958,64959,64960,64961,64962,64963,64964,64965,64966,64967,65008,65009,65010,65011,65012,65013,65014,65015,65016,65017,65018,65019,65020,65136,65137,65138,65139,65140,65142,65143,65144,65145,65146,65147,65148,65149,65150,65151,65152,65153,65154,65155,65156,65157,65158,65159,65160,65161,65162,65163,65164,65165,65166,65167,65168,65169,65170,65171,65172,65173,65174,65175,65176,65177,65178,65179,65180,65181,65182,65183,65184,65185,65186,65187,65188,65189,65190,65191,65192,65193,65194,65195,65196,65197,65198,65199,65200,65201,65202,65203,65204,65205,65206,65207,65208,65209,65210,65211,65212,65213,65214,65215,65216,65217,65218,65219,65220,65221,65222,65223,65224,65225,65226,65227,65228,65229,65230,65231,65232,65233,65234,65235,65236,65237,65238,65239,65240,65241,65242,65243,65244,65245,65246,65247,65248,65249,65250,65251,65252,65253,65254,65255,65256,65257,65258,65259,65260,65261,65262,65263,65264,65265,65266,65267,65268,65269,65270,65271,65272,65273,65274,65275,65276,67584,67585,67586,67587,67588,67589,67592,67594,67595,67596,67597,67598,67599,67600,67601,67602,67603,67604,67605,67606,67607,67608,67609,67610,67611,67612,67613,67614,67615,67616,67617,67618,67619,67620,67621,67622,67623,67624,67625,67626,67627,67628,67629,67630,67631,67632,67633,67634,67635,67636,67637,67639,67640,67644,67647,67648,67649,67650,67651,67652,67653,67654,67655,67656,67657,67658,67659,67660,67661,67662,67663,67664,67665,67666,67667,67668,67669,67671,67672,67673,67674,67675,67676,67677,67678,67679,67840,67841,67842,67843,67844,67845,67846,67847,67848,67849,67850,67851,67852,67853,67854,67855,67856,67857,67858,67859,67860,67861,67862,67863,67864,67865,67866,67867,67872,67873,67874,67875,67876,67877,67878,67879,67880,67881,67882,67883,67884,67885,67886,67887,67888,67889,67890,67891,67892,67893,67894,67895,67896,67897,67903,67968,67969,67970,67971,67972,67973,67974,67975,67976,67977,67978,67979,67980,67981,67982,67983,67984,67985,67986,67987,67988,67989,67990,67991,67992,67993,67994,67995,67996,67997,67998,67999,68e3,68001,68002,68003,68004,68005,68006,68007,68008,68009,68010,68011,68012,68013,68014,68015,68016,68017,68018,68019,68020,68021,68022,68023,68030,68031,68096,68112,68113,68114,68115,68117,68118,68119,68121,68122,68123,68124,68125,68126,68127,68128,68129,68130,68131,68132,68133,68134,68135,68136,68137,68138,68139,68140,68141,68142,68143,68144,68145,68146,68147,68160,68161,68162,68163,68164,68165,68166,68167,68176,68177,68178,68179,68180,68181,68182,68183,68184,68192,68193,68194,68195,68196,68197,68198,68199,68200,68201,68202,68203,68204,68205,68206,68207,68208,68209,68210,68211,68212,68213,68214,68215,68216,68217,68218,68219,68220,68221,68222,68223,68352,68353,68354,68355,68356,68357,68358,68359,68360,68361,68362,68363,68364,68365,68366,68367,68368,68369,68370,68371,68372,68373,68374,68375,68376,68377,68378,68379,68380,68381,68382,68383,68384,68385,68386,68387,68388,68389,68390,68391,68392,68393,68394,68395,68396,68397,68398,68399,68400,68401,68402,68403,68404,68405,68416,68417,68418,68419,68420,68421,68422,68423,68424,68425,68426,68427,68428,68429,68430,68431,68432,68433,68434,68435,68436,68437,68440,68441,68442,68443,68444,68445,68446,68447,68448,68449,68450,68451,68452,68453,68454,68455,68456,68457,68458,68459,68460,68461,68462,68463,68464,68465,68466,68472,68473,68474,68475,68476,68477,68478,68479,68608,68609,68610,68611,68612,68613,68614,68615,68616,68617,68618,68619,68620,68621,68622,68623,68624,68625,68626,68627,68628,68629,68630,68631,68632,68633,68634,68635,68636,68637,68638,68639,68640,68641,68642,68643,68644,68645,68646,68647,68648,68649,68650,68651,68652,68653,68654,68655,68656,68657,68658,68659,68660,68661,68662,68663,68664,68665,68666,68667,68668,68669,68670,68671,68672,68673,68674,68675,68676,68677,68678,68679,68680,126464,126465,126466,126467,126469,126470,126471,126472,126473,126474,126475,126476,126477,126478,126479,126480,126481,126482,126483,126484,126485,126486,126487,126488,126489,126490,126491,126492,126493,126494,126495,126497,126498,126500,126503,126505,126506,126507,126508,126509,126510,126511,126512,126513,126514,126516,126517,126518,126519,126521,126523,126530,126535,126537,126539,126541,126542,126543,126545,126546,126548,126551,126553,126555,126557,126559,126561,126562,126564,126567,126568,126569,126570,126572,126573,126574,126575,126576,126577,126578,126580,126581,126582,126583,126585,126586,126587,126588,126590,126592,126593,126594,126595,126596,126597,126598,126599,126600,126601,126603,126604,126605,126606,126607,126608,126609,126610,126611,126612,126613,126614,126615,126616,126617,126618,126619,126625,126626,126627,126629,126630,126631,126632,126633,126635,126636,126637,126638,126639,126640,126641,126642,126643,126644,126645,126646,126647,126648,126649,126650,126651,1114109];f.prototype.applyStyles=function(n,t){t=t||this.div;for(var i in n)n.hasOwnProperty(i)&&(t.style[i]=n[i])};f.prototype.formatStyle=function(n,t){return n===0?0:n+t};e.prototype=o(f.prototype);e.prototype.constructor=e;t.prototype.move=function(n,t){t=t!==undefined?t:this.lineHeight;switch(n){case"+x":this.left+=t;this.right+=t;break;case"-x":this.left-=t;this.right-=t;break;case"+y":this.top+=t;this.bottom+=t;break;case"-y":this.top-=t;this.bottom-=t}};t.prototype.overlaps=function(n){return this.left<n.right&&this.right>n.left&&this.top<n.bottom&&this.bottom>n.top};t.prototype.overlapsAny=function(n){for(var t=0;t<n.length;t++)if(this.overlaps(n[t]))return!0;return!1};t.prototype.within=function(n){return this.top>=n.top&&this.bottom<=n.bottom&&this.left>=n.left&&this.right<=n.right};t.prototype.overlapsOppositeAxis=function(n,t){switch(t){case"+x":return this.left<n.left;case"-x":return this.right>n.right;case"+y":return this.top<n.top;case"-y":return this.bottom>n.bottom}};t.prototype.intersectPercentage=function(n){var t=Math.max(0,Math.min(this.right,n.right)-Math.max(this.left,n.left)),i=Math.max(0,Math.min(this.bottom,n.bottom)-Math.max(this.top,n.top)),r=t*i;return r/(this.height*this.width)};t.prototype.toCSSCompatValues=function(n){return{top:this.top-n.top,bottom:n.bottom-this.bottom,left:this.left-n.left,right:n.right-this.right,height:this.height,width:this.width}};t.getSimpleBoxPosition=function(n){var t=n.div?n.div.offsetHeight:n.tagName?n.offsetHeight:0,r=n.div?n.div.offsetWidth:n.tagName?n.offsetWidth:0,i=n.div?n.div.offsetTop:n.tagName?n.offsetTop:0;return n=n.div?n.div.getBoundingClientRect():n.tagName?n.getBoundingClientRect():n,{left:n.left,right:n.right,top:n.top||i,height:n.height||t,bottom:n.bottom||i+(n.height||t),width:n.width||r}};r.StringDecoder=function(){return{decode:function(n){if(!n)return"";if(typeof n!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(n))}}};r.convertCueToDOMTree=function(n,t){return!n||!t?null:a(n,t)};var g=.05,nt="sans-serif",tt="1.5%";r.processCues=function(n,i,r){function h(n){for(var t=0;t<n.length;t++)if(n[t].hasBeenReset||!n[t].displayState)return!0;return!1}var u,f;if(!n||!i||!r)return null;while(r.firstChild)r.removeChild(r.firstChild);if(u=n.document.createElement("div"),u.style.position="absolute",u.style.left="0",u.style.right="0",u.style.top="0",u.style.bottom="0",u.style.margin=tt,r.appendChild(u),!h(i)){for(f=0;f<i.length;f++)u.appendChild(i[f].displayState);return}var o=[],s=t.getSimpleBoxPosition(u),c=Math.round(s.height*g*100)/100,l={font:c+"px "+nt};(function(){for(var r,f,h=0;h<i.length;h++)f=i[h],r=new e(n,f,l),u.appendChild(r.div),d(n,r,s,o),f.displayState=r.div,o.push(t.getSimpleBoxPosition(r))})()};r.Parser=function(n,t,i){i||(i=t,t={});t||(t={});this.window=n;this.vttjs=t;this.state="INITIAL";this.buffer="";this.decoder=i||new TextDecoder("utf8");this.regionList=[]};r.Parser.prototype={reportOrThrowError:function(n){if(n instanceof i)this.onparsingerror&&this.onparsingerror(n);else throw n;},parse:function(n){function o(){for(var i=t.buffer,n=0,r;n<i.length&&i[n]!=="\r"&&i[n]!=="\n";)++n;return r=i.substr(0,n),i[n]==="\r"&&++n,i[n]==="\n"&&++n,t.buffer=i.substr(n),r}function l(n){var i=new u,r;s(n,function(n,t){var f,r;switch(n){case"id":i.set(n,t);break;case"width":i.percent(n,t);break;case"lines":i.integer(n,t);break;case"regionanchor":case"viewportanchor":if(f=t.split(","),f.length!==2)break;if(r=new u,r.percent("x",f[0]),r.percent("y",f[1]),!r.has("x")||!r.has("y"))break;i.set(n+"X",r.get("x"));i.set(n+"Y",r.get("y"));break;case"scroll":i.alt(n,t,["up"])}},/=/,/\s/);i.has("id")&&(r=new(t.vttjs.VTTRegion||t.window.VTTRegion),r.width=i.get("width",100),r.lines=i.get("lines",3),r.regionAnchorX=i.get("regionanchorX",0),r.regionAnchorY=i.get("regionanchorY",100),r.viewportAnchorX=i.get("viewportanchorX",0),r.viewportAnchorY=i.get("viewportanchorY",100),r.scroll=i.get("scroll",""),t.onregion&&t.onregion(r),t.regionList.push({id:i.get("id"),region:r}))}function a(n){s(n,function(n,t){switch(n){case"Region":l(t)}},/:/)}var t=this,r,e,f,c;n&&(t.buffer+=t.decoder.decode(n,{stream:!0}));try{if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;if(r=o(),e=r.match(/^WEBVTT([ \t].*)?$/),!e||!e[0])throw new i(i.Errors.BadSignature);t.state="HEADER"}for(f=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;f?f=!1:r=o();switch(t.state){case"HEADER":/:/.test(r)?a(r):r||(t.state="ID");continue;case"NOTE":r||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(r)){t.state="NOTE";break}if(!r)continue;if(t.cue=new(t.vttjs.VTTCue||t.window.VTTCue)(0,0,""),t.state="CUE",r.indexOf("-->")===-1){t.cue.id=r;continue}case"CUE":try{v(r,t.cue,t.regionList)}catch(h){t.reportOrThrowError(h);t.cue=null;t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":if(c=r.indexOf("-->")!==-1,!r||c&&(f=!0)){t.oncue&&t.oncue(t.cue);t.cue=null;t.state="ID";continue}t.cue.text&&(t.cue.text+="\n");t.cue.text+=r;continue;case"BADCUE":r||(t.state="ID");continue}}}catch(h){if(t.reportOrThrowError(h),t.state==="CUETEXT"&&t.cue&&t.oncue)t.oncue(t.cue);t.cue=null;t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var n=this;try{if(n.buffer+=n.decoder.decode(),(n.cue||n.state==="HEADER")&&(n.buffer+="\n\n",n.parse()),n.state==="INITIAL")throw new i(i.Errors.BadSignature);}catch(t){n.reportOrThrowError(t)}return n.onflush&&n.onflush(),this}};n.WebVTT=r}(this,this.vttjs||{}),vjs.JSON={},vjs.JSON.safeParseTuple=function(n,t){var i,r=null;try{i=JSON.parse(n,t)}catch(u){r=u;vjs.log("JSON.parse(): invalid or malformed JSON data")}return[r,i]},vjs.autoSetup=function(){var e,t,o,n,i,u=document.getElementsByTagName("video"),f=document.getElementsByTagName("audio"),r=[];if(u&&u.length>0)for(n=0,i=u.length;n<i;n++)r.push(u[n]);if(f&&f.length>0)for(n=0,i=f.length;n<i;n++)r.push(f[n]);if(r&&r.length>0)for(n=0,i=r.length;n<i;n++)if(t=r[n],t&&t.getAttribute)t.player===undefined&&(e=t.getAttribute("data-setup"),e!==null&&(o=videojs(t)));else{vjs.autoSetupTimeout(1);break}else vjs.windowLoaded||vjs.autoSetupTimeout(1)},vjs.autoSetupTimeout=function(n){setTimeout(vjs.autoSetup,n)},document.readyState==="complete")vjs.windowLoaded=!0;else vjs.one(window,"load",function(){vjs.windowLoaded=!0});vjs.autoSetupTimeout(1);vjs.plugin=function(n,t){vjs.Player.prototype[n]=t};vjs.getIsoLangs=function(){return{ab:{name:"Abkhaz",nativeName:"аҧсуа"},aa:{name:"Afar",nativeName:"Afaraf"},af:{name:"Afrikaans",nativeName:"Afrikaans"},ak:{name:"Akan",nativeName:"Akan"},sq:{name:"Albanian",nativeName:"Shqip"},am:{name:"Amharic",nativeName:"አማርኛ"},ar:{name:"Arabic",nativeName:"العربية"},an:{name:"Aragonese",nativeName:"Aragonés"},hy:{name:"Armenian",nativeName:"Հայերեն"},as:{name:"Assamese",nativeName:"অসমীয়া"},av:{name:"Avaric",nativeName:"авар мацӀ, магӀарул мацӀ"},ae:{name:"Avestan",nativeName:"avesta"},ay:{name:"Aymara",nativeName:"aymar aru"},az:{name:"Azerbaijani",nativeName:"azərbaycan dili"},bm:{name:"Bambara",nativeName:"bamanankan"},ba:{name:"Bashkir",nativeName:"башҡорт теле"},eu:{name:"Basque",nativeName:"euskara, euskera"},be:{name:"Belarusian",nativeName:"Беларуская"},bn:{name:"Bengali",nativeName:"বাংলা"},bh:{name:"Bihari",nativeName:"भोजपुरी"},bi:{name:"Bislama",nativeName:"Bislama"},bs:{name:"Bosnian",nativeName:"bosanski jezik"},br:{name:"Breton",nativeName:"brezhoneg"},bg:{name:"Bulgarian",nativeName:"български език"},my:{name:"Burmese",nativeName:"ဗမာစာ"},ca:{name:"Catalan; Valencian",nativeName:"Català"},ch:{name:"Chamorro",nativeName:"Chamoru"},ce:{name:"Chechen",nativeName:"нохчийн мотт"},ny:{name:"Chichewa; Chewa; Nyanja",nativeName:"chiCheŵa, chinyanja"},zh:{name:"Chinese",nativeName:"中文 (Zhōngwén), 汉语, 漢語"},cv:{name:"Chuvash",nativeName:"чӑваш чӗлхи"},kw:{name:"Cornish",nativeName:"Kernewek"},co:{name:"Corsican",nativeName:"corsu, lingua corsa"},cr:{name:"Cree",nativeName:"ᓀᐦᐃᔭᐍᐏᐣ"},hr:{name:"Croatian",nativeName:"hrvatski"},cs:{name:"Czech",nativeName:"čeština"},da:{name:"Danish",nativeName:"dansk"},dv:{name:"Divehi; Dhivehi; Maldivian;",nativeName:"ދިވެހި"},nl:{name:"Dutch",nativeName:"Nederlands"},en:{name:"English",nativeName:"English"},eo:{name:"Esperanto",nativeName:"Esperanto"},et:{name:"Estonian",nativeName:"eesti"},ee:{name:"Ewe",nativeName:"Eʋegbe"},fo:{name:"Faroese",nativeName:"føroyskt"},fj:{name:"Fijian",nativeName:"vosa Vakaviti"},fi:{name:"Finnish",nativeName:"suomi"},fr:{name:"French",nativeName:"français"},ff:{name:"Fula; Fulah; Pulaar; Pular",nativeName:"Fulfulde, Pulaar, Pular"},gl:{name:"Galician",nativeName:"Galego"},ka:{name:"Georgian",nativeName:"ქართული"},de:{name:"German",nativeName:"Deutsch"},el:{name:"Greek, Modern",nativeName:"Ελληνικά"},gn:{name:"Guaraní",nativeName:"Avañeẽ"},gu:{name:"Gujarati",nativeName:"ગુજરાતી"},ht:{name:"Haitian; Haitian Creole",nativeName:"Kreyòl ayisyen"},ha:{name:"Hausa",nativeName:"Hausa, هَوُسَ"},he:{name:"Hebrew (modern)",nativeName:"עברית"},hz:{name:"Herero",nativeName:"Otjiherero"},hi:{name:"Hindi",nativeName:"हिन्दी, हिंदी"},ho:{name:"Hiri Motu",nativeName:"Hiri Motu"},hu:{name:"Hungarian",nativeName:"Magyar"},ia:{name:"Interlingua",nativeName:"Interlingua"},id:{name:"Indonesian",nativeName:"Bahasa Indonesia"},ie:{name:"Interlingue",nativeName:"Interlingue"},ga:{name:"Irish",nativeName:"Gaeilge"},ig:{name:"Igbo",nativeName:"Asụsụ Igbo"},ik:{name:"Inupiaq",nativeName:"Iñupiaq"},io:{name:"Ido",nativeName:"Ido"},is:{name:"Icelandic",nativeName:"Íslenska"},it:{name:"Italian",nativeName:"Italiano"},iu:{name:"Inuktitut",nativeName:"ᐃᓄᒃᑎᑐᑦ"},ja:{name:"Japanese",nativeName:"日本語"},jv:{name:"Javanese",nativeName:"basa Jawa"},kl:{name:"Kalaallisut, Greenlandic",nativeName:"kalaallisut, kalaallit oqaasii"},kn:{name:"Kannada",nativeName:"ಕನ್ನಡ"},kr:{name:"Kanuri",nativeName:"Kanuri"},ks:{name:"Kashmiri",nativeName:"कश्मीरी, كشميري‎"},kk:{name:"Kazakh",nativeName:"Қазақ тілі"},km:{name:"Khmer",nativeName:"ភាសាខ្មែរ"},ki:{name:"Kikuyu, Gikuyu",nativeName:"Gĩkũyũ"},rw:{name:"Kinyarwanda",nativeName:"Ikinyarwanda"},ky:{name:"Kirghiz, Kyrgyz",nativeName:"кыргыз тили"},kv:{name:"Komi",nativeName:"коми кыв"},kg:{name:"Kongo",nativeName:"KiKongo"},ko:{name:"Korean",nativeName:"한국어 (韓國語), 조선말 (朝鮮語)"},ku:{name:"Kurdish",nativeName:"كوردی‎"},kj:{name:"Kwanyama, Kuanyama",nativeName:"Kuanyama"},la:{name:"Latin",nativeName:"latine"},lb:{name:"Luxembourgish, Letzeburgesch",nativeName:"Lëtzebuergesch"},lg:{name:"Luganda",nativeName:"Luganda"},li:{name:"Limburgish, Limburgan, Limburger",nativeName:"Limburgs"},ln:{name:"Lingala",nativeName:"Lingála"},lo:{name:"Lao",nativeName:"ພາສາລາວ"},lt:{name:"Lithuanian",nativeName:"lietuvių kalba"},lu:{name:"Luba-Katanga",nativeName:""},lv:{name:"Latvian",nativeName:"latviešu valoda"},gv:{name:"Manx",nativeName:"Gaelg, Gailck"},mk:{name:"Macedonian",nativeName:"македонски јазик"},mg:{name:"Malagasy",nativeName:"Malagasy fiteny"},ms:{name:"Malay",nativeName:"bahasa Melayu, بهاس ملايو‎"},ml:{name:"Malayalam",nativeName:"മലയാളം"},mt:{name:"Maltese",nativeName:"Malti"},mi:{name:"Māori",nativeName:"te reo Māori"},mr:{name:"Marathi (Marāṭhī)",nativeName:"मराठी"},mh:{name:"Marshallese",nativeName:"Kajin M̧ajeļ"},mn:{name:"Mongolian",nativeName:"монгол"},na:{name:"Nauru",nativeName:"Ekakairũ Naoero"},nv:{name:"Navajo, Navaho",nativeName:"Diné bizaad, Dinékʼehǰí"},nb:{name:"Norwegian Bokmål",nativeName:"Norsk bokmål"},nd:{name:"North Ndebele",nativeName:"isiNdebele"},ne:{name:"Nepali",nativeName:"नेपाली"},ng:{name:"Ndonga",nativeName:"Owambo"},nn:{name:"Norwegian Nynorsk",nativeName:"Norsk nynorsk"},no:{name:"Norwegian",nativeName:"Norsk"},ii:{name:"Nuosu",nativeName:"ꆈꌠ꒿ Nuosuhxop"},nr:{name:"South Ndebele",nativeName:"isiNdebele"},oc:{name:"Occitan",nativeName:"Occitan"},oj:{name:"Ojibwe, Ojibwa",nativeName:"ᐊᓂᔑᓈᐯᒧᐎᓐ"},cu:{name:"Old Church Slavonic, Church Slavic, Church Slavonic, Old Bulgarian, Old Slavonic",nativeName:"ѩзыкъ словѣньскъ"},om:{name:"Oromo",nativeName:"Afaan Oromoo"},or:{name:"Oriya",nativeName:"ଓଡ଼ିଆ"},os:{name:"Ossetian, Ossetic",nativeName:"ирон æвзаг"},pa:{name:"Panjabi, Punjabi",nativeName:"ਪੰਜਾਬੀ, پنجابی‎"},pi:{name:"Pāli",nativeName:"पाऴि"},fa:{name:"Persian",nativeName:"فارسی"},pl:{name:"Polish",nativeName:"polski"},ps:{name:"Pashto, Pushto",nativeName:"پښتو"},pt:{name:"Portuguese",nativeName:"Português"},qu:{name:"Quechua",nativeName:"Runa Simi, Kichwa"},rm:{name:"Romansh",nativeName:"rumantsch grischun"},rn:{name:"Kirundi",nativeName:"kiRundi"},ro:{name:"Romanian, Moldavian, Moldovan",nativeName:"română"},ru:{name:"Russian",nativeName:"русский"},sa:{name:"Sanskrit (Saṁskṛta)",nativeName:"संस्कृतम्"},sc:{name:"Sardinian",nativeName:"sardu"},sd:{name:"Sindhi",nativeName:"सिन्धी, سنڌي، سندھی‎"},se:{name:"Northern Sami",nativeName:"Davvisámegiella"},sm:{name:"Samoan",nativeName:"gagana faa Samoa"},sg:{name:"Sango",nativeName:"yângâ tî sängö"},sr:{name:"Serbian",nativeName:"српски језик"},gd:{name:"Scottish Gaelic; Gaelic",nativeName:"Gàidhlig"},sn:{name:"Shona",nativeName:"chiShona"},si:{name:"Sinhala, Sinhalese",nativeName:"සිංහල"},sk:{name:"Slovak",nativeName:"slovenčina"},sl:{name:"Slovene",nativeName:"slovenščina"},so:{name:"Somali",nativeName:"Soomaaliga, af Soomaali"},st:{name:"Southern Sotho",nativeName:"Sesotho"},es:{name:"Spanish",nativeName:"español"},su:{name:"Sundanese",nativeName:"Basa Sunda"},sw:{name:"Swahili",nativeName:"Kiswahili"},ss:{name:"Swati",nativeName:"SiSwati"},sv:{name:"Swedish",nativeName:"svenska"},ta:{name:"Tamil",nativeName:"தமிழ்"},te:{name:"Telugu",nativeName:"తెలుగు"},tg:{name:"Tajik",nativeName:"تاجیکی‎"},th:{name:"Thai",nativeName:"ไทย"},ti:{name:"Tigrinya",nativeName:"ትግርኛ"},bo:{name:"Tibetan Standard, Tibetan, Central",nativeName:"བོད་ཡིག"},tk:{name:"Turkmen",nativeName:"Türkmen"},tl:{name:"Tagalog",nativeName:"Wikang Tagalog"},tn:{name:"Tswana",nativeName:"Setswana"},to:{name:"Tonga (Tonga Islands)",nativeName:"faka Tonga"},tr:{name:"Turkish",nativeName:"Türkçe"},ts:{name:"Tsonga",nativeName:"Xitsonga"},tt:{name:"Tatar",nativeName:"تاتارچا‎"},tw:{name:"Twi",nativeName:"Twi"},ty:{name:"Tahitian",nativeName:"Reo Tahiti"},ug:{name:"Uighur, Uyghur",nativeName:"ئۇيغۇرچە‎"},uk:{name:"Ukrainian",nativeName:"українська"},ur:{name:"Urdu",nativeName:"اردو"},uz:{name:"Uzbek",nativeName:"zbek, Ўзбек, أۇزبېك‎"},ve:{name:"Venda",nativeName:"Tshivenḓa"},vi:{name:"Vietnamese",nativeName:"Tiếng Việt"},vo:{name:"Volapük",nativeName:"Volapük"},wa:{name:"Walloon",nativeName:"Walon"},cy:{name:"Welsh",nativeName:"Cymraeg"},wo:{name:"Wolof",nativeName:"Wollof"},fy:{name:"Western Frisian",nativeName:"Frysk"},xh:{name:"Xhosa",nativeName:"isiXhosa"},yi:{name:"Yiddish",nativeName:"ייִדיש"},yo:{name:"Yoruba",nativeName:"Yorùbá"},za:{name:"Zhuang, Chuang",nativeName:"Saɯ cueŋƅ, Saw cuengh"}}};vjs.get2LetterLangCode=function(n){return{aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",alb:"sq",amh:"am",ara:"ar",arm:"hy",hye:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",eus:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",tib:"bo",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",mya:"my",cat:"ca",cze:"cs",ces:"cs",cha:"ch",che:"ce",chi:"zh",zho:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",wel:"cy",cym:"cy",cze:"cs",ces:"cs",dan:"da",ger:"de",deu:"de",div:"dv",dut:"nl",nld:"nl",dzo:"dz",gre:"el",ell:"el",eng:"en",epo:"eo",est:"et",baq:"eu",eus:"eu",ewe:"ee",fao:"fo",per:"fa",fas:"fa",fij:"fj",fin:"fi",fre:"fr",fra:"fr",fre:"fr",fra:"fr",fry:"fy",ful:"ff",geo:"ka",kat:"ka",ger:"de",deu:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",ell:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",arm:"hy",hye:"hy",ibo:"ig",ice:"is",isl:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",ice:"is",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",geo:"ka",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",lug:"lg",mac:"mk",mkd:"mk",mah:"mh",mal:"ml",mao:"mi",mri:"mi",mar:"mr",may:"ms",msa:"ms",mac:"mk",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mao:"mi",mri:"mi",may:"ms",msa:"ms",bur:"my",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",dut:"nl",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",fas:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",rum:"ro",ron:"ro",rum:"ro",ron:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slo:"sk",slk:"sk",slo:"sk",slk:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",alb:"sq",sqi:"sq",srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",bod:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",cym:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",chi:"zh",zho:"zh",zul:"zu"}[n]};Dash=function(){"use strict";return{modules:{},dependencies:{},vo:{},di:{}}}();Dash.dependencies.DashParser=function(){"use strict";var f=31536e3,e=2592e3,o=86400,s=3600,n=60,h=60,t=1e3,i=/^P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,r=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})([0-9]{2}))?/,u=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,c=[{type:"duration",test:function(n){return i.test(n)},converter:function(t){var r=i.exec(t);return parseFloat(r[2]||0)*f+parseFloat(r[4]||0)*e+parseFloat(r[6]||0)*o+parseFloat(r[8]||0)*s+parseFloat(r[10]||0)*n+parseFloat(r[12]||0)},suffix:function(){return""}},{type:"datetime",test:function(n){return r.test(n)},converter:function(i){var u=r.exec(i),f,e;return f=Date.UTC(parseInt(u[1],10),parseInt(u[2],10)-1,parseInt(u[3],10),parseInt(u[4],10),parseInt(u[5],10),u[6]&&parseInt(u[6],10)||0,u[7]&&parseFloat(u[7])*t||0),u[9]&&u[10]&&(e=parseInt(u[9],10)*h+parseInt(u[10],10),f+=(u[8]==="+"?-1:1)*e*n*t),new Date(f)},suffix:function(){return""}},{type:"numeric",test:function(n){return u.test(n)},converter:function(n){return parseFloat(n)},suffix:function(){return""}},{type:"numeric",test:function(n){return u.test(n)},converter:function(n){return n},suffix:function(){return"_str"}}],l=function(){var n,t,i,r;return r=[{name:"profiles",merge:!1},{name:"width",merge:!1},{name:"height",merge:!1},{name:"sar",merge:!1},{name:"frameRate",merge:!1},{name:"audioSamplingRate",merge:!1},{name:"mimeType",merge:!1},{name:"segmentProfiles",merge:!1},{name:"codecs",merge:!1},{name:"maximumSAPPeriod",merge:!1},{name:"startsWithSap",merge:!1},{name:"maxPlayoutRate",merge:!1},{name:"codingDependency",merge:!1},{name:"scanType",merge:!1},{name:"FramePacking",merge:!0},{name:"AudioChannelConfiguration",merge:!0},{name:"ContentProtection",merge:!0}],n={},n.name="AdaptationSet",n.isRoot=!1,n.isArray=!0,n.parent=null,n.children=[],n.properties=r,t={},t.name="Representation",t.isRoot=!1,t.isArray=!0,t.parent=n,t.children=[],t.properties=r,n.children.push(t),i={},i.name="SubRepresentation",i.isRoot=!1,i.isArray=!0,i.parent=t,i.children=[],i.properties=r,t.children.push(i),n},a=function(){var n,t,i,r;return r=[{name:"SegmentBase",merge:!0},{name:"SegmentTemplate",merge:!0},{name:"SegmentList",merge:!0}],n={},n.name="Period",n.isRoot=!1,n.isArray=!0,n.parent=null,n.children=[],n.properties=r,t={},t.name="AdaptationSet",t.isRoot=!1,t.isArray=!0,t.parent=n,t.children=[],t.properties=r,n.children.push(t),i={},i.name="Representation",i.isRoot=!1,i.isArray=!0,i.parent=t,i.children=[],i.properties=r,t.children.push(i),n},v=function(){var i,n,t,r,u;return u=[{name:"BaseURL",merge:!0,mergeFunction:function(n,t){return t.indexOf("http://")===0?t:n+t}}],i={},i.name="mpd",i.isRoot=!0,i.isArray=!0,i.parent=null,i.children=[],i.properties=u,n={},n.name="Period",n.isRoot=!1,n.isArray=!0,n.parent=null,n.children=[],n.properties=u,i.children.push(n),t={},t.name="AdaptationSet",t.isRoot=!1,t.isArray=!0,t.parent=n,t.children=[],t.properties=u,n.children.push(t),r={},r.name="Representation",r.isRoot=!1,r.isArray=!0,r.parent=t,r.children=[],r.properties=u,t.children.push(r),i},y=function(){var n=[];return n.push(l()),n.push(a()),n.push(v()),n},p=function(n,t){var i,e=new X2JS(c,"",!0),o=new ObjectIron(y()),f=new Date,r=null,u=null;try{i=e.xml_str2json(n);r=new Date;i.hasOwnProperty("BaseURL")?(i.BaseURL=i.BaseURL_asArray[0],i.BaseURL.toString().indexOf("http")!==0&&(i.BaseURL=t+i.BaseURL)):i.BaseURL=t;o.run(i);u=new Date;this.debug.log("Parsing complete: ( xml2json: "+(r.getTime()-f.getTime())+"ms, objectiron: "+(u.getTime()-r.getTime())+"ms, total: "+(u.getTime()-f.getTime())/1e3+"s)")}catch(s){return this.errHandler.manifestError("parsing the manifest failed","parse",n),null}return i};return{debug:undefined,errHandler:undefined,parse:p}};Dash.dependencies.DashParser.prototype={constructor:Dash.dependencies.DashParser};!function(){var n,t,r,i;!function(){var u={},f={};n=function(n,t,i){u[n]={deps:t,callback:i}};i=r=t=function(n){function l(t){var i;if("."!==t.charAt(0))return t;for(var f=t.split("/"),r=n.split("/").slice(0,-1),u=0,e=f.length;e>u;u++)if(i=f[u],".."===i)r.pop();else{if("."===i)continue;r.push(i)}return r.join("/")}var c;if(i._eak_seen=u,f[n])return f[n];if(f[n]={},!u[n])throw new Error("Could not find module "+n);for(var s,h=u[n],e=h.deps,a=h.callback,o=[],r=0,v=e.length;v>r;r++)"exports"===e[r]?o.push(s={}):o.push(t(l(e[r])));return c=a.apply(this,o),f[n]=s||c}}();n("promise/all",["./utils","exports"],function(n,t){"use strict";function i(n){var t=this;if(!r(n))throw new TypeError("You must pass an array to all.");return new t(function(t,i){function h(n){return function(t){e(n,t)}}function e(n,i){o[n]=i;0==--s&&t(o)}var f,o=[],s=n.length,r;for(0===s&&t([]),r=0;r<n.length;r++)f=n[r],f&&u(f.then)?f.then(h(r),i):e(r,f)})}var r=n.isArray,u=n.isFunction;t.all=i});n("promise/asap",["exports"],function(n){"use strict";function e(){return function(){process.nextTick(i)}}function o(){var n=0,r=new f(i),t=document.createTextNode("");return r.observe(t,{characterData:!0}),function(){t.data=n=++n%2}}function s(){return function(){c.setTimeout(i,1)}}function i(){for(var n=0;n<t.length;n++){var i=t[n],r=i[0],u=i[1];r(u)}t=[]}function h(n,i){var u=t.push([n,i]);1===u&&r()}var r,u="undefined"!=typeof window?window:{},f=u.MutationObserver||u.WebKitMutationObserver,c="undefined"!=typeof global?global:void 0===this?window:this,t=[];r="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?e():f?o():s();n.asap=h});n("promise/config",["exports"],function(n){"use strict";function i(n,i){return 2!==arguments.length?t[n]:(t[n]=i,void 0)}var t={instrument:!1};n.config=t;n.configure=i});n("promise/polyfill",["./promise","./utils","exports"],function(n,t,i){"use strict";function r(){var n,t;n="undefined"!=typeof global?global:"undefined"!=typeof window&&window.document?window:self;t="Promise"in n&&"resolve"in n.Promise&&"reject"in n.Promise&&"all"in n.Promise&&"race"in n.Promise&&function(){var t;return new n.Promise(function(n){t=n}),f(t)}();t||(n.Promise=u)}var u=n.Promise,f=t.isFunction;i.polyfill=r});n("promise/promise",["./config","./utils","./all","./race","./resolve","./reject","./asap","exports"],function(n,t,i,r,u,f,e,o){"use strict";function s(n){if(!v(n))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof s))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[];nt(n,this)}function nt(n,t){function r(n){c(t,n)}function i(n){h(t,n)}try{n(r,i)}catch(u){i(u)}}function w(n,t,i,r){var u,e,f,o,s=v(i);if(s)try{u=i(r);f=!0}catch(l){o=!0;e=l}else u=r,f=!0;k(t,u)||(s&&f?c(t,u):o?h(t,e):n===y?c(t,u):n===p&&h(t,u))}function tt(n,t,i,r){var u=n._subscribers,f=u.length;u[f]=t;u[f+y]=i;u[f+p]=r}function b(n,t){for(var u,f,r=n._subscribers,e=n._detail,i=0;i<r.length;i+=3)u=r[i],f=r[i+t],w(t,u,f,e);n._subscribers=null}function k(n,t){var i,r=null;try{if(n===t)throw new TypeError("A promises callback cannot return that same promise.");if(ut(t)&&(r=t.then,v(r)))return r.call(t,function(r){return i?!0:(i=!0,t!==r?c(n,r):a(n,r),void 0)},function(t){return i?!0:(i=!0,h(n,t),void 0)}),!0}catch(u){return i?!0:(h(n,u),!0)}return!1}function c(n,t){n===t?a(n,t):k(n,t)||a(n,t)}function a(n,t){n._state===d&&(n._state=g,n._detail=t,l.async(it,n))}function h(n,t){n._state===d&&(n._state=g,n._detail=t,l.async(rt,n))}function it(n){b(n,n._state=y)}function rt(n){b(n,n._state=p)}var l=n.config,ut=(n.configure,t.objectOrFunction),v=t.isFunction,ft=(t.now,i.all),et=r.race,ot=u.resolve,st=f.reject,ht=e.asap;l.async=ht;var d=void 0,g=0,y=1,p=2;s.prototype={constructor:s,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(n,t){var i=this,r=new this.constructor(function(){}),u;return this._state?(u=arguments,l.async(function(){w(i._state,r,u[i._state-1],i._detail)})):tt(this,r,n,t),r},"catch":function(n){return this.then(null,n)}};s.all=ft;s.race=et;s.resolve=ot;s.reject=st;o.Promise=s});n("promise/race",["./utils","exports"],function(n,t){"use strict";function i(n){var t=this;if(!r(n))throw new TypeError("You must pass an array to race.");return new t(function(t,i){for(var r,u=0;u<n.length;u++)r=n[u],r&&"function"==typeof r.then?r.then(t,i):t(r)})}var r=n.isArray;t.race=i});n("promise/reject",["exports"],function(n){"use strict";function t(n){var t=this;return new t(function(t,i){i(n)})}n.reject=t});n("promise/resolve",["exports"],function(n){"use strict";function t(n){if(n&&"object"==typeof n&&n.constructor===this)return n;var t=this;return new t(function(t){t(n)})}n.resolve=t});n("promise/utils",["exports"],function(n){"use strict";function i(n){return t(n)||"object"==typeof n&&null!==n}function t(n){return"function"==typeof n}function r(n){return"[object Array]"===Object.prototype.toString.call(n)}var u=Date.now||function(){return(new Date).getTime()};n.objectOrFunction=i;n.isFunction=t;n.isArray=r;n.now=u});t("promise/polyfill").polyfill()}(),function(n,t){typeof define=="function"&&define.amd?define("forge",[],t):n.forge=t()}(this,function(){var i,t,n;return function(r){function e(n,t){return nt.call(n,t)}function c(n,t){var o,s,u,e,h,y,c,w,i,l,p,r=t&&t.split("/"),a=f.map,v=a&&a["*"]||{};if(n&&n.charAt(0)===".")if(t){for(r=r.slice(0,r.length-1),n=n.split("/"),h=n.length-1,f.nodeIdCompat&&b.test(n[h])&&(n[h]=n[h].replace(b,"")),n=r.concat(n),i=0;i<n.length;i+=1)if(p=n[i],p===".")n.splice(i,1),i-=1;else if(p===".."){if(i===1&&(n[2]===".."||n[0]===".."))break;i>0&&(n.splice(i-1,2),i-=2)}n=n.join("/")}else n.indexOf("./")===0&&(n=n.substring(2));if((r||v)&&a){for(o=n.split("/"),i=o.length;i>0;i-=1){if(s=o.slice(0,i).join("/"),r)for(l=r.length;l>0;l-=1)if(u=a[r.slice(0,l).join("/")],u&&(u=u[s],u)){e=u;y=i;break}if(e)break;!c&&v&&v[s]&&(c=v[s],w=i)}!e&&c&&(e=c,y=w);e&&(o.splice(0,y,e),n=o.join("/"))}return n}function p(n,t){return function(){return o.apply(r,tt.call(arguments,0).concat([n,t]))}}function k(n){return function(t){return c(t,n)}}function d(n){return function(t){u[n]=t}}function l(n){if(e(h,n)){var t=h[n];delete h[n];y[n]=!0;a.apply(r,t)}if(!e(u,n)&&!e(y,n))throw new Error("No "+n);return u[n]}function w(n){var i,t=n?n.indexOf("!"):-1;return t>-1&&(i=n.substring(0,t),n=n.substring(t+1,n.length)),[i,n]}function g(n){return function(){return f&&f.config&&f.config[n]||{}}}var a,o,v,s,u={},h={},f={},y={},nt=Object.prototype.hasOwnProperty,tt=[].slice,b=/\.js$/;v=function(n,t){var r,u=w(n),i=u[0];return n=u[1],i&&(i=c(i,t),r=l(i)),i?n=r&&r.normalize?r.normalize(n,k(t)):c(n,t):(n=c(n,t),u=w(n),i=u[0],n=u[1],i&&(r=l(i))),{f:i?i+"!"+n:n,n:n,pr:i,p:r}};s={require:function(n){return p(n)},exports:function(n){var t=u[n];return typeof t!="undefined"?t:u[n]={}},module:function(n){return{id:n,uri:"",exports:u[n],config:g(n)}}};a=function(n,t,i,f){var w,o,k,b,c,a=[],g=typeof i,nt;if(f=f||n,g==="undefined"||g==="function"){for(t=!t.length&&i.length?["require","exports","module"]:t,c=0;c<t.length;c+=1)if(b=v(t[c],f),o=b.f,o==="require")a[c]=s.require(n);else if(o==="exports")a[c]=s.exports(n),nt=!0;else if(o==="module")w=a[c]=s.module(n);else if(e(u,o)||e(h,o)||e(y,o))a[c]=l(o);else{if(!b.p)throw new Error(n+" missing "+o);b.p.load(b.n,p(f,!0),d(o),{});a[c]=u[o]}k=i?i.apply(u[n],a):undefined;n&&(w&&w.exports!==r&&w.exports!==u[n]?u[n]=w.exports:k===r&&nt||(u[n]=k))}else n&&(u[n]=i)};i=t=o=function(n,t,i,u,e){if(typeof n=="string")return s[n]?s[n](t):l(v(n,t).f);if(!n.splice){if(f=n,f.deps&&o(f.deps,f.callback),!t)return;t.splice?(n=t,t=i,i=null):n=r}return t=t||function(){},typeof i=="function"&&(i=u,u=e),u?a(r,n,t,i):setTimeout(function(){a(r,n,t,i)},4),o};o.config=function(n){return o(n)};i._defined=u;n=function(n,t,i){t.splice||(i=t,t=[]);e(u,n)||e(h,n)||(h[n]=[n,t,i])};n.amd={jQuery:!0}}(),n("node_modules/almond/almond",function(){}),function(){function u(n){function o(n){var i,r;if(this.data="",this.read=0,typeof n=="string")this.data=n;else if(t.isArrayBuffer(n)||t.isArrayBufferView(n)){i=new Uint8Array(n);try{this.data=String.fromCharCode.apply(null,i)}catch(u){for(r=0;r<i.length;++r)this.putByte(i[r])}}else(n instanceof o||typeof n=="object"&&typeof n.data=="string"&&typeof n.read=="number")&&(this.data=n.data,this.read=n.read);this._constructedStringLength=0}function l(n,i){i=i||{};this.read=i.readOffset||0;this.growSize=i.growSize||1024;var r=t.isArrayBuffer(n),u=t.isArrayBufferView(n);if(r||u){this.data=r?new DataView(n):new DataView(n.buffer,n.byteOffset,n.byteLength);this.write="writeOffset"in i?i.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0));this.write=0;n!==null&&n!==undefined&&this.putBytes(n);"writeOffset"in i&&(this.write=i.writeOffset)}var t=n.util=n.util||{},i,c,r,u,f;typeof process=="undefined"||!process.nextTick?typeof setImmediate=="function"?(t.setImmediate=setImmediate,t.nextTick=function(n){return setImmediate(n)}):(t.setImmediate=function(n){setTimeout(n,0)},t.nextTick=t.setImmediate):(t.nextTick=process.nextTick,t.setImmediate=typeof setImmediate=="function"?setImmediate:t.nextTick);t.isArray=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};t.isArrayBuffer=function(n){return typeof ArrayBuffer!="undefined"&&n instanceof ArrayBuffer};i=[];typeof DataView!="undefined"&&i.push(DataView);typeof Int8Array!="undefined"&&i.push(Int8Array);typeof Uint8Array!="undefined"&&i.push(Uint8Array);typeof Uint8ClampedArray!="undefined"&&i.push(Uint8ClampedArray);typeof Int16Array!="undefined"&&i.push(Int16Array);typeof Uint16Array!="undefined"&&i.push(Uint16Array);typeof Int32Array!="undefined"&&i.push(Int32Array);typeof Uint32Array!="undefined"&&i.push(Uint32Array);typeof Float32Array!="undefined"&&i.push(Float32Array);typeof Float64Array!="undefined"&&i.push(Float64Array);t.isArrayBufferView=function(n){for(var t=0;t<i.length;++t)if(n instanceof i[t])return!0;return!1};t.ByteBuffer=o;t.ByteStringBuffer=o;c=4096;t.ByteStringBuffer.prototype._optimizeConstructedString=function(n){this._constructedStringLength+=n;this._constructedStringLength>c&&(this.data.substr(0,1),this._constructedStringLength=0)};t.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};t.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};t.ByteStringBuffer.prototype.putByte=function(n){return this.putBytes(String.fromCharCode(n))};t.ByteStringBuffer.prototype.fillWithByte=function(n,t){n=String.fromCharCode(n);for(var i=this.data;t>0;)t&1&&(i+=n),t>>>=1,t>0&&(n+=n);return this.data=i,this._optimizeConstructedString(t),this};t.ByteStringBuffer.prototype.putBytes=function(n){return this.data+=n,this._optimizeConstructedString(n.length),this};t.ByteStringBuffer.prototype.putString=function(n){return this.putBytes(t.encodeUtf8(n))};t.ByteStringBuffer.prototype.putInt16=function(n){return this.putBytes(String.fromCharCode(n>>8&255)+String.fromCharCode(n&255))};t.ByteStringBuffer.prototype.putInt24=function(n){return this.putBytes(String.fromCharCode(n>>16&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n&255))};t.ByteStringBuffer.prototype.putInt32=function(n){return this.putBytes(String.fromCharCode(n>>24&255)+String.fromCharCode(n>>16&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n&255))};t.ByteStringBuffer.prototype.putInt16Le=function(n){return this.putBytes(String.fromCharCode(n&255)+String.fromCharCode(n>>8&255))};t.ByteStringBuffer.prototype.putInt24Le=function(n){return this.putBytes(String.fromCharCode(n&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n>>16&255))};t.ByteStringBuffer.prototype.putInt32Le=function(n){return this.putBytes(String.fromCharCode(n&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n>>16&255)+String.fromCharCode(n>>24&255))};t.ByteStringBuffer.prototype.putInt=function(n,t){var i="";do t-=8,i+=String.fromCharCode(n>>t&255);while(t>0);return this.putBytes(i)};t.ByteStringBuffer.prototype.putSignedInt=function(n,t){return n<0&&(n+=2<<t-1),this.putInt(n,t)};t.ByteStringBuffer.prototype.putBuffer=function(n){return this.putBytes(n.getBytes())};t.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};t.ByteStringBuffer.prototype.getInt16=function(){var n=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,n};t.ByteStringBuffer.prototype.getInt24=function(){var n=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,n};t.ByteStringBuffer.prototype.getInt32=function(){var n=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,n};t.ByteStringBuffer.prototype.getInt16Le=function(){var n=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,n};t.ByteStringBuffer.prototype.getInt24Le=function(){var n=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,n};t.ByteStringBuffer.prototype.getInt32Le=function(){var n=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,n};t.ByteStringBuffer.prototype.getInt=function(n){var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),n-=8;while(n>0);return t};t.ByteStringBuffer.prototype.getSignedInt=function(n){var t=this.getInt(n),i=2<<n-2;return t>=i&&(t-=i<<1),t};t.ByteStringBuffer.prototype.getBytes=function(n){var t;return n?(n=Math.min(this.length(),n),t=this.data.slice(this.read,this.read+n),this.read+=n):n===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};t.ByteStringBuffer.prototype.bytes=function(n){return typeof n=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+n)};t.ByteStringBuffer.prototype.at=function(n){return this.data.charCodeAt(this.read+n)};t.ByteStringBuffer.prototype.setAt=function(n,t){return this.data=this.data.substr(0,this.read+n)+String.fromCharCode(t)+this.data.substr(this.read+n+1),this};t.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};t.ByteStringBuffer.prototype.copy=function(){var n=t.createBuffer(this.data);return n.read=this.read,n};t.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};t.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};t.ByteStringBuffer.prototype.truncate=function(n){var t=Math.max(0,this.length()-n);return this.data=this.data.substr(this.read,t),this.read=0,this};t.ByteStringBuffer.prototype.toHex=function(){for(var i,n="",t=this.read;t<this.data.length;++t)i=this.data.charCodeAt(t),i<16&&(n+="0"),n+=i.toString(16);return n};t.ByteStringBuffer.prototype.toString=function(){return t.decodeUtf8(this.bytes())};t.DataBuffer=l;t.DataBuffer.prototype.length=function(){return this.write-this.read};t.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};t.DataBuffer.prototype.accommodate=function(n,t){if(this.length()>=n)return this;t=Math.max(t||this.growSize,n);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),i=new Uint8Array(this.length()+t);return i.set(r),this.data=new DataView(i.buffer),this};t.DataBuffer.prototype.putByte=function(n){return this.accommodate(1),this.data.setUint8(this.write++,n),this};t.DataBuffer.prototype.fillWithByte=function(n,t){this.accommodate(t);for(var i=0;i<t;++i)this.data.setUint8(n);return this};t.DataBuffer.prototype.putBytes=function(n,i){var e,r,f,u;if(t.isArrayBufferView(n))return r=new Uint8Array(n.buffer,n.byteOffset,n.byteLength),e=r.byteLength-r.byteOffset,this.accommodate(e),f=new Uint8Array(this.data.buffer,this.write),f.set(r),this.write+=e,this;if(t.isArrayBuffer(n))return r=new Uint8Array(n),this.accommodate(r.byteLength),f=new Uint8Array(this.data.buffer),f.set(r,this.write),this.write+=r.byteLength,this;if(n instanceof t.DataBuffer||typeof n=="object"&&typeof n.read=="number"&&typeof n.write=="number"&&t.isArrayBufferView(n.data))return r=new Uint8Array(n.data.byteLength,n.read,n.length()),this.accommodate(r.byteLength),f=new Uint8Array(n.data.byteLength,this.write),f.set(r),this.write+=r.byteLength,this;if(n instanceof t.ByteStringBuffer&&(n=n.data,i="binary"),i=i||"binary",typeof n=="string"){if(i==="hex")return this.accommodate(Math.ceil(n.length/2)),u=new Uint8Array(this.data.buffer,this.write),this.write+=t.binary.hex.decode(n,u,this.write),this;if(i==="base64")return this.accommodate(Math.ceil(n.length/4)*3),u=new Uint8Array(this.data.buffer,this.write),this.write+=t.binary.base64.decode(n,u,this.write),this;if(i==="utf8"&&(n=t.encodeUtf8(n),i="binary"),i==="binary"||i==="raw")return this.accommodate(n.length),u=new Uint8Array(this.data.buffer,this.write),this.write+=t.binary.raw.decode(u),this;if(i==="utf16")return this.accommodate(n.length*2),u=new Uint16Array(this.data.buffer,this.write),this.write+=t.text.utf16.encode(u),this;throw new Error("Invalid encoding: "+i);}throw Error("Invalid parameter: "+n);};t.DataBuffer.prototype.putBuffer=function(n){return this.putBytes(n),n.clear(),this};t.DataBuffer.prototype.putString=function(n){return this.putBytes(n,"utf16")};t.DataBuffer.prototype.putInt16=function(n){return this.accommodate(2),this.data.setInt16(this.write,n),this.write+=2,this};t.DataBuffer.prototype.putInt24=function(n){return this.accommodate(3),this.data.setInt16(this.write,n>>8&65535),this.data.setInt8(this.write,n>>16&255),this.write+=3,this};t.DataBuffer.prototype.putInt32=function(n){return this.accommodate(4),this.data.setInt32(this.write,n),this.write+=4,this};t.DataBuffer.prototype.putInt16Le=function(n){return this.accommodate(2),this.data.setInt16(this.write,n,!0),this.write+=2,this};t.DataBuffer.prototype.putInt24Le=function(n){return this.accommodate(3),this.data.setInt8(this.write,n>>16&255),this.data.setInt16(this.write,n>>8&65535,!0),this.write+=3,this};t.DataBuffer.prototype.putInt32Le=function(n){return this.accommodate(4),this.data.setInt32(this.write,n,!0),this.write+=4,this};t.DataBuffer.prototype.putInt=function(n,t){this.accommodate(t/8);do t-=8,this.data.setInt8(this.write++,n>>t&255);while(t>0);return this};t.DataBuffer.prototype.putSignedInt=function(n,t){return this.accommodate(t/8),n<0&&(n+=2<<t-1),this.putInt(n,t)};t.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};t.DataBuffer.prototype.getInt16=function(){var n=this.data.getInt16(this.read);return this.read+=2,n};t.DataBuffer.prototype.getInt24=function(){var n=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,n};t.DataBuffer.prototype.getInt32=function(){var n=this.data.getInt32(this.read);return this.read+=4,n};t.DataBuffer.prototype.getInt16Le=function(){var n=this.data.getInt16(this.read,!0);return this.read+=2,n};t.DataBuffer.prototype.getInt24Le=function(){var n=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,n};t.DataBuffer.prototype.getInt32Le=function(){var n=this.data.getInt32(this.read,!0);return this.read+=4,n};t.DataBuffer.prototype.getInt=function(n){var t=0;do t=(t<<8)+this.data.getInt8(this.read++),n-=8;while(n>0);return t};t.DataBuffer.prototype.getSignedInt=function(n){var t=this.getInt(n),i=2<<n-2;return t>=i&&(t-=i<<1),t};t.DataBuffer.prototype.getBytes=function(n){var t;return n?(n=Math.min(this.length(),n),t=this.data.slice(this.read,this.read+n),this.read+=n):n===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};t.DataBuffer.prototype.bytes=function(n){return typeof n=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+n)};t.DataBuffer.prototype.at=function(n){return this.data.getUint8(this.read+n)};t.DataBuffer.prototype.setAt=function(n,t){return this.data.setUint8(n,t),this};t.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};t.DataBuffer.prototype.copy=function(){return new t.DataBuffer(this)};t.DataBuffer.prototype.compact=function(){if(this.read>0){var n=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(n.byteLength);t.set(n);this.data=new DataView(t);this.write-=this.read;this.read=0}return this};t.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};t.DataBuffer.prototype.truncate=function(n){return this.write=Math.max(0,this.length()-n),this.read=Math.min(this.read,this.write),this};t.DataBuffer.prototype.toHex=function(){for(var i,n="",t=this.read;t<this.data.byteLength;++t)i=this.data.getUint8(t),i<16&&(n+="0"),n+=i.toString(16);return n};t.DataBuffer.prototype.toString=function(n){var i=new Uint8Array(this.data,this.read,this.length());if(n=n||"utf8",n==="binary"||n==="raw")return t.binary.raw.encode(i);if(n==="hex")return t.binary.hex.encode(i);if(n==="base64")return t.binary.base64.encode(i);if(n==="utf8")return t.text.utf8.decode(i);if(n==="utf16")return t.text.utf16.decode(i);throw new Error("Invalid encoding: "+n);};t.createBuffer=function(n,i){return i=i||"raw",n!==undefined&&i==="utf8"&&(n=t.encodeUtf8(n)),new t.ByteBuffer(n)};t.fillString=function(n,t){for(var i="";t>0;)t&1&&(i+=n),t>>>=1,t>0&&(n+=n);return i};t.xorBytes=function(n,t,i){for(var u="",o="",r="",f=0,e=0;i>0;--i,++f)o=n.charCodeAt(f)^t.charCodeAt(f),e>=10&&(u+=r,r="",e=0),r+=String.fromCharCode(o),++e;return u+=r,u};t.hexToBytes=function(n){var i="",t=0;for(n.length&!0&&(t=1,i+=String.fromCharCode(parseInt(n[0],16)));t<n.length;t+=2)i+=String.fromCharCode(parseInt(n.substr(t,2),16));return i};t.bytesToHex=function(n){return t.createBuffer(n).toHex()};t.int32ToBytes=function(n){return String.fromCharCode(n>>24&255)+String.fromCharCode(n>>16&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n&255)};r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";u=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];t.encode64=function(n,t){for(var i="",o="",s,u,f,e=0;e<n.length;)s=n.charCodeAt(e++),u=n.charCodeAt(e++),f=n.charCodeAt(e++),i+=r.charAt(s>>2),i+=r.charAt((s&3)<<4|u>>4),isNaN(u)?i+="==":(i+=r.charAt((u&15)<<2|f>>6),i+=isNaN(f)?"=":r.charAt(f&63)),t&&i.length>t&&(o+=i.substr(0,t)+"\r\n",i=i.substr(t));return o+=i,o};t.decode64=function(n){n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var i="",o,f,r,e,t=0;t<n.length;)o=u[n.charCodeAt(t++)-43],f=u[n.charCodeAt(t++)-43],r=u[n.charCodeAt(t++)-43],e=u[n.charCodeAt(t++)-43],i+=String.fromCharCode(o<<2|f>>4),r!==64&&(i+=String.fromCharCode((f&15)<<4|r>>2),e!==64&&(i+=String.fromCharCode((r&3)<<6|e)));return i};t.encodeUtf8=function(n){return unescape(encodeURIComponent(n))};t.decodeUtf8=function(n){return decodeURIComponent(escape(n))};t.binary={raw:{},hex:{},base64:{}};t.binary.raw.encode=function(n){return String.fromCharCode.apply(null,n)};t.binary.raw.decode=function(n,t,i){var r=t,f,u;for(r||(r=new Uint8Array(n.length)),i=i||0,f=i,u=0;u<n.length;++u)r[f++]=n.charCodeAt(u);return t?f-i:r};t.binary.hex.encode=t.bytesToHex;t.binary.hex.decode=function(n,t,i){var r=t,u,f;for(r||(r=new Uint8Array(Math.ceil(n.length/2))),i=i||0,u=0,f=i,n.length&1&&(u=1,r[f++]=parseInt(n[0],16));u<n.length;u+=2)r[f++]=parseInt(n.substr(u,2),16);return t?f-i:r};t.binary.base64.encode=function(n,t){for(var i="",o="",s,u,f,e=0;e<n.byteLength;)s=n[e++],u=n[e++],f=n[e++],i+=r.charAt(s>>2),i+=r.charAt((s&3)<<4|u>>4),isNaN(u)?i+="==":(i+=r.charAt((u&15)<<2|f>>6),i+=isNaN(f)?"=":r.charAt(f&63)),t&&i.length>t&&(o+=i.substr(0,t)+"\r\n",i=i.substr(t));return o+=i,o};t.binary.base64.decode=function(n,t,i){var r=t,c,s,o,h,f,e;for(r||(r=new Uint8Array(Math.ceil(n.length/4)*3)),n=n.replace(/[^A-Za-z0-9\+\/\=]/g,""),i=i||0,f=0,e=i;f<n.length;)c=u[n.charCodeAt(f++)-43],s=u[n.charCodeAt(f++)-43],o=u[n.charCodeAt(f++)-43],h=u[n.charCodeAt(f++)-43],r[e++]=c<<2|s>>4,o!==64&&(r[e++]=(s&15)<<4|o>>2,h!==64&&(r[e++]=(o&3)<<6|h));return t?e-i:r};t.text={utf8:{},utf16:{}};t.text.utf8.encode=function(n,i,r){var u,e,f;for(n=t.encodeUtf8(n),u=i,u||(u=new Uint8Array(n.length)),r=r||0,e=r,f=0;f<n.length;++f)u[e++]=n.charCodeAt(f);return i?e-r:u};t.text.utf8.decode=function(n){return t.decodeUtf8(String.fromCharCode.apply(null,n))};t.text.utf16.encode=function(n,t,i){var r=t,e,f,o,u;for(r||(r=new Uint8Array(n.length)),e=new Uint16Array(r),i=i||0,f=i,o=i,u=0;u<n.length;++u)e[o++]=n.charCodeAt(u),f+=2;return t?f-i:r};t.text.utf16.decode=function(n){return String.fromCharCode.apply(null,new Uint16Array(n))};t.deflate=function(n,i,r){if(i=t.decode64(n.deflate(t.encode64(i)).rval),r){var u=2,f=i.charCodeAt(1);f&32&&(u=6);i=i.substring(u,i.length-4)}return i};t.inflate=function(n,i){var r=n.inflate(t.encode64(i)).rval;return r===null?null:t.decode64(r)};var s=function(n,i,r){var u,f;if(!n)throw new Error("WebStorage not available.");if(r===null?u=n.removeItem(i):(r=t.encode64(JSON.stringify(r)),u=n.setItem(i,r)),typeof u!="undefined"&&u.rval!==!0){f=new Error(u.error.message);throw f.id=u.error.id,f.name=u.error.name,f;}},h=function(n,i){var r,u;if(!n)throw new Error("WebStorage not available.");if(r=n.getItem(i),n.init)if(r.rval===null){if(r.error){u=new Error(r.error.message);throw u.id=r.error.id,u.name=r.error.name,u;}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(t.decode64(r))),r},a=function(n,t,i,r){var u=h(n,t);u===null&&(u={});u[i]=r;s(n,t,u)},v=function(n,t,i){var r=h(n,t);return r!==null&&(r=i in r?r[i]:null),r},y=function(n,t,i){var r=h(n,t),u,f;if(r!==null&&i in r){delete r[i];u=!0;for(f in r){u=!1;break}u&&(r=null);s(n,t,r)}},p=function(n,t){s(n,t,null)},e=function(n,t,i){var f=null,r,u,e,o;typeof i=="undefined"&&(i=["web","flash"]);u=!1;e=null;for(o in i){r=i[o];try{if(r==="flash"||r==="both"){if(t[0]===null)throw new Error("Flash local storage not available.");f=n.apply(this,t);u=r==="flash"}(r==="web"||r==="both")&&(t[0]=localStorage,f=n.apply(this,t),u=!0)}catch(s){e=s}if(u)break}if(!u)throw e;return f};t.setItem=function(n,t,i,r,u){e(a,arguments,u)};t.getItem=function(n,t,i,r){return e(v,arguments,r)};t.removeItem=function(n,t,i,r){e(y,arguments,r)};t.clearItems=function(n,t,i){e(p,arguments,i)};t.parseUrl=function(n){var r=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g,i,t;return r.lastIndex=0,i=r.exec(n),t=i===null?null:{full:n,scheme:i[1],host:i[2],port:i[3],path:i[4]},t&&(t.fullHost=t.host,t.port?t.port!==80&&t.scheme==="http"?t.fullHost+=":"+t.port:t.port!==443&&t.scheme==="https"&&(t.fullHost+=":"+t.port):t.scheme==="http"?t.port=80:t.scheme==="https"&&(t.port=443),t.full=t.scheme+"://"+t.fullHost),t};f=null;t.getQueryVariables=function(n){var i=function(n){for(var f,i,e,u={},r=n.split("&"),t=0;t<r.length;t++)f=r[t].indexOf("="),f>0?(i=r[t].substring(0,f),e=r[t].substring(f+1)):(i=r[t],e=null),i in u||(u[i]=[]),!(i in Object.prototype)&&e!==null&&u[i].push(unescape(e));return u},t;return typeof n=="undefined"?(f===null&&(f=typeof window=="undefined"?{}:i(window.location.search.substring(1))),t=f):t=i(n),t};t.parseFragment=function(n){var u=n,r="",f=n.indexOf("?"),i,e;return f>0&&(u=n.substring(0,f),r=n.substring(f+1)),i=u.split("/"),i.length>0&&i[0]===""&&i.shift(),e=r===""?{}:t.getQueryVariables(r),{pathString:u,queryString:r,path:i,query:e}};t.makeRequest=function(n){var i=t.parseFragment(n),r={path:i.pathString,query:i.queryString,getPath:function(n){return typeof n=="undefined"?i.path:i.path[n]},getQuery:function(n,t){var r;return typeof n=="undefined"?r=i.query:(r=i.query[n],r&&typeof t!="undefined"&&(r=r[t])),r},getQueryLast:function(n,t){var u,i=r.getQuery(n);return u=i?i[i.length-1]:t,u}};return r};t.makeLink=function(n,t,i){n=jQuery.isArray(n)?n.join("/"):n;var r=jQuery.param(t||{});return i=i||"",n+(r.length>0?"?"+r:"")+(i.length>0?"#"+i:"")};t.setPath=function(n,t,i){var u,e,r,f;if(typeof n=="object"&&n!==null)for(u=0,e=t.length;u<e;)r=t[u++],u==e?n[r]=i:(f=r in n,(!f||f&&typeof n[r]!="object"||f&&n[r]===null)&&(n[r]={}),n=n[r])};t.getPath=function(n,t,i){for(var f=0,e=t.length,r=!0,u;r&&f<e&&typeof n=="object"&&n!==null;)u=t[f++],r=u in n,r&&(n=n[u]);return r?n:i};t.deletePath=function(n,t){var r,u,i;if(typeof n=="object"&&n!==null)for(r=0,u=t.length;r<u;)if(i=t[r++],r==u)delete n[i];else{if(!(i in n&&typeof n[i]=="object"&&n[i]!==null))break;n=n[i]}};t.isEmpty=function(n){for(var t in n)if(n.hasOwnProperty(t))return!1;return!0};t.format=function(n){for(var i=/%./g,e,r,o=0,t=[],u=0,f;e=i.exec(n);){r=n.substring(u,i.lastIndex-2);r.length>0&&t.push(r);u=i.lastIndex;f=e[0][1];switch(f){case"s":case"o":o<arguments.length?t.push(arguments[o+++1]):t.push("<?>");break;case"%":t.push("%");break;default:t.push("<%"+f+"?>")}}return t.push(n.substring(u)),t.join("")};t.formatNumber=function(n,t,i,r){var f=n,e=isNaN(t=Math.abs(t))?2:t,h=i===undefined?",":i,s=r===undefined?".":r,c=f<0?"-":"",u=parseInt(f=Math.abs(+f||0).toFixed(e),10)+"",o=u.length>3?u.length%3:0;return c+(o?u.substr(0,o)+s:"")+u.substr(o).replace(/(\d{3})(?=\d)/g,"$1"+s)+(e?h+Math.abs(f-u).toFixed(e).slice(2):"")};t.formatSize=function(n){return n=n>=1073741824?t.formatNumber(n/1073741824,2,".","")+" GiB":n>=1048576?t.formatNumber(n/1048576,2,".","")+" MiB":n>=1024?t.formatNumber(n/1024,0)+" KiB":t.formatNumber(n,0)+" bytes",n};t.bytesFromIP=function(n){return n.indexOf(".")!==-1?t.bytesFromIPv4(n):n.indexOf(":")!==-1?t.bytesFromIPv6(n):null};t.bytesFromIPv4=function(n){var r,i,u;if(n=n.split("."),n.length!==4)return null;for(r=t.createBuffer(),i=0;i<n.length;++i){if(u=parseInt(n[i],10),isNaN(u))return null;r.putByte(u)}return r.getBytes()};t.bytesFromIPv6=function(n){var e=0,u,r,i,f;for(n=n.split(":").filter(function(n){return n.length===0&&++e,!0}),u=(8-n.length+e)*2,r=t.createBuffer(),i=0;i<8;++i){if(!n[i]||n[i].length===0){r.fillWithByte(0,u);u=0;continue}f=t.hexToBytes(n[i]);f.length<2&&r.putByte(0);r.putBytes(f)}return r.getBytes()};t.bytesToIP=function(n){return n.length===4?t.bytesToIPv4(n):n.length===16?t.bytesToIPv6(n):null};t.bytesToIPv4=function(n){var i,t;if(n.length!==4)return null;for(i=[],t=0;t<n.length;++t)i.push(n.charCodeAt(t));return i.join(".")};t.bytesToIPv6=function(n){var o,u,e,s,r;if(n.length!==16)return null;var f=[],i=[],h=0;for(o=0;o<n.length;o+=2){for(u=t.bytesToHex(n[o]+n[o+1]);u[0]==="0"&&u!=="0";)u=u.substr(1);u==="0"&&(e=i[i.length-1],s=f.length,!e||s!==e.end+1?i.push({start:s,end:s}):(e.end=s,e.end-e.start>i[h].end-i[h].start&&(h=i.length-1)));f.push(u)}return i.length>0&&(r=i[h],r.end-r.start>0&&(f.splice(r.start,r.end-r.start+1,""),r.start===0&&f.unshift(""),r.end===7&&f.push(""))),f.join(":")};t.estimateCores=function(n,i){function r(n,o,s){if(o===0){var h=Math.floor(n.reduce(function(n,t){return n+t},0)/n.length);return t.cores=Math.max(1,h),URL.revokeObjectURL(u),i(null,t.cores)}f(s,function(t,i){n.push(e(s,i));r(n,o-1,s)})}function f(n,t){for(var e,r=[],f=[],i=0;i<n;++i)e=new Worker(u),e.addEventListener("message",function(i){if(f.push(i.data),f.length===n){for(var u=0;u<n;++u)r[u].terminate();t(null,f)}}),r.push(e);for(i=0;i<n;++i)r[i].postMessage(i)}function e(n,t){for(var u,o,i,f,e=[],r=0;r<n;++r)for(u=t[r],o=e[r]=[],i=0;i<n;++i)r!==i&&(f=t[i],(u.st>f.st&&u.st<f.et||f.st>u.st&&f.st<u.et)&&o.push(i));return e.reduce(function(n,t){return Math.max(n,t.length)},0)}if(typeof n=="function"&&(i=n,n={}),n=n||{},"cores"in t&&!n.update)return i(null,t.cores);if(typeof navigator!="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return t.cores=navigator.hardwareConcurrency,i(null,t.cores);if(typeof Worker=="undefined")return t.cores=1,i(null,t.cores);if(typeof Blob=="undefined")return t.cores=2,i(null,t.cores);var u=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(){for(var n=Date.now(),t=n+4;Date.now()<t;);self.postMessage({st:n,et:t})})}.toString(),")()"],{type:"application/javascript"}));r([],5,16)}}var i="util",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/util",["require","module"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){n.cipher=n.cipher||{};n.cipher.algorithms=n.cipher.algorithms||{};n.cipher.createCipher=function(t,i){var r=t;if(typeof r=="string"&&(r=n.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new n.cipher.BlockCipher({algorithm:r,key:i,decrypt:!1})};n.cipher.createDecipher=function(t,i){var r=t;if(typeof r=="string"&&(r=n.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new n.cipher.BlockCipher({algorithm:r,key:i,decrypt:!0})};n.cipher.registerAlgorithm=function(t,i){t=t.toUpperCase();n.cipher.algorithms[t]=i};n.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in n.cipher.algorithms?n.cipher.algorithms[t]:null};var t=n.cipher.BlockCipher=function(n){this.algorithm=n.algorithm;this.mode=this.algorithm.mode;this.blockSize=this.mode.blockSize;this._finish=!1;this._input=null;this.output=null;this._op=n.decrypt?this.mode.decrypt:this.mode.encrypt;this._decrypt=n.decrypt;this.algorithm.initialize(n)};t.prototype.start=function(t){var i,r;t=t||{};i={};for(r in t)i[r]=t[r];i.decrypt=this._decrypt;this._finish=!1;this._input=n.util.createBuffer();this.output=t.output||n.util.createBuffer();this.mode.start(i)};t.prototype.update=function(n){for(this._finish||this._input.putBuffer(n);this._input.length()>=this.blockSize||this._input.length()>0&&this._finish;)this._op.call(this.mode,this._input,this.output);this._input.compact()};t.prototype.finish=function(n){n&&this.mode.name==="CBC"&&(this.mode.pad=function(t){return n(this.blockSize,t,!1)},this.mode.unpad=function(t){return n(this.blockSize,t,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)?!1:(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t)?!1:this.mode.afterFinish&&!this.mode.afterFinish(this.output,t)?!1:!0)}}var i="cipher",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/cipher",["require","module","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){function i(t){var r,i;if(typeof t=="string"&&(t=n.util.createBuffer(t)),n.util.isArray(t)&&t.length>4)for(r=t,t=n.util.createBuffer(),i=0;i<t.length;++i)t.putByte(r[i]);return n.util.isArray(t)||(t=[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()]),t}function r(n){n[n.length-1]=n[n.length-1]+1&4294967295}function u(n){return[n/4294967296|0,n&4294967295]}n.cipher=n.cipher||{};var t=n.cipher.modes=n.cipher.modes||{};t.ecb=function(n){n=n||{};this.name="ECB";this.cipher=n.cipher;this.blockSize=n.blockSize||16;this._blocks=this.blockSize/4;this._inBlock=new Array(this._blocks);this._outBlock=new Array(this._blocks)};t.ecb.prototype.start=function(){};t.ecb.prototype.encrypt=function(n,t){for(var i=0;i<this._blocks;++i)this._inBlock[i]=n.getInt32();for(this.cipher.encrypt(this._inBlock,this._outBlock),i=0;i<this._blocks;++i)t.putInt32(this._outBlock[i])};t.ecb.prototype.decrypt=function(n,t){for(var i=0;i<this._blocks;++i)this._inBlock[i]=n.getInt32();for(this.cipher.decrypt(this._inBlock,this._outBlock),i=0;i<this._blocks;++i)t.putInt32(this._outBlock[i])};t.ecb.prototype.pad=function(n){var t=n.length()===this.blockSize?this.blockSize:this.blockSize-n.length();return n.fillWithByte(t,t),!0};t.ecb.prototype.unpad=function(n,t){if(t.overflow>0)return!1;var r=n.length(),i=n.at(r-1);return i>this.blockSize<<2?!1:(n.truncate(i),!0)};t.cbc=function(n){n=n||{};this.name="CBC";this.cipher=n.cipher;this.blockSize=n.blockSize||16;this._blocks=this.blockSize/4;this._inBlock=new Array(this._blocks);this._outBlock=new Array(this._blocks)};t.cbc.prototype.start=function(n){if(n.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in n))throw new Error("Invalid IV parameter.");this._iv=i(n.iv);this._prev=this._iv.slice(0)}};t.cbc.prototype.encrypt=function(n,t){for(var i=0;i<this._blocks;++i)this._inBlock[i]=this._prev[i]^n.getInt32();for(this.cipher.encrypt(this._inBlock,this._outBlock),i=0;i<this._blocks;++i)t.putInt32(this._outBlock[i]);this._prev=this._outBlock};t.cbc.prototype.decrypt=function(n,t){for(var i=0;i<this._blocks;++i)this._inBlock[i]=n.getInt32();for(this.cipher.decrypt(this._inBlock,this._outBlock),i=0;i<this._blocks;++i)t.putInt32(this._prev[i]^this._outBlock[i]);this._prev=this._inBlock.slice(0)};t.cbc.prototype.pad=function(n){var t=n.length()===this.blockSize?this.blockSize:this.blockSize-n.length();return n.fillWithByte(t,t),!0};t.cbc.prototype.unpad=function(n,t){if(t.overflow>0)return!1;var r=n.length(),i=n.at(r-1);return i>this.blockSize<<2?!1:(n.truncate(i),!0)};t.cfb=function(n){n=n||{};this.name="CFB";this.cipher=n.cipher;this.blockSize=n.blockSize||16;this._blocks=this.blockSize/4;this._inBlock=null;this._outBlock=new Array(this._blocks)};t.cfb.prototype.start=function(n){if(!("iv"in n))throw new Error("Invalid IV parameter.");this._iv=i(n.iv);this._inBlock=this._iv.slice(0)};t.cfb.prototype.encrypt=function(n,t){this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._blocks;++i)this._inBlock[i]=n.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i])};t.cfb.prototype.decrypt=function(n,t){this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._blocks;++i)this._inBlock[i]=n.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i])};t.cfb.prototype.afterFinish=function(n,t){return t.overflow>0&&n.truncate(this.blockSize-t.overflow),!0};t.ofb=function(n){n=n||{};this.name="OFB";this.cipher=n.cipher;this.blockSize=n.blockSize||16;this._blocks=this.blockSize/4;this._inBlock=null;this._outBlock=new Array(this._blocks)};t.ofb.prototype.start=function(n){if(!("iv"in n))throw new Error("Invalid IV parameter.");this._iv=i(n.iv);this._inBlock=this._iv.slice(0)};t.ofb.prototype.encrypt=function(n,t){this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._blocks;++i)t.putInt32(n.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i]};t.ofb.prototype.decrypt=t.ofb.prototype.encrypt;t.ofb.prototype.afterFinish=function(n,t){return t.overflow>0&&n.truncate(this.blockSize-t.overflow),!0};t.ctr=function(n){n=n||{};this.name="CTR";this.cipher=n.cipher;this.blockSize=n.blockSize||16;this._blocks=this.blockSize/4;this._inBlock=null;this._outBlock=new Array(this._blocks)};t.ctr.prototype.start=function(n){if(!("iv"in n))throw new Error("Invalid IV parameter.");this._iv=i(n.iv);this._inBlock=this._iv.slice(0)};t.ctr.prototype.encrypt=function(n,t){this.cipher.encrypt(this._inBlock,this._outBlock);r(this._inBlock);for(var i=0;i<this._blocks;++i)t.putInt32(n.getInt32()^this._outBlock[i])};t.ctr.prototype.decrypt=t.ctr.prototype.encrypt;t.ctr.prototype.afterFinish=function(n,t){return t.overflow>0&&n.truncate(this.blockSize-t.overflow),!0};t.gcm=function(n){n=n||{};this.name="GCM";this.cipher=n.cipher;this.blockSize=n.blockSize||16;this._blocks=this.blockSize/4;this._inBlock=new Array(this._blocks);this._outBlock=new Array(this._blocks);this._R=3774873600};t.gcm.prototype.start=function(t){var f,i,e,o;if(!("iv"in t))throw new Error("Invalid IV parameter.");if(f=n.util.createBuffer(t.iv),this._cipherLength=0,i="additionalData"in t?n.util.createBuffer(t.additionalData):n.util.createBuffer(),this._tagLength="tagLength"in t?t.tagLength:128,this._tag=null,t.decrypt&&(this._tag=n.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");if(this._hashBlock=new Array(this._blocks),this.tag=null,this._hashSubkey=new Array(this._blocks),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits),e=f.length(),e===12)this._j0=[f.getInt32(),f.getInt32(),f.getInt32(),1];else{for(this._j0=[0,0,0,0];f.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[f.getInt32(),f.getInt32(),f.getInt32(),f.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(u(e*8)))}for(this._inBlock=this._j0.slice(0),r(this._inBlock),i=n.util.createBuffer(i),this._aDataLength=u(i.length()*8),o=i.length()%this.blockSize,o&&i.fillWithByte(0,this.blockSize-o),this._s=[0,0,0,0];i.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[i.getInt32(),i.getInt32(),i.getInt32(),i.getInt32()])};t.gcm.prototype.encrypt=function(t,i){var e,o,u,f;for(this.cipher.encrypt(this._inBlock,this._outBlock),r(this._inBlock),e=t.length(),f=0;f<this._blocks;++f)this._outBlock[f]^=t.getInt32();for(e<this.blockSize?(o=e%this.blockSize,this._cipherLength+=o,u=n.util.createBuffer(),u.putInt32(this._outBlock[0]),u.putInt32(this._outBlock[1]),u.putInt32(this._outBlock[2]),u.putInt32(this._outBlock[3]),u.truncate(this.blockSize-o),this._outBlock[0]=u.getInt32(),this._outBlock[1]=u.getInt32(),this._outBlock[2]=u.getInt32(),this._outBlock[3]=u.getInt32()):this._cipherLength+=this.blockSize,f=0;f<this._blocks;++f)i.putInt32(this._outBlock[f]);this._s=this.ghash(this._hashSubkey,this._s,this._outBlock)};t.gcm.prototype.decrypt=function(n,t){var u,i;for(this.cipher.encrypt(this._inBlock,this._outBlock),r(this._inBlock),u=n.length(),this._hashBlock[0]=n.getInt32(),this._hashBlock[1]=n.getInt32(),this._hashBlock[2]=n.getInt32(),this._hashBlock[3]=n.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock),i=0;i<this._blocks;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);this._cipherLength+=u<this.blockSize?u%this.blockSize:this.blockSize};t.gcm.prototype.afterFinish=function(t,i){var e=!0,o,f,r;for(i.overflow&&t.truncate(this.blockSize-i.overflow),this.tag=n.util.createBuffer(),o=this._aDataLength.concat(u(this._cipherLength*8)),this._s=this.ghash(this._hashSubkey,this._s,o),f=[],this.cipher.encrypt(this._j0,f),r=0;r<this._blocks;++r)this.tag.putInt32(this._s[r]^f[r]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),i.decrypt&&this.tag.bytes()!==this._tag&&(e=!1),e};t.gcm.prototype.multiply=function(n,t){for(var f,r=[0,0,0,0],i=t.slice(0),u=0;u<128;++u)f=n[u/32|0]&1<<31-u%32,f&&(r[0]^=i[0],r[1]^=i[1],r[2]^=i[2],r[3]^=i[3]),this.pow(i,i);return r};t.gcm.prototype.pow=function(n,t){for(var r=n[3]&1,i=3;i>0;--i)t[i]=n[i]>>>1|(n[i-1]&1)<<31;t[0]=n[0]>>>1;r&&(t[0]^=this._R)};t.gcm.prototype.tableMultiply=function(n){for(var t=[0,0,0,0],i=0;i<32;++i){var u=i/8|0,f=n[u]>>>(7-i%8)*4&15,r=this._m[i][f];t[0]^=r[0];t[1]^=r[1];t[2]^=r[2];t[3]^=r[3]}return t};t.gcm.prototype.ghash=function(n,t,i){return t[0]^=i[0],t[1]^=i[1],t[2]^=i[2],t[3]^=i[3],this.tableMultiply(t)};t.gcm.prototype.generateHashTable=function(n,t){for(var u=8/t,r=4*u,f=16*u,e=new Array(f),i=0;i<f;++i){var o=[0,0,0,0],s=i/r|0,h=(r-1-i%r)*t;o[s]=1<<t-1<<h;e[i]=this.generateSubHashTable(this.multiply(o,n),t)}return e};t.gcm.prototype.generateSubHashTable=function(n,t){var h=1<<t,u=h>>>1,r=new Array(h),i,f,e,o,s;for(r[u]=n.slice(0),i=u>>>1;i>0;)this.pow(r[2*i],r[i]=[]),i>>=1;for(i=2;i<u;){for(f=1;f<i;++f)e=r[i],o=r[f],r[i+f]=[e[0]^o[0],e[1]^o[1],e[2]^o[2],e[3]^o[3]];i*=2}for(r[0]=[0,0,0,0],i=u+1;i<h;++i)s=r[i^u],r[i]=[n[0]^s[0],n[1]^s[1],n[2]^s[2],n[3]^s[3]];return r}}var i="cipherModes",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/cipherModes",["require","module","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){function f(t,i){var r=function(){return new n.aes.Algorithm(t,i)};n.cipher.registerAlgorithm(t,r)}function c(){var u,f,o,c,w,l,e,b,v,y,n,p;for(s=!0,a=[0,1,2,4,8,16,32,64,128,27,54],u=new Array(256),n=0;n<128;++n)u[n]=n<<1,u[n+128]=n+128<<1^283;for(t=new Array(256),h=new Array(256),r=new Array(4),i=new Array(4),n=0;n<4;++n)r[n]=new Array(256),i[n]=new Array(256);for(f=0,o=0,n=0;n<256;++n){for(e=o^o<<1^o<<2^o<<3^o<<4,e=e>>8^e&255^99,t[f]=e,h[e]=f,b=u[e],c=u[f],w=u[c],l=u[w],v=b<<24^e<<16^e<<8^e^b,y=(c^w^l)<<24^(f^l)<<16^(f^w^l)<<8^f^c^l,p=0;p<4;++p)r[p][f]=v,i[p][e]=y,v=v<<24|v>>>8,y=y<<24|y>>>8;f===0?f=o=1:(f=c^u[u[u[c^l]]],o^=u[u[o]])}}function l(n,r){for(var s,y,e=n.slice(0),o,p=1,h=e.length,w=h+6+1,l=u*w,f=h;f<l;++f)o=e[f-1],f%h==0?(o=t[o>>>16&255]<<24^t[o>>>8&255]<<16^t[o&255]<<8^t[o>>>24]^a[p]<<24,p++):h>6&&f%h==4&&(o=t[o>>>24]<<24^t[o>>>16&255]<<16^t[o>>>8&255]<<8^t[o&255]),e[f]=e[f-h]^o;if(r){var v,b=i[0],k=i[1],d=i[2],g=i[3],c=e.slice(0);for(l=e.length,f=0,s=l-u;f<l;f+=u,s-=u)if(f===0||f===l-u)c[f]=e[s],c[f+1]=e[s+3],c[f+2]=e[s+2],c[f+3]=e[s+1];else for(y=0;y<u;++y)v=e[s+y],c[f+(3&-y)]=b[t[v>>>24]]^k[t[v>>>16&255]]^d[t[v>>>8&255]]^g[t[v&255]];e=c}return e}function o(n,u,f,e){var tt=n.length/4-1,y,p,w,b,o,s,c,l,a,d,g,nt,v,k;for(e?(y=i[0],p=i[1],w=i[2],b=i[3],o=h):(y=r[0],p=r[1],w=r[2],b=r[3],o=t),s=u[0]^n[0],c=u[e?3:1]^n[1],l=u[2]^n[2],a=u[e?1:3]^n[3],v=3,k=1;k<tt;++k)d=y[s>>>24]^p[c>>>16&255]^w[l>>>8&255]^b[a&255]^n[++v],g=y[c>>>24]^p[l>>>16&255]^w[a>>>8&255]^b[s&255]^n[++v],nt=y[l>>>24]^p[a>>>16&255]^w[s>>>8&255]^b[c&255]^n[++v],a=y[a>>>24]^p[s>>>16&255]^w[c>>>8&255]^b[l&255]^n[++v],s=d,c=g,l=nt;f[0]=o[s>>>24]<<24^o[c>>>16&255]<<16^o[l>>>8&255]<<8^o[a&255]^n[++v];f[e?3:1]=o[c>>>24]<<24^o[l>>>16&255]<<16^o[a>>>8&255]<<8^o[s&255]^n[++v];f[2]=o[l>>>24]<<24^o[a>>>16&255]<<16^o[s>>>8&255]<<8^o[c&255]^n[++v];f[e?1:3]=o[a>>>24]<<24^o[s>>>16&255]<<16^o[c>>>8&255]<<8^o[l&255]^n[++v]}function e(t){var u,r,i,f;return t=t||{},u=(t.mode||"CBC").toUpperCase(),r="AES-"+u,i=t.decrypt?n.cipher.createDecipher(r,t.key):n.cipher.createCipher(r,t.key),f=i.start,i.start=function(t,r){var u=null;r instanceof n.util.ByteBuffer&&(u=r,r={});r=r||{};r.output=u;r.iv=t;f.call(i,r)},i}n.aes=n.aes||{};n.aes.startEncrypting=function(n,t,i,r){var u=e({key:n,output:i,decrypt:!1,mode:r});return u.start(t),u};n.aes.createEncryptionCipher=function(n,t){return e({key:n,output:null,decrypt:!1,mode:t})};n.aes.startDecrypting=function(n,t,i,r){var u=e({key:n,output:i,decrypt:!0,mode:r});return u.start(t),u};n.aes.createDecryptionCipher=function(n,t){return e({key:n,output:null,decrypt:!0,mode:t})};n.aes.Algorithm=function(n,t){s||c();var i=this;i.name=n;i.mode=new t({blockSize:16,cipher:{encrypt:function(n,t){return o(i._w,n,t,!1)},decrypt:function(n,t){return o(i._w,n,t,!0)}}});i._init=!1};n.aes.Algorithm.prototype.initialize=function(t){var i,u,f,r,e,o;if(!this._init){if(i=t.key,typeof i!="string"||i.length!==16&&i.length!==24&&i.length!==32){if(n.util.isArray(i)&&(i.length===16||i.length===24||i.length===32))for(u=i,i=n.util.createBuffer(),r=0;r<u.length;++r)i.putByte(u[r])}else i=n.util.createBuffer(i);if(!n.util.isArray(i)&&(u=i,i=[],f=u.length(),f===16||f===24||f===32))for(f>>>=2,r=0;r<f;++r)i.push(u.getInt32());if(!n.util.isArray(i)||i.length!==4&&i.length!==6&&i.length!==8)throw new Error("Invalid key parameter.");e=this.mode.name;o=["CFB","OFB","CTR","GCM"].indexOf(e)!==-1;this._w=l(i,t.decrypt&&!o);this._init=!0}};n.aes._expandKey=function(n,t){return s||c(),l(n,t)};n.aes._updateBlock=o;f("AES-CBC",n.cipher.modes.cbc);f("AES-CFB",n.cipher.modes.cfb);f("AES-OFB",n.cipher.modes.ofb);f("AES-CTR",n.cipher.modes.ctr);f("AES-GCM",n.cipher.modes.gcm);var s=!1,u=4,t,h,a,r,i}var i="aes",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/aes",["require","module","./cipher","./cipherModes","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){n.pki=n.pki||{};var t=n.pki.oids=n.oids=n.oids||{};t["1.2.840.113549.1.1.1"]="rsaEncryption";t.rsaEncryption="1.2.840.113549.1.1.1";t["1.2.840.113549.1.1.4"]="md5WithRSAEncryption";t.md5WithRSAEncryption="1.2.840.113549.1.1.4";t["1.2.840.113549.1.1.5"]="sha1WithRSAEncryption";t.sha1WithRSAEncryption="1.2.840.113549.1.1.5";t["1.2.840.113549.1.1.7"]="RSAES-OAEP";t["RSAES-OAEP"]="1.2.840.113549.1.1.7";t["1.2.840.113549.1.1.8"]="mgf1";t.mgf1="1.2.840.113549.1.1.8";t["1.2.840.113549.1.1.9"]="pSpecified";t.pSpecified="1.2.840.113549.1.1.9";t["1.2.840.113549.1.1.10"]="RSASSA-PSS";t["RSASSA-PSS"]="1.2.840.113549.1.1.10";t["1.2.840.113549.1.1.11"]="sha256WithRSAEncryption";t.sha256WithRSAEncryption="1.2.840.113549.1.1.11";t["1.2.840.113549.1.1.12"]="sha384WithRSAEncryption";t.sha384WithRSAEncryption="1.2.840.113549.1.1.12";t["1.2.840.113549.1.1.13"]="sha512WithRSAEncryption";t.sha512WithRSAEncryption="1.2.840.113549.1.1.13";t["1.3.14.3.2.7"]="desCBC";t.desCBC="1.3.14.3.2.7";t["1.3.14.3.2.26"]="sha1";t.sha1="1.3.14.3.2.26";t["2.16.840.1.101.3.4.2.1"]="sha256";t.sha256="2.16.840.1.101.3.4.2.1";t["2.16.840.1.101.3.4.2.2"]="sha384";t.sha384="2.16.840.1.101.3.4.2.2";t["2.16.840.1.101.3.4.2.3"]="sha512";t.sha512="2.16.840.1.101.3.4.2.3";t["1.2.840.113549.2.5"]="md5";t.md5="1.2.840.113549.2.5";t["1.2.840.113549.1.7.1"]="data";t.data="1.2.840.113549.1.7.1";t["1.2.840.113549.1.7.2"]="signedData";t.signedData="1.2.840.113549.1.7.2";t["1.2.840.113549.1.7.3"]="envelopedData";t.envelopedData="1.2.840.113549.1.7.3";t["1.2.840.113549.1.7.4"]="signedAndEnvelopedData";t.signedAndEnvelopedData="1.2.840.113549.1.7.4";t["1.2.840.113549.1.7.5"]="digestedData";t.digestedData="1.2.840.113549.1.7.5";t["1.2.840.113549.1.7.6"]="encryptedData";t.encryptedData="1.2.840.113549.1.7.6";t["1.2.840.113549.1.9.1"]="emailAddress";t.emailAddress="1.2.840.113549.1.9.1";t["1.2.840.113549.1.9.2"]="unstructuredName";t.unstructuredName="1.2.840.113549.1.9.2";t["1.2.840.113549.1.9.3"]="contentType";t.contentType="1.2.840.113549.1.9.3";t["1.2.840.113549.1.9.4"]="messageDigest";t.messageDigest="1.2.840.113549.1.9.4";t["1.2.840.113549.1.9.5"]="signingTime";t.signingTime="1.2.840.113549.1.9.5";t["1.2.840.113549.1.9.6"]="counterSignature";t.counterSignature="1.2.840.113549.1.9.6";t["1.2.840.113549.1.9.7"]="challengePassword";t.challengePassword="1.2.840.113549.1.9.7";t["1.2.840.113549.1.9.8"]="unstructuredAddress";t.unstructuredAddress="1.2.840.113549.1.9.8";t["1.2.840.113549.1.9.14"]="extensionRequest";t.extensionRequest="1.2.840.113549.1.9.14";t["1.2.840.113549.1.9.20"]="friendlyName";t.friendlyName="1.2.840.113549.1.9.20";t["1.2.840.113549.1.9.21"]="localKeyId";t.localKeyId="1.2.840.113549.1.9.21";t["1.2.840.113549.1.9.22.1"]="x509Certificate";t.x509Certificate="1.2.840.113549.1.9.22.1";t["1.2.840.113549.1.12.10.1.1"]="keyBag";t.keyBag="1.2.840.113549.1.12.10.1.1";t["1.2.840.113549.1.12.10.1.2"]="pkcs8ShroudedKeyBag";t.pkcs8ShroudedKeyBag="1.2.840.113549.1.12.10.1.2";t["1.2.840.113549.1.12.10.1.3"]="certBag";t.certBag="1.2.840.113549.1.12.10.1.3";t["1.2.840.113549.1.12.10.1.4"]="crlBag";t.crlBag="1.2.840.113549.1.12.10.1.4";t["1.2.840.113549.1.12.10.1.5"]="secretBag";t.secretBag="1.2.840.113549.1.12.10.1.5";t["1.2.840.113549.1.12.10.1.6"]="safeContentsBag";t.safeContentsBag="1.2.840.113549.1.12.10.1.6";t["1.2.840.113549.1.5.13"]="pkcs5PBES2";t.pkcs5PBES2="1.2.840.113549.1.5.13";t["1.2.840.113549.1.5.12"]="pkcs5PBKDF2";t.pkcs5PBKDF2="1.2.840.113549.1.5.12";t["1.2.840.113549.1.12.1.1"]="pbeWithSHAAnd128BitRC4";t.pbeWithSHAAnd128BitRC4="1.2.840.113549.1.12.1.1";t["1.2.840.113549.1.12.1.2"]="pbeWithSHAAnd40BitRC4";t.pbeWithSHAAnd40BitRC4="1.2.840.113549.1.12.1.2";t["1.2.840.113549.1.12.1.3"]="pbeWithSHAAnd3-KeyTripleDES-CBC";t["pbeWithSHAAnd3-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.3";t["1.2.840.113549.1.12.1.4"]="pbeWithSHAAnd2-KeyTripleDES-CBC";t["pbeWithSHAAnd2-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.4";t["1.2.840.113549.1.12.1.5"]="pbeWithSHAAnd128BitRC2-CBC";t["pbeWithSHAAnd128BitRC2-CBC"]="1.2.840.113549.1.12.1.5";t["1.2.840.113549.1.12.1.6"]="pbewithSHAAnd40BitRC2-CBC";t["pbewithSHAAnd40BitRC2-CBC"]="1.2.840.113549.1.12.1.6";t["1.2.840.113549.3.7"]="des-EDE3-CBC";t["des-EDE3-CBC"]="1.2.840.113549.3.7";t["2.16.840.1.101.3.4.1.2"]="aes128-CBC";t["aes128-CBC"]="2.16.840.1.101.3.4.1.2";t["2.16.840.1.101.3.4.1.22"]="aes192-CBC";t["aes192-CBC"]="2.16.840.1.101.3.4.1.22";t["2.16.840.1.101.3.4.1.42"]="aes256-CBC";t["aes256-CBC"]="2.16.840.1.101.3.4.1.42";t["2.5.4.3"]="commonName";t.commonName="2.5.4.3";t["2.5.4.5"]="serialName";t.serialName="2.5.4.5";t["2.5.4.6"]="countryName";t.countryName="2.5.4.6";t["2.5.4.7"]="localityName";t.localityName="2.5.4.7";t["2.5.4.8"]="stateOrProvinceName";t.stateOrProvinceName="2.5.4.8";t["2.5.4.10"]="organizationName";t.organizationName="2.5.4.10";t["2.5.4.11"]="organizationalUnitName";t.organizationalUnitName="2.5.4.11";t["2.16.840.1.113730.1.1"]="nsCertType";t.nsCertType="2.16.840.1.113730.1.1";t["2.5.29.1"]="authorityKeyIdentifier";t["2.5.29.2"]="keyAttributes";t["2.5.29.3"]="certificatePolicies";t["2.5.29.4"]="keyUsageRestriction";t["2.5.29.5"]="policyMapping";t["2.5.29.6"]="subtreesConstraint";t["2.5.29.7"]="subjectAltName";t["2.5.29.8"]="issuerAltName";t["2.5.29.9"]="subjectDirectoryAttributes";t["2.5.29.10"]="basicConstraints";t["2.5.29.11"]="nameConstraints";t["2.5.29.12"]="policyConstraints";t["2.5.29.13"]="basicConstraints";t["2.5.29.14"]="subjectKeyIdentifier";t.subjectKeyIdentifier="2.5.29.14";t["2.5.29.15"]="keyUsage";t.keyUsage="2.5.29.15";t["2.5.29.16"]="privateKeyUsagePeriod";t["2.5.29.17"]="subjectAltName";t.subjectAltName="2.5.29.17";t["2.5.29.18"]="issuerAltName";t.issuerAltName="2.5.29.18";t["2.5.29.19"]="basicConstraints";t.basicConstraints="2.5.29.19";t["2.5.29.20"]="cRLNumber";t["2.5.29.21"]="cRLReason";t["2.5.29.22"]="expirationDate";t["2.5.29.23"]="instructionCode";t["2.5.29.24"]="invalidityDate";t["2.5.29.25"]="cRLDistributionPoints";t["2.5.29.26"]="issuingDistributionPoint";t["2.5.29.27"]="deltaCRLIndicator";t["2.5.29.28"]="issuingDistributionPoint";t["2.5.29.29"]="certificateIssuer";t["2.5.29.30"]="nameConstraints";t["2.5.29.31"]="cRLDistributionPoints";t["2.5.29.32"]="certificatePolicies";t["2.5.29.33"]="policyMappings";t["2.5.29.34"]="policyConstraints";t["2.5.29.35"]="authorityKeyIdentifier";t["2.5.29.36"]="policyConstraints";t["2.5.29.37"]="extKeyUsage";t.extKeyUsage="2.5.29.37";t["2.5.29.46"]="freshestCRL";t["2.5.29.54"]="inhibitAnyPolicy";t["1.3.6.1.5.5.7.3.1"]="serverAuth";t.serverAuth="1.3.6.1.5.5.7.3.1";t["1.3.6.1.5.5.7.3.2"]="clientAuth";t.clientAuth="1.3.6.1.5.5.7.3.2";t["1.3.6.1.5.5.7.3.3"]="codeSigning";t.codeSigning="1.3.6.1.5.5.7.3.3";t["1.3.6.1.5.5.7.3.4"]="emailProtection";t.emailProtection="1.3.6.1.5.5.7.3.4";t["1.3.6.1.5.5.7.3.8"]="timeStamping";t.timeStamping="1.3.6.1.5.5.7.3.8"}var i="oids",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/oids",["require","module"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){var t=n.asn1=n.asn1||{},i,r;t.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};t.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};t.create=function(t,i,r,u){var e,f;if(n.util.isArray(u)){for(e=[],f=0;f<u.length;++f)u[f]!==undefined&&e.push(u[f]);u=e}return{tagClass:t,type:i,constructed:r,composed:r||n.util.isArray(u),value:u}};i=function(n){var t=n.getByte(),i,r;return t===128?undefined:(r=t&128,i=r?n.getInt((t&127)<<3):t,i)};t.fromDer=function(r,u){var o,e,a,h,c,b,v,k,y,p;if(u===undefined&&(u=!0),typeof r=="string"&&(r=n.util.createBuffer(r)),r.length()<2){o=new Error("Too few bytes to parse DER.");throw o.bytes=r.length(),o;}var s=r.getByte(),w=s&192,l=s&31,f=i(r);if(r.length()<f){if(u){o=new Error("Too few bytes to read ASN.1 value.");throw o.detail=r.length()+" < "+f,o;}f=r.length()}if(a=(s&32)==32,h=a,!h&&w===t.Class.UNIVERSAL&&l===t.Type.BITSTRING&&f>1){if(c=r.read,b=r.getByte(),b===0&&(s=r.getByte(),v=s&192,v===t.Class.UNIVERSAL||v===t.Class.CONTEXT_SPECIFIC))try{k=i(r);h=k===f-(r.read-c);h&&(++c,--f)}catch(d){}r.read=c}if(h)if(e=[],f===undefined)for(;;){if(r.bytes(2)===String.fromCharCode(0,0)){r.getBytes(2);break}e.push(t.fromDer(r,u))}else for(y=r.length();f>0;)e.push(t.fromDer(r,u)),f-=y-r.length(),y=r.length();else{if(f===undefined){if(u)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=r.length()}if(l===t.Type.BMPSTRING)for(e="",p=0;p<f;p+=2)e+=String.fromCharCode(r.getInt16());else e=r.getBytes(f)}return t.create(w,l,a,e)};t.toDer=function(i){var f=n.util.createBuffer(),s=i.tagClass|i.type,u=n.util.createBuffer(),o,e,r;if(i.composed)for(i.constructed?s|=32:u.putByte(0),r=0;r<i.value.length;++r)i.value[r]!==undefined&&u.putBuffer(t.toDer(i.value[r]));else if(i.type===t.Type.BMPSTRING)for(r=0;r<i.value.length;++r)u.putInt16(i.value.charCodeAt(r));else u.putBytes(i.value);if(f.putByte(s),u.length()<=127)f.putByte(u.length()&127);else{o=u.length();e="";do e+=String.fromCharCode(o&255),o>>>=8;while(o>0);for(f.putByte(e.length|128),r=e.length-1;r>=0;--r)f.putByte(e.charCodeAt(r))}return f.putBuffer(u),f};t.oidToDer=function(t){var i=t.split("."),o=n.util.createBuffer(),s,r,u,h,f,e;for(o.putByte(40*parseInt(i[0],10)+parseInt(i[1],10)),f=2;f<i.length;++f){s=!0;r=[];u=parseInt(i[f],10);do h=u&127,u>>>=7,s||(h|=128),r.push(h),s=!1;while(u>0);for(e=r.length-1;e>=0;--e)o.putByte(r[e])}return o};t.derToOid=function(t){var u,i,r;for(typeof t=="string"&&(t=n.util.createBuffer(t)),i=t.getByte(),u=Math.floor(i/40)+"."+i%40,r=0;t.length()>0;)i=t.getByte(),r<<=7,i&128?r+=i&127:(u+="."+(r+i),r=0);return u};t.utcTimeToDate=function(n){var t=new Date,u=parseInt(n.substr(0,2),10),i,r;u=u>=50?1900+u:2e3+u;var o=parseInt(n.substr(2,2),10)-1,s=parseInt(n.substr(4,2),10),h=parseInt(n.substr(6,2),10),c=parseInt(n.substr(8,2),10),e=0;if(n.length>11&&(i=n.charAt(10),r=10,i!=="+"&&i!=="-"&&(e=parseInt(n.substr(10,2),10),r+=2)),t.setUTCFullYear(u,o,s),t.setUTCHours(h,c,e,0),r&&(i=n.charAt(r),i==="+"||i==="-")){var l=parseInt(n.substr(r+1,2),10),a=parseInt(n.substr(r+4,2),10),f=l*60+a;f*=6e4;i==="+"?t.setTime(+t-f):t.setTime(+t+f)}return t};t.generalizedTimeToDate=function(n){var t=new Date,o=parseInt(n.substr(0,4),10),s=parseInt(n.substr(4,2),10)-1,h=parseInt(n.substr(6,2),10),c=parseInt(n.substr(8,2),10),l=parseInt(n.substr(10,2),10),a=parseInt(n.substr(12,2),10),f=0,i=0,e=!1,r,u,v,y;return n.charAt(n.length-1)==="Z"&&(e=!0),r=n.length-5,u=n.charAt(r),(u==="+"||u==="-")&&(v=parseInt(n.substr(r+1,2),10),y=parseInt(n.substr(r+4,2),10),i=v*60+y,i*=6e4,u==="+"&&(i*=-1),e=!0),n.charAt(14)==="."&&(f=parseFloat(n.substr(14),10)*1e3),e?(t.setUTCFullYear(o,s,h),t.setUTCHours(c,l,a,f),t.setTime(+t+i)):(t.setFullYear(o,s,h),t.setHours(c,l,a,f)),t};t.dateToUtcTime=function(n){var r="",t=[],i;for(t.push((""+n.getUTCFullYear()).substr(2)),t.push(""+(n.getUTCMonth()+1)),t.push(""+n.getUTCDate()),t.push(""+n.getUTCHours()),t.push(""+n.getUTCMinutes()),t.push(""+n.getUTCSeconds()),i=0;i<t.length;++i)t[i].length<2&&(r+="0"),r+=t[i];return r+="Z",r};t.integerToDer=function(t){var i=n.util.createBuffer(),r;if(t>=-128&&t<128)return i.putSignedInt(t,8);if(t>=-32768&&t<32768)return i.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return i.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return i.putSignedInt(t,32);r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r;};t.derToInteger=function(t){typeof t=="string"&&(t=n.util.createBuffer(t));var i=t.length()*8;if(i>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(i)};t.validate=function(i,r,u,f){var e=!1,s,o;if(i.tagClass!==r.tagClass&&typeof r.tagClass!="undefined"||i.type!==r.type&&typeof r.type!="undefined")f&&(i.tagClass!==r.tagClass&&f.push("["+r.name+'] Expected tag class "'+r.tagClass+'", got "'+i.tagClass+'"'),i.type!==r.type&&f.push("["+r.name+'] Expected type "'+r.type+'", got "'+i.type+'"'));else if(i.constructed===r.constructed||typeof r.constructed=="undefined"){if(e=!0,r.value&&n.util.isArray(r.value))for(s=0,o=0;e&&o<r.value.length;++o)e=r.value[o].optional||!1,i.value[s]&&(e=t.validate(i.value[s],r.value[o],u,f),e?++s:r.value[o].optional&&(e=!0)),!e&&f&&f.push("["+r.name+'] Tag class "'+r.tagClass+'", type "'+r.type+'" expected value length "'+r.value.length+'", got "'+i.value.length+'"');e&&u&&(r.capture&&(u[r.capture]=i.value),r.captureAsn1&&(u[r.captureAsn1]=i))}else f&&f.push("["+r.name+'] Expected constructed "'+r.constructed+'", got "'+i.constructed+'"');return e};r=/[^\\u0000-\\u00ff]/;t.prettyPrint=function(i,u,f){var e="",s,l,h,o,c;for(u=u||0,f=f||2,u>0&&(e+="\n"),s="",o=0;o<u*f;++o)s+=" ";e+=s+"Tag: ";switch(i.tagClass){case t.Class.UNIVERSAL:e+="Universal:";break;case t.Class.APPLICATION:e+="Application:";break;case t.Class.CONTEXT_SPECIFIC:e+="Context-Specific:";break;case t.Class.PRIVATE:e+="Private:"}if(i.tagClass===t.Class.UNIVERSAL){e+=i.type;switch(i.type){case t.Type.NONE:e+=" (None)";break;case t.Type.BOOLEAN:e+=" (Boolean)";break;case t.Type.BITSTRING:e+=" (Bit string)";break;case t.Type.INTEGER:e+=" (Integer)";break;case t.Type.OCTETSTRING:e+=" (Octet string)";break;case t.Type.NULL:e+=" (Null)";break;case t.Type.OID:e+=" (Object Identifier)";break;case t.Type.ODESC:e+=" (Object Descriptor)";break;case t.Type.EXTERNAL:e+=" (External or Instance of)";break;case t.Type.REAL:e+=" (Real)";break;case t.Type.ENUMERATED:e+=" (Enumerated)";break;case t.Type.EMBEDDED:e+=" (Embedded PDV)";break;case t.Type.UTF8:e+=" (UTF8)";break;case t.Type.ROID:e+=" (Relative Object Identifier)";break;case t.Type.SEQUENCE:e+=" (Sequence)";break;case t.Type.SET:e+=" (Set)";break;case t.Type.PRINTABLESTRING:e+=" (Printable String)";break;case t.Type.IA5String:e+=" (IA5String (ASCII))";break;case t.Type.UTCTIME:e+=" (UTC time)";break;case t.Type.GENERALIZEDTIME:e+=" (Generalized time)";break;case t.Type.BMPSTRING:e+=" (BMP String)"}}else e+=i.type;if(e+="\n",e+=s+"Constructed: "+i.constructed+"\n",i.composed){for(l=0,h="",o=0;o<i.value.length;++o)i.value[o]!==undefined&&(l+=1,h+=t.prettyPrint(i.value[o],u+1,f),o+1<i.value.length&&(h+=","));e+=s+"Sub values: "+l+h}else if(e+=s+"Value: ",i.type===t.Type.OID&&(c=t.derToOid(i.value),e+=c,n.pki&&n.pki.oids&&c in n.pki.oids&&(e+=" ("+n.pki.oids[c]+") ")),i.type===t.Type.INTEGER)try{e+=t.derToInteger(i.value)}catch(a){e+="0x"+n.util.bytesToHex(i.value)}else i.type===t.Type.OCTETSTRING?(r.test(i.value)||(e+="("+i.value+") "),e+="0x"+n.util.bytesToHex(i.value)):e+=i.type===t.Type.UTF8?n.util.decodeUtf8(i.value):i.type===t.Type.PRINTABLESTRING||i.type===t.Type.IA5String?i.value:r.test(i.value)?"0x"+n.util.bytesToHex(i.value):i.value.length===0?"[null]":i.value;return e}}var i="asn1",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/asn1",["require","module","./util","./oids"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){function s(){u=String.fromCharCode(128);u+=n.util.fillString(String.fromCharCode(0),64);r=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9];i=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21];t=new Array(64);for(var f=0;f<64;++f)t[f]=Math.floor(Math.abs(Math.sin(f+1))*4294967296);o=!0}function f(n,u,f){for(var c,a,h,o,s,v,l,e,y=f.length();y>=64;){for(a=n.h0,h=n.h1,o=n.h2,s=n.h3,e=0;e<16;++e)u[e]=f.getInt32Le(),v=s^h&(o^s),c=a+v+t[e]+u[e],l=i[e],a=s,s=o,o=h,h+=c<<l|c>>>32-l;for(;e<32;++e)v=o^s&(h^o),c=a+v+t[e]+u[r[e]],l=i[e],a=s,s=o,o=h,h+=c<<l|c>>>32-l;for(;e<48;++e)v=h^o^s,c=a+v+t[e]+u[r[e]],l=i[e],a=s,s=o,o=h,h+=c<<l|c>>>32-l;for(;e<64;++e)v=o^(h|~s),c=a+v+t[e]+u[r[e]],l=i[e],a=s,s=o,o=h,h+=c<<l|c>>>32-l;n.h0=n.h0+a|0;n.h1=n.h1+h|0;n.h2=n.h2+o|0;n.h3=n.h3+s|0;y-=64}}var e=n.md5=n.md5||{};n.md=n.md||{};n.md.algorithms=n.md.algorithms||{};n.md.md5=n.md.algorithms.md5=e;e.create=function(){o||s();var r=null,i=n.util.createBuffer(),e=new Array(16),t={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,messageLength64:[0,0]};return t.start=function(){return t.messageLength=0,t.messageLength64=[0,0],i=n.util.createBuffer(),r={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},t},t.start(),t.update=function(u,o){return o==="utf8"&&(u=n.util.encodeUtf8(u)),t.messageLength+=u.length,t.messageLength64[0]+=u.length/4294967296>>>0,t.messageLength64[1]+=u.length>>>0,i.putBytes(u),f(r,e,i),(i.read>2048||i.length()===0)&&i.compact(),t},t.digest=function(){var h=n.util.createBuffer(),o,s;return h.putBytes(i.bytes()),h.putBytes(u.substr(0,64-(t.messageLength64[1]+8&63))),h.putInt32Le(t.messageLength64[1]<<3),h.putInt32Le(t.messageLength64[0]<<3|t.messageLength64[0]>>>28),o={h0:r.h0,h1:r.h1,h2:r.h2,h3:r.h3},f(o,e,h),s=n.util.createBuffer(),s.putInt32Le(o.h0),s.putInt32Le(o.h1),s.putInt32Le(o.h2),s.putInt32Le(o.h3),s},t};var u=null,r=null,i=null,t=null,o=!1}var i="md5",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/md5",["require","module","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){function f(){t=String.fromCharCode(128);t+=n.util.fillString(String.fromCharCode(0),64);i=!0}function r(n,t,i){for(var r,e,f,s,o,h,c,u,l=i.length();l>=64;){for(e=n.h0,f=n.h1,s=n.h2,o=n.h3,h=n.h4,u=0;u<16;++u)r=i.getInt32(),t[u]=r,c=o^f&(s^o),r=(e<<5|e>>>27)+c+h+1518500249+r,h=o,o=s,s=f<<30|f>>>2,f=e,e=r;for(;u<20;++u)r=t[u-3]^t[u-8]^t[u-14]^t[u-16],r=r<<1|r>>>31,t[u]=r,c=o^f&(s^o),r=(e<<5|e>>>27)+c+h+1518500249+r,h=o,o=s,s=f<<30|f>>>2,f=e,e=r;for(;u<32;++u)r=t[u-3]^t[u-8]^t[u-14]^t[u-16],r=r<<1|r>>>31,t[u]=r,c=f^s^o,r=(e<<5|e>>>27)+c+h+1859775393+r,h=o,o=s,s=f<<30|f>>>2,f=e,e=r;for(;u<40;++u)r=t[u-6]^t[u-16]^t[u-28]^t[u-32],r=r<<2|r>>>30,t[u]=r,c=f^s^o,r=(e<<5|e>>>27)+c+h+1859775393+r,h=o,o=s,s=f<<30|f>>>2,f=e,e=r;for(;u<60;++u)r=t[u-6]^t[u-16]^t[u-28]^t[u-32],r=r<<2|r>>>30,t[u]=r,c=f&s|o&(f^s),r=(e<<5|e>>>27)+c+h+2400959708+r,h=o,o=s,s=f<<30|f>>>2,f=e,e=r;for(;u<80;++u)r=t[u-6]^t[u-16]^t[u-28]^t[u-32],r=r<<2|r>>>30,t[u]=r,c=f^s^o,r=(e<<5|e>>>27)+c+h+3395469782+r,h=o,o=s,s=f<<30|f>>>2,f=e,e=r;n.h0=n.h0+e|0;n.h1=n.h1+f|0;n.h2=n.h2+s|0;n.h3=n.h3+o|0;n.h4=n.h4+h|0;l-=64}}var u=n.sha1=n.sha1||{},t,i;n.md=n.md||{};n.md.algorithms=n.md.algorithms||{};n.md.sha1=n.md.algorithms.sha1=u;u.create=function(){i||f();var e=null,o=n.util.createBuffer(),s=new Array(80),u={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,messageLength64:[0,0]};return u.start=function(){return u.messageLength=0,u.messageLength64=[0,0],o=n.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},u},u.start(),u.update=function(t,i){return i==="utf8"&&(t=n.util.encodeUtf8(t)),u.messageLength+=t.length,u.messageLength64[0]+=t.length/4294967296>>>0,u.messageLength64[1]+=t.length>>>0,o.putBytes(t),r(e,s,o),(o.read>2048||o.length()===0)&&o.compact(),u},u.digest=function(){var h=n.util.createBuffer(),i,f;return h.putBytes(o.bytes()),h.putBytes(t.substr(0,64-(u.messageLength64[1]+8&63))),h.putInt32(u.messageLength64[0]<<3|u.messageLength64[0]>>>28),h.putInt32(u.messageLength64[1]<<3),i={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4},r(i,s,h),f=n.util.createBuffer(),f.putInt32(i.h0),f.putInt32(i.h1),f.putInt32(i.h2),f.putInt32(i.h3),f.putInt32(i.h4),f},u};t=null;i=!1}var i="sha1",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/sha1",["require","module","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){function e(){t=String.fromCharCode(128);t+=n.util.fillString(String.fromCharCode(0),64);f=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];u=!0}function i(n,t,i){for(var e,s,p,w,b,k,r,u,h,l,v,o,a,c,y,d=i.length();d>=64;){for(r=0;r<16;++r)t[r]=i.getInt32();for(;r<64;++r)e=t[r-2],e=(e>>>17|e<<15)^(e>>>19|e<<13)^e>>>10,s=t[r-15],s=(s>>>7|s<<25)^(s>>>18|s<<14)^s>>>3,t[r]=e+t[r-7]+s+t[r-16]|0;for(u=n.h0,h=n.h1,l=n.h2,v=n.h3,o=n.h4,a=n.h5,c=n.h6,y=n.h7,r=0;r<64;++r)w=(o>>>6|o<<26)^(o>>>11|o<<21)^(o>>>25|o<<7),b=c^o&(a^c),p=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),k=u&h|l&(u^h),e=y+w+b+f[r]+t[r],s=p+k,y=c,c=a,a=o,o=v+e|0,v=l,l=h,h=u,u=e+s|0;n.h0=n.h0+u|0;n.h1=n.h1+h|0;n.h2=n.h2+l|0;n.h3=n.h3+v|0;n.h4=n.h4+o|0;n.h5=n.h5+a|0;n.h6=n.h6+c|0;n.h7=n.h7+y|0;d-=64}}var r=n.sha256=n.sha256||{};n.md=n.md||{};n.md.algorithms=n.md.algorithms||{};n.md.sha256=n.md.algorithms.sha256=r;r.create=function(){u||e();var f=null,o=n.util.createBuffer(),s=new Array(64),r={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,messageLength64:[0,0]};return r.start=function(){return r.messageLength=0,r.messageLength64=[0,0],o=n.util.createBuffer(),f={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},r},r.start(),r.update=function(t,u){return u==="utf8"&&(t=n.util.encodeUtf8(t)),r.messageLength+=t.length,r.messageLength64[0]+=t.length/4294967296>>>0,r.messageLength64[1]+=t.length>>>0,o.putBytes(t),i(f,s,o),(o.read>2048||o.length()===0)&&o.compact(),r},r.digest=function(){var h=n.util.createBuffer(),u,e;return h.putBytes(o.bytes()),h.putBytes(t.substr(0,64-(r.messageLength64[1]+8&63))),h.putInt32(r.messageLength64[0]<<3|r.messageLength64[0]>>>28),h.putInt32(r.messageLength64[1]<<3),u={h0:f.h0,h1:f.h1,h2:f.h2,h3:f.h3,h4:f.h4,h5:f.h5,h6:f.h6,h7:f.h7},i(u,s,h),e=n.util.createBuffer(),e.putInt32(u.h0),e.putInt32(u.h1),e.putInt32(u.h2),e.putInt32(u.h3),e.putInt32(u.h4),e.putInt32(u.h5),e.putInt32(u.h6),e.putInt32(u.h7),e},r};var t=null,u=!1,f=null}var i="sha256",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/sha256",["require","module","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){function s(){u=String.fromCharCode(128);u+=n.util.fillString(String.fromCharCode(0),128);f=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]];t={};t["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]];t["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]];t["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]];t["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]];o=!0}function e(n,t,i){for(var p,w,nt,tt,ct,lt,at,vt,yt,pt,wt,bt,o,s,l,a,b,k,it,rt,h,c,d,g,v,y,ut,ft,u,e,r,et,ot,st,ht,kt=i.length();kt>=128;){for(u=0;u<16;++u)t[u][0]=i.getInt32()>>>0,t[u][1]=i.getInt32()>>>0;for(;u<80;++u)et=t[u-2],e=et[0],r=et[1],p=((e>>>19|r<<13)^(r>>>29|e<<3)^e>>>6)>>>0,w=((e<<13|r>>>19)^(r<<3|e>>>29)^(e<<26|r>>>6))>>>0,st=t[u-15],e=st[0],r=st[1],nt=((e>>>1|r<<31)^(e>>>8|r<<24)^e>>>7)>>>0,tt=((e<<31|r>>>1)^(e<<24|r>>>8)^(e<<25|r>>>7))>>>0,ot=t[u-7],ht=t[u-16],r=w+ot[1]+tt+ht[1],t[u][0]=p+ot[0]+nt+ht[0]+(r/4294967296>>>0)>>>0,t[u][1]=r>>>0;for(o=n[0][0],s=n[0][1],l=n[1][0],a=n[1][1],b=n[2][0],k=n[2][1],it=n[3][0],rt=n[3][1],h=n[4][0],c=n[4][1],d=n[5][0],g=n[5][1],v=n[6][0],y=n[6][1],ut=n[7][0],ft=n[7][1],u=0;u<80;++u)at=((h>>>14|c<<18)^(h>>>18|c<<14)^(c>>>9|h<<23))>>>0,vt=((h<<18|c>>>14)^(h<<14|c>>>18)^(c<<23|h>>>9))>>>0,yt=(v^h&(d^v))>>>0,pt=(y^c&(g^y))>>>0,ct=((o>>>28|s<<4)^(s>>>2|o<<30)^(s>>>7|o<<25))>>>0,lt=((o<<4|s>>>28)^(s<<30|o>>>2)^(s<<25|o>>>7))>>>0,wt=(o&l|b&(o^l))>>>0,bt=(s&a|k&(s^a))>>>0,r=ft+vt+pt+f[u][1]+t[u][1],p=ut+at+yt+f[u][0]+t[u][0]+(r/4294967296>>>0)>>>0,w=r>>>0,r=lt+bt,nt=ct+wt+(r/4294967296>>>0)>>>0,tt=r>>>0,ut=v,ft=y,v=d,y=g,d=h,g=c,r=rt+w,h=it+p+(r/4294967296>>>0)>>>0,c=r>>>0,it=b,rt=k,b=l,k=a,l=o,a=s,r=w+tt,o=p+nt+(r/4294967296>>>0)>>>0,s=r>>>0;r=n[0][1]+s;n[0][0]=n[0][0]+o+(r/4294967296>>>0)>>>0;n[0][1]=r>>>0;r=n[1][1]+a;n[1][0]=n[1][0]+l+(r/4294967296>>>0)>>>0;n[1][1]=r>>>0;r=n[2][1]+k;n[2][0]=n[2][0]+b+(r/4294967296>>>0)>>>0;n[2][1]=r>>>0;r=n[3][1]+rt;n[3][0]=n[3][0]+it+(r/4294967296>>>0)>>>0;n[3][1]=r>>>0;r=n[4][1]+c;n[4][0]=n[4][0]+h+(r/4294967296>>>0)>>>0;n[4][1]=r>>>0;r=n[5][1]+g;n[5][0]=n[5][0]+d+(r/4294967296>>>0)>>>0;n[5][1]=r>>>0;r=n[6][1]+y;n[6][0]=n[6][0]+v+(r/4294967296>>>0)>>>0;n[6][1]=r>>>0;r=n[7][1]+ft;n[7][0]=n[7][0]+ut+(r/4294967296>>>0)>>>0;n[7][1]=r>>>0;kt-=128}}var i=n.sha512=n.sha512||{},r;n.md=n.md||{};n.md.algorithms=n.md.algorithms||{};n.md.sha512=n.md.algorithms.sha512=i;r=n.sha384=n.sha512.sha384=n.sha512.sha384||{};r.create=function(){return i.create("SHA-384")};n.md.sha384=n.md.algorithms.sha384=r;n.sha512.sha256=n.sha512.sha256||{create:function(){return i.create("SHA-512/256")}};n.md["sha512/256"]=n.md.algorithms["sha512/256"]=n.sha512.sha256;n.sha512.sha224=n.sha512.sha224||{create:function(){return i.create("SHA-512/224")}};n.md["sha512/224"]=n.md.algorithms["sha512/224"]=n.sha512.sha224;i.create=function(i){var c,r;if(o||s(),typeof i=="undefined"&&(i="SHA-512"),i in t){var l=t[i],h=null,f=n.util.createBuffer(),a=new Array(80);for(c=0;c<80;++c)a[c]=new Array(2);return r={algorithm:i.replace("-","").toLowerCase(),blockLength:128,digestLength:64,messageLength:0,messageLength128:[0,0,0,0]},r.start=function(){r.messageLength=0;r.messageLength128=[0,0,0,0];f=n.util.createBuffer();h=new Array(l.length);for(var t=0;t<l.length;++t)h[t]=l[t].slice(0);return r},r.start(),r.update=function(t,i){var u,o;for(i==="utf8"&&(t=n.util.encodeUtf8(t)),r.messageLength+=t.length,u=t.length,u=[u/4294967296>>>0,u>>>0],o=3;o>=0;--o)r.messageLength128[o]+=u[1],u[1]=u[0]+(r.messageLength128[o]/4294967296>>>0),r.messageLength128[o]=r.messageLength128[o]>>>0,u[0]=u[1]/4294967296>>>0;return f.putBytes(t),e(h,a,f),(f.read>2048||f.length()===0)&&f.compact(),r},r.digest=function(){var s=n.util.createBuffer(),c,o,l,v,t;for(s.putBytes(f.bytes()),s.putBytes(u.substr(0,128-(r.messageLength128[3]+16&127))),c=[],t=0;t<3;++t)c[t]=r.messageLength128[t]<<3|r.messageLength128[t-1]>>>28;for(c[3]=r.messageLength128[3]<<3,s.putInt32(c[0]),s.putInt32(c[1]),s.putInt32(c[2]),s.putInt32(c[3]),o=new Array(h.length),t=0;t<h.length;++t)o[t]=h[t].slice(0);for(e(o,a,s),l=n.util.createBuffer(),v=i==="SHA-512"?o.length:i==="SHA-384"?o.length-2:o.length-4,t=0;t<v;++t)l.putInt32(o[t][0]),(t!==v-1||i!=="SHA-512/224")&&l.putInt32(o[t][1]);return l},r}throw new Error("Invalid SHA-512 algorithm: "+i);};var u=null,o=!1,f=null,t=null}var i="sha512",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/sha512",["require","module","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){n.md=n.md||{};n.md.algorithms={md5:n.md5,sha1:n.sha1,sha256:n.sha256};n.md.md5=n.md5;n.md.sha1=n.sha1;n.md.sha256=n.sha256}var i="md",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/md",["require","module","./md5","./sha1","./sha256","./sha512"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){var t=n.hmac=n.hmac||{};t.create=function(){var f=null,t=null,i=null,r=null,u={};return u.start=function(u,e){var h,s,o;if(u!==null)if(typeof u=="string"){if(u=u.toLowerCase(),!(u in n.md.algorithms))throw new Error('Unknown hash algorithm "'+u+'"');t=n.md.algorithms[u].create()}else t=u;if(e===null)e=f;else{if(typeof e=="string")e=n.util.createBuffer(e);else if(n.util.isArray(e))for(s=e,e=n.util.createBuffer(),o=0;o<s.length;++o)e.putByte(s[o]);for(h=e.length(),h>t.blockLength&&(t.start(),t.update(e.bytes()),e=t.digest()),i=n.util.createBuffer(),r=n.util.createBuffer(),h=e.length(),o=0;o<h;++o)s=e.at(o),i.putByte(54^s),r.putByte(92^s);if(h<t.blockLength)for(s=t.blockLength-h,o=0;o<s;++o)i.putByte(54),r.putByte(92);f=e;i=i.bytes();r=r.bytes()}t.start();t.update(i)},u.update=function(n){t.update(n)},u.getMac=function(){var n=t.digest().bytes();return t.start(),t.update(r),t.update(n),t.digest()},u.digest=u.getMac,u}}var i="hmac",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/hmac",["require","module","./md","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){function t(n){for(var u,r,f,t=n.name+": ",e=[],o=function(n,t){return" "+t},i=0;i<n.values.length;++i)e.push(n.values[i].replace(/^(\S+\r\n)/,o));for(t+=e.join(",")+"\r\n",u=0,r=-1,i=0;i<t.length;++i,++u)u>65&&r!==-1?(f=t[r],f===","?(++r,t=t.substr(0,r)+"\r\n "+t.substr(r)):t=t.substr(0,r)+"\r\n"+f+t.substr(r+1),u=i-r-1,r=-1,++i):(t[i]===" "||t[i]==="\t"||t[i]===",")&&(r=i);return t}function r(n){return n.replace(/^\s+/,"")}var i=n.pem=n.pem||{};i.encode=function(i,r){var u,f,e;if(r=r||{},u="-----BEGIN "+i.type+"-----\r\n",i.procType&&(f={name:"Proc-Type",values:[String(i.procType.version),i.procType.type]},u+=t(f)),i.contentDomain&&(f={name:"Content-Domain",values:[i.contentDomain]},u+=t(f)),i.dekInfo&&(f={name:"DEK-Info",values:[i.dekInfo.algorithm]},i.dekInfo.parameters&&f.values.push(i.dekInfo.parameters),u+=t(f)),i.headers)for(e=0;e<i.headers.length;++e)u+=t(i.headers[e]);return i.procType&&(u+="\r\n"),u+=n.util.encode64(i.body,r.maxline||64)+"\r\n",u+="-----END "+i.type+"-----\r\n",u};i.decode=function(t){for(var l=[],y=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,i,u,s,o,a,h,v,f,e,c;;){if(i=y.exec(t),!i)break;if(u={type:i[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:n.util.decode64(i[3])},l.push(u),i[2]){for(s=i[2].split(/\r?\n/),o=0;i&&o<s.length;){for(a=s[o].replace(/\s+$/,""),h=o+1;h<s.length;++h){if(v=s[h],!/\s/.test(v[0]))break;a+=v;o=h}if(i=a.match(/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/),i){for(f={name:i[1],values:[]},e=i[2].split(","),c=0;c<e.length;++c)f.values.push(r(e[c]));if(u.procType)if(u.contentDomain||f.name!=="Content-Domain")if(u.dekInfo||f.name!=="DEK-Info")u.headers.push(f);else{if(f.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');u.dekInfo={algorithm:e[0],parameters:e[1]||null}}else u.contentDomain=e[0]||"";else{if(f.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(f.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');u.procType={version:e[0],type:e[1]}}}++o}if(u.procType==="ENCRYPTED"&&!u.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".');}}if(l.length===0)throw new Error("Invalid PEM formatted message.");return l}}var i="pem",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/pem",["require","module","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){function t(t,i){var r=function(){return new n.des.Algorithm(t,i)};n.cipher.registerAlgorithm(t,r)}function u(n){for(var i,t,u,e,o,l=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],a=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],v=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],y=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],p=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],w=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],b=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],k=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],d=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],g=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],nt=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],tt=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],it=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],rt=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],ut=n.length()>8?3:1,f=[],s=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],h=0,r,c=0;c<ut;c++)for(i=n.getInt32(),t=n.getInt32(),r=(i>>>4^t)&252645135,t^=r,i^=r<<4,r=(t>>>-16^i)&65535,i^=r,t^=r<<-16,r=(i>>>2^t)&858993459,t^=r,i^=r<<2,r=(t>>>-16^i)&65535,i^=r,t^=r<<-16,r=(i>>>1^t)&1431655765,t^=r,i^=r<<1,r=(t>>>8^i)&16711935,i^=r,t^=r<<8,r=(i>>>1^t)&1431655765,t^=r,i^=r<<1,r=i<<8|t>>>20&240,i=t<<24|t<<8&16711680|t>>>8&65280|t>>>24&240,t=r,u=0;u<s.length;++u)s[u]?(i=i<<2|i>>>26,t=t<<2|t>>>26):(i=i<<1|i>>>27,t=t<<1|t>>>27),i&=-15,t&=-15,e=l[i>>>28]|a[i>>>24&15]|v[i>>>20&15]|y[i>>>16&15]|p[i>>>12&15]|w[i>>>8&15]|b[i>>>4&15],o=k[t>>>28]|d[t>>>24&15]|g[t>>>20&15]|nt[t>>>16&15]|tt[t>>>12&15]|it[t>>>8&15]|rt[t>>>4&15],r=(o>>>16^e)&65535,f[h++]=e^r,f[h++]=o^r<<16;return f}function r(n,t,i,r){var g=n.length===32?3:9,d,v,y,u,p,nt,tt,w,b,k;for(d=g===3?r?[30,-2,-2]:[0,32,2]:r?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2],y=t[0],u=t[1],v=(y>>>4^u)&252645135,u^=v,y^=v<<4,v=(y>>>16^u)&65535,u^=v,y^=v<<16,v=(u>>>2^y)&858993459,y^=v,u^=v<<2,v=(u>>>8^y)&16711935,y^=v,u^=v<<8,v=(y>>>1^u)&1431655765,u^=v,y^=v<<1,y=y<<1|y>>>31,u=u<<1|u>>>31,p=0;p<g;p+=3){for(nt=d[p+1],tt=d[p+2],w=d[p];w!=nt;w+=tt)b=u^n[w],k=(u>>>4|u<<28)^n[w+1],v=y,y=u,u=v^(e[b>>>24&63]|s[b>>>16&63]|c[b>>>8&63]|a[b&63]|f[k>>>24&63]|o[k>>>16&63]|h[k>>>8&63]|l[k&63]);v=y;y=u;u=v}y=y>>>1|y<<31;u=u>>>1|u<<31;v=(y>>>1^u)&1431655765;u^=v;y^=v<<1;v=(u>>>8^y)&16711935;y^=v;u^=v<<8;v=(u>>>2^y)&858993459;y^=v;u^=v<<2;v=(y>>>16^u)&65535;u^=v;y^=v<<16;v=(y>>>4^u)&252645135;u^=v;y^=v<<4;i[0]=y;i[1]=u}function i(t){var u,r,i,f;return t=t||{},u=(t.mode||"CBC").toUpperCase(),r="DES-"+u,i=t.decrypt?n.cipher.createDecipher(r,t.key):n.cipher.createCipher(r,t.key),f=i.start,i.start=function(t,r){var u=null;r instanceof n.util.ByteBuffer&&(u=r,r={});r=r||{};r.output=u;r.iv=t;f.call(i,r)},i}n.des=n.des||{};n.des.startEncrypting=function(n,t,r,u){var f=i({key:n,output:r,decrypt:!1,mode:u||(t===null?"ECB":"CBC")});return f.start(t),f};n.des.createEncryptionCipher=function(n,t){return i({key:n,output:null,decrypt:!1,mode:t})};n.des.startDecrypting=function(n,t,r,u){var f=i({key:n,output:r,decrypt:!0,mode:u||(t===null?"ECB":"CBC")});return f.start(t),f};n.des.createDecryptionCipher=function(n,t){return i({key:n,output:null,decrypt:!0,mode:t})};n.des.Algorithm=function(n,t){var i=this;i.name=n;i.mode=new t({blockSize:8,cipher:{encrypt:function(n,t){return r(i._keys,n,t,!1)},decrypt:function(n,t){return r(i._keys,n,t,!0)}}});i._init=!1};n.des.Algorithm.prototype.initialize=function(t){if(!this._init){var i=n.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&i.length()!==24)throw new Error("Invalid Triple-DES key size: "+i.length()*8);this._keys=u(i);this._init=!0}};t("DES-ECB",n.cipher.modes.ecb);t("DES-CBC",n.cipher.modes.cbc);t("DES-CFB",n.cipher.modes.cfb);t("DES-OFB",n.cipher.modes.ofb);t("DES-CTR",n.cipher.modes.ctr);t("3DES-ECB",n.cipher.modes.ecb);t("3DES-CBC",n.cipher.modes.cbc);t("3DES-CFB",n.cipher.modes.cfb);t("3DES-OFB",n.cipher.modes.ofb);t("3DES-CTR",n.cipher.modes.ctr);var f=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],e=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],o=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],s=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],h=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],c=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],l=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],a=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696]}var i="des",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/des",["require","module","./cipher","./cipherModes","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){var t=n.pkcs5=n.pkcs5||{};n.pbkdf2=t.pbkdf2=function(t,i,r,u,f,e){function b(){if(h>y)return e(null,p);o.start(null,null);o.update(i);o.update(n.util.int32ToBytes(h));s=a=o.digest().getBytes();v=2;k()}function k(){if(v<=r)return o.start(null,null),o.update(a),l=o.digest().getBytes(),s=n.util.xorBytes(s,l,c),a=l,++v,n.util.setImmediate(k);p+=h<y?s:s.substr(0,d);++h;b()}var c,w,p,s,l,a,h,v;if(typeof f=="function"&&(e=f,f=null),(typeof f=="undefined"||f===null)&&(f=n.md.sha1.create()),c=f.digestLength,u>4294967295*c){if(w=new Error("Derived key is too long."),e)return e(w);throw w;}var y=Math.ceil(u/c),d=u-(y-1)*c,o=n.hmac.create();if(o.start(f,t),p="",!e){for(h=1;h<=y;++h){for(o.start(null,null),o.update(i),o.update(n.util.int32ToBytes(h)),s=a=o.digest().getBytes(),v=2;v<=r;++v)o.start(null,null),o.update(a),l=o.digest().getBytes(),s=n.util.xorBytes(s,l,c),a=l;p+=h<y?s:s.substr(0,d)}return p}h=1;b()}}var i="pbkdf2",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/pbkdf2",["require","module","./hmac","./md","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){var u=typeof process!="undefined"&&process.versions&&process.versions.node,i=null,r;n.disableNativeCode||!u||process.versions["node-webkit"]||(i=t("crypto"));r=n.prng=n.prng||{};r.create=function(t){function s(n){if(r.pools[0].messageLength>=32)return u(),n();var t=32-r.pools[0].messageLength<<5;r.seedFile(t,function(t,i){if(t)return n(t);r.collect(i);u();n()})}function h(){if(r.pools[0].messageLength>=32)return u();var n=32-r.pools[0].messageLength<<5;r.collect(r.seedFileSync(n));u()}function u(){var n=r.plugin.md.create(),t,i,u,f;for(n.update(r.pools[0].digest().getBytes()),r.pools[0].start(),t=1,i=1;i<32;++i)t=t===31?2147483648:t<<2,t%r.reseeds==0&&(n.update(r.pools[i].digest().getBytes()),r.pools[i].start());u=n.digest().getBytes();n.start();n.update(u);f=n.digest().getBytes();r.key=r.plugin.formatKey(u);r.seed=r.plugin.formatSeed(f);r.reseeds=r.reseeds===4294967295?0:r.reseeds+1;r.generated=0}function e(t){var s=null,e,i,l,o,h,u,c,f,r;if(typeof window!="undefined"&&(e=window.crypto||window.msCrypto,e&&e.getRandomValues&&(s=function(n){return e.getRandomValues(n)})),i=n.util.createBuffer(),s)while(i.length()<t){l=Math.max(1,Math.min(t-i.length(),65536)/4);o=new Uint32Array(Math.floor(l));try{for(s(o),r=0;r<o.length;++r)i.putInt32(o[r])}catch(a){if(!(typeof QuotaExceededError!="undefined"&&a instanceof QuotaExceededError))throw a;}}if(i.length()<t)for(f=Math.floor(Math.random()*65536);i.length()<t;)for(u=16807*(f&65535),h=16807*(f>>16),u+=(h&32767)<<16,u+=h>>15,u=(u&2147483647)+(u>>31),f=u&4294967295,r=0;r<3;++r)c=f>>>(r<<3),c^=Math.floor(Math.random()*256),i.putByte(String.fromCharCode(c&255));return i.getBytes(t)}for(var r={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0},c=t.md,o=new Array(32),f=0;f<32;++f)o[f]=c.create();return r.pools=o,r.pool=0,r.generate=function(t,i){function u(l){if(l)return i(l);if(e.length()>=t)return i(null,e.getBytes(t));if(r.generated>1048575&&(r.key=null),r.key===null)return n.util.nextTick(function(){s(u)});var a=f(r.key,r.seed);r.generated+=a.length;e.putBytes(a);r.key=h(f(r.key,o(r.seed)));r.seed=c(f(r.key,r.seed));n.util.setImmediate(u)}if(!i)return r.generateSync(t);var f=r.plugin.cipher,o=r.plugin.increment,h=r.plugin.formatKey,c=r.plugin.formatSeed,e=n.util.createBuffer();r.key=null;u()},r.generateSync=function(t){var u=r.plugin.cipher,e=r.plugin.increment,o=r.plugin.formatKey,s=r.plugin.formatSeed,i,f;for(r.key=null,i=n.util.createBuffer();i.length()<t;)r.generated>1048575&&(r.key=null),r.key===null&&h(),f=u(r.key,r.seed),r.generated+=f.length,i.putBytes(f),r.key=o(u(r.key,e(r.seed))),r.seed=s(u(r.key,r.seed));return i.getBytes(t)},i?(r.seedFile=function(n,t){i.randomBytes(n,function(n,i){if(n)return t(n);t(null,i.toString())})},r.seedFileSync=function(n){return i.randomBytes(n).toString()}):(r.seedFile=function(n,t){try{t(null,e(n))}catch(i){t(i)}},r.seedFileSync=e),r.collect=function(n){for(var i=n.length,t=0;t<i;++t)r.pools[r.pool].update(n.substr(t,1)),r.pool=r.pool===31?0:r.pool+1},r.collectInt=function(n,t){for(var u="",i=0;i<t;i+=8)u+=String.fromCharCode(n>>i&255);r.collect(u)},r.registerWorker=function(n){if(n===self)r.seedFile=function(n,t){function i(n){var r=n.data;r.forge&&r.forge.prng&&(self.removeEventListener("message",i),t(r.forge.prng.err,r.forge.prng.bytes))}self.addEventListener("message",i);self.postMessage({forge:{prng:{needed:n}}})};else{var t=function(t){var i=t.data;i.forge&&i.forge.prng&&r.seedFile(i.forge.prng.needed,function(t,i){n.postMessage({forge:{prng:{err:t,bytes:i}}})})};n.addEventListener("message",t)}},r}}var i="prng",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/prng",["require","module","./md","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){n.random&&n.random.getBytes||function(t){function h(){var t=n.prng.create(r);return t.getBytes=function(n,i){return t.generate(n,i)},t.getBytesSync=function(n){return t.generate(n)},t}var r={},f=new Array(4),e=n.util.createBuffer(),o,s,u;r.formatKey=function(t){var i=n.util.createBuffer(t);return t=new Array(4),t[0]=i.getInt32(),t[1]=i.getInt32(),t[2]=i.getInt32(),t[3]=i.getInt32(),n.aes._expandKey(t,!1)};r.formatSeed=function(t){var i=n.util.createBuffer(t);return t=new Array(4),t[0]=i.getInt32(),t[1]=i.getInt32(),t[2]=i.getInt32(),t[3]=i.getInt32(),t};r.cipher=function(t,i){return n.aes._updateBlock(t,i,f,!1),e.putInt32(f[0]),e.putInt32(f[1]),e.putInt32(f[2]),e.putInt32(f[3]),e.getBytes()};r.increment=function(n){return++n[3],n};r.md=n.md.sha256;var i=h(),l=typeof process!="undefined"&&process.versions&&process.versions.node,c=null;if(typeof window!="undefined"&&(o=window.crypto||window.msCrypto,o&&o.getRandomValues&&(c=function(n){return o.getRandomValues(n)})),n.disableNativeCode||!l&&!c){if(typeof window=="undefined"||window.document===undefined,i.collectInt(+new Date,32),typeof navigator!="undefined"){s="";for(u in navigator)try{typeof navigator[u]=="string"&&(s+=navigator[u])}catch(a){}i.collect(s);s=null}t&&(t().mousemove(function(n){i.collectInt(n.clientX,16);i.collectInt(n.clientY,16)}),t().keypress(function(n){i.collectInt(n.charCode,8)}))}if(n.random)for(u in i)n.random[u]=i[u];else n.random=i;n.random.createInstance=h}(typeof jQuery!="undefined"?jQuery:null)}var i="random",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/random",["require","module","./aes","./md","./prng","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){var t=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],r=[1,2,3,5],u=function(n,t){return n<<t&65535|(n&65535)>>16-t},f=function(n,t){return(n&65535)>>t|n<<16-t&65535},i;n.rc2=n.rc2||{};n.rc2.expandKey=function(i,r){typeof i=="string"&&(i=n.util.createBuffer(i));r=r||128;for(var f=i,o=i.length(),s=r,e=Math.ceil(s/8),h=255>>(s&7),u=o;u<128;u++)f.putByte(t[f.at(u-1)+f.at(u-o)&255]);for(f.setAt(128-e,t[f.at(128-e)&h]),u=127-e;u>=0;u--)f.setAt(u,t[f.at(u+1)^f.at(u+e)]);return f};i=function(t,i,e){var w=!1,s=null,h=null,c=null,l,p,o,a,v=[],b,y;for(t=n.rc2.expandKey(t,i),o=0;o<64;o++)v.push(t.getInt16Le());return e?(l=function(n){for(o=0;o<4;o++)n[o]+=v[a]+(n[(o+3)%4]&n[(o+2)%4])+(~n[(o+3)%4]&n[(o+1)%4]),n[o]=u(n[o],r[o]),a++},p=function(n){for(o=0;o<4;o++)n[o]+=v[n[(o+3)%4]&63]}):(l=function(n){for(o=3;o>=0;o--)n[o]=f(n[o],r[o]),n[o]-=v[a]+(n[(o+3)%4]&n[(o+2)%4])+(~n[(o+3)%4]&n[(o+1)%4]),a--},p=function(n){for(o=3;o>=0;o--)n[o]-=v[n[(o+3)%4]&63]}),b=function(n){var t=[],r,i,u;for(o=0;o<4;o++)r=s.getInt16Le(),c!==null&&(e?r^=c.getInt16Le():c.putInt16Le(r)),t.push(r&65535);for(a=e?0:63,i=0;i<n.length;i++)for(u=0;u<n[i][0];u++)n[i][1](t);for(o=0;o<4;o++)c!==null&&(e?c.putInt16Le(t[o]):t[o]^=c.getInt16Le()),h.putInt16Le(t[o])},y=null,y={start:function(t,i){t&&typeof t=="string"&&(t=n.util.createBuffer(t));w=!1;s=n.util.createBuffer();h=i||new n.util.createBuffer;c=t;y.output=h},update:function(n){for(w||s.putBuffer(n);s.length()>=8;)b([[5,l],[1,p],[6,l],[1,p],[5,l]])},finish:function(n){var t=!0,i,r,u;return e&&(n?t=n(8,s,!e):(i=s.length()===8?8:8-s.length(),s.fillWithByte(i,i))),t&&(w=!0,y.update()),e||(t=s.length()===0,t&&(n?t=n(8,h,!e):(r=h.length(),u=h.at(r-1),u>r?t=!1:h.truncate(u)))),t}},y};n.rc2.startEncrypting=function(t,i,r){var u=n.rc2.createEncryptionCipher(t,128);return u.start(i,r),u};n.rc2.createEncryptionCipher=function(n,t){return i(n,t,!0)};n.rc2.startDecrypting=function(t,i,r){var u=n.rc2.createDecryptionCipher(t,128);return u.start(i,r),u};n.rc2.createDecryptionCipher=function(n,t){return i(n,t,!1)}}var i="rc2",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/rc2",["require","module","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){function t(n,t,i){this.data=[];n!=null&&("number"==typeof n?this.fromNumber(n,t,i):t==null&&"string"!=typeof n?this.fromString(n,256):this.fromString(n,t))}function i(){return new t(null)}function ut(n,t,i,r,u,f){while(--f>=0){var e=t*this.data[n++]+i.data[r]+u;u=Math.floor(e/67108864);i.data[r++]=e&67108863}return u}function ft(n,t,i,r,u,f){for(var o=t&32767,s=t>>15;--f>=0;){var e=this.data[n]&32767,h=this.data[n++]>>15,c=s*e+h*o;e=o*e+((c&32767)<<15)+i.data[r]+(u&1073741823);u=(e>>>30)+(c>>>15)+s*h+(u>>>30);i.data[r++]=e&1073741823}return u}function w(n,t,i,r,u,f){for(var o=t&16383,s=t>>14;--f>=0;){var e=this.data[n]&16383,h=this.data[n++]>>14,c=s*e+h*o;e=o*e+((c&16383)<<14)+i.data[r]+u;u=(e>>28)+(c>>14)+s*h;i.data[r++]=e&268435455}return u}function b(n){return it.charAt(n)}function k(n,t){var i=a[n.charCodeAt(t)];return i==null?-1:i}function et(n){for(var t=this.t-1;t>=0;--t)n.data[t]=this.data[t];n.t=this.t;n.s=this.s}function ot(n){this.t=1;this.s=n<0?-1:0;n>0?this.data[0]=n:n<-1?this.data[0]=n+this.DV:this.t=0}function e(n){var t=i();return t.fromInt(n),t}function st(n,i){var u,f;if(i==16)u=4;else if(i==8)u=3;else if(i==256)u=8;else if(i==2)u=1;else if(i==32)u=5;else{if(i!=4){this.fromRadix(n,i);return}u=2}this.t=0;this.s=0;for(var e=n.length,o=!1,r=0;--e>=0;){if(f=u==8?n[e]&255:k(n,e),f<0){n.charAt(e)=="-"&&(o=!0);continue}o=!1;r==0?this.data[this.t++]=f:r+u>this.DB?(this.data[this.t-1]|=(f&(1<<this.DB-r)-1)<<r,this.data[this.t++]=f>>this.DB-r):this.data[this.t-1]|=f<<r;r+=u;r>=this.DB&&(r-=this.DB)}u==8&&(n[0]&128)!=0&&(this.s=-1,r>0&&(this.data[this.t-1]|=(1<<this.DB-r)-1<<r));this.clamp();o&&t.ZERO.subTo(this,this)}function ht(){for(var n=this.s&this.DM;this.t>0&&this.data[this.t-1]==n;)--this.t}function ct(n){var t;if(this.s<0)return"-"+this.negate().toString(n);if(n==16)t=4;else if(n==8)t=3;else if(n==2)t=1;else if(n==32)t=5;else{if(n!=4)return this.toRadix(n);t=2}var o=(1<<t)-1,u,f=!1,e="",r=this.t,i=this.DB-r*this.DB%t;if(r-->0)for(i<this.DB&&(u=this.data[r]>>i)>0&&(f=!0,e=b(u));r>=0;)i<t?(u=(this.data[r]&(1<<i)-1)<<t-i,u|=this.data[--r]>>(i+=this.DB-t)):(u=this.data[r]>>(i-=t)&o,i<=0&&(i+=this.DB,--r)),u>0&&(f=!0),f&&(e+=b(u));return f?e:"0"}function lt(){var n=i();return t.ZERO.subTo(this,n),n}function at(){return this.s<0?this.negate():this}function vt(n){var t=this.s-n.s,i;if(t!=0)return t;if(i=this.t,t=i-n.t,t!=0)return this.s<0?-t:t;while(--i>=0)if((t=this.data[i]-n.data[i])!=0)return t;return 0}function v(n){var i=1,t;return(t=n>>>16)!=0&&(n=t,i+=16),(t=n>>8)!=0&&(n=t,i+=8),(t=n>>4)!=0&&(n=t,i+=4),(t=n>>2)!=0&&(n=t,i+=2),(t=n>>1)!=0&&(n=t,i+=1),i}function yt(){return this.t<=0?0:this.DB*(this.t-1)+v(this.data[this.t-1]^this.s&this.DM)}function pt(n,t){for(var i=this.t-1;i>=0;--i)t.data[i+n]=this.data[i];for(i=n-1;i>=0;--i)t.data[i]=0;t.t=this.t+n;t.s=this.s}function wt(n,t){for(var i=n;i<this.t;++i)t.data[i-n]=this.data[i];t.t=Math.max(this.t-n,0);t.s=this.s}function bt(n,t){for(var u=n%this.DB,e=this.DB-u,o=(1<<e)-1,r=Math.floor(n/this.DB),f=this.s<<u&this.DM,i=this.t-1;i>=0;--i)t.data[i+r+1]=this.data[i]>>e|f,f=(this.data[i]&o)<<u;for(i=r-1;i>=0;--i)t.data[i]=0;t.data[r]=f;t.t=this.t+r+1;t.s=this.s;t.clamp()}function kt(n,t){var i,r;if(t.s=this.s,i=Math.floor(n/this.DB),i>=this.t){t.t=0;return}var u=n%this.DB,f=this.DB-u,e=(1<<u)-1;for(t.data[0]=this.data[i]>>u,r=i+1;r<this.t;++r)t.data[r-i-1]|=(this.data[r]&e)<<f,t.data[r-i]=this.data[r]>>u;u>0&&(t.data[this.t-i-1]|=(this.s&e)<<f);t.t=this.t-i;t.clamp()}function dt(n,t){for(var r=0,i=0,u=Math.min(n.t,this.t);r<u;)i+=this.data[r]-n.data[r],t.data[r++]=i&this.DM,i>>=this.DB;if(n.t<this.t){for(i-=n.s;r<this.t;)i+=this.data[r],t.data[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<n.t;)i-=n.data[r],t.data[r++]=i&this.DM,i>>=this.DB;i-=n.s}t.s=i<0?-1:0;i<-1?t.data[r++]=this.DV+i:i>0&&(t.data[r++]=i);t.t=r;t.clamp()}function gt(n,i){var u=this.abs(),f=n.abs(),r=u.t;for(i.t=r+f.t;--r>=0;)i.data[r]=0;for(r=0;r<f.t;++r)i.data[r+u.t]=u.am(0,f.data[r],i,r,0,u.t);i.s=0;i.clamp();this.s!=n.s&&t.ZERO.subTo(i,i)}function ni(n){for(var i=this.abs(),t=n.t=2*i.t,r;--t>=0;)n.data[t]=0;for(t=0;t<i.t-1;++t)r=i.am(t,i.data[t],n,2*t,0,1),(n.data[t+i.t]+=i.am(t+1,2*i.data[t],n,2*t+1,r,i.t-t-1))>=i.DV&&(n.data[t+i.t]-=i.DV,n.data[t+i.t+1]=1);n.t>0&&(n.data[n.t-1]+=i.am(t,i.data[t],n,2*t,0,1));n.s=0;n.clamp()}function ti(n,r,u){var s=n.abs(),l,e,a,p;if(!(s.t<=0)){if(l=this.abs(),l.t<s.t){r!=null&&r.fromInt(0);u!=null&&this.copyTo(u);return}u==null&&(u=i());var f=i(),w=this.s,k=n.s,c=this.DB-v(s.data[s.t-1]);if(c>0?(s.lShiftTo(c,f),l.lShiftTo(c,u)):(s.copyTo(f),l.copyTo(u)),e=f.t,a=f.data[e-1],a!=0){var b=a*(1<<this.F1)+(e>1?f.data[e-2]>>this.F2:0),d=this.FV/b,g=(1<<this.F1)/b,nt=1<<this.F2,h=u.t,y=h-e,o=r==null?i():r;for(f.dlShiftTo(y,o),u.compareTo(o)>=0&&(u.data[u.t++]=1,u.subTo(o,u)),t.ONE.dlShiftTo(e,o),o.subTo(f,f);f.t<e;)f.data[f.t++]=0;while(--y>=0)if(p=u.data[--h]==a?this.DM:Math.floor(u.data[h]*d+(u.data[h-1]+nt)*g),(u.data[h]+=f.am(0,p,u,y,0,e))<p)for(f.dlShiftTo(y,o),u.subTo(o,u);u.data[h]<--p;)u.subTo(o,u);r!=null&&(u.drShiftTo(e,r),w!=k&&t.ZERO.subTo(r,r));u.t=e;u.clamp();c>0&&u.rShiftTo(c,u);w<0&&t.ZERO.subTo(u,u)}}}function ii(n){var r=i();return this.abs().divRemTo(n,null,r),this.s<0&&r.compareTo(t.ZERO)>0&&n.subTo(r,r),r}function o(n){this.m=n}function ri(n){return n.s<0||n.compareTo(this.m)>=0?n.mod(this.m):n}function ui(n){return n}function fi(n){n.divRemTo(this.m,null,n)}function ei(n,t,i){n.multiplyTo(t,i);this.reduce(i)}function oi(n,t){n.squareTo(t);this.reduce(t)}function si(){var t,n;return this.t<1?0:(t=this.data[0],(t&1)==0)?0:(n=t&3,n=n*(2-(t&15)*n)&15,n=n*(2-(t&255)*n)&255,n=n*(2-((t&65535)*n&65535))&65535,n=n*(2-t*n%this.DV)%this.DV,n>0?this.DV-n:-n)}function s(n){this.m=n;this.mp=n.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<n.DB-15)-1;this.mt2=2*n.t}function hi(n){var r=i();return n.abs().dlShiftTo(this.m.t,r),r.divRemTo(this.m,null,r),n.s<0&&r.compareTo(t.ZERO)>0&&this.m.subTo(r,r),r}function ci(n){var t=i();return n.copyTo(t),this.reduce(t),t}function li(n){for(var i,t,r;n.t<=this.mt2;)n.data[n.t++]=0;for(i=0;i<this.m.t;++i)for(t=n.data[i]&32767,r=t*this.mpl+((t*this.mph+(n.data[i]>>15)*this.mpl&this.um)<<15)&n.DM,t=i+this.m.t,n.data[t]+=this.m.am(0,r,n,i,0,this.m.t);n.data[t]>=n.DV;)n.data[t]-=n.DV,n.data[++t]++;n.clamp();n.drShiftTo(this.m.t,n);n.compareTo(this.m)>=0&&n.subTo(this.m,n)}function ai(n,t){n.squareTo(t);this.reduce(t)}function vi(n,t,i){n.multiplyTo(t,i);this.reduce(i)}function yi(){return(this.t>0?this.data[0]&1:this.s)==0}function pi(n,r){var s;if(n>4294967295||n<1)return t.ONE;var u=i(),f=i(),e=r.convert(this),o=v(n)-1;for(e.copyTo(u);--o>=0;)r.sqrTo(u,f),(n&1<<o)>0?r.mulTo(f,e,u):(s=u,u=f,f=s);return r.revert(u)}function wi(n,t){var i;return i=n<256||t.isEven()?new o(t):new s(t),this.exp(n,i)}function bi(){var n=i();return this.copyTo(n),n}function ki(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function di(){return this.t==0?this.s:this.data[0]<<24>>24}function gi(){return this.t==0?this.s:this.data[0]<<16>>16}function nr(n){return Math.floor(Math.LN2*this.DB/Math.log(n))}function tr(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function ir(n){if(n==null&&(n=10),this.signum()==0||n<2||n>36)return"0";var s=this.chunkSize(n),f=Math.pow(n,s),o=e(f),t=i(),r=i(),u="";for(this.divRemTo(o,t,r);t.signum()>0;)u=(f+r.intValue()).toString(n).substr(1)+u,t.divRemTo(o,t,r);return r.intValue().toString(n)+u}function rr(n,i){var u,e;this.fromInt(0);i==null&&(i=10);var o=this.chunkSize(i),h=Math.pow(i,o),s=!1,f=0,r=0;for(u=0;u<n.length;++u){if(e=k(n,u),e<0){n.charAt(u)=="-"&&this.signum()==0&&(s=!0);continue}r=i*r+e;++f>=o&&(this.dMultiply(h),this.dAddOffset(r,0),f=0,r=0)}f>0&&(this.dMultiply(Math.pow(i,f)),this.dAddOffset(r,0));s&&t.ZERO.subTo(this,this)}function ur(n,i,r){if("number"==typeof i)if(n<2)this.fromInt(1);else for(this.fromNumber(n,r),this.testBit(n-1)||this.bitwiseTo(t.ONE.shiftLeft(n-1),p,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(i);)this.dAddOffset(2,0),this.bitLength()>n&&this.subTo(t.ONE.shiftLeft(n-1),this);else{var u=[],f=n&7;u.length=(n>>3)+1;i.nextBytes(u);f>0?u[0]&=(1<<f)-1:u[0]=0;this.fromString(u,256)}}function fr(){var i=this.t,u=[],n,t,r;if(u[0]=this.s,n=this.DB-i*this.DB%8,r=0,i-->0)for(n<this.DB&&(t=this.data[i]>>n)!=(this.s&this.DM)>>n&&(u[r++]=t|this.s<<this.DB-n);i>=0;)n<8?(t=(this.data[i]&(1<<n)-1)<<8-n,t|=this.data[--i]>>(n+=this.DB-8)):(t=this.data[i]>>(n-=8)&255,n<=0&&(n+=this.DB,--i)),(t&128)!=0&&(t|=-256),r==0&&(this.s&128)!=(t&128)&&++r,(r>0||t!=this.s)&&(u[r++]=t);return u}function er(n){return this.compareTo(n)==0}function or(n){return this.compareTo(n)<0?this:n}function sr(n){return this.compareTo(n)>0?this:n}function hr(n,t,i){for(var u,f=Math.min(n.t,this.t),r=0;r<f;++r)i.data[r]=t(this.data[r],n.data[r]);if(n.t<this.t){for(u=n.s&this.DM,r=f;r<this.t;++r)i.data[r]=t(this.data[r],u);i.t=this.t}else{for(u=this.s&this.DM,r=f;r<n.t;++r)i.data[r]=t(u,n.data[r]);i.t=n.t}i.s=t(this.s,n.s);i.clamp()}function cr(n,t){return n&t}function lr(n){var t=i();return this.bitwiseTo(n,cr,t),t}function p(n,t){return n|t}function ar(n){var t=i();return this.bitwiseTo(n,p,t),t}function d(n,t){return n^t}function vr(n){var t=i();return this.bitwiseTo(n,d,t),t}function g(n,t){return n&~t}function yr(n){var t=i();return this.bitwiseTo(n,g,t),t}function pr(){for(var n=i(),t=0;t<this.t;++t)n.data[t]=this.DM&~this.data[t];return n.t=this.t,n.s=~this.s,n}function wr(n){var t=i();return n<0?this.rShiftTo(-n,t):this.lShiftTo(n,t),t}function br(n){var t=i();return n<0?this.lShiftTo(-n,t):this.rShiftTo(n,t),t}function kr(n){if(n==0)return-1;var t=0;return(n&65535)==0&&(n>>=16,t+=16),(n&255)==0&&(n>>=8,t+=8),(n&15)==0&&(n>>=4,t+=4),(n&3)==0&&(n>>=2,t+=2),(n&1)==0&&++t,t}function dr(){for(var n=0;n<this.t;++n)if(this.data[n]!=0)return n*this.DB+kr(this.data[n]);return this.s<0?this.t*this.DB:-1}function gr(n){for(var t=0;n!=0;)n&=n-1,++t;return t}function nu(){for(var t=0,i=this.s&this.DM,n=0;n<this.t;++n)t+=gr(this.data[n]^i);return t}function tu(n){var t=Math.floor(n/this.DB);return t>=this.t?this.s!=0:(this.data[t]&1<<n%this.DB)!=0}function iu(n,i){var r=t.ONE.shiftLeft(n);return this.bitwiseTo(r,i,r),r}function ru(n){return this.changeBit(n,p)}function uu(n){return this.changeBit(n,g)}function fu(n){return this.changeBit(n,d)}function eu(n,t){for(var r=0,i=0,u=Math.min(n.t,this.t);r<u;)i+=this.data[r]+n.data[r],t.data[r++]=i&this.DM,i>>=this.DB;if(n.t<this.t){for(i+=n.s;r<this.t;)i+=this.data[r],t.data[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<n.t;)i+=n.data[r],t.data[r++]=i&this.DM,i>>=this.DB;i+=n.s}t.s=i<0?-1:0;i>0?t.data[r++]=i:i<-1&&(t.data[r++]=this.DV+i);t.t=r;t.clamp()}function ou(n){var t=i();return this.addTo(n,t),t}function su(n){var t=i();return this.subTo(n,t),t}function hu(n){var t=i();return this.multiplyTo(n,t),t}function cu(n){var t=i();return this.divRemTo(n,t,null),t}function lu(n){var t=i();return this.divRemTo(n,null,t),t}function au(n){var t=i(),r=i();return this.divRemTo(n,t,r),[t,r]}function vu(n){this.data[this.t]=this.am(0,n-1,this,0,0,this.t);++this.t;this.clamp()}function yu(n,t){if(n!=0){while(this.t<=t)this.data[this.t++]=0;for(this.data[t]+=n;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}function l(){}function nt(n){return n}function pu(n,t,i){n.multiplyTo(t,i)}function wu(n,t){n.squareTo(t)}function bu(n){return this.exp(n,new l)}function ku(n,t,i){var r=Math.min(this.t+n.t,t),u;for(i.s=0,i.t=r;r>0;)i.data[--r]=0;for(u=i.t-this.t;r<u;++r)i.data[r+this.t]=this.am(0,n.data[r],i,r,0,this.t);for(u=Math.min(n.t,t);r<u;++r)this.am(0,n.data[r],i,r,0,t-r);i.clamp()}function du(n,t,i){--t;var r=i.t=this.t+n.t-t;for(i.s=0;--r>=0;)i.data[r]=0;for(r=Math.max(t-this.t,0);r<n.t;++r)i.data[this.t+r-t]=this.am(t-r,n.data[r],i,0,0,this.t+r-t);i.clamp();i.drShiftTo(1,i)}function h(n){this.r2=i();this.q3=i();t.ONE.dlShiftTo(2*n.t,this.r2);this.mu=this.r2.divide(n);this.m=n}function gu(n){if(n.s<0||n.t>2*this.m.t)return n.mod(this.m);if(n.compareTo(this.m)<0)return n;var t=i();return n.copyTo(t),this.reduce(t),t}function nf(n){return n}function tf(n){for(n.drShiftTo(this.m.t-1,this.r2),n.t>this.m.t+1&&(n.t=this.m.t+1,n.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);n.compareTo(this.r2)<0;)n.dAddOffset(1,this.m.t+1);for(n.subTo(this.r2,n);n.compareTo(this.m)>=0;)n.subTo(this.m,n)}function rf(n,t){n.squareTo(t);this.reduce(t)}function uf(n,t,i){n.multiplyTo(t,i);this.reduce(i)}function ff(n,t){var r=n.bitLength(),w,u=e(1),c,d;if(r<=0)return u;w=r<18?1:r<48?3:r<144?4:r<768?5:6;c=r<8?new o(t):t.isEven()?new h(t):new s(t);var y=[],f=3,b=w-1,g=(1<<w)-1;if(y[1]=c.convert(this),w>1)for(d=i(),c.sqrTo(y[1],d);f<=g;)y[f]=i(),c.mulTo(d,y[f-2],y[f]),f+=2;var l=n.t-1,p,nt=!0,a=i(),k;for(r=v(n.data[l])-1;l>=0;){for(r>=b?p=n.data[l]>>r-b&g:(p=(n.data[l]&(1<<r+1)-1)<<b-r,l>0&&(p|=n.data[l-1]>>this.DB+r-b)),f=w;(p&1)==0;)p>>=1,--f;if((r-=f)<0&&(r+=this.DB,--l),nt)y[p].copyTo(u),nt=!1;else{while(f>1)c.sqrTo(u,a),c.sqrTo(a,u),f-=2;f>0?c.sqrTo(u,a):(k=u,u=a,a=k);c.mulTo(a,y[p],u)}while(l>=0&&(n.data[l]&1<<r)==0)c.sqrTo(u,a),k=u,u=a,a=k,--r<0&&(r=this.DB-1,--l)}return c.revert(u)}function ef(n){var i=this.s<0?this.negate():this.clone(),t=n.s<0?n.negate():n.clone(),f,u,r;if(i.compareTo(t)<0&&(f=i,i=t,t=f),u=i.getLowestSetBit(),r=t.getLowestSetBit(),r<0)return i;for(u<r&&(r=u),r>0&&(i.rShiftTo(r,i),t.rShiftTo(r,t));i.signum()>0;)(u=i.getLowestSetBit())>0&&i.rShiftTo(u,i),(u=t.getLowestSetBit())>0&&t.rShiftTo(u,t),i.compareTo(t)>=0?(i.subTo(t,i),i.rShiftTo(1,i)):(t.subTo(i,t),t.rShiftTo(1,t));return r>0&&t.lShiftTo(r,t),t}function of(n){var r,t,i;if(n<=0)return 0;if(r=this.DV%n,t=this.s<0?n-1:0,this.t>0)if(r==0)t=this.data[0]%n;else for(i=this.t-1;i>=0;--i)t=(r*t+this.data[i])%n;return t}function sf(n){var h=n.isEven();if(this.isEven()&&h||n.signum()==0)return t.ZERO;for(var u=n.clone(),f=this.clone(),o=e(1),r=e(0),s=e(0),i=e(1);u.signum()!=0;){while(u.isEven())u.rShiftTo(1,u),h?(o.isEven()&&r.isEven()||(o.addTo(this,o),r.subTo(n,r)),o.rShiftTo(1,o)):r.isEven()||r.subTo(n,r),r.rShiftTo(1,r);while(f.isEven())f.rShiftTo(1,f),h?(s.isEven()&&i.isEven()||(s.addTo(this,s),i.subTo(n,i)),s.rShiftTo(1,s)):i.isEven()||i.subTo(n,i),i.rShiftTo(1,i);u.compareTo(f)>=0?(u.subTo(f,u),h&&o.subTo(s,o),r.subTo(i,r)):(f.subTo(u,f),h&&s.subTo(o,s),i.subTo(r,i))}return f.compareTo(t.ONE)!=0?t.ZERO:i.compareTo(n)>=0?i.subtract(n):i.signum()<0?(i.addTo(n,i),i.signum()<0?i.add(n):i):i}function hf(n){var t,i=this.abs(),r,f;if(i.t==1&&i.data[0]<=u[u.length-1]){for(t=0;t<u.length;++t)if(i.data[0]==u[t])return!0;return!1}if(i.isEven())return!1;for(t=1;t<u.length;){for(r=u[t],f=t+1;f<u.length&&r<rt;)r*=u[f++];for(r=i.modInt(r);t<f;)if(r%u[t++]==0)return!1}return i.millerRabin(n)}function cf(n){var r=this.subtract(t.ONE),f=r.getLowestSetBit(),o,s,u,e,i,h;if(f<=0)return!1;for(o=r.shiftRight(f),s=lf(),e=0;e<n;++e){do u=new t(this.bitLength(),s);while(u.compareTo(t.ONE)<=0||u.compareTo(r)>=0);if(i=u.modPow(o,this),i.compareTo(t.ONE)!=0&&i.compareTo(r)!=0){for(h=1;h++<f&&i.compareTo(r)!=0;)if(i=i.modPowInt(2,this),i.compareTo(t.ONE)==0)return!1;if(i.compareTo(r)!=0)return!1}}return!0}function lf(){return{nextBytes:function(n){for(var t=0;t<n.length;++t)n[t]=Math.floor(Math.random()*255)}}}var f,tt=(0xdeadbeefcafe&16777215)==15715070,y,it,a,c,r,u,rt;for(typeof navigator=="undefined"?(t.prototype.am=w,f=28):tt&&navigator.appName=="Microsoft Internet Explorer"?(t.prototype.am=ft,f=30):tt&&navigator.appName!="Netscape"?(t.prototype.am=ut,f=26):(t.prototype.am=w,f=28),t.prototype.DB=f,t.prototype.DM=(1<<f)-1,t.prototype.DV=1<<f,y=52,t.prototype.FV=Math.pow(2,y),t.prototype.F1=y-f,t.prototype.F2=2*f-y,it="0123456789abcdefghijklmnopqrstuvwxyz",a=[],c="0".charCodeAt(0),r=0;r<=9;++r)a[c++]=r;for(c="a".charCodeAt(0),r=10;r<36;++r)a[c++]=r;for(c="A".charCodeAt(0),r=10;r<36;++r)a[c++]=r;o.prototype.convert=ri;o.prototype.revert=ui;o.prototype.reduce=fi;o.prototype.mulTo=ei;o.prototype.sqrTo=oi;s.prototype.convert=hi;s.prototype.revert=ci;s.prototype.reduce=li;s.prototype.mulTo=vi;s.prototype.sqrTo=ai;t.prototype.copyTo=et;t.prototype.fromInt=ot;t.prototype.fromString=st;t.prototype.clamp=ht;t.prototype.dlShiftTo=pt;t.prototype.drShiftTo=wt;t.prototype.lShiftTo=bt;t.prototype.rShiftTo=kt;t.prototype.subTo=dt;t.prototype.multiplyTo=gt;t.prototype.squareTo=ni;t.prototype.divRemTo=ti;t.prototype.invDigit=si;t.prototype.isEven=yi;t.prototype.exp=pi;t.prototype.toString=ct;t.prototype.negate=lt;t.prototype.abs=at;t.prototype.compareTo=vt;t.prototype.bitLength=yt;t.prototype.mod=ii;t.prototype.modPowInt=wi;t.ZERO=e(0);t.ONE=e(1);l.prototype.convert=nt;l.prototype.revert=nt;l.prototype.mulTo=pu;l.prototype.sqrTo=wu;h.prototype.convert=gu;h.prototype.revert=nf;h.prototype.reduce=tf;h.prototype.mulTo=uf;h.prototype.sqrTo=rf;u=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509];rt=67108864/u[u.length-1];t.prototype.chunkSize=nr;t.prototype.toRadix=ir;t.prototype.fromRadix=rr;t.prototype.fromNumber=ur;t.prototype.bitwiseTo=hr;t.prototype.changeBit=iu;t.prototype.addTo=eu;t.prototype.dMultiply=vu;t.prototype.dAddOffset=yu;t.prototype.multiplyLowerTo=ku;t.prototype.multiplyUpperTo=du;t.prototype.modInt=of;t.prototype.millerRabin=cf;t.prototype.clone=bi;t.prototype.intValue=ki;t.prototype.byteValue=di;t.prototype.shortValue=gi;t.prototype.signum=tr;t.prototype.toByteArray=fr;t.prototype.equals=er;t.prototype.min=or;t.prototype.max=sr;t.prototype.and=lr;t.prototype.or=ar;t.prototype.xor=vr;t.prototype.andNot=yr;t.prototype.not=pr;t.prototype.shiftLeft=wr;t.prototype.shiftRight=br;t.prototype.getLowestSetBit=dr;t.prototype.bitCount=nu;t.prototype.testBit=tu;t.prototype.setBit=ru;t.prototype.clearBit=uu;t.prototype.flipBit=fu;t.prototype.add=ou;t.prototype.subtract=su;t.prototype.multiply=hu;t.prototype.divide=cu;t.prototype.remainder=lu;t.prototype.divideAndRemainder=au;t.prototype.modPow=ff;t.prototype.modInverse=sf;t.prototype.pow=bu;t.prototype.gcd=ef;t.prototype.isProbablePrime=hf;n.jsbn=n.jsbn||{};n.jsbn.BigInteger=t}var i="jsbn",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/jsbn",["require","module"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){function t(t,i,r){var f,e,u,o;for(r||(r=n.md.sha1.create()),f="",e=Math.ceil(i/r.digestLength),u=0;u<e;++u)o=String.fromCharCode(u>>24&255,u>>16&255,u>>8&255,u&255),r.start(),r.update(t+o),f+=r.digest().getBytes();return f.substring(0,i)}var i=n.pkcs1=n.pkcs1||{};i.encode_rsa_oaep=function(i,r,u){var s,e,f,h,l,c,a,v,o;if(typeof u=="string"?(s=u,e=arguments[3]||undefined,f=arguments[4]||undefined):u&&(s=u.label||undefined,e=u.seed||undefined,f=u.md||undefined,u.mgf1&&u.mgf1.md&&(h=u.mgf1.md)),f?f.start():f=n.md.sha1.create(),h||(h=f),l=Math.ceil(i.n.bitLength()/8),c=l-2*f.digestLength-2,r.length>c){o=new Error("RSAES-OAEP input message length is too long.");throw o.length=r.length,o.maxLength=c,o;}s||(s="");f.update(s,"raw");var w=f.digest(),y="",b=c-r.length;for(a=0;a<b;a++)y+="\0";if(v=w.getBytes()+y+"\x01"+r,e){if(e.length!==f.digestLength){o=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw o.seedLength=e.length,o.digestLength=f.digestLength,o;}}else e=n.random.getBytes(f.digestLength);var k=t(e,l-f.digestLength-1,h),p=n.util.xorBytes(v,k,v.length),d=t(p,f.digestLength,h),g=n.util.xorBytes(e,d,e.length);return"\0"+g+p};i.decode_rsa_oaep=function(i,r,u){var o,f,s,h,e,l,a,v,y;if(typeof u=="string"?(o=u,f=arguments[3]||undefined):u&&(o=u.label||undefined,f=u.md||undefined,u.mgf1&&u.mgf1.md&&(s=u.mgf1.md)),h=Math.ceil(i.n.bitLength()/8),r.length!==h){e=new Error("RSAES-OAEP encoded message length is invalid.");throw e.length=r.length,e.expectedLength=h,e;}if(f===undefined?f=n.md.sha1.create():f.start(),s||(s=f),h<2*f.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");o||(o="");f.update(o,"raw");var k=f.digest().getBytes(),d=r.charAt(0),w=r.substring(1,f.digestLength+1),p=r.substring(1+f.digestLength),g=t(p,f.digestLength,s),nt=n.util.xorBytes(w,g,w.length),tt=t(nt,h-f.digestLength-1,s),c=n.util.xorBytes(p,tt,p.length),it=c.substring(0,f.digestLength),e=d!=="\0";for(l=0;l<f.digestLength;++l)e|=k.charAt(l)!==it.charAt(l);for(a=1,v=f.digestLength,y=f.digestLength;y<c.length;y++){var b=c.charCodeAt(y),rt=b&1^1,ut=a?65534:0;e|=b&ut;a&=rt;v+=a}if(e||c.charCodeAt(v)!==1)throw new Error("Invalid RSAES-OAEP padding.");return c.substring(v+1)}}var i="pkcs1",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/pkcs1",["require","module","./util","./random","./sha1"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){function e(n,t,i,u){return"workers"in i?o(n,t,i,u):r(n,t,i,u)}function r(i,u,f,e){var o=t(i,u),v=0,l=s(o.bitLength()),h,a;"millerRabinTests"in f&&(l=f.millerRabinTests);h=10;"maxBlockTime"in f&&(h=f.maxBlockTime);a=+new Date;do{if(o.bitLength()>i&&(o=t(i,u)),o.isProbablePrime(l))return e(null,o);o.dAddOffset(c[v++%8],0)}while(h<0||+new Date-a<h);n.util.setImmediate(function(){r(i,u,f,e)})}function o(u,f,e,o){function c(){function y(n){var v,s,y;if(!e){if(--c,v=n.data,v.found){for(s=0;s<r.length;++s)r[s].terminate();return e=!0,o(null,new i(v.prime,16))}h.bitLength()>u&&(h=t(u,f));y=h.toString(16);n.target.postMessage({hex:y,workLoad:l});h.dAddOffset(a,0)}}var r,c,n,e;for(s=Math.max(1,s),r=[],n=0;n<s;++n)r[n]=new Worker(v);for(c=s,n=0;n<s;++n)r[n].addEventListener("message",y);e=!1}if(typeof Worker=="undefined")return r(u,f,e,o);var h=t(u,f),s=e.workers,l=e.workLoad||100,a=l*30/8,v=e.workerScript||"forge/prime.worker.js";if(s===-1)return n.util.estimateCores(function(n,t){n&&(t=2);s=t-1;c()});c()}function t(n,t){var r=new i(n,t),e=n-1;return r.testBit(e)||r.bitwiseTo(i.ONE.shiftLeft(e),f,r),r.dAddOffset(31-r.mod(u).byteValue(),0),r}function s(n){return n<=100?27:n<=150?18:n<=200?15:n<=250?12:n<=300?9:n<=350?8:n<=400?7:n<=500?6:n<=600?5:n<=800?4:n<=1250?3:2}var f;if(!n.prime){var h=n.prime=n.prime||{},i=n.jsbn.BigInteger,c=[6,4,2,4,2,4,6,2],u=new i(null);u.fromInt(30);f=function(n,t){return n|t};h.generateProbablePrime=function(t,i,r){var u,f,o;if(typeof i=="function"&&(r=i,i={}),i=i||{},u=i.algorithm||"PRIMEINC",typeof u=="string"&&(u={name:u}),u.options=u.options||{},f=i.prng||n.random,o={nextBytes:function(n){for(var i=f.getBytesSync(n.length),t=0;t<n.length;++t)n[t]=i.charCodeAt(t)}},u.name==="PRIMEINC")return e(t,o,u.options,r);throw new Error("Invalid prime generation algorithm: "+u.name);}}}var i="prime",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/prime",["require","module","./util","./jsbn","./random"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){function e(t,i,r){var u=n.util.createBuffer(),h=Math.ceil(i.n.bitLength()/8),s,e,o,c,l,f;if(t.length>h-11){s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=h-11,s;}if(u.putByte(0),u.putByte(r),e=h-3-t.length,r===0||r===1)for(o=r===0?0:255,f=0;f<e;++f)u.putByte(o);else while(e>0){for(c=0,l=n.random.getBytes(e),f=0;f<e;++f)o=l.charCodeAt(f),o===0?++c:u.putByte(o);e=c}return u.putByte(0),u.putBytes(t),u}function f(t,i,r,u){var h=Math.ceil(i.n.bitLength()/8),f=n.util.createBuffer(t),l=f.getByte(),o=f.getByte(),e,s,c;if(l!==0||r&&o!==0&&o!==1||!r&&o!=2||r&&o===0&&typeof u=="undefined")throw new Error("Encryption block is invalid.");if(e=0,o===0){for(e=h-3-u,s=0;s<e;++s)if(f.getByte()!==0)throw new Error("Encryption block is invalid.");}else if(o===1)for(e=0;f.length()>1;){if(f.getByte()!==255){--f.read;break}++e}else if(o===2)for(e=0;f.length()>1;){if(f.getByte()===0){--f.read;break}++e}if(c=f.getByte(),c!==0||e!==h-3-f.length())throw new Error("Encryption block is invalid.");return f.getBytes()}function s(t,u,f){function s(){e(t.pBits,function(n,i){if(n)return f(n);if(t.p=i,t.q!==null)return o(n,t.q);e(t.qBits,o)})}function e(t,i){n.prime.generateProbablePrime(t,h,i)}function o(n,u){var c,h;if(n)return f(n);if(t.q=u,t.p.compareTo(t.q)<0&&(c=t.p,t.p=t.q,t.q=c),t.p.subtract(r.ONE).gcd(t.e).compareTo(r.ONE)!==0){t.p=null;s();return}if(t.q.subtract(r.ONE).gcd(t.e).compareTo(r.ONE)!==0){t.q=null;e(t.qBits,o);return}if(t.p1=t.p.subtract(r.ONE),t.q1=t.q.subtract(r.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(r.ONE)!==0){t.p=t.q=null;s();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null;e(t.qBits,o);return}h=t.e.modInverse(t.phi);t.keys={privateKey:i.rsa.setPrivateKey(t.n,t.e,h,t.p,t.q,h.mod(t.p1),h.mod(t.q1),t.q.modInverse(t.p)),publicKey:i.rsa.setPublicKey(t.n,t.e)};f(null,t.keys)}typeof u=="function"&&(f=u,u={});u=u||{};var h={algorithm:{name:u.algorithm||"PRIMEINC",options:{workers:u.workers||2,workLoad:u.workLoad||100,workerScript:u.workerScript}}};"prng"in u&&(h.prng=u.prng);s()}function u(t){var i=t.toString(16);return i[0]>="8"&&(i="00"+i),n.util.hexToBytes(i)}function h(n){return n<=100?27:n<=150?18:n<=200?15:n<=250?12:n<=300?9:n<=350?8:n<=400?7:n<=500?6:n<=600?5:n<=800?4:n<=1250?3:2}var r,t;typeof r=="undefined"&&(r=n.jsbn.BigInteger);t=n.asn1;n.pki=n.pki||{};n.pki.rsa=n.rsa=n.rsa||{};var i=n.pki,c=[6,4,2,4,2,4,6,2],l={name:"PrivateKeyInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},a={name:"RSAPrivateKey",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},v={name:"RSAPublicKey",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},y=n.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:t.Class.UNIVERSAL,type:t.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},p=function(n){var e,o,f;if(n.algorithm in i.oids){e=i.oids[n.algorithm];var s=t.oidToDer(e).getBytes(),r=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),u=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]);return u.value.push(t.create(t.Class.UNIVERSAL,t.Type.OID,!1,s)),u.value.push(t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")),o=t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,n.digest().getBytes()),r.value.push(u),r.value.push(o),t.toDer(r).getBytes()}f=new Error("Unknown message digest algorithm.");throw f.algorithm=n.algorithm,f;},o=function(t,i,u){var e,f,o,s;if(u)return t.modPow(i.e,i.n);if(!i.p||!i.q)return t.modPow(i.d,i.n);i.dP||(i.dP=i.d.mod(i.p.subtract(r.ONE)));i.dQ||(i.dQ=i.d.mod(i.q.subtract(r.ONE)));i.qInv||(i.qInv=i.q.modInverse(i.p));do e=new r(n.util.bytesToHex(n.random.getBytes(i.n.bitLength()/8)),16).mod(i.n);while(e.equals(r.ZERO));for(t=t.multiply(e.modPow(i.e,i.n)).mod(i.n),f=t.mod(i.p).modPow(i.dP,i.p),o=t.mod(i.q).modPow(i.dQ,i.q);f.compareTo(o)<0;)f=f.add(i.p);return s=f.subtract(o).multiply(i.qInv).mod(i.p).multiply(i.q).add(o),s=s.multiply(e.modInverse(i.n)).mod(i.n),s};i.rsa.encrypt=function(t,i,u){var h=u,f,a=Math.ceil(i.n.bitLength()/8);u!==!1&&u!==!0?(h=u===2,f=e(t,i,u)):(f=n.util.createBuffer(),f.putBytes(t));for(var v=new r(f.toHex(),16),y=o(v,i,h),c=y.toString(16),s=n.util.createBuffer(),l=a-Math.ceil(c.length/2);l>0;)s.putByte(0),--l;return s.putBytes(n.util.hexToBytes(c)),s.getBytes()};i.rsa.decrypt=function(t,i,u,e){var c=Math.ceil(i.n.bitLength()/8),s,l;if(t.length!==c){s=new Error("Encrypted message length is invalid.");throw s.length=t.length,s.expected=c,s;}if(l=new r(n.util.createBuffer(t).toHex(),16),l.compareTo(i.n)>=0)throw new Error("Encrypted message is invalid.");for(var y=o(l,i,u),a=y.toString(16),h=n.util.createBuffer(),v=c-Math.ceil(a.length/2);v>0;)h.putByte(0),--v;return h.putBytes(n.util.hexToBytes(a)),e!==!1?f(h.getBytes(),i,u):h.getBytes()};i.rsa.createKeyPairGenerationState=function(t,i,u){typeof t=="string"&&(t=parseInt(t,10));t=t||2048;u=u||{};var o=u.prng||n.random,s={nextBytes:function(n){for(var i=o.getBytesSync(n.length),t=0;t<n.length;++t)n[t]=i.charCodeAt(t)}},e=u.algorithm||"PRIMEINC",f;if(e!=="PRIMEINC")throw new Error("Invalid key generation algorithm: "+e);return f={algorithm:e,state:0,bits:t,rng:s,eInt:i||65537,e:new r(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},f.e.fromInt(f.eInt),f};i.rsa.stepKeyPairGenerationState=function(n,t){var e,u,s,f;"algorithm"in n||(n.algorithm="PRIMEINC");e=new r(null);e.fromInt(30);for(var l=0,y=function(n,t){return n|t},a=+new Date,o,v=0;n.keys===null&&(t<=0||v<t);)n.state===0?(u=n.p===null?n.pBits:n.qBits,s=u-1,n.pqState===0?(n.num=new r(u,n.rng),n.num.testBit(s)||n.num.bitwiseTo(r.ONE.shiftLeft(s),y,n.num),n.num.dAddOffset(31-n.num.mod(e).byteValue(),0),l=0,++n.pqState):n.pqState===1?n.num.bitLength()>u?n.pqState=0:n.num.isProbablePrime(h(n.num.bitLength()))?++n.pqState:n.num.dAddOffset(c[l++%8],0):n.pqState===2?n.pqState=n.num.subtract(r.ONE).gcd(n.e).compareTo(r.ONE)===0?3:0:n.pqState===3&&(n.pqState=0,n.p===null?n.p=n.num:n.q=n.num,n.p!==null&&n.q!==null&&++n.state,n.num=null)):n.state===1?(n.p.compareTo(n.q)<0&&(n.num=n.p,n.p=n.q,n.q=n.num),++n.state):n.state===2?(n.p1=n.p.subtract(r.ONE),n.q1=n.q.subtract(r.ONE),n.phi=n.p1.multiply(n.q1),++n.state):n.state===3?n.phi.gcd(n.e).compareTo(r.ONE)===0?++n.state:(n.p=null,n.q=null,n.state=0):n.state===4?(n.n=n.p.multiply(n.q),n.n.bitLength()===n.bits?++n.state:(n.q=null,n.state=0)):n.state===5&&(f=n.e.modInverse(n.phi),n.keys={privateKey:i.rsa.setPrivateKey(n.n,n.e,f,n.p,n.q,f.mod(n.p1),f.mod(n.q1),n.q.modInverse(n.p)),publicKey:i.rsa.setPublicKey(n.n,n.e)}),o=+new Date,v+=o-a,a=o;return n.keys!==null};i.rsa.generateKeyPair=function(n,t,r,u){arguments.length===1?typeof n=="object"?(r=n,n=undefined):typeof n=="function"&&(u=n,n=undefined):arguments.length===2?typeof n=="number"?typeof t=="function"?(u=t,t=undefined):typeof t!="number"&&(r=t,t=undefined):(r=n,u=t,n=undefined,t=undefined):arguments.length===3&&(typeof t=="number"?typeof r=="function"&&(u=r,r=undefined):(u=r,r=t,t=undefined));r=r||{};n===undefined&&(n=r.bits||2048);t===undefined&&(t=r.e||65537);var f=i.rsa.createKeyPairGenerationState(n,t,r);if(!u)return i.rsa.stepKeyPairGenerationState(f,0),f.keys;s(f,r,u)};i.setRsaPublicKey=i.rsa.setPublicKey=function(r,u){var o={n:r,e:u};return o.encrypt=function(t,r,u){if(typeof r=="string"?r=r.toUpperCase():r===undefined&&(r="RSAES-PKCS1-V1_5"),r==="RSAES-PKCS1-V1_5")r={encode:function(n,t){return e(n,t,2).getBytes()}};else if(r==="RSA-OAEP"||r==="RSAES-OAEP")r={encode:function(t,i){return n.pkcs1.encode_rsa_oaep(i,t,u)}};else if(["RAW","NONE","NULL",null].indexOf(r)!==-1)r={encode:function(n){return n}};else if(typeof r=="string")throw new Error('Unsupported encryption scheme: "'+r+'".');var f=r.encode(t,o,!0);return i.rsa.encrypt(f,o,!0)},o.verify=function(n,r,u){typeof u=="string"?u=u.toUpperCase():u===undefined&&(u="RSASSA-PKCS1-V1_5");u==="RSASSA-PKCS1-V1_5"?u={verify:function(n,i){i=f(i,o,!0);var r=t.fromDer(i);return n===r.value[1].value}}:(u==="NONE"||u==="NULL"||u===null)&&(u={verify:function(n,t){return t=f(t,o,!0),n===t}});var e=i.rsa.decrypt(r,o,!0,!1);return u.verify(n,e,o.n.bitLength())},o};i.setRsaPrivateKey=i.rsa.setPrivateKey=function(t,r,u,e,o,s,h,c){var l={n:t,e:r,d:u,p:e,q:o,dP:s,dQ:h,qInv:c};return l.decrypt=function(t,r,u){typeof r=="string"?r=r.toUpperCase():r===undefined&&(r="RSAES-PKCS1-V1_5");var e=i.rsa.decrypt(t,l,!1,!1);if(r==="RSAES-PKCS1-V1_5")r={decode:f};else if(r==="RSA-OAEP"||r==="RSAES-OAEP")r={decode:function(t,i){return n.pkcs1.decode_rsa_oaep(i,t,u)}};else{if(["RAW","NONE","NULL",null].indexOf(r)===-1)throw new Error('Unsupported encryption scheme: "'+r+'".');r={decode:function(n){return n}}}return r.decode(e,l,!1)},l.sign=function(n,t){var r=!1,u;return typeof t=="string"&&(t=t.toUpperCase()),t===undefined||t==="RSASSA-PKCS1-V1_5"?(t={encode:p},r=1):(t==="NONE"||t==="NULL"||t===null)&&(t={encode:function(){return n}},r=1),u=t.encode(n,l.n.bitLength()),i.rsa.encrypt(u,l,r)},l};i.wrapRsaPrivateKey=function(n){return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(0).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(i.oids.rsaEncryption).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")]),t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,t.toDer(n).getBytes())])};i.privateKeyFromAsn1=function(u){var f={},e=[],o,s,h,c,v,y,p,w,b;if(t.validate(u,l,f,e)&&(u=t.fromDer(n.util.createBuffer(f.privateKey))),f={},e=[],!t.validate(u,a,f,e)){o=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw o.errors=e,o;}return s=n.util.createBuffer(f.privateKeyModulus).toHex(),h=n.util.createBuffer(f.privateKeyPublicExponent).toHex(),c=n.util.createBuffer(f.privateKeyPrivateExponent).toHex(),v=n.util.createBuffer(f.privateKeyPrime1).toHex(),y=n.util.createBuffer(f.privateKeyPrime2).toHex(),p=n.util.createBuffer(f.privateKeyExponent1).toHex(),w=n.util.createBuffer(f.privateKeyExponent2).toHex(),b=n.util.createBuffer(f.privateKeyCoefficient).toHex(),i.setRsaPrivateKey(new r(s,16),new r(h,16),new r(c,16),new r(v,16),new r(y,16),new r(p,16),new r(w,16),new r(b,16))};i.privateKeyToAsn1=i.privateKeyToRSAPrivateKey=function(n){return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(0).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,u(n.n)),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,u(n.e)),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,u(n.d)),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,u(n.p)),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,u(n.q)),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,u(n.dP)),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,u(n.dQ)),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,u(n.qInv))])};i.publicKeyFromAsn1=function(u){var f={},o=[],s,e,h,c;if(t.validate(u,y,f,o)){if(s=t.derToOid(f.publicKeyOid),s!==i.oids.rsaEncryption){e=new Error("Cannot read public key. Unknown OID.");throw e.oid=s,e;}u=f.rsaPublicKey}if(o=[],!t.validate(u,v,f,o)){e=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw e.errors=o,e;}return h=n.util.createBuffer(f.publicKeyModulus).toHex(),c=n.util.createBuffer(f.publicKeyExponent).toHex(),i.setRsaPublicKey(new r(h,16),new r(c,16))};i.publicKeyToAsn1=i.publicKeyToSubjectPublicKeyInfo=function(n){return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(i.oids.rsaEncryption).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")]),t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,[i.publicKeyToRSAPublicKey(n)])])};i.publicKeyToRSAPublicKey=function(n){return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,u(n.n)),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,u(n.e))])}}var i="rsa",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/rsa",["require","module","./asn1","./jsbn","./oids","./pkcs1","./prime","./random","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){function u(n,t){return n.start().update(t).digest().getBytes()}var f,t,i;typeof f=="undefined"&&(f=n.jsbn.BigInteger);t=n.asn1;i=n.pki=n.pki||{};i.pbe=n.pbe=n.pbe||{};var r=i.oids,e={name:"EncryptedPrivateKeyInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},o={name:"PBES2Algorithms",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,onstructed:!0,capture:"kdfIterationCount"}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},s={name:"pkcs-12PbeParams",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"iterations"}]};i.encryptPrivateKeyInfo=function(u,f,e){var c,l,a,h;e=e||{};e.saltSize=e.saltSize||8;e.count=e.count||2048;e.algorithm=e.algorithm||"aes128";var v=n.random.getBytesSync(e.saltSize),y=e.count,k=t.integerToDer(y),o,p,w;if(e.algorithm.indexOf("aes")===0||e.algorithm==="des"){switch(e.algorithm){case"aes128":o=16;c=16;l=r["aes128-CBC"];a=n.aes.createEncryptionCipher;break;case"aes192":o=24;c=16;l=r["aes192-CBC"];a=n.aes.createEncryptionCipher;break;case"aes256":o=32;c=16;l=r["aes256-CBC"];a=n.aes.createEncryptionCipher;break;case"des":o=8;c=8;l=r.desCBC;a=n.des.createEncryptionCipher;break;default:h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=e.algorithm,h;}var d=n.pkcs5.pbkdf2(f,v,y,o),b=n.random.getBytesSync(c),s=a(d);s.start(b);s.update(t.toDer(u));s.finish();w=s.output.getBytes();p=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.pkcs5PBES2).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.pkcs5PBKDF2).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,v),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,k.getBytes())])]),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(l).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,b)])])])}else{if(e.algorithm!=="3des"){h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=e.algorithm,h;}o=24;var g=new n.util.ByteBuffer(v),d=i.pbe.generatePkcs12Key(f,g,1,y,o),b=i.pbe.generatePkcs12Key(f,g,2,y,o),s=n.des.createEncryptionCipher(d);s.start(b);s.update(t.toDer(u));s.finish();w=s.output.getBytes();p=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,v),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,k.getBytes())])])}return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[p,t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,w)])};i.decryptPrivateKeyInfo=function(r,u){var h=null,f={},c=[],o;if(!t.validate(r,e,f,c)){o=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=c,o;}var l=t.derToOid(f.encryptionOid),s=i.pbe.getCipher(l,f.encryptionParams,u),a=n.util.createBuffer(f.encryptedData);return s.update(a),s.finish()&&(h=t.fromDer(s.output)),h};i.encryptedPrivateKeyToPem=function(i,r){var u={type:"ENCRYPTED PRIVATE KEY",body:t.toDer(i).getBytes()};return n.pem.encode(u,{maxline:r})};i.encryptedPrivateKeyFromPem=function(i){var r=n.pem.decode(i)[0],u;if(r.type!=="ENCRYPTED PRIVATE KEY"){u=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw u.headerType=r.type,u;}if(r.procType&&r.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return t.fromDer(r.body)};i.encryptRsaPrivateKey=function(r,u,f){var l,o,e,s,h,a,v,c,y;if(f=f||{},!f.legacy)return l=i.wrapRsaPrivateKey(i.privateKeyToAsn1(r)),l=i.encryptPrivateKeyInfo(l,u,f),i.encryptedPrivateKeyToPem(l);switch(f.algorithm){case"aes128":o="AES-128-CBC";s=16;e=n.random.getBytesSync(16);h=n.aes.createEncryptionCipher;break;case"aes192":o="AES-192-CBC";s=24;e=n.random.getBytesSync(16);h=n.aes.createEncryptionCipher;break;case"aes256":o="AES-256-CBC";s=32;e=n.random.getBytesSync(16);h=n.aes.createEncryptionCipher;break;case"3des":o="DES-EDE3-CBC";s=24;e=n.random.getBytesSync(8);h=n.des.createEncryptionCipher;break;case"des":o="DES-CBC";s=8;e=n.random.getBytesSync(8);h=n.des.createEncryptionCipher;break;default:a=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+f.algorithm+'".');throw a.algorithm=f.algorithm,a;}return v=n.pbe.opensslDeriveBytes(u,e.substr(0,8),s),c=h(v),c.start(e),c.update(t.toDer(i.privateKeyToAsn1(r))),c.finish(),y={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:o,parameters:n.util.bytesToHex(e).toUpperCase()},body:c.output.getBytes()},n.pem.encode(y)};i.decryptRsaPrivateKey=function(r,u){var e=null,f=n.pem.decode(r)[0],o,s,h;if(f.type!=="ENCRYPTED PRIVATE KEY"&&f.type!=="PRIVATE KEY"&&f.type!=="RSA PRIVATE KEY"){h=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw h.headerType=h,h;}if(f.procType&&f.procType.type==="ENCRYPTED"){switch(f.dekInfo.algorithm){case"DES-CBC":o=8;s=n.des.createDecryptionCipher;break;case"DES-EDE3-CBC":o=24;s=n.des.createDecryptionCipher;break;case"AES-128-CBC":o=16;s=n.aes.createDecryptionCipher;break;case"AES-192-CBC":o=24;s=n.aes.createDecryptionCipher;break;case"AES-256-CBC":o=32;s=n.aes.createDecryptionCipher;break;case"RC2-40-CBC":o=5;s=function(t){return n.rc2.createDecryptionCipher(t,40)};break;case"RC2-64-CBC":o=8;s=function(t){return n.rc2.createDecryptionCipher(t,64)};break;case"RC2-128-CBC":o=16;s=function(t){return n.rc2.createDecryptionCipher(t,128)};break;default:h=new Error('Could not decrypt private key; unsupported encryption algorithm "'+f.dekInfo.algorithm+'".');throw h.algorithm=f.dekInfo.algorithm,h;}var l=n.util.hexToBytes(f.dekInfo.parameters),a=n.pbe.opensslDeriveBytes(u,l.substr(0,8),o),c=s(a);if(c.start(l),c.update(n.util.createBuffer(f.body)),!c.finish())return e;e=c.output.getBytes()}else e=f.body;return e=f.type==="ENCRYPTED PRIVATE KEY"?i.decryptPrivateKeyInfo(t.fromDer(e),u):t.fromDer(e),e!==null&&(e=i.privateKeyFromAsn1(e)),e};i.pbe.generatePkcs12Key=function(t,i,r,u,f,e){var w,o,ft,d,et,g,c,ot,nt,h,tt,v,st,it,y,p;(typeof e=="undefined"||e===null)&&(e=n.md.sha1.create());var rt=e.digestLength,s=e.blockLength,l=new n.util.ByteBuffer,a=new n.util.ByteBuffer;if(t!==null&&t!==undefined){for(o=0;o<t.length;o++)a.putInt16(t.charCodeAt(o));a.putInt16(0)}var b=a.length(),k=i.length(),ut=new n.util.ByteBuffer;for(ut.fillWithByte(r,s),ft=s*Math.ceil(k/s),d=new n.util.ByteBuffer,o=0;o<ft;o++)d.putByte(i.at(o%k));for(et=s*Math.ceil(b/s),g=new n.util.ByteBuffer,o=0;o<et;o++)g.putByte(a.at(o%b));for(c=d,c.putBuffer(g),ot=Math.ceil(f/rt),nt=1;nt<=ot;nt++){for(h=new n.util.ByteBuffer,h.putBytes(ut.bytes()),h.putBytes(c.bytes()),tt=0;tt<u;tt++)e.start(),e.update(h.getBytes()),h=e.digest();for(v=new n.util.ByteBuffer,o=0;o<s;o++)v.putByte(h.at(o%rt));for(st=Math.ceil(k/s)+Math.ceil(b/s),it=new n.util.ByteBuffer,w=0;w<st;w++){for(y=new n.util.ByteBuffer(c.getBytes(s)),p=511,o=v.length()-1;o>=0;o--)p>>=8,p+=v.at(o)+y.at(o),y.setAt(o,p&255);it.putBuffer(y)}c=it;l.putBuffer(h)}return l.truncate(l.length()-f),l};i.pbe.getCipher=function(n,t,r){switch(n){case i.oids.pkcs5PBES2:return i.pbe.getCipherForPBES2(n,t,r);case i.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case i.oids["pbewithSHAAnd40BitRC2-CBC"]:return i.pbe.getCipherForPKCS12PBE(n,t,r);default:var u=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw u.oid=n,u.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],u;}};i.pbe.getCipherForPBES2=function(r,u,f){var s={},a=[],e,v,l,h,c;if(!t.validate(u,o,s,a)){e=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw e.errors=a,e;}if(r=t.derToOid(s.kdfOid),r!==i.oids.pkcs5PBKDF2){e=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw e.oid=r,e.supportedOids=["pkcs5PBKDF2"],e;}if(r=t.derToOid(s.encOid),r!==i.oids["aes128-CBC"]&&r!==i.oids["aes192-CBC"]&&r!==i.oids["aes256-CBC"]&&r!==i.oids["des-EDE3-CBC"]&&r!==i.oids.desCBC){e=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw e.oid=r,e.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],e;}v=s.kdfSalt;l=n.util.createBuffer(s.kdfIterationCount);l=l.getInt(l.length()<<3);switch(i.oids[r]){case"aes128-CBC":h=16;c=n.aes.createDecryptionCipher;break;case"aes192-CBC":h=24;c=n.aes.createDecryptionCipher;break;case"aes256-CBC":h=32;c=n.aes.createDecryptionCipher;break;case"des-EDE3-CBC":h=24;c=n.des.createDecryptionCipher;break;case"desCBC":h=8;c=n.des.createDecryptionCipher}var p=n.pkcs5.pbkdf2(f,v,l,h),w=s.encIv,y=c(p);return y.start(w),y};i.pbe.getCipherForPKCS12PBE=function(r,u,f){var h={},y=[],c,o,l,a,v,e,p,w;if(!t.validate(u,s,h,y)){e=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw e.errors=y,e;}c=n.util.createBuffer(h.salt);o=n.util.createBuffer(h.iterations);o=o.getInt(o.length()<<3);switch(r){case i.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:l=24;a=8;v=n.des.startDecrypting;break;case i.oids["pbewithSHAAnd40BitRC2-CBC"]:l=5;a=8;v=function(t,i){var r=n.rc2.createDecryptionCipher(t,40);return r.start(i,null),r};break;default:e=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw e.oid=r,e;}return p=i.pbe.generatePkcs12Key(f,c,1,o,l),w=i.pbe.generatePkcs12Key(f,c,2,o,a),v(p,w)};i.pbe.opensslDeriveBytes=function(t,i,r,f){var e,o,s;for((typeof f=="undefined"||f===null)&&(f=n.md.md5.create()),i===null&&(i=""),e=[u(f,t+i)],o=16,s=1;o<r;++s,o+=16)e.push(u(f,e[s-1]+t+i));return e.join("").substr(0,r)}}var i="pbe",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/pbe",["require","module","./aes","./asn1","./des","./md","./oids","./pem","./pbkdf2","./random","./rc2","./rsa","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){var t=n.asn1,i=n.pkcs7asn1=n.pkcs7asn1||{},r,u,f;n.pkcs7=n.pkcs7||{};n.pkcs7.asn1=i;r={name:"ContentInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};i.contentInfoValidator=r;u={name:"EncryptedContentInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:t.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};i.envelopedDataValidator={name:"EnvelopedData",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(u)};i.encryptedDataValidator={name:"EncryptedData",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"}].concat(u)};f={name:"SignerInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.Version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1},{name:"SignerInfo.IssuerAndSerialNumber",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0},{name:"SignerInfo.DigestAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0},{name:"SignerInfo.AuthenticatedAttributes",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.DigestEncryptionAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0},{name:"SignerInfo.EncryptedDigest",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.UnauthenticatedAttributes",tagClass:t.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0}]};i.signedDataValidator={name:"SignedData",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},r,{name:"SignedData.Certificates",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:t.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,capture:"signerInfos",optional:!0,value:[f]}]};i.recipientInfoValidator={name:"RecipientInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:t.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}}var i="pkcs7asn1",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/pkcs7asn1",["require","module","./asn1","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){n.mgf=n.mgf||{};var t=n.mgf.mgf1=n.mgf1=n.mgf1||{};t.create=function(t){return{generate:function(i,r){for(var e,u=new n.util.ByteBuffer,o=Math.ceil(r/t.digestLength),f=0;f<o;f++)e=new n.util.ByteBuffer,e.putInt32(f),t.start(),t.update(i+e.getBytes()),u.putBuffer(t.digest());return u.truncate(u.length()-r),u.getBytes()}}}}var i="mgf1",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/mgf1",["require","module","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){n.mgf=n.mgf||{};n.mgf.mgf1=n.mgf1}var i="mgf",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/mgf",["require","module","./mgf1"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){var t=n.pss=n.pss||{};t.create=function(t){var r,s,e;arguments.length===3&&(t={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var u=t.md,o=t.mgf,f=u.digestLength,i=t.salt||null;if(typeof i=="string"&&(i=n.util.createBuffer(i)),"saltLength"in t)r=t.saltLength;else{if(i===null)throw new Error("Salt length not specified or specific salt not given.");r=i.length()}if(i!==null&&i.length()!==r)throw new Error("Given salt length does not match length of given salt.");return s=t.prng||n.random,e={},e.encode=function(t,e){var h,w=e-1,v=Math.ceil(w/8),d=t.digest().getBytes(),y,c,p,l,k;if(v<f+r+2)throw new Error("Message is too long to encrypt.");y=i===null?s.getBytesSync(r):i.bytes();c=new n.util.ByteBuffer;c.fillWithByte(0,8);c.putBytes(d);c.putBytes(y);u.start();u.update(c.getBytes());p=u.digest().getBytes();l=new n.util.ByteBuffer;l.fillWithByte(0,v-r-f-2);l.putByte(1);l.putBytes(y);var g=l.getBytes(),b=v-f-1,nt=o.generate(p,b),a="";for(h=0;h<b;h++)a+=String.fromCharCode(g.charCodeAt(h)^nt.charCodeAt(h));return k=65280>>8*v-w&255,a=String.fromCharCode(a.charCodeAt(0)&~k)+a.substr(1),a+p+String.fromCharCode(188)},e.verify=function(t,i,e){var s,y=e-1,c=Math.ceil(y/8),k,h,v,d,l,g;if(i=i.substr(-c),c<f+r+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(i.charCodeAt(c-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var a=c-f-1,p=i.substr(0,a),w=i.substr(a,f),b=65280>>8*c-y&255;if((p.charCodeAt(0)&b)!=0)throw new Error("Bits beyond keysize not zero as expected.");for(k=o.generate(w,a),h="",s=0;s<a;s++)h+=String.fromCharCode(p.charCodeAt(s)^k.charCodeAt(s));for(h=String.fromCharCode(h.charCodeAt(0)&~b)+h.substr(1),v=c-f-r-2,s=0;s<v;s++)if(h.charCodeAt(s)!==0)throw new Error("Leftmost octets not zero as expected");if(h.charCodeAt(v)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");return d=h.substr(-r),l=new n.util.ByteBuffer,l.fillWithByte(0,8),l.putBytes(t),l.putBytes(d),u.start(),u.update(l.getBytes()),g=u.digest().getBytes(),w===g},e}}var i="pss",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/pss",["require","module","./random","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){function e(n,t){var r,i,u;for(typeof t=="string"&&(t={shortName:t}),r=null,u=0;r===null&&u<n.attributes.length;++u)i=n.attributes[u],t.type&&t.type===i.type?r=i:t.name&&t.name===i.name?r=i:t.shortName&&t.shortName===i.shortName&&(r=i);return r}function o(i){for(var u,f,o=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),r,s,h=i.attributes,e=0;e<h.length;++e)r=h[e],u=r.value,f=t.Type.PRINTABLESTRING,"valueTagClass"in r&&(f=r.valueTagClass,f===t.Type.UTF8&&(u=n.util.encodeUtf8(u))),s=t.create(t.Class.UNIVERSAL,t.Type.SET,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.type).getBytes()),t.create(t.Class.UNIVERSAL,f,!1,u)])]),o.value.push(s);return o}function f(n){for(var o,e,f,s=0;s<n.length;++s){if(f=n[s],typeof f.name=="undefined"&&(f.type&&f.type in i.oids?f.name=i.oids[f.type]:f.shortName&&f.shortName in u&&(f.name=i.oids[u[f.shortName]])),typeof f.type=="undefined"){if(!(f.name&&f.name in i.oids)){e=new Error("Attribute type not specified.");throw e.attribute=f,e;}f.type=i.oids[f.name]}if(typeof f.shortName=="undefined"&&f.name&&f.name in u&&(f.shortName=u[f.name]),f.type===r.extensionRequest&&(f.valueConstructed=!0,f.valueTagClass=t.Type.SEQUENCE,!f.value&&f.extensions))for(f.value=[],o=0;o<f.extensions.length;++o)f.value.push(i.certificateExtensionToAsn1(c(f.extensions[o])));if(typeof f.value=="undefined"){e=new Error("Attribute value not specified.");throw e.attribute=f,e;}}}function c(u,f){var y,l,o,e,c,a,s,p,h;if(f=f||{},typeof u.name=="undefined"&&u.id&&u.id in i.oids&&(u.name=i.oids[u.id]),typeof u.id=="undefined"){if(!(u.name&&u.name in i.oids)){h=new Error("Extension ID not specified.");throw h.extension=u,h;}u.id=i.oids[u.name]}if(typeof u.value=="undefined"){if(u.name==="keyUsage"){var o=0,e=0,v=0;u.digitalSignature&&(e|=128,o=7);u.nonRepudiation&&(e|=64,o=6);u.keyEncipherment&&(e|=32,o=5);u.dataEncipherment&&(e|=16,o=4);u.keyAgreement&&(e|=8,o=3);u.keyCertSign&&(e|=4,o=2);u.cRLSign&&(e|=2,o=1);u.encipherOnly&&(e|=1,o=0);u.decipherOnly&&(v|=128,o=7);s=String.fromCharCode(o);v!==0?s+=String.fromCharCode(e)+String.fromCharCode(v):e!==0&&(s+=String.fromCharCode(e));u.value=t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,s)}else if(u.name==="basicConstraints")u.value=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),u.cA&&u.value.value.push(t.create(t.Class.UNIVERSAL,t.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in u&&u.value.value.push(t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(u.pathLenConstraint).getBytes()));else if(u.name==="extKeyUsage"){u.value=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]);y=u.value.value;for(l in u)u[l]===!0&&(l in r?y.push(t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r[l]).getBytes())):l.indexOf(".")!==-1&&y.push(t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(l).getBytes())))}else if(u.name==="nsCertType")o=0,e=0,u.client&&(e|=128,o=7),u.server&&(e|=64,o=6),u.email&&(e|=32,o=5),u.objsign&&(e|=16,o=4),u.reserved&&(e|=8,o=3),u.sslCA&&(e|=4,o=2),u.emailCA&&(e|=2,o=1),u.objCA&&(e|=1,o=0),s=String.fromCharCode(o),e!==0&&(s+=String.fromCharCode(e)),u.value=t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,s);else if(u.name==="subjectAltName"||u.name==="issuerAltName")for(u.value=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),a=0;a<u.altNames.length;++a){if(c=u.altNames[a],s=c.value,c.type===7&&c.ip){if(s=n.util.bytesFromIP(c.ip),s===null){h=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw h.extension=u,h;}}else c.type===8&&(s=c.oid?t.oidToDer(t.oidToDer(c.oid)):t.oidToDer(s));u.value.value.push(t.create(t.Class.CONTEXT_SPECIFIC,c.type,!1,s))}else u.name==="subjectKeyIdentifier"&&f.cert&&(p=f.cert.generateSubjectKeyIdentifier(),u.subjectKeyIdentifier=p.toHex(),u.value=t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,p.getBytes()));if(typeof u.value=="undefined"){h=new Error("Extension value not specified.");throw h.extension=u,h;}return u}}function h(n,i){switch(n){case r["RSASSA-PSS"]:var u=[];return i.hash.algorithmOid!==undefined&&u.push(t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(i.hash.algorithmOid).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")])])),i.mgf.algorithmOid!==undefined&&u.push(t.create(t.Class.CONTEXT_SPECIFIC,1,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(i.mgf.algorithmOid).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(i.mgf.hash.algorithmOid).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")])])])),i.saltLength!==undefined&&u.push(t.create(t.Class.CONTEXT_SPECIFIC,2,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(i.saltLength).getBytes())])),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,u);default:return t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")}}function a(i){var f=t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[]),e,u,h,c;if(i.attributes.length===0)return f;for(e=i.attributes,u=0;u<e.length;++u){var r=e[u],o=r.value,s=t.Type.UTF8;"valueTagClass"in r&&(s=r.valueTagClass);s===t.Type.UTF8&&(o=n.util.encodeUtf8(o));h=!1;"valueConstructed"in r&&(h=r.valueConstructed);c=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.type).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,[t.create(t.Class.UNIVERSAL,s,h,o)])]);f.value.push(c)}return f}var t=n.asn1,i=n.pki=n.pki||{},r=i.oids,u={},s;u.CN=r.commonName;u.commonName="CN";u.C=r.countryName;u.countryName="C";u.L=r.localityName;u.localityName="L";u.ST=r.stateOrProvinceName;u.stateOrProvinceName="ST";u.O=r.organizationName;u.organizationName="O";u.OU=r.organizationalUnitName;u.organizationalUnitName="OU";u.E=r.emailAddress;u.emailAddress="E";var l=n.pki.rsa.publicKeyValidator,v={name:"Certificate",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:t.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:t.Class.UNIVERSAL,type:t.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:t.Class.UNIVERSAL,type:t.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:t.Class.UNIVERSAL,type:t.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:t.Class.UNIVERSAL,type:t.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},l,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:t.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:t.Class.UNIVERSAL,type:t.Type.BITSTRING,constructed:!1,capture:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:t.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:t.Class.UNIVERSAL,type:t.Type.BITSTRING,constructed:!1,capture:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:t.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:t.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:t.Class.UNIVERSAL,type:t.Type.BITSTRING,constructed:!1,capture:"certSignature"}]},y={name:"rsapss",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:t.Class.UNIVERSAL,type:t.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:t.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:t.Class.UNIVERSAL,type:t.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:t.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:t.Class.UNIVERSAL,type:t.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:t.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:t.Class.UNIVERSAL,type:t.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},p={name:"CertificationRequestInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},l,{name:"CertificationRequestInfo.attributes",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,constructed:!0}]}]}]},w={name:"CertificationRequest",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[p,{name:"CertificationRequest.signatureAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:t.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:t.Class.UNIVERSAL,type:t.Type.BITSTRING,constructed:!1,capture:"csrSignature"}]};i.RDNAttributesAsArray=function(n,i){for(var o,c=[],s,e,f,h=0;h<n.value.length;++h)for(s=n.value[h],o=0;o<s.value.length;++o)f={},e=s.value[o],f.type=t.derToOid(e.value[0].value),f.value=e.value[1].value,f.valueTagClass=e.value[1].type,f.type in r&&(f.name=r[f.type],f.name in u&&(f.shortName=u[f.name])),i&&(i.update(f.type),i.update(f.value)),c.push(f);return c};i.CRIAttributesAsArray=function(n){for(var e,f,o,c=[],s=0;s<n.length;++s){var l=n[s],a=t.derToOid(l.value[0].value),h=l.value[1].value;for(e=0;e<h.length;++e){if(f={},f.type=a,f.value=h[e].value,f.valueTagClass=h[e].type,f.type in r&&(f.name=r[f.type],f.name in u&&(f.shortName=u[f.name])),f.type===r.extensionRequest)for(f.extensions=[],o=0;o<f.value.length;++o)f.extensions.push(i.certificateExtensionFromAsn1(f.value[o]));c.push(f)}}return c};s=function(n,i,u){var f={},e,o,s;if(n!==r["RSASSA-PSS"])return f;if(u&&(f={hash:{algorithmOid:r.sha1},mgf:{algorithmOid:r.mgf1,hash:{algorithmOid:r.sha1}},saltLength:20}),e={},o=[],!t.validate(i,y,e,o)){s=new Error("Cannot read RSASSA-PSS parameter block.");throw s.errors=o,s;}return e.hashOid!==undefined&&(f.hash=f.hash||{},f.hash.algorithmOid=t.derToOid(e.hashOid)),e.maskGenOid!==undefined&&(f.mgf=f.mgf||{},f.mgf.algorithmOid=t.derToOid(e.maskGenOid),f.mgf.hash=f.mgf.hash||{},f.mgf.hash.algorithmOid=t.derToOid(e.maskGenHashOid)),e.saltLength!==undefined&&(f.saltLength=e.saltLength.charCodeAt(0)),f};i.certificateFromPem=function(r,u,f){var e=n.pem.decode(r)[0],o,s;if(e.type!=="CERTIFICATE"&&e.type!=="X509 CERTIFICATE"&&e.type!=="TRUSTED CERTIFICATE"){o=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw o.headerType=e.type,o;}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");return s=t.fromDer(e.body,f),i.certificateFromAsn1(s,u)};i.certificateToPem=function(r,u){var f={type:"CERTIFICATE",body:t.toDer(i.certificateToAsn1(r)).getBytes()};return n.pem.encode(f,{maxline:u})};i.publicKeyFromPem=function(r){var u=n.pem.decode(r)[0],f,e;if(u.type!=="PUBLIC KEY"&&u.type!=="RSA PUBLIC KEY"){f=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw f.headerType=u.type,f;}if(u.procType&&u.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");return e=t.fromDer(u.body),i.publicKeyFromAsn1(e)};i.publicKeyToPem=function(r,u){var f={type:"PUBLIC KEY",body:t.toDer(i.publicKeyToAsn1(r)).getBytes()};return n.pem.encode(f,{maxline:u})};i.publicKeyToRSAPublicKeyPem=function(r,u){var f={type:"RSA PUBLIC KEY",body:t.toDer(i.publicKeyToRSAPublicKey(r)).getBytes()};return n.pem.encode(f,{maxline:u})};i.getPublicKeyFingerprint=function(r,u){var f,h,o,e,s;u=u||{};f=u.md||n.md.sha1.create();h=u.type||"RSAPublicKey";switch(h){case"RSAPublicKey":o=t.toDer(i.publicKeyToRSAPublicKey(r)).getBytes();break;case"SubjectPublicKeyInfo":o=t.toDer(i.publicKeyToAsn1(r)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+u.type+'".');}if(f.start(),f.update(o),e=f.digest(),u.encoding==="hex")return s=e.toHex(),u.delimiter?s.match(/.{2}/g).join(u.delimiter):s;if(u.encoding==="binary")return e.getBytes();if(u.encoding)throw new Error('Unknown encoding "'+u.encoding+'".');return e};i.certificationRequestFromPem=function(r,u,f){var e=n.pem.decode(r)[0],o,s;if(e.type!=="CERTIFICATE REQUEST"){o=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw o.headerType=e.type,o;}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");return s=t.fromDer(e.body,f),i.certificationRequestFromAsn1(s,u)};i.certificationRequestToPem=function(r,u){var f={type:"CERTIFICATE REQUEST",body:t.toDer(i.certificationRequestToAsn1(r)).getBytes()};return n.pem.encode(f,{maxline:u})};i.createCertificate=function(){var u={};return u.version=2,u.serialNumber="00",u.signatureOid=null,u.signature=null,u.siginfo={},u.siginfo.algorithmOid=null,u.validity={},u.validity.notBefore=new Date,u.validity.notAfter=new Date,u.issuer={},u.issuer.getField=function(n){return e(u.issuer,n)},u.issuer.addField=function(n){f([n]);u.issuer.attributes.push(n)},u.issuer.attributes=[],u.issuer.hash=null,u.subject={},u.subject.getField=function(n){return e(u.subject,n)},u.subject.addField=function(n){f([n]);u.subject.attributes.push(n)},u.subject.attributes=[],u.subject.hash=null,u.extensions=[],u.publicKey=null,u.md=null,u.setSubject=function(n,t){f(n);u.subject.attributes=n;delete u.subject.uniqueId;t&&(u.subject.uniqueId=t);u.subject.hash=null},u.setIssuer=function(n,t){f(n);u.issuer.attributes=n;delete u.issuer.uniqueId;t&&(u.issuer.uniqueId=t);u.issuer.hash=null},u.setExtensions=function(n){for(var t=0;t<n.length;++t)c(n[t],{cert:u});u.extensions=n},u.getExtension=function(n){var t,i,r;for(typeof n=="string"&&(n={name:n}),t=null,r=0;t===null&&r<u.extensions.length;++r)i=u.extensions[r],n.id&&i.id===n.id?t=i:n.name&&i.name===n.name&&(t=i);return t},u.sign=function(f,e){var o,s,h;if(u.md=e||n.md.sha1.create(),o=r[u.md.algorithm+"WithRSAEncryption"],!o){s=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw s.algorithm=u.md.algorithm,s;}u.signatureOid=u.siginfo.algorithmOid=o;u.tbsCertificate=i.getTBSCertificate(u);h=t.toDer(u.tbsCertificate);u.md.update(h.getBytes());u.signature=f.sign(u.md)},u.verify=function(f){var l=!1,o,a,v,y,c,s,h,e;if(!u.issued(f)){var p=f.issuer,w=u.subject,e=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw e.expectedIssuer=p.attributes,e.actualIssuer=w.attributes,e;}if(o=f.md,o===null){if(f.signatureOid in r){a=r[f.signatureOid];switch(a){case"sha1WithRSAEncryption":o=n.md.sha1.create();break;case"md5WithRSAEncryption":o=n.md.md5.create();break;case"sha256WithRSAEncryption":o=n.md.sha256.create();break;case"RSASSA-PSS":o=n.md.sha256.create()}}if(o===null){e=new Error("Could not compute certificate digest. Unknown signature OID.");throw e.signatureOid=f.signatureOid,e;}v=f.tbsCertificate||i.getTBSCertificate(f);y=t.toDer(v);o.update(y.getBytes())}if(o!==null){switch(f.signatureOid){case r.sha1WithRSAEncryption:c=undefined;break;case r["RSASSA-PSS"]:if(s=r[f.signatureParameters.mgf.hash.algorithmOid],s===undefined||n.md[s]===undefined){e=new Error("Unsupported MGF hash function.");throw e.oid=f.signatureParameters.mgf.hash.algorithmOid,e.name=s,e;}if(h=r[f.signatureParameters.mgf.algorithmOid],h===undefined||n.mgf[h]===undefined){e=new Error("Unsupported MGF function.");throw e.oid=f.signatureParameters.mgf.algorithmOid,e.name=h,e;}if(h=n.mgf[h].create(n.md[s].create()),s=r[f.signatureParameters.hash.algorithmOid],s===undefined||n.md[s]===undefined)throw{message:"Unsupported RSASSA-PSS hash function.",oid:f.signatureParameters.hash.algorithmOid,name:s};c=n.pss.create(n.md[s].create(),h,f.signatureParameters.saltLength)}l=u.publicKey.verify(o.digest().getBytes(),f.signature,c)}return l},u.isIssuer=function(n){var t=!1,i=u.issuer,f=n.subject,e,o,r;if(i.hash&&f.hash)t=i.hash===f.hash;else if(i.attributes.length===f.attributes.length)for(t=!0,r=0;t&&r<i.attributes.length;++r)e=i.attributes[r],o=f.attributes[r],(e.type!==o.type||e.value!==o.value)&&(t=!1);return t},u.issued=function(n){return n.isIssuer(u)},u.generateSubjectKeyIdentifier=function(){return i.getPublicKeyFingerprint(u.publicKey,{type:"RSAPublicKey"})},u.verifySubjectKeyIdentifier=function(){for(var i,f,e=r.subjectKeyIdentifier,t=0;t<u.extensions.length;++t)if(i=u.extensions[t],i.id===e)return f=u.generateSubjectKeyIdentifier().getBytes(),n.util.hexToBytes(i.subjectKeyIdentifier)===f;return!1},u};i.certificateFromAsn1=function(u,o){var c={},g=[],w,y,h,nt,b,l,p,a,tt,k,d;if(!t.validate(u,v,c,g)){a=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw a.errors=g,a;}if(typeof c.certSignature!="string"){for(w="\0",y=0;y<c.certSignature.length;++y)w+=t.toDer(c.certSignature[y]).getBytes();c.certSignature=w}if(p=t.derToOid(c.publicKeyOid),p!==i.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");if(h=i.createCertificate(),h.version=c.certVersion?c.certVersion.charCodeAt(0):0,nt=n.util.createBuffer(c.certSerialNumber),h.serialNumber=nt.toHex(),h.signatureOid=n.asn1.derToOid(c.certSignatureOid),h.signatureParameters=s(h.signatureOid,c.certSignatureParams,!0),h.siginfo.algorithmOid=n.asn1.derToOid(c.certinfoSignatureOid),h.siginfo.parameters=s(h.siginfo.algorithmOid,c.certinfoSignatureParams,!1),b=n.util.createBuffer(c.certSignature),++b.read,h.signature=b.getBytes(),l=[],c.certValidity1UTCTime!==undefined&&l.push(t.utcTimeToDate(c.certValidity1UTCTime)),c.certValidity2GeneralizedTime!==undefined&&l.push(t.generalizedTimeToDate(c.certValidity2GeneralizedTime)),c.certValidity3UTCTime!==undefined&&l.push(t.utcTimeToDate(c.certValidity3UTCTime)),c.certValidity4GeneralizedTime!==undefined&&l.push(t.generalizedTimeToDate(c.certValidity4GeneralizedTime)),l.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(l.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(h.validity.notBefore=l[0],h.validity.notAfter=l[1],h.tbsCertificate=c.tbsCertificate,o){if(h.md=null,h.signatureOid in r){p=r[h.signatureOid];switch(p){case"sha1WithRSAEncryption":h.md=n.md.sha1.create();break;case"md5WithRSAEncryption":h.md=n.md.md5.create();break;case"sha256WithRSAEncryption":h.md=n.md.sha256.create();break;case"RSASSA-PSS":h.md=n.md.sha256.create()}}if(h.md===null){a=new Error("Could not compute certificate digest. Unknown signature OID.");throw a.signatureOid=h.signatureOid,a;}tt=t.toDer(h.tbsCertificate);h.md.update(tt.getBytes())}return k=n.md.sha1.create(),h.issuer.getField=function(n){return e(h.issuer,n)},h.issuer.addField=function(n){f([n]);h.issuer.attributes.push(n)},h.issuer.attributes=i.RDNAttributesAsArray(c.certIssuer,k),c.certIssuerUniqueId&&(h.issuer.uniqueId=c.certIssuerUniqueId),h.issuer.hash=k.digest().toHex(),d=n.md.sha1.create(),h.subject.getField=function(n){return e(h.subject,n)},h.subject.addField=function(n){f([n]);h.subject.attributes.push(n)},h.subject.attributes=i.RDNAttributesAsArray(c.certSubject,d),c.certSubjectUniqueId&&(h.subject.uniqueId=c.certSubjectUniqueId),h.subject.hash=d.digest().toHex(),h.extensions=c.certExtensions?i.certificateExtensionsFromAsn1(c.certExtensions):[],h.publicKey=i.publicKeyFromAsn1(c.subjectPublicKeyInfo),h};i.certificateExtensionsFromAsn1=function(n){for(var u,t,f=[],r=0;r<n.value.length;++r)for(u=n.value[r],t=0;t<u.value.length;++t)f.push(i.certificateExtensionFromAsn1(u.value[t]));return f};i.certificateExtensionFromAsn1=function(i){var u={},s,h,c,e,o,l,a,f;if(u.id=t.derToOid(i.value[0].value),u.critical=!1,i.value[1].type===t.Type.BOOLEAN?(u.critical=i.value[1].value.charCodeAt(0)!==0,u.value=i.value[2].value):u.value=i.value[1].value,u.id in r)if(u.name=r[u.id],u.name==="keyUsage"){var f=t.fromDer(u.value),e=0,v=0;f.value.length>1&&(e=f.value.charCodeAt(1),v=f.value.length>2?f.value.charCodeAt(2):0);u.digitalSignature=(e&128)==128;u.nonRepudiation=(e&64)==64;u.keyEncipherment=(e&32)==32;u.dataEncipherment=(e&16)==16;u.keyAgreement=(e&8)==8;u.keyCertSign=(e&4)==4;u.cRLSign=(e&2)==2;u.encipherOnly=(e&1)==1;u.decipherOnly=(v&128)==128}else if(u.name==="basicConstraints")f=t.fromDer(u.value),u.cA=f.value.length>0&&f.value[0].type===t.Type.BOOLEAN?f.value[0].value.charCodeAt(0)!==0:!1,s=null,f.value.length>0&&f.value[0].type===t.Type.INTEGER?s=f.value[0].value:f.value.length>1&&(s=f.value[1].value),s!==null&&(u.pathLenConstraint=t.derToInteger(s));else if(u.name==="extKeyUsage")for(f=t.fromDer(u.value),h=0;h<f.value.length;++h)c=t.derToOid(f.value[h].value),c in r?u[r[c]]=!0:u[c]=!0;else if(u.name==="nsCertType")f=t.fromDer(u.value),e=0,f.value.length>1&&(e=f.value.charCodeAt(1)),u.client=(e&128)==128,u.server=(e&64)==64,u.email=(e&32)==32,u.objsign=(e&16)==16,u.reserved=(e&8)==8,u.sslCA=(e&4)==4,u.emailCA=(e&2)==2,u.objCA=(e&1)==1;else if(u.name==="subjectAltName"||u.name==="issuerAltName")for(u.altNames=[],f=t.fromDer(u.value),l=0;l<f.value.length;++l){o=f.value[l];a={type:o.type,value:o.value};u.altNames.push(a);switch(o.type){case 7:a.ip=n.util.bytesToIP(o.value);break;case 8:a.oid=t.derToOid(o.value)}}else u.name==="subjectKeyIdentifier"&&(f=t.fromDer(u.value),u.subjectKeyIdentifier=n.util.bytesToHex(f.value));return u};i.certificationRequestFromAsn1=function(u,o){var c={},k=[],y,a,h,p,v,l,d,b;if(!t.validate(u,w,c,k)){l=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw l.errors=k,l;}if(typeof c.csrSignature!="string"){for(y="\0",a=0;a<c.csrSignature.length;++a)y+=t.toDer(c.csrSignature[a]).getBytes();c.csrSignature=y}if(v=t.derToOid(c.publicKeyOid),v!==i.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");if(h=i.createCertificationRequest(),h.version=c.csrVersion?c.csrVersion.charCodeAt(0):0,h.signatureOid=n.asn1.derToOid(c.csrSignatureOid),h.signatureParameters=s(h.signatureOid,c.csrSignatureParams,!0),h.siginfo.algorithmOid=n.asn1.derToOid(c.csrSignatureOid),h.siginfo.parameters=s(h.siginfo.algorithmOid,c.csrSignatureParams,!1),p=n.util.createBuffer(c.csrSignature),++p.read,h.signature=p.getBytes(),h.certificationRequestInfo=c.certificationRequestInfo,o){if(h.md=null,h.signatureOid in r){v=r[h.signatureOid];switch(v){case"sha1WithRSAEncryption":h.md=n.md.sha1.create();break;case"md5WithRSAEncryption":h.md=n.md.md5.create();break;case"sha256WithRSAEncryption":h.md=n.md.sha256.create();break;case"RSASSA-PSS":h.md=n.md.sha256.create()}}if(h.md===null){l=new Error("Could not compute certification request digest. Unknown signature OID.");throw l.signatureOid=h.signatureOid,l;}d=t.toDer(h.certificationRequestInfo);h.md.update(d.getBytes())}return b=n.md.sha1.create(),h.subject.getField=function(n){return e(h.subject,n)},h.subject.addField=function(n){f([n]);h.subject.attributes.push(n)},h.subject.attributes=i.RDNAttributesAsArray(c.certificationRequestInfoSubject,b),h.subject.hash=b.digest().toHex(),h.publicKey=i.publicKeyFromAsn1(c.subjectPublicKeyInfo),h.getAttribute=function(n){return e(h,n)},h.addAttribute=function(n){f([n]);h.attributes.push(n)},h.attributes=i.CRIAttributesAsArray(c.certificationRequestInfoAttributes||[]),h};i.createCertificationRequest=function(){var u={};return u.version=0,u.signatureOid=null,u.signature=null,u.siginfo={},u.siginfo.algorithmOid=null,u.subject={},u.subject.getField=function(n){return e(u.subject,n)},u.subject.addField=function(n){f([n]);u.subject.attributes.push(n)},u.subject.attributes=[],u.subject.hash=null,u.publicKey=null,u.attributes=[],u.getAttribute=function(n){return e(u,n)},u.addAttribute=function(n){f([n]);u.attributes.push(n)},u.md=null,u.setSubject=function(n){f(n);u.subject.attributes=n;u.subject.hash=null},u.setAttributes=function(n){f(n);u.attributes=n},u.sign=function(f,e){var o,s,h;if(u.md=e||n.md.sha1.create(),o=r[u.md.algorithm+"WithRSAEncryption"],!o){s=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw s.algorithm=u.md.algorithm,s;}u.signatureOid=u.siginfo.algorithmOid=o;u.certificationRequestInfo=i.getCertificationRequestInfo(u);h=t.toDer(u.certificationRequestInfo);u.md.update(h.getBytes());u.signature=f.sign(u.md)},u.verify=function(){var h=!1,o=u.md,c,l,a,v,e,s,f;if(o===null){if(u.signatureOid in r){c=r[u.signatureOid];switch(c){case"sha1WithRSAEncryption":o=n.md.sha1.create();break;case"md5WithRSAEncryption":o=n.md.md5.create();break;case"sha256WithRSAEncryption":o=n.md.sha256.create();break;case"RSASSA-PSS":o=n.md.sha256.create()}}if(o===null){f=new Error("Could not compute certification request digest. Unknown signature OID.");throw f.signatureOid=u.signatureOid,f;}l=u.certificationRequestInfo||i.getCertificationRequestInfo(u);a=t.toDer(l);o.update(a.getBytes())}if(o!==null){switch(u.signatureOid){case r["RSASSA-PSS"]:if(e=r[u.signatureParameters.mgf.hash.algorithmOid],e===undefined||n.md[e]===undefined){f=new Error("Unsupported MGF hash function.");throw f.oid=u.signatureParameters.mgf.hash.algorithmOid,f.name=e,f;}if(s=r[u.signatureParameters.mgf.algorithmOid],s===undefined||n.mgf[s]===undefined){f=new Error("Unsupported MGF function.");throw f.oid=u.signatureParameters.mgf.algorithmOid,f.name=s,f;}if(s=n.mgf[s].create(n.md[e].create()),e=r[u.signatureParameters.hash.algorithmOid],e===undefined||n.md[e]===undefined){f=new Error("Unsupported RSASSA-PSS hash function.");throw f.oid=u.signatureParameters.hash.algorithmOid,f.name=e,f;}v=n.pss.create(n.md[e].create(),s,u.signatureParameters.saltLength)}h=u.publicKey.verify(o.digest().getBytes(),u.signature,v)}return h},u};i.getTBSCertificate=function(r){var u=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(r.version).getBytes())]),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,n.util.hexToBytes(r.serialNumber)),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.siginfo.algorithmOid).getBytes()),h(r.siginfo.algorithmOid,r.siginfo.parameters)]),o(r.issuer),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.UTCTIME,!1,t.dateToUtcTime(r.validity.notBefore)),t.create(t.Class.UNIVERSAL,t.Type.UTCTIME,!1,t.dateToUtcTime(r.validity.notAfter))]),o(r.subject),i.publicKeyToAsn1(r.publicKey)]);return r.issuer.uniqueId&&u.value.push(t.create(t.Class.CONTEXT_SPECIFIC,1,!0,[t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,String.fromCharCode(0)+r.issuer.uniqueId)])),r.subject.uniqueId&&u.value.push(t.create(t.Class.CONTEXT_SPECIFIC,2,!0,[t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,String.fromCharCode(0)+r.subject.uniqueId)])),r.extensions.length>0&&u.value.push(i.certificateExtensionsToAsn1(r.extensions)),u};i.getCertificationRequestInfo=function(n){return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(n.version).getBytes()),o(n.subject),i.publicKeyToAsn1(n.publicKey),a(n)])};i.distinguishedNameToAsn1=function(n){return o(n)};i.certificateToAsn1=function(n){var r=n.tbsCertificate||i.getTBSCertificate(n);return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[r,t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(n.signatureOid).getBytes()),h(n.signatureOid,n.signatureParameters)]),t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,String.fromCharCode(0)+n.signature)])};i.certificateExtensionsToAsn1=function(n){var u=t.create(t.Class.CONTEXT_SPECIFIC,3,!0,[]),f=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),r;for(u.value.push(f),r=0;r<n.length;++r)f.value.push(i.certificateExtensionToAsn1(n[r]));return u};i.certificateExtensionToAsn1=function(n){var i=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),r;return i.value.push(t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(n.id).getBytes())),n.critical&&i.value.push(t.create(t.Class.UNIVERSAL,t.Type.BOOLEAN,!1,String.fromCharCode(255))),r=n.value,typeof n.value!="string"&&(r=t.toDer(r).getBytes()),i.value.push(t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,r)),i};i.certificationRequestToAsn1=function(n){var r=n.certificationRequestInfo||i.getCertificationRequestInfo(n);return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[r,t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(n.signatureOid).getBytes()),h(n.signatureOid,n.signatureParameters)]),t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,String.fromCharCode(0)+n.signature)])};i.createCaStore=function(r){function e(t){if(!t.hash){var r=n.md.sha1.create();t.attributes=i.RDNAttributesAsArray(o(t),r);t.hash=r.digest().toHex()}return u.certs[t.hash]||null}var u={certs:{}},f,s;if(u.getIssuer=function(n){return e(n.issuer)},u.addCertificate=function(t){var f,r;typeof t=="string"&&(t=n.pki.certificateFromPem(t));t.subject.hash||(f=n.md.sha1.create(),t.subject.attributes=i.RDNAttributesAsArray(o(t.subject),f),t.subject.hash=f.digest().toHex());t.subject.hash in u.certs?(r=u.certs[t.subject.hash],n.util.isArray(r)||(r=[r]),r.push(t)):u.certs[t.subject.hash]=t},u.hasCertificate=function(r){var u=e(r.subject),o,f,s;if(!u)return!1;for(n.util.isArray(u)||(u=[u]),o=t.toDer(i.certificateToAsn1(r)).getBytes(),f=0;f<u.length;++f)if(s=t.toDer(i.certificateToAsn1(u[f])).getBytes(),o===s)return!0;return!1},r)for(f=0;f<r.length;++f)s=r[f],u.addCertificate(s);return u};i.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};i.verifyCertificateChain=function(t,r,u){var h,l,g,a,k,c,v,nt,y,o;r=r.slice(0);var tt=r.slice(0),p=new Date,d=!0,f=null,w=0;do{var e=r.shift(),s=null,b=!1;if((p<e.validity.notBefore||p>e.validity.notAfter)&&(f={message:"Certificate is not valid yet or has expired.",error:i.certificateError.certificate_expired,notBefore:e.validity.notBefore,notAfter:e.validity.notAfter,now:p}),f===null){if(s=r[0]||t.getIssuer(e),s===null&&e.isIssuer(e)&&(b=!0,s=e),s){for(h=s,n.util.isArray(h)||(h=[h]),l=!1;!l&&h.length>0;){s=h.shift();try{l=s.verify(e)}catch(it){}}l||(f={message:"Certificate signature is invalid.",error:i.certificateError.bad_certificate})}f!==null||s&&!b||t.hasCertificate(e)||(f={message:"Certificate is not trusted.",error:i.certificateError.unknown_ca})}if(f===null&&s&&!e.isIssuer(s)&&(f={message:"Certificate issuer is invalid.",error:i.certificateError.bad_certificate}),f===null)for(g={keyUsage:!0,basicConstraints:!0},a=0;f===null&&a<e.extensions.length;++a)k=e.extensions[a],!k.critical||k.name in g||(f={message:"Certificate has an unsupported critical extension.",error:i.certificateError.unsupported_certificate});if(f!==null||d&&(r.length!==0||s&&!b)||(c=e.getExtension("basicConstraints"),v=e.getExtension("keyUsage"),v===null||v.keyCertSign&&c!==null||(f={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:i.certificateError.bad_certificate}),f!==null||c===null||c.cA||(f={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:i.certificateError.bad_certificate}),f===null&&v!==null&&"pathLenConstraint"in c&&(nt=w-1,nt>c.pathLenConstraint&&(f={message:"Certificate basicConstraints pathLenConstraint violated.",error:i.certificateError.bad_certificate}))),y=f===null?!0:f.error,o=u?u(y,w,tt):y,o!==!0){y===!0&&(f={message:"The application rejected the certificate.",error:i.certificateError.bad_certificate});(o||o===0)&&(typeof o=="object"&&!n.util.isArray(o)?(o.message&&(f.message=o.message),o.error&&(f.error=o.error)):typeof o=="string"&&(f.error=o));throw f;}f=null;d=!1;++w}while(r.length>0);return!0}}var i="x509",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t.pki}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/x509",["require","module","./aes","./asn1","./des","./md","./mgf","./oids","./pem","./pss","./rsa","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){function r(n,t,i,r){for(var e,u,o=[],f=0;f<n.length;f++)for(e=0;e<n[f].safeBags.length;e++)if(u=n[f].safeBags[e],r===undefined||u.type===r){if(t===null){o.push(u);continue}u.attributes[t]!==undefined&&u.attributes[t].indexOf(i)>=0&&o.push(u)}return o}function f(t){var r,i;if(t.composed||t.constructed){for(r=n.util.createBuffer(),i=0;i<t.value.length;++i)r.putBytes(t.value[i].value);t.composed=t.constructed=!1;t.value=r.getBytes()}return t}function o(n,r,u,o){var l,c;if(r=t.fromDer(r,u),r.tagClass!==t.Class.UNIVERSAL||r.type!==t.Type.SEQUENCE||r.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(l=0;l<r.value.length;l++){var b=r.value[l],a={},w=[];if(!t.validate(b,e,a,w)){c=new Error("Cannot read ContentInfo.");throw c.errors=w,c;}var y={encrypted:!1},p=null,v=a.content.value[0];switch(t.derToOid(a.contentType)){case i.oids.data:if(v.tagClass!==t.Class.UNIVERSAL||v.type!==t.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");p=f(v).value;break;case i.oids.encryptedData:p=s(v,o);y.encrypted=!0;break;default:c=new Error("Unsupported PKCS#12 contentType.");throw c.contentType=t.derToOid(a.contentType),c;}y.safeBags=h(p,u,o);n.safeContents.push(y)}}function s(r,u){var o={},c=[],s,e;if(!t.validate(r,n.pkcs7.asn1.encryptedDataValidator,o,c)){e=new Error("Cannot read EncryptedContentInfo.");throw e.errors=c,e;}if(s=t.derToOid(o.contentType),s!==i.oids.data){e=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw e.oid=s,e;}s=t.derToOid(o.encAlgorithm);var h=i.pbe.getCipher(s,o.encParameter,u),l=f(o.encryptedContentAsn1),a=n.util.createBuffer(l.value);if(h.update(a),!h.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return h.output.getBytes()}function h(n,r,u){var p,h,o,v,w,s,f;if(!r&&n.length===0)return[];if(n=t.fromDer(n,r),n.tagClass!==t.Class.UNIVERSAL||n.type!==t.Type.SEQUENCE||n.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(p=[],h=0;h<n.value.length;h++){var b=n.value[h],e={},l=[];if(!t.validate(b,a,e,l)){f=new Error("Cannot read SafeBag.");throw f.errors=l,f;}o={type:t.derToOid(e.bagId),attributes:c(e.bagAttributes)};p.push(o);s=e.bagValue.value[0];switch(o.type){case i.oids.pkcs8ShroudedKeyBag:if(s=i.decryptPrivateKeyInfo(s,u),s===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case i.oids.keyBag:o.key=i.privateKeyFromAsn1(s);continue;case i.oids.certBag:v=y;w=function(){if(t.derToOid(e.certId)!==i.oids.x509Certificate){var n=new Error("Unsupported certificate type, only X.509 supported.");throw n.oid=t.derToOid(e.certId),n;}o.cert=i.certificateFromAsn1(t.fromDer(e.cert,r),!0)};break;default:f=new Error("Unsupported PKCS#12 SafeBag type.");throw f.oid=o.type,f;}if(v!==undefined&&!t.validate(s,v,e,l)){f=new Error("Cannot read PKCS#12 "+v.name);throw f.errors=l,f;}w()}return p}function c(n){var o={},u,r,s,h,f,e;if(n!==undefined)for(u=0;u<n.length;++u){if(r={},s=[],!t.validate(n[u],v,r,s)){h=new Error("Cannot read PKCS#12 BagAttribute.");throw h.errors=s,h;}if(f=t.derToOid(r.oid),i.oids[f]!==undefined)for(o[i.oids[f]]=[],e=0;e<r.values.length;++e)o[i.oids[f]].push(r.values[e].value)}return o}var t=n.asn1,i=n.pki,u=n.pkcs12=n.pkcs12||{},e={name:"ContentInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:t.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},l={name:"PFX",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"},e,{name:"PFX.macData",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:t.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},a={name:"SafeBag",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:t.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},v={name:"Attribute",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,constructed:!0,capture:"values"}]},y={name:"CertBag",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:t.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:t.Class.UNIVERSAL,type:t.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};u.pkcs12FromAsn1=function(e,s,h){var c,k,v,a,p,g;if(typeof s=="string"?(h=s,s=!0):s===undefined&&(s=!0),c={},k=[],!t.validate(e,l,c,k)){a=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw a.errors=a,a;}if(v={version:c.version.charCodeAt(0),safeContents:[],getBags:function(t){var u={},i;return"localKeyId"in t?i=t.localKeyId:"localKeyIdHex"in t&&(i=n.util.hexToBytes(t.localKeyIdHex)),i===undefined&&!("friendlyName"in t)&&"bagType"in t&&(u[t.bagType]=r(v.safeContents,null,null,t.bagType)),i!==undefined&&(u.localKeyId=r(v.safeContents,"localKeyId",i,t.bagType)),"friendlyName"in t&&(u.friendlyName=r(v.safeContents,"friendlyName",t.friendlyName,t.bagType)),u},getBagsByFriendlyName:function(n,t){return r(v.safeContents,"friendlyName",n,t)},getBagsByLocalKeyId:function(n,t){return r(v.safeContents,"localKeyId",n,t)}},c.version.charCodeAt(0)!==3){a=new Error("PKCS#12 PFX of version other than 3 not supported.");throw a.version=c.version.charCodeAt(0),a;}if(t.derToOid(c.contentType)!==i.oids.data){a=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw a.oid=t.derToOid(c.contentType),a;}if(p=c.content.value[0],p.tagClass!==t.Class.UNIVERSAL||p.type!==t.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(p=f(p),c.mac){var y=null,w=0,d=t.derToOid(c.macAlgorithm);switch(d){case i.oids.sha1:y=n.md.sha1.create();w=20;break;case i.oids.sha256:y=n.md.sha256.create();w=32;break;case i.oids.sha384:y=n.md.sha384.create();w=48;break;case i.oids.sha512:y=n.md.sha512.create();w=64;break;case i.oids.md5:y=n.md.md5.create();w=16}if(y===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+d);var nt=new n.util.ByteBuffer(c.macSalt),tt="macIterations"in c?parseInt(n.util.bytesToHex(c.macIterations),16):1,it=u.generateKey(h,nt,3,tt,w,y),b=n.hmac.create();if(b.start(y,it),b.update(p.value),g=b.getMac(),g.getBytes()!==c.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?");}return o(v,p.value,s,h),v};u.toPkcs12Asn1=function(r,f,e,o){var s,a,h,v,c,y,p,w,l,nt,tt,b,k,it,rt,d,ut,ot;for(o=o||{},o.saltSize=o.saltSize||8,o.count=o.count||2048,o.algorithm=o.algorithm||o.encAlgorithm||"aes128",("useMac"in o)||(o.useMac=!0),("localKeyId"in o)||(o.localKeyId=null),("generateLocalKeyId"in o)||(o.generateLocalKeyId=!0),s=o.localKeyId,s!==null?s=n.util.hexToBytes(s):o.generateLocalKeyId&&(f?(h=n.util.isArray(f)?f[0]:f,typeof h=="string"&&(h=i.certificateFromPem(h)),v=n.md.sha1.create(),v.update(t.toDer(i.certificateToAsn1(h)).getBytes()),s=v.digest().getBytes()):s=n.random.getBytes(20)),c=[],s!==null&&c.push(t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(i.oids.localKeyId).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,s)])])),("friendlyName"in o)&&c.push(t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(i.oids.friendlyName).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,[t.create(t.Class.UNIVERSAL,t.Type.BMPSTRING,!1,o.friendlyName)])])),c.length>0&&(a=t.create(t.Class.UNIVERSAL,t.Type.SET,!0,c)),y=[],p=[],f!==null&&(p=n.util.isArray(f)?f:[f]),w=[],l=0;l<p.length;++l){f=p[l];typeof f=="string"&&(f=i.certificateFromPem(f));var st=l===0?a:undefined,ht=i.certificateToAsn1(f),ct=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(i.oids.certBag).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(i.oids.x509Certificate).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,t.toDer(ht).getBytes())])])]),st]);w.push(ct)}if(w.length>0&&(nt=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,w),tt=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(i.oids.data).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,t.toDer(nt).getBytes())])]),y.push(tt)),b=null,r!==null&&(k=i.wrapRsaPrivateKey(i.privateKeyToAsn1(r)),b=e===null?t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(i.oids.keyBag).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[k]),a]):t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(i.oids.pkcs8ShroudedKeyBag).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[i.encryptPrivateKeyInfo(k,e,o)]),a]),it=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[b]),rt=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(i.oids.data).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,t.toDer(it).getBytes())])]),y.push(rt)),d=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,y),o.useMac){var v=n.md.sha1.create(),ft=new n.util.ByteBuffer(n.random.getBytes(o.saltSize)),et=o.count,r=u.generateKey(e,ft,3,et,20),g=n.hmac.create();g.start(v,r);g.update(t.toDer(d).getBytes());ot=g.getMac();ut=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(i.oids.sha1).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")]),t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,ot.getBytes())]),t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,ft.getBytes()),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(et).getBytes())])}return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(3).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(i.oids.data).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,t.toDer(d).getBytes())])]),ut])};u.generateKey=n.pbe.generatePkcs12Key}var i="pkcs12",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/pkcs12",["require","module","./asn1","./hmac","./oids","./pkcs7asn1","./pbe","./random","./rsa","./sha1","./util","./x509"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){var i=n.asn1,t=n.pki=n.pki||{};t.pemToDer=function(t){var i=n.pem.decode(t)[0];if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return n.util.createBuffer(i.body)};t.privateKeyFromPem=function(r){var u=n.pem.decode(r)[0],f,e;if(u.type!=="PRIVATE KEY"&&u.type!=="RSA PRIVATE KEY"){f=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw f.headerType=u.type,f;}if(u.procType&&u.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");return e=i.fromDer(u.body),t.privateKeyFromAsn1(e)};t.privateKeyToPem=function(r,u){var f={type:"RSA PRIVATE KEY",body:i.toDer(t.privateKeyToAsn1(r)).getBytes()};return n.pem.encode(f,{maxline:u})};t.privateKeyInfoToPem=function(t,r){var u={type:"PRIVATE KEY",body:i.toDer(t).getBytes()};return n.pem.encode(u,{maxline:r})}}var i="pki",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/pki",["require","module","./asn1","./oids","./pbe","./pem","./pbkdf2","./pkcs12","./pss","./rsa","./util","./x509"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){var h=function(t,i,r,u){var c=n.util.createBuffer(),l=t.length>>1,a=l+(t.length&1),p=t.substr(0,a),w=t.substr(l,a),e=n.util.createBuffer(),f=n.hmac.create(),v,y,s,h,o;for(r=i+r,v=Math.ceil(u/16),y=Math.ceil(u/20),f.start("MD5",p),s=n.util.createBuffer(),e.putBytes(r),o=0;o<v;++o)f.start(null,null),f.update(e.getBytes()),e.putBuffer(f.digest()),f.start(null,null),f.update(e.bytes()+r),s.putBuffer(f.digest());for(f.start("SHA1",w),h=n.util.createBuffer(),e.clear(),e.putBytes(r),o=0;o<y;++o)f.start(null,null),f.update(e.getBytes()),e.putBuffer(f.digest()),f.start(null,null),f.update(e.bytes()+r),h.putBuffer(f.digest());return c.putBytes(n.util.xorBytes(s.getBytes(),h.getBytes(),u)),c},ri=function(){},ft=function(t,i,r){var f=n.hmac.create(),u;return f.start("SHA1",t),u=n.util.createBuffer(),u.putInt32(i[0]),u.putInt32(i[1]),u.putByte(r.type),u.putByte(r.version.major),u.putByte(r.version.minor),u.putInt16(r.length),u.putBytes(r.fragment.bytes()),f.update(u.getBytes()),f.digest().getBytes()},et=function(t,i){var u=!1,r;try{r=t.deflate(i.fragment.getBytes());i.fragment=n.util.createBuffer(r);i.length=r.length;u=!0}catch(f){}return u},ot=function(t,i){var u=!1,r;try{r=t.inflate(i.fragment.getBytes());i.fragment=n.util.createBuffer(r);i.length=r.length;u=!0}catch(f){}return u},e=function(t,i){var r=0;switch(i){case 1:r=t.getByte();break;case 2:r=t.getInt16();break;case 3:r=t.getInt24();break;case 4:r=t.getInt32()}return n.util.createBuffer(t.getBytes(r))},o=function(n,t,i){n.putInt(i.length(),t<<3);n.putBuffer(i)},i={},a,ut,v;i.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}};i.SupportedVersions=[i.Versions.TLS_1_1,i.Versions.TLS_1_0];i.Version=i.SupportedVersions[0];i.MaxFragment=15360;i.ConnectionEnd={server:0,client:1};i.PRFAlgorithm={tls_prf_sha256:0};i.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};i.CipherType={stream:0,block:1,aead:2};i.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};i.CompressionMethod={none:0,deflate:1};i.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24};i.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};i.Alert={};i.Alert.Level={warning:1,fatal:2};i.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};i.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2};i.CipherSuites={};i.getCipherSuite=function(n){var r=null,u,t;for(u in i.CipherSuites)if(t=i.CipherSuites[u],t.id[0]===n.charCodeAt(0)&&t.id[1]===n.charCodeAt(1)){r=t;break}return r};i.handleUnexpected=function(n){var t=!n.open&&n.entity===i.ConnectionEnd.client;t||n.error(n,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.unexpected_message}})};i.handleHelloRequest=function(n){!n.handshaking&&n.handshakes>0&&(i.queue(n,i.createAlert(n,{level:i.Alert.Level.warning,description:i.Alert.Description.no_renegotiation})),i.flush(n));n.process()};i.parseHelloMessage=function(t,r,u){var f=null,s=t.entity===i.ConnectionEnd.client,o,c,h,l,a,v,p,y;if(u<38)t.error(t,{message:s?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.illegal_parameter}});else{if(o=r.fragment,c=o.length(),f={version:{major:o.getByte(),minor:o.getByte()},random:n.util.createBuffer(o.getBytes(32)),session_id:e(o,1),extensions:[]},s?(f.cipher_suite=o.getBytes(2),f.compression_method=o.getByte()):(f.cipher_suites=e(o,2),f.compression_methods=e(o,1)),c=u-(c-o.length()),c>0){for(h=e(o,2);h.length()>0;)f.extensions.push({type:[h.getByte(),h.getByte()],data:e(h,2)});if(!s)for(l=0;l<f.extensions.length;++l)if(a=f.extensions[l],a.type[0]===0&&a.type[1]===0)for(v=e(a.data,2);v.length()>0;){if(p=v.getByte(),p!==0)break;t.session.extensions.server_name.serverNameList.push(e(v,2).getBytes())}}if(t.session.version&&(f.version.major!==t.session.version.major||f.version.minor!==t.session.version.minor))return t.error(t,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.protocol_version}});if(s)t.session.cipherSuite=i.getCipherSuite(f.cipher_suite);else for(y=n.util.createBuffer(f.cipher_suites.bytes());y.length()>0;)if(t.session.cipherSuite=i.getCipherSuite(y.getBytes(2)),t.session.cipherSuite!==null)break;if(t.session.cipherSuite===null)return t.error(t,{message:"No cipher suites in common.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.handshake_failure},cipherSuite:n.util.bytesToHex(f.cipher_suite)});t.session.compressionMethod=s?f.compression_method:i.CompressionMethod.none}return f};i.createSecurityParameters=function(n,t){var r=n.entity===i.ConnectionEnd.client,u=t.random.bytes(),f=r?n.session.sp.client_random:u,e=r?u:i.createRandom().getBytes();n.session.sp={entity:n.entity,prf_algorithm:i.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:n.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:f,server_random:e}};i.handleServerHello=function(n,t,r){var u=i.parseHelloMessage(n,t,r),f;if(!n.fail){if(!(u.version.minor<=n.version.minor))return n.error(n,{message:"Incompatible TLS version.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.protocol_version}});n.version.minor=u.version.minor;n.session.version=n.version;f=u.session_id.bytes();f.length>0&&f===n.session.id?(n.expect=d,n.session.resuming=!0,n.session.sp.server_random=u.random.bytes()):(n.expect=ht,n.session.resuming=!1,i.createSecurityParameters(n,u));n.session.id=f;n.process()}};i.handleClientHello=function(t,r,u){var e=i.parseHelloMessage(t,r,u),o,f,s,h;if(!t.fail){if(o=e.session_id.bytes(),f=null,t.sessionCache&&(f=t.sessionCache.getSession(o),f===null?o="":(f.version.major!==e.version.major||f.version.minor>e.version.minor)&&(f=null,o="")),o.length===0&&(o=n.random.getBytes(32)),t.session.id=o,t.session.clientHelloVersion=e.version,t.session.sp={},f)t.version=t.session.version=f.version,t.session.sp=f.sp;else{for(h=1;h<i.SupportedVersions.length;++h)if(s=i.SupportedVersions[h],s.minor<=e.version.minor)break;t.version={major:s.major,minor:s.minor};t.session.version=t.version}f!==null?(t.expect=p,t.session.resuming=!0,t.session.sp.client_random=e.random.bytes()):(t.expect=t.verifyClient!==!1?wt:y,t.session.resuming=!1,i.createSecurityParameters(t,e));t.open=!0;i.queue(t,i.createRecord(t,{type:i.ContentType.handshake,data:i.createServerHello(t)}));t.session.resuming?(i.queue(t,i.createRecord(t,{type:i.ContentType.change_cipher_spec,data:i.createChangeCipherSpec()})),t.state.pending=i.createConnectionState(t),t.state.current.write=t.state.pending.write,i.queue(t,i.createRecord(t,{type:i.ContentType.handshake,data:i.createFinished(t)}))):(i.queue(t,i.createRecord(t,{type:i.ContentType.handshake,data:i.createCertificate(t)})),t.fail||(i.queue(t,i.createRecord(t,{type:i.ContentType.handshake,data:i.createServerKeyExchange(t)})),t.verifyClient!==!1&&i.queue(t,i.createRecord(t,{type:i.ContentType.handshake,data:i.createCertificateRequest(t)})),i.queue(t,i.createRecord(t,{type:i.ContentType.handshake,data:i.createServerHelloDone(t)}))));i.flush(t);t.process()}};i.handleCertificate=function(t,r,u){var o;if(u<3)return t.error(t,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.illegal_parameter}});var l=r.fragment,h={certificate_list:e(l,3)},s,c,f=[];try{while(h.certificate_list.length()>0)s=e(h.certificate_list,3),c=n.asn1.fromDer(s),s=n.pki.certificateFromAsn1(c,!0),f.push(s)}catch(a){return t.error(t,{message:"Could not parse certificate list.",cause:a,send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.bad_certificate}})}o=t.entity===i.ConnectionEnd.client;!o&&t.verifyClient!==!0||f.length!==0?f.length===0?t.expect=o?k:y:(o?t.session.serverCertificate=f[0]:t.session.clientCertificate=f[0],i.verifyCertificateChain(t,f)&&(t.expect=o?k:y)):t.error(t,{message:o?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.illegal_parameter}});t.process()};i.handleServerKeyExchange=function(n,t,r){if(r>0)return n.error(n,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.unsupported_certificate}});n.expect=ct;n.process()};i.handleClientKeyExchange=function(t,r,u){var o,s;if(u<48)return t.error(t,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.unsupported_certificate}});var h=r.fragment,c={enc_pre_master_secret:e(h,2).getBytes()},f=null;if(t.getPrivateKey)try{f=t.getPrivateKey(t,t.session.serverCertificate);f=n.pki.privateKeyFromPem(f)}catch(l){t.error(t,{message:"Could not get private key.",cause:l,send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.internal_error}})}if(f===null)return t.error(t,{message:"No private key set.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.internal_error}});try{if(o=t.session.sp,o.pre_master_secret=f.decrypt(c.enc_pre_master_secret),s=t.session.clientHelloVersion,s.major!==o.pre_master_secret.charCodeAt(0)||s.minor!==o.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.");}catch(l){o.pre_master_secret=n.random.getBytes(48)}t.expect=p;t.session.clientCertificate!==null&&(t.expect=bt);t.process()};i.handleCertificateRequest=function(n,t,r){if(r<3)return n.error(n,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.illegal_parameter}});var u=t.fragment,f={certificate_types:e(u,1),certificate_authorities:e(u,2)};n.session.certificateRequest=f;n.expect=lt;n.process()};i.handleCertificateVerify=function(t,r,u){var o,s,h,f,c;if(u<2)return t.error(t,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.illegal_parameter}});o=r.fragment;o.read-=4;s=o.bytes();o.read+=4;h={signature:e(o,2).getBytes()};f=n.util.createBuffer();f.putBuffer(t.session.md5.digest());f.putBuffer(t.session.sha1.digest());f=f.getBytes();try{if(c=t.session.clientCertificate,!c.publicKey.verify(f,h.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");t.session.md5.update(s);t.session.sha1.update(s)}catch(l){return t.error(t,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.handshake_failure}})}t.expect=p;t.process()};i.handleServerHelloDone=function(t,r,u){var o;if(u>0)return t.error(t,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.record_overflow}});if(t.serverCertificate===null){var e={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.insufficient_security}},f=t.verify(t,e.alert.description,0,[]);if(f!==!0)return(f||f===0)&&(typeof f=="object"&&!n.util.isArray(f)?(f.message&&(e.message=f.message),f.alert&&(e.alert.description=f.alert)):typeof f=="number"&&(e.alert.description=f)),t.error(t,e)}if(t.session.certificateRequest!==null&&(r=i.createRecord(t,{type:i.ContentType.handshake,data:i.createCertificate(t)}),i.queue(t,r)),r=i.createRecord(t,{type:i.ContentType.handshake,data:i.createClientKeyExchange(t)}),i.queue(t,r),t.expect=yt,o=function(n,t){n.session.certificateRequest!==null&&n.session.clientCertificate!==null&&i.queue(n,i.createRecord(n,{type:i.ContentType.handshake,data:i.createCertificateVerify(n,t)}));i.queue(n,i.createRecord(n,{type:i.ContentType.change_cipher_spec,data:i.createChangeCipherSpec()}));n.state.pending=i.createConnectionState(n);n.state.current.write=n.state.pending.write;i.queue(n,i.createRecord(n,{type:i.ContentType.handshake,data:i.createFinished(n)}));n.expect=d;i.flush(n);n.process()},t.session.certificateRequest===null||t.session.clientCertificate===null)return o(t,null);i.getClientSignature(t,o)};i.handleChangeCipherSpec=function(n,t){if(t.fragment.getByte()!==1)return n.error(n,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.illegal_parameter}});var r=n.entity===i.ConnectionEnd.client;(n.session.resuming&&r||!n.session.resuming&&!r)&&(n.state.pending=i.createConnectionState(n));n.state.current.read=n.state.pending.read;(!n.session.resuming&&r||n.session.resuming&&!r)&&(n.state.pending=null);n.expect=r?at:kt;n.process()};i.handleFinished=function(t,r){var u=r.fragment,e,o;u.read-=4;e=u.bytes();u.read+=4;o=r.fragment.getBytes();u=n.util.createBuffer();u.putBuffer(t.session.md5.digest());u.putBuffer(t.session.sha1.digest());var f=t.entity===i.ConnectionEnd.client,s=f?"server finished":"client finished",c=t.session.sp,l=h;if(u=l(c.master_secret,s,u.getBytes(),12),u.getBytes()!==o)return t.error(t,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.decrypt_error}});t.session.md5.update(e);t.session.sha1.update(e);(t.session.resuming&&f||!t.session.resuming&&!f)&&(i.queue(t,i.createRecord(t,{type:i.ContentType.change_cipher_spec,data:i.createChangeCipherSpec()})),t.state.current.write=t.state.pending.write,t.state.pending=null,i.queue(t,i.createRecord(t,{type:i.ContentType.handshake,data:i.createFinished(t)})));t.expect=f?vt:dt;t.handshaking=!1;++t.handshakes;t.peerCertificate=f?t.session.serverCertificate:t.session.clientCertificate;i.flush(t);t.isConnected=!0;t.connected(t);t.process()};i.handleAlert=function(n,t){var f=t.fragment,u={level:f.getByte(),description:f.getByte()},r;switch(u.description){case i.Alert.Description.close_notify:r="Connection closed.";break;case i.Alert.Description.unexpected_message:r="Unexpected message.";break;case i.Alert.Description.bad_record_mac:r="Bad record MAC.";break;case i.Alert.Description.decryption_failed:r="Decryption failed.";break;case i.Alert.Description.record_overflow:r="Record overflow.";break;case i.Alert.Description.decompression_failure:r="Decompression failed.";break;case i.Alert.Description.handshake_failure:r="Handshake failure.";break;case i.Alert.Description.bad_certificate:r="Bad certificate.";break;case i.Alert.Description.unsupported_certificate:r="Unsupported certificate.";break;case i.Alert.Description.certificate_revoked:r="Certificate revoked.";break;case i.Alert.Description.certificate_expired:r="Certificate expired.";break;case i.Alert.Description.certificate_unknown:r="Certificate unknown.";break;case i.Alert.Description.illegal_parameter:r="Illegal parameter.";break;case i.Alert.Description.unknown_ca:r="Unknown certificate authority.";break;case i.Alert.Description.access_denied:r="Access denied.";break;case i.Alert.Description.decode_error:r="Decode error.";break;case i.Alert.Description.decrypt_error:r="Decrypt error.";break;case i.Alert.Description.export_restriction:r="Export restriction.";break;case i.Alert.Description.protocol_version:r="Unsupported protocol version.";break;case i.Alert.Description.insufficient_security:r="Insufficient security.";break;case i.Alert.Description.internal_error:r="Internal error.";break;case i.Alert.Description.user_canceled:r="User canceled.";break;case i.Alert.Description.no_renegotiation:r="Renegotiation not supported.";break;default:r="Unknown error."}if(u.description===i.Alert.Description.close_notify)return n.close();n.error(n,{message:r,send:!1,origin:n.entity===i.ConnectionEnd.client?"server":"client",alert:u});n.process()};i.handleHandshake=function(t,r){var u=r.fragment,f=u.getByte(),e=u.getInt24(),o;if(e>u.length())return t.fragmented=r,r.fragment=n.util.createBuffer(),u.read-=4,t.process();t.fragmented=null;u.read-=4;o=u.bytes(e+4);u.read+=4;f in l[t.entity][t.expect]?(t.entity===i.ConnectionEnd.server&&!t.open&&!t.fail&&(t.handshaking=!0,t.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:n.md.md5.create(),sha1:n.md.sha1.create()}),f!==i.HandshakeType.hello_request&&f!==i.HandshakeType.certificate_verify&&f!==i.HandshakeType.finished&&(t.session.md5.update(o),t.session.sha1.update(o)),l[t.entity][t.expect][f](t,r,e)):i.handleUnexpected(t,r)};i.handleApplicationData=function(n,t){n.data.putBuffer(t.fragment);n.dataReady(n);n.process()};i.handleHeartbeat=function(t,r){var f=r.fragment,e=f.getByte(),o=f.getInt16(),u=f.getBytes(o);if(e===i.HeartbeatMessageType.heartbeat_request){if(t.handshaking||o>u.length)return t.process();i.queue(t,i.createRecord(t,{type:i.ContentType.heartbeat,data:i.createHeartbeat(i.HeartbeatMessageType.heartbeat_response,u)}));i.flush(t)}else if(e===i.HeartbeatMessageType.heartbeat_response){if(u!==t.expectedHeartbeatPayload)return t.process();t.heartbeatReceived&&t.heartbeatReceived(t,n.util.createBuffer(u))}t.process()};var st=0,ht=1,k=2,ct=3,lt=4,d=5,at=6,vt=7,yt=8,pt=0,wt=1,y=2,bt=3,p=4,kt=5,dt=6,t=i.handleUnexpected,g=i.handleChangeCipherSpec,r=i.handleAlert,f=i.handleHandshake,nt=i.handleApplicationData,u=i.handleHeartbeat,w=[];w[i.ConnectionEnd.client]=[[t,r,f,t,u],[t,r,f,t,u],[t,r,f,t,u],[t,r,f,t,u],[t,r,f,t,u],[g,r,t,t,u],[t,r,f,t,u],[t,r,f,nt,u],[t,r,f,t,u]];w[i.ConnectionEnd.server]=[[t,r,f,t,u],[t,r,f,t,u],[t,r,f,t,u],[t,r,f,t,u],[g,r,t,t,u],[t,r,f,t,u],[t,r,f,nt,u],[t,r,f,t,u]];var s=i.handleHelloRequest,gt=i.handleServerHello,tt=i.handleCertificate,it=i.handleServerKeyExchange,b=i.handleCertificateRequest,c=i.handleServerHelloDone,rt=i.handleFinished,l=[];l[i.ConnectionEnd.client]=[[t,t,gt,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[s,t,t,t,t,t,t,t,t,t,t,tt,it,b,c,t,t,t,t,t,t],[s,t,t,t,t,t,t,t,t,t,t,t,it,b,c,t,t,t,t,t,t],[s,t,t,t,t,t,t,t,t,t,t,t,t,b,c,t,t,t,t,t,t],[s,t,t,t,t,t,t,t,t,t,t,t,t,t,c,t,t,t,t,t,t],[s,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[s,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,rt],[s,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[s,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t]];var ni=i.handleClientHello,ti=i.handleClientKeyExchange,ii=i.handleCertificateVerify;l[i.ConnectionEnd.server]=[[t,ni,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,tt,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,ti,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,ii,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,rt],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t]];i.generateKeys=function(n,t){var s=h,f=t.client_random+t.server_random,e,o,r,u;return n.session.resuming||(t.master_secret=s(t.pre_master_secret,"master secret",f,48).bytes(),t.pre_master_secret=null),f=t.server_random+t.client_random,e=2*t.mac_key_length+2*t.enc_key_length,o=n.version.major===i.Versions.TLS_1_0.major&&n.version.minor===i.Versions.TLS_1_0.minor,o&&(e+=2*t.fixed_iv_length),r=s(t.master_secret,"key expansion",f,e),u={client_write_MAC_key:r.getBytes(t.mac_key_length),server_write_MAC_key:r.getBytes(t.mac_key_length),client_write_key:r.getBytes(t.enc_key_length),server_write_key:r.getBytes(t.enc_key_length)},o&&(u.client_write_IV=r.getBytes(t.fixed_iv_length),u.server_write_IV=r.getBytes(t.fixed_iv_length)),u};i.createConnectionState=function(n){var u=n.entity===i.ConnectionEnd.client,f=function(){var n={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(){return!0},compressionState:null,compressFunction:function(){return!0},updateSequenceNumber:function(){n.sequenceNumber[1]===4294967295?(n.sequenceNumber[1]=0,++n.sequenceNumber[0]):++n.sequenceNumber[1]}};return n},t={read:f(),write:f()},r;if(t.read.update=function(n,r){return t.read.cipherFunction(r,t.read)?t.read.compressFunction(n,r,t.read)||n.error(n,{message:"Could not decompress record.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.decompression_failure}}):n.error(n,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.bad_record_mac}}),!n.fail},t.write.update=function(n,r){return t.write.compressFunction(n,r,t.write)?t.write.cipherFunction(r,t.write)||n.error(n,{message:"Could not encrypt record.",send:!1,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.internal_error}}):n.error(n,{message:"Could not compress record.",send:!1,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.internal_error}}),!n.fail},n.session){r=n.session.sp;n.session.cipherSuite.initSecurityParameters(r);r.keys=i.generateKeys(n,r);t.read.macKey=u?r.keys.server_write_MAC_key:r.keys.client_write_MAC_key;t.write.macKey=u?r.keys.client_write_MAC_key:r.keys.server_write_MAC_key;n.session.cipherSuite.initConnectionState(t,n,r);switch(r.compression_algorithm){case i.CompressionMethod.none:break;case i.CompressionMethod.deflate:t.read.compressFunction=ot;t.write.compressFunction=et;break;default:throw new Error("Unsupported compression algorithm.");}}return t};i.createRandom=function(){var i=new Date,r=+i+i.getTimezoneOffset()*6e4,t=n.util.createBuffer();return t.putInt32(r),t.putBytes(n.random.getBytes(28)),t};i.createRecord=function(n,t){if(!t.data)return null;return{type:t.type,version:{major:n.version.major,minor:n.version.minor},length:t.data.length(),fragment:t.data}};i.createAlert=function(t,r){var u=n.util.createBuffer();return u.putByte(r.level),u.putByte(r.description),i.createRecord(t,{type:i.ContentType.alert,data:u})};i.createClientHello=function(t){var u,s,a,y,h,p,c,f,l,v,e;for(t.session.clientHelloVersion={major:t.version.major,minor:t.version.minor},u=n.util.createBuffer(),s=0;s<t.cipherSuites.length;++s)a=t.cipherSuites[s],u.putByte(a.id[0]),u.putByte(a.id[1]);y=u.length();h=n.util.createBuffer();h.putByte(i.CompressionMethod.none);p=h.length();c=n.util.createBuffer();t.virtualHost&&(f=n.util.createBuffer(),f.putByte(0),f.putByte(0),l=n.util.createBuffer(),l.putByte(0),o(l,2,n.util.createBuffer(t.virtualHost)),v=n.util.createBuffer(),o(v,2,l),o(f,2,v),c.putBuffer(f));e=c.length();e>0&&(e+=2);var w=t.session.id,b=w.length+1+2+4+28+2+y+1+p+e,r=n.util.createBuffer();return r.putByte(i.HandshakeType.client_hello),r.putInt24(b),r.putByte(t.version.major),r.putByte(t.version.minor),r.putBytes(t.session.sp.client_random),o(r,1,n.util.createBuffer(w)),o(r,2,u),o(r,1,h),e>0&&o(r,2,c),r};i.createServerHello=function(t){var u=t.session.id,f=u.length+1+2+4+28+2+1,r=n.util.createBuffer();return r.putByte(i.HandshakeType.server_hello),r.putInt24(f),r.putByte(t.version.major),r.putByte(t.version.minor),r.putBytes(t.session.sp.server_random),o(r,1,n.util.createBuffer(u)),r.putByte(t.session.cipherSuite.id[0]),r.putByte(t.session.cipherSuite.id[1]),r.putByte(t.session.compressionMethod),r};i.createCertificate=function(t){var v=t.entity===i.ConnectionEnd.client,r=null,y,e,s,h,u,c,l,a,p,f;if(t.getCertificate&&(y=v?t.session.certificateRequest:t.session.extensions.server_name.serverNameList,r=t.getCertificate(t,y)),e=n.util.createBuffer(),r!==null)try{for(n.util.isArray(r)||(r=[r]),s=null,h=0;h<r.length;++h){if(u=n.pem.decode(r[h])[0],u.type!=="CERTIFICATE"&&u.type!=="X509 CERTIFICATE"&&u.type!=="TRUSTED CERTIFICATE"){c=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw c.headerType=u.type,c;}if(u.procType&&u.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");l=n.util.createBuffer(u.body);s===null&&(s=n.asn1.fromDer(l.bytes(),!1));a=n.util.createBuffer();o(a,3,l);e.putBuffer(a)}r=n.pki.certificateFromAsn1(s);v?t.session.clientCertificate=r:t.session.serverCertificate=r}catch(w){return t.error(t,{message:"Could not send certificate list.",cause:w,send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.bad_certificate}})}return p=3+e.length(),f=n.util.createBuffer(),f.putByte(i.HandshakeType.certificate),f.putInt24(p),o(f,3,e),f};i.createClientKeyExchange=function(t){var r=n.util.createBuffer(),f,e,o,u;return r.putByte(t.session.clientHelloVersion.major),r.putByte(t.session.clientHelloVersion.minor),r.putBytes(n.random.getBytes(46)),f=t.session.sp,f.pre_master_secret=r.getBytes(),e=t.session.serverCertificate.publicKey,r=e.encrypt(f.pre_master_secret),o=r.length+2,u=n.util.createBuffer(),u.putByte(i.HandshakeType.client_key_exchange),u.putInt24(o),u.putInt16(r.length),u.putBytes(r),u};i.createServerKeyExchange=function(){var r=0,t=n.util.createBuffer();return r>0&&(t.putByte(i.HandshakeType.server_key_exchange),t.putInt24(r)),t};i.getClientSignature=function(t,r){var u=n.util.createBuffer();u.putBuffer(t.session.md5.digest());u.putBuffer(t.session.sha1.digest());u=u.getBytes();t.getSignature=t.getSignature||function(t,r,u){var f=null;if(t.getPrivateKey)try{f=t.getPrivateKey(t,t.session.clientCertificate);f=n.pki.privateKeyFromPem(f)}catch(e){t.error(t,{message:"Could not get private key.",cause:e,send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.internal_error}})}f===null?t.error(t,{message:"No private key set.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.internal_error}}):r=f.sign(r,null);u(t,r)};t.getSignature(t,u,r)};i.createCertificateVerify=function(t,r){var f=r.length+2,u=n.util.createBuffer();return u.putByte(i.HandshakeType.certificate_verify),u.putInt24(f),u.putInt16(r.length),u.putBytes(r),u};i.createCertificateRequest=function(t){var f=n.util.createBuffer(),u,e,s,h,c,r;f.putByte(1);u=n.util.createBuffer();for(e in t.caStore.certs)s=t.caStore.certs[e],h=n.pki.distinguishedNameToAsn1(s.subject),u.putBuffer(n.asn1.toDer(h));return c=1+f.length()+2+u.length(),r=n.util.createBuffer(),r.putByte(i.HandshakeType.certificate_request),r.putInt24(c),o(r,1,f),o(r,2,u),r};i.createServerHelloDone=function(){var t=n.util.createBuffer();return t.putByte(i.HandshakeType.server_hello_done),t.putInt24(0),t};i.createChangeCipherSpec=function(){var t=n.util.createBuffer();return t.putByte(1),t};i.createFinished=function(t){var r=n.util.createBuffer(),u;r.putBuffer(t.session.md5.digest());r.putBuffer(t.session.sha1.digest());var f=t.entity===i.ConnectionEnd.client,e=t.session.sp,o=h,s=f?"client finished":"server finished";return r=o(e.master_secret,s,r.getBytes(),12),u=n.util.createBuffer(),u.putByte(i.HandshakeType.finished),u.putInt24(r.length()),u.putBuffer(r),u};i.createHeartbeat=function(t,i,r){var u,f,e;return typeof r=="undefined"&&(r=i.length),u=n.util.createBuffer(),u.putByte(t),u.putInt16(r),u.putBytes(i),f=u.length(),e=Math.max(16,f-r-3),u.putBytes(n.random.getBytes(e)),u};i.queue=function(t,r){var e,f,u,o,s,h;if(r){if(r.type===i.ContentType.handshake&&(e=r.fragment.bytes(),t.session.md5.update(e),t.session.sha1.update(e),e=null),r.fragment.length()<=i.MaxFragment)f=[r];else{for(f=[],u=r.fragment.bytes();u.length>i.MaxFragment;)f.push(i.createRecord(t,{type:r.type,data:n.util.createBuffer(u.slice(0,i.MaxFragment))})),u=u.slice(i.MaxFragment);u.length>0&&f.push(i.createRecord(t,{type:r.type,data:n.util.createBuffer(u)}))}for(o=0;o<f.length&&!t.fail;++o)s=f[o],h=t.state.current.write,h.update(t,s)&&t.records.push(s)}};i.flush=function(n){for(var i,t=0;t<n.records.length;++t)i=n.records[t],n.tlsData.putByte(i.type),n.tlsData.putByte(i.version.major),n.tlsData.putByte(i.version.minor),n.tlsData.putInt16(i.fragment.length()),n.tlsData.putBuffer(n.records[t].fragment);return n.records=[],n.tlsDataReady(n)};a=function(t){switch(t){case!0:return!0;case n.pki.certificateError.bad_certificate:return i.Alert.Description.bad_certificate;case n.pki.certificateError.unsupported_certificate:return i.Alert.Description.unsupported_certificate;case n.pki.certificateError.certificate_revoked:return i.Alert.Description.certificate_revoked;case n.pki.certificateError.certificate_expired:return i.Alert.Description.certificate_expired;case n.pki.certificateError.certificate_unknown:return i.Alert.Description.certificate_unknown;case n.pki.certificateError.unknown_ca:return i.Alert.Description.unknown_ca;default:return i.Alert.Description.bad_certificate}};ut=function(t){switch(t){case!0:return!0;case i.Alert.Description.bad_certificate:return n.pki.certificateError.bad_certificate;case i.Alert.Description.unsupported_certificate:return n.pki.certificateError.unsupported_certificate;case i.Alert.Description.certificate_revoked:return n.pki.certificateError.certificate_revoked;case i.Alert.Description.certificate_expired:return n.pki.certificateError.certificate_expired;case i.Alert.Description.certificate_unknown:return n.pki.certificateError.certificate_unknown;case i.Alert.Description.unknown_ca:return n.pki.certificateError.unknown_ca;default:return n.pki.certificateError.bad_certificate}};i.verifyCertificateChain=function(t,r){try{n.pki.verifyCertificateChain(t.caStore,r,function(r,u,f){var s=a(r),e=t.verify(t,r,u,f),o;if(e!==!0){if(typeof e=="object"&&!n.util.isArray(e)){o=new Error("The application rejected the certificate.");throw o.send=!0,o.alert={level:i.Alert.Level.fatal,description:i.Alert.Description.bad_certificate},e.message&&(o.message=e.message),e.alert&&(o.alert.description=e.alert),o;}e!==r&&(e=ut(e))}return e})}catch(f){var u=f;(typeof u!="object"||n.util.isArray(u))&&(u={send:!0,alert:{level:i.Alert.Level.fatal,description:a(f)}});"send"in u||(u.send=!0);"alert"in u||(u.alert={level:i.Alert.Level.fatal,description:a(u.error)});t.error(t,u)}return!t.fail};i.createSessionCache=function(t,i){var r=null,u;if(t&&t.getSession&&t.setSession&&t.order)r=t;else{r={};r.cache=t||{};r.capacity=Math.max(i||100,1);r.order=[];for(u in t)r.order.length<=i?r.order.push(u):delete t[u];r.getSession=function(t){var f=null,i=null,u;if(t?i=n.util.bytesToHex(t):r.order.length>0&&(i=r.order[0]),i!==null&&i in r.cache){f=r.cache[i];delete r.cache[i];for(u in r.order)if(r.order[u]===i){r.order.splice(u,1);break}}return f};r.setSession=function(t,i){var u;r.order.length===r.capacity&&(u=r.order.shift(),delete r.cache[u]);u=n.util.bytesToHex(t);r.order.push(u);r.cache[u]=i}}return r};i.createConnection=function(t){var f=null,u,e;if(f=t.caStore?n.util.isArray(t.caStore)?n.pki.createCaStore(t.caStore):t.caStore:n.pki.createCaStore(),u=t.cipherSuites||null,u===null){u=[];for(e in i.CipherSuites)u.push(i.CipherSuites[e])}var o=t.server||!1?i.ConnectionEnd.server:i.ConnectionEnd.client,s=t.sessionCache?i.createSessionCache(t.sessionCache):null,r={version:{major:i.Version.major,minor:i.Version.minor},entity:o,sessionId:t.sessionId,caStore:f,sessionCache:s,cipherSuites:u,connected:t.connected,virtualHost:t.virtualHost||null,verifyClient:t.verifyClient||!1,verify:t.verify||function(n,t){return t},getCertificate:t.getCertificate||null,getPrivateKey:t.getPrivateKey||null,getSignature:t.getSignature||null,input:n.util.createBuffer(),tlsData:n.util.createBuffer(),data:n.util.createBuffer(),tlsDataReady:t.tlsDataReady,dataReady:t.dataReady,heartbeatReceived:t.heartbeatReceived,closed:t.closed,error:function(n,r){r.origin=r.origin||(n.entity===i.ConnectionEnd.client?"client":"server");r.send&&(i.queue(n,i.createAlert(n,r.alert)),i.flush(n));var u=r.fatal!==!1;u&&(n.fail=!0);t.error(n,r);u&&n.close(!1)},deflate:t.deflate||null,inflate:t.inflate||null};r.reset=function(n){r.version={major:i.Version.major,minor:i.Version.minor};r.record=null;r.session=null;r.peerCertificate=null;r.state={pending:null,current:null};r.expect=r.entity===i.ConnectionEnd.client?st:pt;r.fragmented=null;r.records=[];r.open=!1;r.handshakes=0;r.handshaking=!1;r.isConnected=!1;r.fail=!n&&typeof n!="undefined";r.input.clear();r.tlsData.clear();r.data.clear();r.state.current=i.createConnectionState(r)};r.reset();var h=function(n,t){var r=t.type-i.ContentType.change_cipher_spec,u=w[n.entity][n.expect];r in u?u[r](n,t):i.handleUnexpected(n,t)},c=function(t){var f=0,r=t.input,e=r.length(),u;return e<5?f=5-e:(t.record={type:r.getByte(),version:{major:r.getByte(),minor:r.getByte()},length:r.getInt16(),fragment:n.util.createBuffer(),ready:!1},u=t.record.version.major===t.version.major,u&&t.session&&t.session.version&&(u=t.record.version.minor===t.version.minor),u||t.error(t,{message:"Incompatible TLS version.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.protocol_version}})),f},l=function(n){var r=0,t=n.input,u=t.length(),f;return u<n.record.length?r=n.record.length-u:(n.record.fragment.putBytes(t.getBytes(n.record.length)),t.compact(),f=n.state.current.read,f.update(n,n.record)&&(n.fragmented!==null&&(n.fragmented.type===n.record.type?(n.fragmented.fragment.putBuffer(n.record.fragment),n.record=n.fragmented):n.error(n,{message:"Invalid fragmented record.",send:!0,alert:{level:i.Alert.Level.fatal,description:i.Alert.Description.unexpected_message}})),n.record.ready=!0)),r};return r.handshake=function(t){if(r.entity!==i.ConnectionEnd.client)r.error(r,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(r.handshaking)r.error(r,{message:"Handshake already in progress.",fatal:!1});else{r.fail&&!r.open&&r.handshakes===0&&(r.fail=!1);r.handshaking=!0;t=t||"";var u=null;t.length>0&&(r.sessionCache&&(u=r.sessionCache.getSession(t)),u===null&&(t=""));t.length===0&&r.sessionCache&&(u=r.sessionCache.getSession(),u!==null&&(t=u.id));r.session={id:t,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:n.md.md5.create(),sha1:n.md.sha1.create()};u&&(r.version=u.version,r.session.sp=u.sp);r.session.sp.client_random=i.createRandom().getBytes();r.open=!0;i.queue(r,i.createRecord(r,{type:i.ContentType.handshake,data:i.createClientHello(r)}));i.flush(r)}},r.process=function(n){var t=0;return n&&r.input.putBytes(n),r.fail||(r.record!==null&&r.record.ready&&r.record.fragment.isEmpty()&&(r.record=null),r.record===null&&(t=c(r)),!r.fail&&r.record!==null&&!r.record.ready&&(t=l(r)),!r.fail&&r.record!==null&&r.record.ready&&h(r,r.record)),t},r.prepare=function(t){return i.queue(r,i.createRecord(r,{type:i.ContentType.application_data,data:n.util.createBuffer(t)})),i.flush(r)},r.prepareHeartbeatRequest=function(t,u){return t instanceof n.util.ByteBuffer&&(t=t.bytes()),typeof u=="undefined"&&(u=t.length),r.expectedHeartbeatPayload=t,i.queue(r,i.createRecord(r,{type:i.ContentType.heartbeat,data:i.createHeartbeat(i.HeartbeatMessageType.heartbeat_request,t,u)})),i.flush(r)},r.close=function(n){if(!r.fail&&r.sessionCache&&r.session){var t={id:r.session.id,version:r.session.version,sp:r.session.sp};t.sp.keys=null;r.sessionCache.setSession(t.id,t)}r.open&&(r.open=!1,r.input.clear(),(r.isConnected||r.handshaking)&&(r.isConnected=r.handshaking=!1,i.queue(r,i.createAlert(r,{level:i.Alert.Level.warning,description:i.Alert.Description.close_notify})),i.flush(r)),r.closed(r));r.reset(n)},r};n.tls=n.tls||{};for(v in i)typeof i[v]!="function"&&(n.tls[v]=i[v]);n.tls.prf_tls1=h;n.tls.hmac_sha1=ft;n.tls.createSessionCache=i.createSessionCache;n.tls.createConnection=i.createConnection}var i="tls",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/tls",["require","module","./asn1","./hmac","./md","./pem","./pki","./random","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){function i(i,r,f){var e=r.entity===n.tls.ConnectionEnd.client;i.read.cipherState={init:!1,cipher:n.cipher.createDecipher("AES-CBC",e?f.keys.server_write_key:f.keys.client_write_key),iv:e?f.keys.server_write_IV:f.keys.client_write_IV};i.write.cipherState={init:!1,cipher:n.cipher.createCipher("AES-CBC",e?f.keys.client_write_key:f.keys.server_write_key),iv:e?f.keys.client_write_IV:f.keys.server_write_IV};i.read.cipherFunction=o;i.write.cipherFunction=u;i.read.macLength=i.write.macLength=f.mac_length;i.read.macFunction=i.write.macFunction=t.hmac_sha1}function u(i,r){var o=!1,s=r.macFunction(r.macKey,r.sequenceNumber,i),e,u;return i.fragment.putBytes(s),r.updateSequenceNumber(),e=i.version.minor===t.Versions.TLS_1_0.minor?r.cipherState.init?null:r.cipherState.iv:n.random.getBytesSync(16),r.cipherState.init=!0,u=r.cipherState.cipher,u.start({iv:e}),i.version.minor>=t.Versions.TLS_1_1.minor&&u.output.putBytes(e),u.update(i.fragment),u.finish(f)&&(i.fragment=u.output,i.length=i.fragment.length(),o=!0),o}function f(n,t,i){if(!i){var r=n-t.length()%n;t.fillWithByte(r-1,r)}return!0}function e(n,t,i){var r=!0,e,u,f;if(i){for(e=t.length(),u=t.last(),f=e-1-u;f<e-1;++f)r=r&&t.at(f)==u;r&&t.truncate(u+1)}return r}function o(i,u){var s=!1,a,f,o,h,c,l,v;for(++r,a=i.version.minor===t.Versions.TLS_1_0.minor?u.cipherState.init?null:u.cipherState.iv:i.fragment.getBytes(16),u.cipherState.init=!0,f=u.cipherState.cipher,f.start({iv:a}),f.update(i.fragment),s=f.finish(e),o=u.macLength,h="",c=0;c<o;++c)h+=String.fromCharCode(0);return l=f.output.length(),l>=o?(i.fragment=f.output.getBytes(l-o),h=f.output.getBytes(o)):i.fragment=f.output.getBytes(),i.fragment=n.util.createBuffer(i.fragment),i.length=i.fragment.length(),v=u.macFunction(u.macKey,u.sequenceNumber,i),u.updateSequenceNumber(),s=v===h&&s,s}var t=n.tls,r;t.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(n){n.bulk_cipher_algorithm=t.BulkCipherAlgorithm.aes;n.cipher_type=t.CipherType.block;n.enc_key_length=16;n.block_length=16;n.fixed_iv_length=16;n.record_iv_length=16;n.mac_algorithm=t.MACAlgorithm.hmac_sha1;n.mac_length=20;n.mac_key_length=20},initConnectionState:i};t.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(n){n.bulk_cipher_algorithm=t.BulkCipherAlgorithm.aes;n.cipher_type=t.CipherType.block;n.enc_key_length=32;n.block_length=16;n.fixed_iv_length=16;n.record_iv_length=16;n.mac_algorithm=t.MACAlgorithm.hmac_sha1;n.mac_length=20;n.mac_key_length=20},initConnectionState:i};r=0}var i="aesCipherSuites",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/aesCipherSuites",["require","module","./aes","./tls"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){n.debug=n.debug||{};n.debug.storage={};n.debug.get=function(t,i){var r;return typeof t=="undefined"?r=n.debug.storage:t in n.debug.storage&&(r=typeof i=="undefined"?n.debug.storage[t]:n.debug.storage[t][i]),r};n.debug.set=function(t,i,r){t in n.debug.storage||(n.debug.storage[t]={});n.debug.storage[t][i]=r};n.debug.clear=function(t,i){typeof t=="undefined"?n.debug.storage={}:t in n.debug.storage&&(typeof i=="undefined"?delete n.debug.storage[t]:delete n.debug.storage[t][i])}}var i="debug",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/debug",["require","module"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){function t(t,i,r,u){t.generate=function(t,f){for(var h,e=new n.util.ByteBuffer,c=Math.ceil(f/u)+r,s=new n.util.ByteBuffer,o=r;o<c;++o)s.putInt32(o),i.start(),i.update(t+s.getBytes()),h=i.digest(),e.putBytes(h.getBytes(u));return e.truncate(e.length()-f),e.getBytes()}}n.kem=n.kem||{};var i=n.jsbn.BigInteger;n.kem.rsa={};n.kem.rsa.create=function(t,r){r=r||{};var f=r.prng||n.random,u={};return u.encrypt=function(r,u){var s=Math.ceil(r.n.bitLength()/8),e,o,h,c;do e=new i(n.util.bytesToHex(f.getBytesSync(s)),16).mod(r.n);while(e.equals(i.ZERO));return e=n.util.hexToBytes(e.toString(16)),o=s-e.length,o>0&&(e=n.util.fillString(String.fromCharCode(0),o)+e),h=r.encrypt(e,"NONE"),c=t.generate(e,u),{encapsulation:h,key:c}},u.decrypt=function(n,i,r){var u=n.decrypt(i,"NONE");return t.generate(u,r)},u};n.kem.kdf1=function(n,i){t(this,n,0,i||n.digestLength)};n.kem.kdf2=function(n,i){t(this,n,1,i||n.digestLength)}}var i="kem",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/kem",["require","module","./util","./random","./jsbn"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){var s,h,t,r,c,e,u,l;n.log=n.log||{};n.log.levels=["none","error","warning","info","debug","verbose","max"];var f={},o=[],i=null;for(n.log.LEVEL_LOCKED=2,n.log.NO_LEVEL_CHECK=4,n.log.INTERPOLATE=8,t=0;t<n.log.levels.length;++t)s=n.log.levels[t],f[s]={index:t,name:s.toUpperCase()};for(n.log.logMessage=function(t){for(var i,u,e=f[t.level].index,r=0;r<o.length;++r)i=o[r],i.flags&n.log.NO_LEVEL_CHECK?i.f(t):(u=f[i.level].index,e<=u&&i.f(i,t))},n.log.prepareStandard=function(n){"standard"in n||(n.standard=f[n.level].name+" ["+n.category+"] "+n.message)},n.log.prepareFull=function(t){if(!("full"in t)){var i=[t.message];i=i.concat([]||t.arguments);t.full=n.util.format.apply(this,i)}},n.log.prepareStandardFull=function(t){"standardFull"in t||(n.log.prepareStandard(t),t.standardFull=t.standard)},h=["error","warning","info","debug","verbose"],t=0;t<h.length;++t)(function(t){n.log[t]=function(i,r){var u=Array.prototype.slice.call(arguments).slice(2),f={timestamp:new Date,level:t,category:i,message:r,arguments:u};n.log.logMessage(f)}})(h[t]);n.log.makeLogger=function(t){var i={flags:0,f:t};return n.log.setLevel(i,"none"),i};n.log.setLevel=function(t,i){var u=!1,r,f;if(t&&!(t.flags&n.log.LEVEL_LOCKED))for(r=0;r<n.log.levels.length;++r)if(f=n.log.levels[r],i==f){t.level=i;u=!0;break}return u};n.log.lock=function(t,i){typeof i=="undefined"||i?t.flags|=n.log.LEVEL_LOCKED:t.flags&=~n.log.LEVEL_LOCKED};n.log.addLogger=function(n){o.push(n)};typeof console!="undefined"&&"log"in console?(console.error&&console.warn&&console.info&&console.debug?(c={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},e=function(t,i){n.log.prepareStandard(i);var u=c[i.level],r=[i.standard];r=r.concat(i.arguments.slice());u.apply(console,r)},r=n.log.makeLogger(e)):(e=function(t,i){n.log.prepareStandardFull(i);console.log(i.standardFull)},r=n.log.makeLogger(e)),n.log.setLevel(r,"debug"),n.log.addLogger(r),i=r):console={log:function(){}};i!==null&&(u=n.util.getQueryVariables(),"console.level"in u&&n.log.setLevel(i,u["console.level"].slice(-1)[0]),"console.lock"in u&&(l=u["console.lock"].slice(-1)[0],l=="true"&&n.log.lock(i)));n.log.consoleLogger=i}var i="log",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/log",["require","module","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){var t=n.asn1,i=n.pkcs7=n.pkcs7||{};i.messageFromPem=function(r){var u=n.pem.decode(r)[0],f,e;if(u.type!=="PKCS7"){f=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw f.headerType=u.type,f;}if(u.procType&&u.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");return e=t.fromDer(u.body),i.messageFromAsn1(e)};i.messageToPem=function(i,r){var u={type:"PKCS7",body:t.toDer(i.toAsn1()).getBytes()};return n.pem.encode(u,{maxline:r})};i.messageFromAsn1=function(r){var f={},s=[],e,o,u;if(!t.validate(r,i.asn1.contentInfoValidator,f,s)){e=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw e.errors=s,e;}o=t.derToOid(f.contentType);switch(o){case n.pki.oids.envelopedData:u=i.createEnvelopedData();break;case n.pki.oids.encryptedData:u=i.createEncryptedData();break;case n.pki.oids.signedData:u=i.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+o+" is not (yet) supported.");}return u.fromAsn1(f.content.value[0]),u};var f=function(r){var u={},e=[],f;if(!t.validate(r,i.asn1.recipientInfoValidator,u,e)){f=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 EnvelopedData.");throw f.errors=e,f;}return{version:u.version.charCodeAt(0),issuer:n.pki.RDNAttributesAsArray(u.issuer),serialNumber:n.util.createBuffer(u.serial).toHex(),encryptedContent:{algorithm:t.derToOid(u.encAlgorithm),parameter:u.encParameter.value,content:u.encKey}}},e=function(i){return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(i.version).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[n.pki.distinguishedNameToAsn1({attributes:i.issuer}),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,n.util.hexToBytes(i.serialNumber))]),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(i.encryptedContent.algorithm).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")]),t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,i.encryptedContent.content)])},o=function(n){for(var i=[],t=0;t<n.length;t++)i.push(f(n[t]));return i},s=function(n){for(var i=[],t=0;t<n.length;t++)i.push(e(n[t]));return i},h=function(i){return[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(n.pki.oids.data).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(i.algorithm).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,i.parameter.getBytes())]),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,i.content.getBytes())])]},r=function(i,r,u){var f={},s,h,o,e;if(!t.validate(r,u,f,[])){s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s;}if(h=t.derToOid(f.contentType),h!==n.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(f.encryptedContent){if(o="",n.util.isArray(f.encryptedContent))for(e=0;e<f.encryptedContent.length;++e){if(f.encryptedContent[e].type!==t.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");o+=f.encryptedContent[e].value}else o=f.encryptedContent;i.encryptedContent={algorithm:t.derToOid(f.encAlgorithm),parameter:n.util.createBuffer(f.encParameter.value),content:n.util.createBuffer(o)}}if(f.content){if(o="",n.util.isArray(f.content))for(e=0;e<f.content.length;++e){if(f.content[e].type!==t.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");o+=f.content[e].value}else o=f.content;i.content=n.util.createBuffer(o)}return i.version=f.version.charCodeAt(0),i.rawCapture=f,f},u=function(t){if(t.encryptedContent.key===undefined)throw new Error("Symmetric key not available.");if(t.content===undefined){var i;switch(t.encryptedContent.algorithm){case n.pki.oids["aes128-CBC"]:case n.pki.oids["aes192-CBC"]:case n.pki.oids["aes256-CBC"]:i=n.aes.createDecryptionCipher(t.encryptedContent.key);break;case n.pki.oids.desCBC:case n.pki.oids["des-EDE3-CBC"]:i=n.des.createDecryptionCipher(t.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+t.encryptedContent.algorithm);}if(i.start(t.encryptedContent.parameter),i.update(t.encryptedContent.content),!i.finish())throw new Error("Symmetric decryption failed.");t.content=i.output}};i.createSignedData=function(){var u=null;return u={type:n.pki.oids.signedData,version:1,certificates:[],crls:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(t){var e,f;for(r(u,t,i.asn1.signedDataValidator),u.certificates=[],u.crls=[],u.digestAlgorithmIdentifiers=[],u.contentInfo=null,u.signerInfos=[],e=u.rawCapture.certificates.value,f=0;f<e.length;++f)u.certificates.push(n.pki.certificateFromAsn1(e[f]))},toAsn1:function(){var i,r,f;if("content"in u)throw new Error("Signing PKCS#7 content not yet implemented.");for(u.contentInfo||u.sign(),i=[],r=0;r<u.certificates.length;++r)i.push(n.pki.certificateToAsn1(u.certificates[0]));return f=[],t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(u.type).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(u.version).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,u.digestAlgorithmIdentifiers),u.contentInfo,t.create(t.Class.CONTEXT_SPECIFIC,0,!0,i),t.create(t.Class.CONTEXT_SPECIFIC,1,!0,f),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,u.signerInfos)])])])},sign:function(){if("content"in u)throw new Error("PKCS#7 signing not yet implemented.");typeof u.content!="object"&&(u.contentInfo=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(n.pki.oids.data).getBytes())]),"content"in u&&u.contentInfo.value.push(t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,u.content)])))},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.");},addCertificate:function(t){typeof t=="string"&&(t=n.pki.certificateFromPem(t));u.certificates.push(t)},addCertificateRevokationList:function(){throw new Error("PKCS#7 CRL support not yet implemented.");}},u};i.createEncryptedData=function(){var t=null;return t={type:n.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:n.pki.oids["aes256-CBC"]},fromAsn1:function(n){r(t,n,i.asn1.encryptedDataValidator)},decrypt:function(n){n!==undefined&&(t.encryptedContent.key=n);u(t)}},t};i.createEnvelopedData=function(){var f=null;return f={type:n.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:n.pki.oids["aes256-CBC"]},fromAsn1:function(n){var t=r(f,n,i.asn1.envelopedDataValidator);f.recipients=o(t.recipientInfos.value)},toAsn1:function(){return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(f.type).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(f.version).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,s(f.recipients)),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,h(f.encryptedContent))])])])},findRecipient:function(n){for(var r,u,o,t,i=n.issuer.attributes,e=0;e<f.recipients.length;++e)if((r=f.recipients[e],u=r.issuer,r.serialNumber===n.serialNumber)&&u.length===i.length){for(o=!0,t=0;t<i.length;++t)if(u[t].type!==i[t].type||u[t].value!==i[t].value){o=!1;break}if(o)return r}return null},decrypt:function(t,i){if(f.encryptedContent.key===undefined&&t!==undefined&&i!==undefined)switch(t.encryptedContent.algorithm){case n.pki.oids.rsaEncryption:case n.pki.oids.desCBC:var r=i.decrypt(t.encryptedContent.content);f.encryptedContent.key=n.util.createBuffer(r);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm);}u(f)},addRecipient:function(t){f.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:n.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,i){var r,e,o,s,h,u;if(f.encryptedContent.content===undefined){i=i||f.encryptedContent.algorithm;t=t||f.encryptedContent.key;switch(i){case n.pki.oids["aes128-CBC"]:r=16;e=16;o=n.aes.createEncryptionCipher;break;case n.pki.oids["aes192-CBC"]:r=24;e=16;o=n.aes.createEncryptionCipher;break;case n.pki.oids["aes256-CBC"]:r=32;e=16;o=n.aes.createEncryptionCipher;break;case n.pki.oids["des-EDE3-CBC"]:r=24;e=8;o=n.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+i);}if(t===undefined)t=n.util.createBuffer(n.random.getBytes(r));else if(t.length()!=r)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+r+".");if(f.encryptedContent.algorithm=i,f.encryptedContent.key=t,f.encryptedContent.parameter=n.util.createBuffer(n.random.getBytes(e)),s=o(t),s.start(f.encryptedContent.parameter.copy()),s.update(f.content),!s.finish())throw new Error("Symmetric encryption failed.");f.encryptedContent.content=s.output}for(h=0;h<f.recipients.length;h++)if(u=f.recipients[h],u.encryptedContent.content===undefined)switch(u.encryptedContent.algorithm){case n.pki.oids.rsaEncryption:u.encryptedContent.content=u.encryptedContent.key.encrypt(f.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+u.encryptedContent.algorithm);}}},f}}var i="pkcs7",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/pkcs7",["require","module","./aes","./asn1","./des","./oids","./pem","./pkcs7asn1","./random","./util","./x509"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){function t(t,i){var r=i.toString(16),u;r[0]>="8"&&(r="00"+r);u=n.util.hexToBytes(r);t.putInt32(u.length);t.putBytes(u)}function i(n,t){n.putInt32(t.length);n.putString(t)}function r(){for(var i=n.md.sha1.create(),r=arguments.length,t=0;t<r;++t)i.update(arguments[t]);return i.digest()}var u=n.ssh=n.ssh||{};u.privateKeyToPutty=function(u,f,e){var c,d,a,o,v,y,p,w,l,g,tt,s,b;e=e||"";f=f||"";var k="ssh-rsa",nt=f===""?"none":"aes256-cbc",h="PuTTY-User-Key-File-2: "+k+"\r\n";return h+="Encryption: "+nt+"\r\n",h+="Comment: "+e+"\r\n",c=n.util.createBuffer(),i(c,k),t(c,u.e),t(c,u.n),d=n.util.encode64(c.bytes(),64),a=Math.floor(d.length/66)+1,h+="Public-Lines: "+a+"\r\n",h+=d,o=n.util.createBuffer(),t(o,u.d),t(o,u.p),t(o,u.q),t(o,u.qInv),f?(y=o.length()+16-1,y-=y%16,p=r(o.bytes()),p.truncate(p.length()-y+o.length()),o.putBuffer(p),w=n.util.createBuffer(),w.putBuffer(r("\0\0\0\0",f)),w.putBuffer(r("\0\0\0",f)),l=n.aes.createEncryptionCipher(w.truncate(8),"CBC"),l.start(n.util.createBuffer().fillWithByte(0,16)),l.update(o.copy()),l.finish(),g=l.output,g.truncate(16),v=n.util.encode64(g.bytes(),64)):v=n.util.encode64(o.bytes(),64),a=Math.floor(v.length/66)+1,h+="\r\nPrivate-Lines: "+a+"\r\n",h+=v,tt=r("putty-private-key-file-mac-key",f),s=n.util.createBuffer(),i(s,k),i(s,nt),i(s,e),s.putInt32(c.length()),s.putBuffer(c),s.putInt32(o.length()),s.putBuffer(o),b=n.hmac.create(),b.start("sha1",tt),b.update(s.bytes()),h+="\r\nPrivate-MAC: "+b.digest().toHex()+"\r\n",h};u.publicKeyToOpenSSH=function(r,u){var e="ssh-rsa",f;return u=u||"",f=n.util.createBuffer(),i(f,e),t(f,r.e),t(f,r.n),e+" "+n.util.encode64(f.bytes())+" "+u};u.privateKeyToOpenSSH=function(t,i){return i?n.pki.encryptRsaPrivateKey(t,i,{legacy:!0,algorithm:"aes128"}):n.pki.privateKeyToPem(t)};u.getPublicKeyFingerprint=function(r,u){var e,s;u=u||{};var o=u.md||n.md.md5.create(),f=n.util.createBuffer();if(i(f,"ssh-rsa"),t(f,r.e),t(f,r.n),o.start(),o.update(f.getBytes()),e=o.digest(),u.encoding==="hex")return s=e.toHex(),u.delimiter?s.match(/.{2}/g).join(u.delimiter):s;if(u.encoding==="binary")return e.getBytes();if(u.encoding)throw new Error('Unknown encoding "'+u.encoding+'".');return e}}var i="ssh",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/ssh",["require","module","./aes","./hmac","./md5","./sha1","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function u(n){var h="forge.task",k=0,nt={},rt=0,f,s;n.debug.set(h,"tasks",nt);f={};n.debug.set(h,"queues",f);var it="?",ut=30,ft=20,c="ready",u="running",o="blocked",e="sleeping",i="done",r="error",v="stop",l="start",p="block",d="unblock",w="sleep",g="wakeup",y="cancel",b="fail",t={};t[c]={};t[c][v]=c;t[c][l]=u;t[c][y]=i;t[c][b]=r;t[u]={};t[u][v]=c;t[u][l]=u;t[u][p]=o;t[u][d]=u;t[u][w]=e;t[u][g]=u;t[u][y]=i;t[u][b]=r;t[o]={};t[o][v]=o;t[o][l]=o;t[o][p]=o;t[o][d]=o;t[o][w]=o;t[o][g]=o;t[o][y]=i;t[o][b]=r;t[e]={};t[e][v]=e;t[e][l]=e;t[e][p]=e;t[e][d]=e;t[e][w]=e;t[e][g]=e;t[e][y]=i;t[e][b]=r;t[i]={};t[i][v]=i;t[i][l]=i;t[i][p]=i;t[i][d]=i;t[i][w]=i;t[i][g]=i;t[i][y]=i;t[i][b]=r;t[r]={};t[r][v]=r;t[r][l]=r;t[r][p]=r;t[r][d]=r;t[r][w]=r;t[r][g]=r;t[r][y]=r;t[r][b]=r;s=function(t){this.id=-1;this.name=t.name||it;this.parent=t.parent||null;this.run=t.run;this.subtasks=[];this.error=!1;this.state=c;this.blocks=0;this.timeoutId=null;this.swapTime=null;this.userData=null;this.id=rt++;nt[this.id]=this;k>=1&&n.log.verbose(h,"[%s][%s] init",this.id,this.name,this)};s.prototype.debug=function(t){t=t||"";n.log.debug(h,t,"[%s][%s] task:",this.id,this.name,this,"subtasks:",this.subtasks.length,"queue:",f)};s.prototype.next=function(n,t){typeof n=="function"&&(t=n,n=this.name);var i=new s({run:t,name:n,parent:this});return i.state=u,i.type=this.type,i.successCallback=this.successCallback||null,i.failureCallback=this.failureCallback||null,this.subtasks.push(i),this};s.prototype.parallel=function(t,i){return n.util.isArray(t)&&(i=t,t=this.name),this.next(t,function(r){var f=r,e,u,o,s;for(f.block(i.length),e=function(t,r){n.task.start({type:t,run:function(n){i[r](n)},success:function(){f.unblock()},failure:function(){f.unblock()}})},u=0;u<i.length;u++)o=t+"__parallel-"+r.id+"-"+u,s=u,e(o,s)})};s.prototype.stop=function(){this.state=t[this.state][v]};s.prototype.start=function(){this.error=!1;this.state=t[this.state][l];this.state===u&&(this.start=new Date,this.run(this),a(this,0))};s.prototype.block=function(n){n=typeof n=="undefined"?1:n;this.blocks+=n;this.blocks>0&&(this.state=t[this.state][p])};s.prototype.unblock=function(n){return n=typeof n=="undefined"?1:n,this.blocks-=n,this.blocks===0&&this.state!==i&&(this.state=u,a(this,0)),this.blocks};s.prototype.sleep=function(n){n=typeof n=="undefined"?0:n;this.state=t[this.state][w];var i=this;this.timeoutId=setTimeout(function(){i.timeoutId=null;i.state=u;a(i,0)},n)};s.prototype.wait=function(n){n.wait(this)};s.prototype.wakeup=function(){this.state===e&&(cancelTimeout(this.timeoutId),this.timeoutId=null,this.state=u,a(this,0))};s.prototype.cancel=function(){this.state=t[this.state][y];this.permitsNeeded=0;this.timeoutId!==null&&(cancelTimeout(this.timeoutId),this.timeoutId=null);this.subtasks=[]};s.prototype.fail=function(n){if(this.error=!0,tt(this,!0),n)n.error=this.error,n.swapTime=this.swapTime,n.userData=this.userData,a(n,0);else{if(this.parent!==null){for(var t=this.parent;t.parent!==null;)t.error=this.error,t.swapTime=this.swapTime,t.userData=this.userData,t=t.parent;tt(t,!0)}this.failureCallback&&this.failureCallback(this)}};var et=function(n){n.error=!1;n.state=t[n.state][l];setTimeout(function(){n.state===u&&(n.swapTime=+new Date,n.run(n),a(n,0))},0)},a=function(n,t){var i=t>ut||+new Date-n.swapTime>ft,r=function(t){if(t++,n.state===u)if(i&&(n.swapTime=+new Date),n.subtasks.length>0){var r=n.subtasks.shift();r.error=n.error;r.swapTime=n.swapTime;r.userData=n.userData;r.run(r);r.error||a(r,t)}else tt(n),n.error||n.parent!==null&&(n.parent.error=n.error,n.parent.swapTime=n.swapTime,n.parent.userData=n.userData,a(n.parent,t))};i?setTimeout(r,0):r(t)},tt=function(t,r){t.state=i;delete nt[t.id];k>=1&&n.log.verbose(h,"[%s][%s] finish",t.id,t.name,t);t.parent===null&&(t.type in f?f[t.type].length===0?n.log.error(h,"[%s][%s] task queue empty [%s]",t.id,t.name,t.type):f[t.type][0]!==t?n.log.error(h,"[%s][%s] task not first in queue [%s]",t.id,t.name,t.type):(f[t.type].shift(),f[t.type].length===0?(k>=1&&n.log.verbose(h,"[%s][%s] delete queue [%s]",t.id,t.name,t.type),delete f[t.type]):(k>=1&&n.log.verbose(h,"[%s][%s] queue start next [%s] remain:%s",t.id,t.name,t.type,f[t.type].length),f[t.type][0].start())):n.log.error(h,"[%s][%s] task queue missing [%s]",t.id,t.name,t.type),r||(t.error&&t.failureCallback?t.failureCallback(t):!t.error&&t.successCallback&&t.successCallback(t)))};n.task=n.task||{};n.task.start=function(t){var i=new s({run:t.run,name:t.name||it});i.type=t.type;i.successCallback=t.success||null;i.failureCallback=t.failure||null;i.type in f?f[t.type].push(i):(k>=1&&n.log.verbose(h,"[%s][%s] create queue [%s]",i.id,i.name,i.type),f[i.type]=[i],et(i))};n.task.cancel=function(n){n in f&&(f[n]=[f[n][0]])};n.task.createCondition=function(){var n={tasks:{}};return n.wait=function(t){t.id in n.tasks||(t.block(),n.tasks[t.id]=t)},n.notify=function(){var t=n.tasks,i;n.tasks={};for(i in t)t[i].unblock()},n}}var i="task",f,e,o,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports)return typeof forge=="undefined"&&(forge={}),u(forge);f=!0;n=function(n,i){i(t,module)}}o=function(n,t){t.exports=function(t){var f=e.map(function(t){return n(t)}).concat(u),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<f.length;++r)f[r](t);return t[i]}};r=n;n=function(t,i){return e=typeof t=="string"?i.slice(2):t.slice(2),f?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/task",["require","module","./debug","./log","./util"],function(){o.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){var i="forge",u,f,e,r;if(typeof n!="function"){if(typeof module!="object"||!module.exports){typeof forge=="undefined"&&(forge={disableNativeCode:!1});return}u=!0;n=function(n,i){i(t,module)}}e=function(n,t){t.exports=function(t){var u=f.map(function(t){return n(t)}),r;if(t=t||{},t.defined=t.defined||{},t.defined[i])return t[i];for(t.defined[i]=!0,r=0;r<u.length;++r)u[r](t);return t};t.exports.disableNativeCode=!1;t.exports(t.exports)};r=n;n=function(t,i){return f=typeof t=="string"?i.slice(2):t.slice(2),u?(delete n,r.apply(null,Array.prototype.slice.call(arguments,0))):(n=r,n.apply(null,Array.prototype.slice.call(arguments,0)))};n("js/forge",["require","module","./aes","./aesCipherSuites","./asn1","./cipher","./cipherModes","./debug","./des","./hmac","./kem","./log","./md","./mgf1","./pbkdf2","./pem","./pkcs7","./pkcs1","./pkcs12","./pki","./prime","./prng","./pss","./random","./rc2","./ssh","./task","./tls","./util"],function(){e.apply(null,Array.prototype.slice.call(arguments,0))})}(),t("js/forge")});Uint8ArrayUtil={},function(){Uint8ArrayUtil.subarray=function(n,t){return this.slice(n,t)};Uint8ArrayUtil.set_=function(n,t){arguments.length<2&&(t=0);for(var i=0,r=n.length;i<r;++i,++t)this[t]=n[i]&255};Uint8ArrayUtil.TypedArray=function(n){var t,i;if(typeof n=="number")for(t=new Array(n),i=0;i<n;++i)t[i]=0;else t=n.slice(0);return t.subarray=Uint8ArrayUtil.subarray,t.buffer=t,t.byteLength=t.length,t.set=Uint8ArrayUtil.set_,typeof n=="object"&&n.buffer&&(t.buffer=n.buffer),t}}();window.Uint8Array===undefined&&(window.Uint8Array=Uint8ArrayUtil.TypedArray),function(n){(function(t){"use strict";var s,h,c,u,f,e,o,i,r;(function(n){n[n.proceed=0]="proceed";n[n.endOfStream=1]="endOfStream";n[n.retry=2]="retry"})(t.RequestState||(t.RequestState={}));s=t.RequestState,function(n){n[n.arraybuffer=0]="arraybuffer";n[n.blob=1]="blob";n[n.document=2]="document";n[n.json=3]="json";n[n.text=4]="text"}(t.ResponseType||(t.ResponseType={}));h=t.ResponseType,function(n){n[n.mediaSegment=0]="mediaSegment";n[n.initSegment=1]="initSegment";n[n.initBandwidth=2]="initBandwidth"}(t.RequestType||(t.RequestType={}));c=t.RequestType;u=function(){function i(i,r,u){this.azureHtml5=i;this.videoTag=r;this.appConfig=u;this.emeManager=new n.KeySystem.EmeManager(r);this.eventMgr=new n.Events.Manager(i,!1);this.workflows=null;this.presentationUrl=null;this.presentationJson=null;this.commonPresentation=null;this.isLiveToVod=!1;this.videoBufferData=new t.BufferData;this.audioBufferData=new t.BufferData;this.startPositionInSec=NaN;this.authenticationTokens={};this.heuristicSettings=new n.Settings.Heuristics;this.httpRetryPolicySettings=new n.Settings.HttpRetryPolicy;this.httpDataRetrieverSettings=new n.Settings.HttpDataRetriever;this._disposed=!1}return i.prototype.dispose=function(){this._disposed||(this._disposed=!0,this.videoTag=null,this.appConfig=null,this.workflows&&this.workflows.forEach(function(n){n.dispose()}),this.workflows=null,this.presentationUrl=null,this.presentationJson=null,this.authenticationTokens=null,this.emeManager&&(this.emeManager.dispose(),this.emeManager=null),this.eventMgr&&(this.eventMgr.dispose(),this.eventMgr=null),this.commonPresentation&&(this.commonPresentation.dispose(),this.commonPresentation=null),this.heuristicSettings=null,this.videoBufferData&&(this.videoBufferData.dispose(),this.videoBufferData=null),this.audioBufferData&&(this.audioBufferData.dispose(),this.audioBufferData=null))},Object.defineProperty(i.prototype,"disposed",{get:function(){return this._disposed},enumerable:!0,configurable:!0}),i.prototype.reset=function(){this.presentationUrl=null;this.presentationJson=null;this.startPositionInSec=NaN;this.authenticationTokens={};this.commonPresentation&&(this.commonPresentation.dispose(),this.commonPresentation=null);this.emeManager&&this.emeManager.reset();this.heuristicSettings&&this.heuristicSettings.reset();this.videoBufferData&&(this.videoBufferData.dispose(),this.videoBufferData=new t.BufferData);this.audioBufferData&&(this.audioBufferData.dispose(),this.audioBufferData=new t.BufferData)},i.prototype.setUserConfig=function(n){n.maxBufferInSec!==undefined&&(this.heuristicSettings.buffer.maxBufferInSec=n.maxBufferInSec);n.prerollPercent!==undefined&&(this.heuristicSettings.buffer.prerollPercent=n.prerollPercent);n.livePlaybackOffsetPercent!==undefined&&(this.heuristicSettings.buffer.livePlaybackOffsetPercent=n.livePlaybackOffsetPercent);n.windowSizeHeuristicsEnabled!==undefined&&(this.heuristicSettings.windowSizeHeuristicsEnabled=n.windowSizeHeuristicsEnabled);n.preFetchDataEnabled!==undefined&&(this.heuristicSettings.preFetchDataEnabled=n.preFetchDataEnabled);n.maxRetryPerSegment!==undefined&&(this.httpRetryPolicySettings.maxRetryPerSegment=n.maxRetryPerSegment);n.maxSkipSegments!==undefined&&(this.httpRetryPolicySettings.maxSkipSegments=n.maxSkipSegments);n.maxTotalRetries!==undefined&&(this.httpRetryPolicySettings.maxTotalRetries=n.maxTotalRetries)},i.prototype.maxBufferInSec=function(){return this.appConfig&&this.appConfig.maxBufferInSec&&this.appConfig.maxBufferInSec!="0"?parseInt(this.appConfig.maxBufferInSec):this.heuristicSettings.buffer.maxBufferInSec},i.prototype.prerollBufferInSec=function(){return this.maxBufferInSec()*this.heuristicSettings.buffer.prerollPercent},i.prototype.lowBufferInSec=function(){return this.maxBufferInSec()*this.heuristicSettings.vodDowngradeBufferLevelPercent*this.heuristicSettings.buffer.lowBufferPercent},i.prototype.liveStartBufferInSec=function(){return this.maxBufferInSec()*(this.heuristicSettings.buffer.prerollPercent+this.heuristicSettings.buffer.livePlaybackOffsetPercent)},i.prototype.updatePresentation=function(n){this.commonPresentation?(this.commonPresentation.isLive&&!n.isLive&&(this.isLiveToVod=!0),this.commonPresentation.transferPresentationState(n),this.presentationJson=n.toJson(),n.dispose()):(this.commonPresentation=n,this.presentationJson=n.toJson())},i}();t.Session=u;f=function(){function n(n,t){this.workflowType=n;this.sessionContext=t;this.state=0;this.retryWaitTimeMSec=0;this.currentModuleId=null;this.requestedStream=null;this.urlsToRetrieve=[];this.selectedTrack=null;this.selectedSegment=null;this.heuristicData=null;this.externalFailure=null;this.failTracker=new r;this._disposed=!1}return n.prototype.dispose=function(){this._disposed||(this._disposed=!0,this.workflowType=null,this.sessionContext=null,this.state=null,this.currentModuleId=null,this.requestedStream=null,this.urlsToRetrieve.forEach(function(n,t,i){i[t].dispose()}),this.urlsToRetrieve=[],this.selectedTrack=null,this.selectedSegment=null,this.heuristicData&&(this.heuristicData.dispose(),this.heuristicData=null),this.externalFailure&&(this.externalFailure.dispose(),this.externalFailure=null),this.failTracker&&(this.failTracker.dispose(),this.failTracker=null))},n.prototype.reset=function(){this.state=0;this.retryWaitTimeMSec=0;this.currentModuleId=null;this.selectedTrack=null;this.selectedSegment=null;1===this.workflowType&&(this.urlsToRetrieve=[]);this.heuristicData&&this.heuristicData.reset();this.externalFailure=null},Object.defineProperty(n.prototype,"disposed",{get:function(){return this._disposed},enumerable:!0,configurable:!0}),n}();t.Request=f;e=function(){function n(n,t,i,r){typeof t=="undefined"&&(t=0);typeof i=="undefined"&&(i=0);typeof r=="undefined"&&(r=0);this.url=n;this.httpResponseCode=-1;this.httpResposeContentType="";this.mediaData=null;this.presentationData=null;this.presTimeInSec=i;this.durationInSec=r;this.responseType=t;this.requestType=0}return n.prototype.dispose=function(){this.url=null;this.httpResponseCode=null;this.httpResposeContentType="";this.mediaData=null;this.presentationData=null;this.presTimeInSec=null;this.durationInSec=null;this.responseType=null},n}();t.UrlRequest=e;o=function(){function n(n){var t=[];n.tracks.forEach(function(n){n.streamingInfo.selectable&&t.push(new i(n))});this.tracksData=t}return n.prototype.dispose=function(){this.tracksData.forEach(function(n,t,i){i[t].dispose()});this.tracksData=[]},n.prototype.reset=function(){this.tracksData.forEach(function(n,t,i){i[t].reset()})},n}();t.HeuristicData=o;i=function(){function n(n){this.trackInfo=n;this.selectable=!0;this.dataRetrieverEstimationInSec=null}return n.prototype.dispose=function(){this.trackInfo=null;this.selectable=null;this.dataRetrieverEstimationInSec=null},n.prototype.reset=function(){this.selectable=!0;this.dataRetrieverEstimationInSec=null},n}();t.TrackData=i;r=function(){function n(){this.reset()}return n.prototype.dispose=function(){this.lastFailure=null;this.lastTrack=null;this.tracksToTry=[]},n.prototype.reset=function(){this.lastFailure=null;this.lastTrack=null;this.totalRetried=0;this.tracksToTry=[];this.trackToTryIdx=0;this.sameRequestRetried=0;this.segmentsSkipped=0},n.prototype.resetForSegment=function(){this.sameRequestRetried=0;this.trackToTryIdx=0},n.prototype.log=function(n,t){this.lastFailure=n;this.lastTrack=t},n.prototype.isNone=function(){return null===this.lastFailure},n.prototype.isLastNetworkFail=function(){return this.lastFailure.code>=2097752&&this.lastFailure.code<3145727},n.prototype.isLastNotReady=function(){return this.lastFailure.code===2097564},n.prototype.isLastServerError=function(){return this.lastFailure.code>=2097652&&this.lastFailure.code<=2097751},n.prototype.isLastNotFound=function(){return this.lastFailure.code===2097556},n}();t.FailTracker=r})(n.Context||(n.Context={}));var t=n.Context}(AzureHtml5JS||(AzureHtml5JS={})),function(n){"use strict";function r(n,t){return new i(n,t)}var u,t,i;n.CreateAzureHtml5=r,function(n){n[n.internalErrStart=0]="internalErrStart";n[n.internalErrDisposed=0]="internalErrDisposed";n[n.internalErrSegmentNotFound=1]="internalErrSegmentNotFound";n[n.internalErrEnd=1048575]="internalErrEnd"}(n.ErrorCode||(n.ErrorCode={}));u=n.ErrorCode;t=function(){function n(){}return n.exception="exception",n.flushvideo="flushvideo",n}();n.InternalEventName=t;i=function(){function i(t,i){this._sessionContext=new n.Context.Session(this,t,i);this._playerType=null;this._autoplay=!0;this._type="";this._error=null;this._dispose=!1;this._passThroughEventNames=[n.EventName.volumechange,n.EventName.ended,n.EventName.timeupdate,n.EventName.pause,n.EventName.play,n.EventName.playing,n.EventName.seeking,n.EventName.seeked,n.EventName.loadstart,n.EventName.loadeddata];this._conditionalEventNames=[n.EventName.waiting,n.EventName.canplaythrough,n.EventName.error];this._registerVideoTagEvents(!0);this._registerInternalEvents(!0)}return i.prototype.dispose=function(){this._dispose=!0;this._workflowCoordinator&&this._workflowCoordinator.dispose();this._sessionContext&&(this._registerVideoTagEvents(!1),this._registerInternalEvents(!1),this._sessionContext.dispose(),this._sessionContext=null);this._error=null},Object.defineProperty(i.prototype,"currentVideoStreamList",{get:function(){return this._workflowCoordinator?this._workflowCoordinator.videoStreamList:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentAudioStreamList",{get:function(){return this._workflowCoordinator?this._workflowCoordinator.audioStreamList:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"src",{get:function(){return this._workflowCoordinator?this._workflowCoordinator.src:this._sessionContext.videoTag.src},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentTime",{get:function(){return this._workflowCoordinator?this._workflowCoordinator.currentTime:this._sessionContext.videoTag.currentTime},set:function(t){n.Log.verbose(7,"currentTime: "+t+" sec");this._workflowCoordinator?this._workflowCoordinator.currentTime=t:this._sessionContext.videoTag.currentTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentAbsoluteTime",{get:function(){return this._sessionContext.videoTag.currentTime},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentDownloadBitrate",{get:function(){return this._workflowCoordinator?this._workflowCoordinator.downloadBitrate:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentPlaybackBitrate",{get:function(){return this._workflowCoordinator?this._workflowCoordinator.playbackBitrate:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"videoBufferData",{get:function(){return this._workflowCoordinator?this._workflowCoordinator.videoBufferData:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"audioBufferData",{get:function(){return this._workflowCoordinator?this._workflowCoordinator.audioBufferData:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"volume",{get:function(){return this._sessionContext.videoTag.volume},set:function(t){n.Log.verbose(7,"volume: "+t.toString);var i=t;NaN!==t&&undefined!==t&&null!==t&&(t<0?i=0:t>1&&(i=1),this._sessionContext.videoTag.volume=i)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"autoplay",{get:function(){return this._autoplay},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"paused",{get:function(){return this._sessionContext.videoTag.paused},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"seeking",{get:function(){return this._sessionContext.videoTag.seeking},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ended",{get:function(){return this._sessionContext.videoTag.ended},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this._sessionContext.videoTag.height},set:function(n){this._sessionContext.videoTag.height=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return this._sessionContext.videoTag.width},set:function(n){this._sessionContext.videoTag.width=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"videoHeight",{get:function(){return this._sessionContext.videoTag.videoHeight},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"videoWidth",{get:function(){return this._sessionContext.videoTag.videoWidth},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isFullScreen",{get:function(){var n=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;return n===this._sessionContext.videoTag?document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled:!1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isLive",{get:function(){return!!this._sessionContext.commonPresentation&&this._sessionContext.commonPresentation.isLive},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"duration",{get:function(){return this._workflowCoordinator?this._workflowCoordinator.duration:this._sessionContext.videoTag.duration},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"buffered",{get:function(){return this._workflowCoordinator?this._workflowCoordinator.buffered:this._sessionContext.videoTag.buffered},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"error",{get:function(){return this._workflowCoordinator&&this._workflowCoordinator.error?this._workflowCoordinator.error:this._error},enumerable:!0,configurable:!0}),i.prototype.canPlayType=function(t){return n.PlayerType.getByPresentationType(t,this._sessionContext.videoTag)?"maybe":""},i.prototype.setSrc=function(t,i){this._sessionContext.reset();this._reset(i);this._playerType=n.PlayerType.getByPresentationType(this._type,this._sessionContext.videoTag);this._playerType||(this._playerType=n.PlayerType.getByUrl(t,this._sessionContext.videoTag));n.Log.verbose(7,"src: "+t+" autoplay: "+this._autoplay+" type: "+(this._type&&this._type.length>0?this._type:"unknown")+" player: "+(null===this._playerType?"unknown":n.PlayerDetector.Type[this._playerType]));this._workflowCoordinator&&(this._workflowCoordinator.dispose(),this._workflowCoordinator=null);this._playerType===1?(this._sessionContext.videoTag.autoplay=this._autoplay,this._sessionContext.videoTag.src=t):this._playerType===3?(this._workflowCoordinator=n.Workflow.CreateCoordinator(this._sessionContext),this._sessionContext.videoTag.autoplay=!1,this._workflowCoordinator.autoplay=this._autoplay,this._workflowCoordinator.src=t):(n.Log.error(7,t+" not supported by AzureHtml5 Video Element"),this._handleError(new n.Failure.External(4194307,t)))},i.prototype.play=function(){n.Log.verbose(7,"play");this._workflowCoordinator?this._workflowCoordinator.play():this._sessionContext.videoTag.play()},i.prototype.pause=function(){n.Log.verbose(7,"pause");this._workflowCoordinator?this._workflowCoordinator.pause():this._sessionContext.videoTag.pause()},i.prototype.requestFullscreen=function(){var i,t;(n.Log.verbose(7,"requestFullscreen"),i=!1,this.isFullScreen)||(t=this._sessionContext.videoTag,t.requestFullscreen?(i=!0,t.requestFullscreen()):t.msRequestFullscreen?(i=!0,t.msRequestFullscreen()):t.webkitRequestFullscreen?(i=!0,t.webkitRequestFullscreen()):t.mozRequestFullScreen&&(i=!0,t.mozRequestFullScreen()),i&&this._sessionContext.eventMgr.dispatchEvent(n.EventName.fullscreenchange))},i.prototype.exitFullscreen=function(){n.Log.verbose(7,"exitFullscreen");var t=!1;this.isFullScreen&&(document.exitFullscreen?(t=!0,document.exitFullscreen()):document.webkitExitFullscreen?(t=!0,document.webkitExitFullscreen()):document.mozCancelFullScreen?(t=!0,document.mozCancelFullScreen()):document.msExitFullscreen&&(t=!0,document.msExitFullscreen()),t&&this._sessionContext.eventMgr.dispatchEvent(n.EventName.fullscreenchange))},i.prototype.addEventListener=function(n,t,i){typeof i=="undefined"&&(i=null);this._sessionContext.eventMgr.addHandler(n,t,i)},i.prototype.removeEventListener=function(n,t){this._sessionContext.eventMgr.removeHandler(n,t)},i.prototype.addKeySystem=function(n){return this._sessionContext.emeManager.addKeySystem(n)},i.prototype._reset=function(n){function i(n){t._dispose||t._handleError(n)}var t=this;this._playerType=null;this._autoplay=!0;this._type="";this._error=null;n&&(this._type=n.type,"autoPlay"in n&&(this._autoplay=n.autoPlay),"authenticationTokens"in n&&(this._sessionContext.authenticationTokens=n.authenticationTokens),n.userConfig&&this._sessionContext.setUserConfig(n.userConfig));this._sessionContext.emeManager.setup(i,this._sessionContext.authenticationTokens)},i.prototype._registerVideoTagEvents=function(t){function u(t){i._dispose||i._error||(n.Log.verbose(7,"dispatching event: "+t.type+" currentTime: "+i._sessionContext.videoTag.currentTime),i._sessionContext.eventMgr.dispatchEvent(t.type))}function f(t){if(!i._dispose&&!i._error)if(n.EventName.error===t.type){if(i._sessionContext.videoTag.readyState===HTMLMediaElement.HAVE_NOTHING){n.Log.warning(7,"Ignoring video element error since state is HAVE_NOTHING "+n.Failure.mediaErrorToString(i._sessionContext.videoTag.error));return}var r=new n.Failure.External;r.translateMediaError(i._sessionContext.videoTag.error);i._handleError(r)}else i._workflowCoordinator||(n.Log.verbose(7,"dispatching event: "+t.type),i._sessionContext.eventMgr.dispatchEvent(t.type))}var r=this,i=this;this._passThroughEventNames.forEach(function(n){t?r._sessionContext.videoTag.addEventListener(n,u):r._sessionContext.videoTag.removeEventListener(n,u)});this._conditionalEventNames.forEach(function(n){t?r._sessionContext.videoTag.addEventListener(n,f):r._sessionContext.videoTag.removeEventListener(n,f)})},i.prototype._registerInternalEvents=function(i){function r(t){function i(){n.Log.error(7,"Throwing error "+t.message);throw new Error(t.message);}u._dispose||t.message&&n.Util.setTimeout(i,0)}var u=this;i?this._sessionContext.eventMgr.addHandler(t.exception,r,this):this._sessionContext.eventMgr.removeHandler(t.exception,r)},i.prototype._handleError=function(t){this._workflowCoordinator&&this._workflowCoordinator.error||(this._error=t,this._workflowCoordinator&&(n.Log.verbose(7,"Disposing WorkflowCoordinator b/c "+t.toString()),this._workflowCoordinator.dispose(),this._workflowCoordinator=null),n.Log.verbose(7,"dispatching event: "+n.EventName.error),this._sessionContext.eventMgr.dispatchEvent(n.EventName.error))},i}()}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(n){"use strict";var e=function(){function n(){this.windowSizeHeuristicsEnabled=n._windowSizeHeuristicsEnabledDefault;this.preFetchDataEnabled=n._preFetchDataEnabledDefault;this.vodStableBufferLevelPercent=n._vodStableBufferLevelPercentDefault;this.vodDowngradeBufferLevelPercent=n._vodDowngradeBufferLevelPercentDefault;this.belowDowngradeBufferLevelDownloadTimeFactor=n._belowDowngradeBufferLevelDownloadTimeFactorDefault;this.bandwidth=null;this.stepRule=null;this.buffer=null;this.bandwidth=new t;this.stepRule=new i;this.buffer=new r}return n.prototype.reset=function(){this.windowSizeHeuristicsEnabled=n._windowSizeHeuristicsEnabledDefault;this.preFetchDataEnabled=n._preFetchDataEnabledDefault;this.vodStableBufferLevelPercent=n._vodStableBufferLevelPercentDefault;this.vodDowngradeBufferLevelPercent=n._vodDowngradeBufferLevelPercentDefault;this.belowDowngradeBufferLevelDownloadTimeFactor=n._belowDowngradeBufferLevelDownloadTimeFactorDefault;this.bandwidth.reset();this.stepRule.reset();this.buffer.reset()},n._windowSizeHeuristicsEnabledDefault=!0,n._preFetchDataEnabledDefault=!0,n._vodStableBufferLevelPercentDefault=.7,n._vodDowngradeBufferLevelPercentDefault=.15,n._belowDowngradeBufferLevelDownloadTimeFactorDefault=.75,n}(),t,i,r,u,f;n.Heuristics=e;t=function(){function n(){this.bandwidthUsabilityPercent=n._bandwidthUsabilityPercentDefault;this.bandwidthDataSizeThresholdInBytes=n._bandwidthDataSizeThresholdInBytesDefault;this.maxBandwidthHistoryCount=n._maxBandwidthHistoryCountDefault}return n.prototype.reset=function(){this.bandwidthUsabilityPercent=n._bandwidthUsabilityPercentDefault;this.bandwidthDataSizeThresholdInBytes=n._bandwidthDataSizeThresholdInBytesDefault;this.maxBandwidthHistoryCount=n._maxBandwidthHistoryCountDefault},n._bandwidthUsabilityPercentDefault=.85,n._bandwidthDataSizeThresholdInBytesDefault=1e4,n._maxBandwidthHistoryCountDefault=5,n}();n.Bandwidth=t;i=function(){function n(){this.minSegmentsBeforeDowngrade=n._minSegmentsBeforeDowngradeDefault;this.minSegmentsBeforeUpgrade=n._minSegmentsBeforeUpgradeDefault;this.maxStepDownInQuality=n._maxStepDownInQualityDefault;this.maxStepUpInQuality=n._maxStepUpInQualityDefault}return n.prototype.reset=function(){this.minSegmentsBeforeDowngrade=n._minSegmentsBeforeDowngradeDefault;this.minSegmentsBeforeUpgrade=n._minSegmentsBeforeUpgradeDefault;this.maxStepDownInQuality=n._maxStepDownInQualityDefault;this.maxStepUpInQuality=n._maxStepUpInQualityDefault},n._minSegmentsBeforeDowngradeDefault=0,n._minSegmentsBeforeUpgradeDefault=2,n._maxStepDownInQualityDefault=10,n._maxStepUpInQualityDefault=3,n}();n.StepRule=i;r=function(){function n(){this.maxBufferInSec=n._maxBufferInSecDefault;this.prerollPercent=n._prerollPercentDefault;this.livePlaybackOffsetPercent=n._livePlaybackOffsetPercentDefault;this.leftEdgeBackoffInSec=n._leftEdgeBackoffInSecDefault;this.lowBufferPercent=n._lowBufferPercentDefault}return n.prototype.reset=function(){this.maxBufferInSec=n._maxBufferInSecDefault;this.prerollPercent=n._prerollPercentDefault;this.lowBufferPercent=n._lowBufferPercentDefault;this.livePlaybackOffsetPercent=n._livePlaybackOffsetPercentDefault;this.leftEdgeBackoffInSec=n._leftEdgeBackoffInSecDefault},n._maxBufferInSecDefault=30,n._prerollPercentDefault=.25,n._lowBufferPercentDefault=.25,n._livePlaybackOffsetPercentDefault=.25,n._leftEdgeBackoffInSecDefault=4,n}();n.Buffer=r;u=function(){function n(){this.maxTotalRetries=n._maxTotalRetriesDefault;this.maxRetryPerSegment=n._maxRetryPerSegmentDefault;this.maxRetryPresentation=n._maxRetryPresentationDefault;this.maxSkipSegments=n._maxSkipSegmentsDefault;this.retryLowerBitrateOnly=!1;this.retryMediaInMSec=n._retryMediaInMSecDefault;this.retryMediaServerErrorInMSec=n._retryMediaServerErrorInMSecDefault;this.retryPresentationInMSec=n._retryPresentationInMSecDefault}return n._maxTotalRetriesDefault=50,n._maxRetryPerSegmentDefault=10,n._maxRetryPresentationDefault=5,n._maxSkipSegmentsDefault=30,n._retryMediaInMSecDefault=2e3,n._retryMediaServerErrorInMSecDefault=4e3,n._retryPresentationInMSecDefault=500,n}();n.HttpRetryPolicy=u;f=function(){function n(){this.timeoutInMSec=n._timeoutInMSecDefault;this.liveEdgeAdjustmentInSec=n._liveEdgeAdjustmentDefaultInSec}return n._timeoutInMSecDefault=5e3,n._liveEdgeAdjustmentDefaultInSec=-1,n}();n.HttpDataRetriever=f})(n.Settings||(n.Settings={}));var t=n.Settings}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";function i(){return new e}function r(n,t){var i=null;if(window.hasOwnProperty("MediaSource")||window.hasOwnProperty("WebKitMediaSource"))i=window.MediaSource||window.WebKitMediaSource;else return!1;return i&&i.isTypeSupported&&(i.isTypeSupported(n)||i.isTypeSupported(n+";"+t))}t.CreateAdapter=i;t.supported=r;var u={closed:0,open:1,ended:2},f=function(){function n(n,t,i){this.bufferIndex=n;this.startTime=t;this.endTime=i}return n}(),e=function(){function i(){this._mediaSource=new MediaSource;this._adapterSourceBuffers=new o;this._disposed=!1;this._videoTag=null;this._buffered=null}return i.prototype.dispose=function(){this._disposed||(this._mediaSource=null,this._adapterSourceBuffers.dispose(),this._adapterSourceBuffers=null,this._videoTag&&(this._videoTag=null),this._disposed=!0)},Object.defineProperty(i.prototype,"readyState",{get:function(){return this._disposed?0:u[this._mediaSource.readyState]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"durationInSec",{get:function(){return this._disposed?NaN:this._mediaSource.duration},set:function(n){this._disposed||(this._mediaSource.duration=n)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"adapterBuffers",{get:function(){return this._disposed?null:this._adapterSourceBuffers.adapterBuffers},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"buffered",{get:function(){return this._buffered},enumerable:!0,configurable:!0}),i.prototype.setVideoElementSrcAsync=function(n){var t=this;return this._videoTag=n,new Promise(function(i,r){if(t._disposed){r("VideoElementAdapter already disposed");return}t._mediaSource.addEventListener("sourceopen",function(){if(t._disposed){r("VideoElementAdapter already disposed");return}i()});n.src=URL.createObjectURL(t._mediaSource)})},i.prototype.setStartTime=function(t){function u(){!r._disposed&&r._videoTag&&r._videoTag.currentTime===0&&(r._videoTag.readyState!==HTMLMediaElement.HAVE_NOTHING?(r._videoTag.currentTime=t,n.Log.verbose(3,"StartTime set: "+t)):(n.Log.verbose(3,"Video tag not ready, will retry to set StartTime to "+t),n.Util.setTimeout(u,i._setCurrentTimeTimeoutInMSec)))}var r=this;u()},i.prototype.addAdapterBuffer=function(i,r,u){function s(){o._updateBuffered()}if(this._disposed)return null;var o=this,f,e=null;try{f=this._mediaSource.addSourceBuffer(i);e=new t.VideoElementAdapterBuffer(u,r,f,s);this._adapterSourceBuffers.add(e,f);n.Log.verbose(3,"Adapter buffer added: "+i+" Adapter buffer total: "+this._adapterSourceBuffers.length)}catch(h){n.Log.error(3,"Failed to add SourceBuffer to MediaSource: "+h)}return e},i.prototype.removeAdapterBuffer=function(t){if(!this._disposed){var i;i=this._adapterSourceBuffers.find(t);-1!==i?(this._mediaSource.removeSourceBuffer(this._adapterSourceBuffers.sourceBuffers[i]),this._adapterSourceBuffers.remove(i),n.Log.verbose(3,"Adapter buffer removed, remaining: "+this._adapterSourceBuffers.length)):n.Log.error(3,"Failed to remove adapter buffer: instance not found")}},i.prototype.endOfStream=function(t){this._disposed||(t?this._mediaSource.endOfStream(t):this._mediaSource.endOfStream(),n.Log.verbose(3,"End of stream signaled"))},i.prototype._updateBuffered=function(){var t,f,u,o,i;if(!this._disposed){var s=this._adapterSourceBuffers.adapterBuffers,h=new n.Common.TimeRangeSet,r=this._findUniqueStartTimes();for(t=0;t<r.length;t++){var c=r[t].startTime,e=r[t].endTime,l=!0;for(f=0;f<s.length;f++)if(u=s[f].buffered,f!==r[t].bufferIndex){for(o=!1,i=0;i<u.length;i++)if(u.start(i)<=c&&c<=u.end(i)){o=!0;u.end(i)<e&&(e=u.end(i));break}if(!o){l=!1;break}}l&&(n.Log.verbose(3,"Intersecting buffer found ("+r[t].startTime+", "+e+")"),h.addRange(new n.Common.TimeRange(r[t].startTime,e)))}this._buffered=h}},i.prototype._findUniqueStartTimes=function(){for(var t,n,i=[],u=this._adapterSourceBuffers.adapterBuffers,r=0;r<u.length;r++)for(t=u[r].buffered,n=0;n<t.length;n++)-1===i.findIndexOf(function(i){return i.startTime===t.start(n)})&&i.push(new f(r,t.start(n),t.end(n)));return i.sort(function(n,t){return n.startTime-t.startTime}),i},i._setCurrentTimeTimeoutInMSec=500,i}(),o=function(){function n(){this.adapterBuffers=[];this.sourceBuffers=[]}return n.prototype.dispose=function(){for(var n=this.adapterBuffers.length-1;n>=0;n--)this.adapterBuffers[n].dispose(),this.adapterBuffers[n]=null;for(n=this.sourceBuffers.length-1;n>=0;n--)this.sourceBuffers[n]=null},Object.defineProperty(n.prototype,"length",{get:function(){if(this.sourceBuffers.length!==this.adapterBuffers.length)throw new Error("AdapterSourceBuffers in invalid state");return this.sourceBuffers.length},enumerable:!0,configurable:!0}),n.prototype.find=function(n){return this.adapterBuffers.indexOf(n)},n.prototype.add=function(n,t){this.adapterBuffers.push(n);this.sourceBuffers.push(t)},n.prototype.remove=function(n){n>=0&&n<this.sourceBuffers.length&&(this.sourceBuffers.splice(n,1),this.adapterBuffers.splice(n,1))},n}()})(n.VideoElementAdapter||(n.VideoElementAdapter={}));var t=n.VideoElementAdapter}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";var i=function(){function t(t,i,r,u){function o(){n.Log.verbose(3,"SourceBuffer 'update' event completed.");e()}function s(){n.Log.error(3,"SourceBuffer append failed with 'error' event.");e()}function e(){f._notifyBufferUpdated();f._tryInternalRemove();f._tryInternalAppend()}var f=this;this._disposed=!1;this._pendingBufferRanges=new n.Common.TimeRangeSet;this._sourceBuffer=r;this._maxAdapterBufferInSec=t;this._playbackPosFn=i;this._notifyBufferUpdated=u;this._pendingBuffer=[];this._pendingRemove=[];this._sourceBuffer.addEventListener("update",o);this._sourceBuffer.addEventListener("error",s)}return Object.defineProperty(t.prototype,"buffered",{get:function(){var t=new n.Common.TimeRangeSet,e,u,i,f,r;for(t.addRanges(this._sourceBuffer.buffered),u=t.length>0?t.end(t.length-1):NaN,i=0;i<this._pendingBufferRanges.length;i++)f=this._pendingBufferRanges.start(i),r=this._pendingBufferRanges.end(i),n.Common.diffTimes(f,u)===0?t.extendLast(r):(e=new n.Common.TimeRange(f,r),t.addRange(e)),u=r;return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"presentationTimeOffsetInSec",{get:function(){return this._sourceBuffer.timestampOffset},set:function(n){this._sourceBuffer.timestampOffset=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioTracks",{get:function(){return this._sourceBuffer.audioTracks},enumerable:!0,configurable:!0}),t.prototype.getBufferedAheadOfCurrentTimeInSec=function(){var n;if(this._disposed)return 0;var t=this.buffered,i=this._playbackPosFn(),r=0;if(0===t.length)return 0;for(n=0;n<t.length;n++)t.start(n)<=i&&i<t.end(n)?r+=t.end(n)-i:i<t.start(n)&&(r+=t.end(n)-t.start(n));return r},t.prototype.bufferFull=function(){return this.getBufferedAheadOfCurrentTimeInSec()>this._maxAdapterBufferInSec},t.prototype.contains=function(n){for(var i=this.buffered,t=0;t<i.length;t++)if(i.start(t)<=n&&n<i.end(t))return!0;return!1},t.prototype.dispose=function(){var n;if(!this._disposed){for(this._disposed=!0,n=this._pendingBuffer.length-1;n>=0;n--)this._pendingBuffer[n]=null;for(this._sourceBuffer=null,n=this._pendingRemove.length-1;n>=0;n--)this._pendingRemove[n]=null;this._pendingBufferRanges&&(this._pendingBufferRanges.dispose(),this._pendingBufferRanges=null)}},t.prototype.append=function(t,i,r){for(var s,f,e,o,u=0;u<this._pendingBuffer.length;u++)if(i<this._pendingBuffer[u].presTimeInSec)break;if(r){if(u>0&&(f=this._pendingBuffer[u-1],o=n.Common.diffTimes(i,f.presTimeInSec+f.durationInSec),o>0))throw new Error("append ("+i+","+r+") failed, overlaps with ("+f.presTimeInSec+","+f.durationInSec+")");if(u<this._pendingBuffer.length&&(e=this._pendingBuffer[u],o=n.Common.diffTimes(e.presTimeInSec,i+r),o>0))throw new Error("append ("+i+","+r+") failed, overlaps with ("+e.presTimeInSec+","+e.durationInSec+")");}s=new n.Common.SegmentData(t,i,r);this._pendingBuffer.splice(u,0,s);this._updatePendingRanges();n.Log.verbose(3,"Appending segment: "+i+" sec "+t.byteLength+" bytes");this._tryInternalAppend();this._notifyBufferUpdated()},t.prototype.remove=function(t,i){var r;t=Math.max(t,0);r=new n.Common.TimeRange(t,i);this._pendingRemove.push(r);n.Log.verbose(3,"Added to remove pending list ["+t+","+i+")");this._tryInternalRemove()},t.prototype.flushFrom=function(n){var r=this._sourceBuffer.buffered,t,i,u;if(this._sourceBuffer.updating&&this._sourceBuffer.abort(),t=0,i=0,r.length>0&&(t=r.start(0)),this._pendingBuffer.length>0&&(t=Math.min(t,this._pendingBuffer[0].presTimeInSec)),this._pendingBuffer.length>0&&(u=this._pendingBuffer[this._pendingBuffer.length-1],i=u.presTimeInSec+u.durationInSec),r.length>0&&(i=Math.max(i,r.end(r.length-1))),undefined!==n&&(t=n),i>t)this.remove(t,i);else if(0!==t||0!==i)throw new Error("flush failed, endTime ("+i+") not greater than startime ("+t+")");},t.prototype.flushUntil=function(n){var r=this._sourceBuffer.buffered,i=0,t=0,u;if(r.length>0&&(i=r.start(0)),this._pendingBuffer.length>0&&(i=Math.min(i,this._pendingBuffer[0].presTimeInSec)),this._pendingBuffer.length>0&&(u=this._pendingBuffer[this._pendingBuffer.length-1],t=u.presTimeInSec+u.durationInSec),r.length>0&&(t=Math.max(t,r.end(r.length-1))),t=Math.min(t,n),t>i)this.remove(i,t);else if(0!==i||0!==t)throw new Error("flush failed, endTime ("+t+") not greater than startime ("+i+")");},t.prototype._tryInternalAppend=function(){if(this._pendingBuffer&&this._sourceBuffer&&0!==this._pendingBuffer.length&&!this._sourceBuffer.updating)try{this._sourceBuffer.appendBuffer(this._pendingBuffer[0].data);n.Log.verbose(3,"Appended segment to SourceBuffer: "+this._pendingBuffer[0].presTimeInSec+" sec "+this._pendingBuffer[0].data.byteLength+" bytes");this._pendingBuffer.splice(0,1);this._updatePendingRanges()}catch(t){switch(t.code){case DOMException.INVALID_STATE_ERR:case DOMException.QUOTA_EXCEEDED_ERR:n.Log.error(3,"Failed to append segment to SourceBuffer, will retry: "+t);break;default:n.Log.error(3,"Failed to append segment to SourceBuffer: "+t);throw t;}}},t.prototype._tryInternalRemove=function(){var t,r,f,i,e;if(this._pendingBuffer&&this._sourceBuffer&&this._pendingRemove)while(0!==this._pendingRemove.length&&!this._sourceBuffer.updating){for(t=this._pendingRemove[0],r=this._pendingBuffer.length-1;r>=0;r--)f=this._pendingBuffer[r],i=f.presTimeInSec,e=f.durationInSec,i>=t.startInSec&&i<t.endInSec&&(i+e<=t.endInSec?(this._pendingBuffer.splice(r,1),this._updatePendingRanges(),this._notifyBufferUpdated(),n.Log.verbose(3,"Segment removed: "+t.startInSec)):n.Log.verbose(3,"Failed to remove range ("+t.startInSec+", "+t.endInSec+") from                             segment ("+i+", "+(i+e)+") - range ends mid - segment"));try{this._sourceBuffer.remove(t.startInSec,t.endInSec);this._pendingRemove.splice(0,1);n.Log.verbose(3,"Removing range from SourceBuffer: ["+t.startInSec+","+t.endInSec+")")}catch(u){switch(u.code){case DOMException.INVALID_ACCESS_ERR:case DOMException.INVALID_STATE_ERR:n.Log.error(3,"Failed to remove segment from SourceBuffer, will retry: "+u);break;default:n.Log.error(3,"Failed to remove segment from SourceBuffer: "+u);throw u;}}}},t.prototype._updatePendingRanges=function(){var t=this,i,r=NaN;this._pendingBufferRanges&&(this._pendingBufferRanges.dispose(),this._pendingBufferRanges=null);this._pendingBufferRanges=new n.Common.TimeRangeSet;this._pendingBuffer.forEach(function(u){n.Common.diffTimes(u.presTimeInSec,r)===0?t._pendingBufferRanges.extendLast(u.endTimestampInSec):(i=new n.Common.TimeRange(u.presTimeInSec,u.endTimestampInSec),t._pendingBufferRanges.addRange(i));r=u.endTimestampInSec})},t}();t.VideoElementAdapterBuffer=i})(n.VideoElementAdapter||(n.VideoElementAdapter={}));var t=n.VideoElementAdapter}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";function i(n){return new r(n)}t.CreateCoordinator=i;var r=function(){function i(n){this._sessionContext=n;this._workflowSeq=t.CreateSequencer(this._sessionContext);this._mediaSource=null;this._lastPresentation=new Date(0);this._pendingPresentation=new Date;this._disposed=!1;this._pendingPlay=!0;this._pendingTryMediaRequestCount=0;this._prerollMet=!1;this._error=null;this._playbackPosInSec=null;this._pendingPlaybackPosInSec=null;this._lastDuration=0;this._videoStreamList=null;this._audioStreamList=null;this._healthCheckLastTime=0;this._healthCheckId=setInterval(this._periodicHealthCheck,i._healthCheckPeriodInMSec,this);this._lastPlaybackBitrate=null;this._lastDownloadBitrate=null;this._registerInternalEvents(!0)}return i.prototype.dispose=function(){this._disposed||(this._registerInternalEvents(!1),this._disposed=!0,this._sessionContext=null,this._lastPresentation=null,this._pendingPresentation=null,this._mediaSource&&(this._mediaSource.dispose(),this._mediaSource=null),this._workflowSeq&&(this._workflowSeq.dispose(),this._workflowSeq=null),this._videoStreamList&&this._videoStreamList.dispose(),this._audioStreamList&&this._audioStreamList.dispose(),clearInterval(this._healthCheckId))},Object.defineProperty(i.prototype,"videoStreamList",{get:function(){return this._videoStreamList},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"audioStreamList",{get:function(){return this._audioStreamList},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"videoBufferData",{get:function(){return this._sessionContext.videoBufferData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"audioBufferData",{get:function(){return this._sessionContext.audioBufferData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"src",{get:function(){return this._sessionContext.presentationUrl},set:function(t){function r(t){function u(){return null!==i._playbackPosInSec&&i._sessionContext.videoTag.seeking?i._playbackPosInSec:i._sessionContext.videoTag.currentTime}function f(){i._disposed||(r.periods[0].streams.forEach(function(r){r.streamingInfo.selected&&(r.streamingInfo.sourceBuffer=i._mediaSource.addAdapterBuffer(r.codec,u,t.sessionContext.maxBufferInSec()),n.assert(null!=r.streamingInfo.sourceBuffer,"presentationWorkflowResolved: Failed to create source buffer for stream "+n.Presentation.StreamType[r.type]),r.type===0?i._sessionContext.videoBufferData.updateBuffer(r.streamingInfo.sourceBuffer):r.type===1&&i._sessionContext.audioBufferData.updateBuffer(r.streamingInfo.sourceBuffer),r.streamingInfo.sourceBuffer.presentationTimeOffsetInSec=r.presentationTimeOffsetInSec)}),i._updateStartPosition(),i._updateDuration(),i._registerVideoDownloadedEvents(),i._registerVideoTagEvents(),i._checkMediaWorkflow(),i._tryTimeUpdateEvent(),t.dispose())}function e(n){throw new Error(n);}if(!i._disposed){var r=null;if(n.Log.verbose(1,"presentationWorkflowResolved"),null===t.sessionContext.commonPresentation)throw new Error("presentationWorkflowResolved: unexpected null values");r=t.sessionContext.commonPresentation;i._videoStreamList=new n.Presentation.VideoStreamList(i._sessionContext,r.periods[0].streams);i._audioStreamList=new n.Presentation.AudioStreamList(i._sessionContext,r.periods[0].streams);i._sessionContext.emeManager.setCodec("video/mp4");i._sessionContext.eventMgr.dispatchEvent(n.EventName.loadedmetadata);i._mediaSource=n.VideoElementAdapter.CreateAdapter();i._mediaSource.setVideoElementSrcAsync(t.sessionContext.videoTag).then(f,e).catch(function(t){i._sessionContext.eventMgr.dispatchEvent(n.InternalEventName.exception,t)})}}function u(t){i._disposed||(n.Log.error(1,"presentationWorkflowRejected:  module: "+t.currentModuleId),t.externalFailure&&n.Failure.isExternalError(t.externalFailure.code)&&(i._error=new n.Failure.External(t.externalFailure.code,t.externalFailure.message),n.Log.error(1,"Dispatching error: "+i.error.toString()),t.sessionContext.eventMgr.dispatchEvent(n.EventName.error)),t.dispose())}n.Log.verbose(1,"src("+t+")");var i=this;this._sessionContext.presentationUrl=t;this._presentationWorkflowAsync(r,u)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentTime",{get:function(){var t=this._sessionContext.videoTag,n=0;return this._sessionContext.commonPresentation&&(n=null!==this._pendingPlaybackPosInSec?this._pendingPlaybackPosInSec:t.currentTime,n=Math.max(this._fromPresentationTime(n),0)),n},set:function(t){var f,e,i;n.Log.verbose(1,"currentTime("+t.toFixed(3)+")");var u=this._sessionContext,r=u.commonPresentation.periods[0].streams,o=!1,s=0,h=0,c=this.duration;if(u.commonPresentation.isLive){var a=u.commonPresentation.timeShiftBufferDepth||Infinity,l=u.heuristicSettings.buffer.leftEdgeBackoffInSec,v=a-l;s=u.liveStartBufferInSec();h=c<v?0:l}for(t=Math.max(t,h),t=Math.min(t,c-s),t=this._toPresentationTime(t),n.Log.verbose(1,"seeking from presentation time "+u.videoTag.currentTime.toFixed(3)+" to "+t.toFixed(3)),f=t,i=0;i<r.length;i++)if(r[i].streamingInfo.selected){if(e=r[i].segments.getByInSegmentTimestamp(t),e)continue;e=r[i].segments.getByInDiscontinuityTimestamp(t);e&&(f=Math.max(f,e.segmentInfo.presTimeInSec))}for(f!==t&&(n.Log.verbose(1,"skipping discontinuity from presentation time "+t+" to "+f),t=f),this._playbackPosInSec=t,u.videoTag.currentTime=t,this._pendingPlaybackPosInSec=null,n.Common.diffTimes(u.videoTag.currentTime,t)&&(n.Log.verbose(1,"set currentTime failed to update videoTag: requested="+t+", actual="+u.videoTag.currentTime),this._pendingPlaybackPosInSec=t),i=0;i<r.length;i++)r[i].streamingInfo.selected&&r[i].streamingInfo.sourceBuffer&&!1===r[i].streamingInfo.sourceBuffer.contains(t)&&(r[i].streamingInfo.pendingSeekPositionInSec=t,r[i].streamingInfo.sourceBuffer.flushFrom(),o=!0,2===r[i].streamingInfo.workflowState&&(r[i].streamingInfo.workflowState=0));this._checkMediaWorkflow();o||this._buffersAbovePreroll()||this._endOfSelectedStreams()||(o=!0);o&&(u.videoTag.paused||(this._pendingPlay=!0,u.videoTag.pause()))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"downloadBitrate",{get:function(){return this._lastDownloadBitrate},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"playbackBitrate",{get:function(){return this._lastPlaybackBitrate},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"autoplay",{set:function(t){n.Log.verbose(1,"autoplay("+t+")");this._pendingPlay=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"duration",{get:function(){var t=this._sessionContext,i=t.commonPresentation,r=Infinity,n;return i&&(n=i.playableWindow,r=n.endInSec-n.startInSec),Math.min(t.videoTag.duration||0,r)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"buffered",{get:function(){var t=null,i;return this._mediaSource&&(i=this._sessionContext.commonPresentation.playableWindow,t=new n.Common.TimeRangeSet,t.addRanges(this._mediaSource.buffered),t.rebase(i.startInSec)),t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"error",{get:function(){return this._error},enumerable:!0,configurable:!0}),i.prototype.play=function(){n.Log.verbose(1,"play()");var t=this._sessionContext,i=t.heuristicSettings.buffer.leftEdgeBackoffInSec;t.commonPresentation&&t.commonPresentation.isLive&&t.videoTag&&t.videoTag.paused&&!t.videoTag.seeking&&this._fromPresentationTime(t.videoTag.currentTime)<i&&(n.Log.verbose(1,"play: skipping from "+t.videoTag.currentTime+" to left edge"),this.currentTime=0);this._buffersAbovePreroll()||this._endOfSelectedStreams()?this._startPlayback():this._pendingPlay=!0;this._resetHealthCheckTime()},i.prototype.pause=function(){var t=this._sessionContext;n.Log.verbose(1,"pause()");this._pendingPlay&&(this._pendingPlay=!1);t.videoTag.pause();this._tryTimeUpdateEvent()},i.prototype._presentationWorkflowAsync=function(t,r){function o(){u._disposed||(!u._sessionContext.commonPresentation||u._sessionContext.commonPresentation.isLive)&&u._workflowSeq.presentationRequestAsync().then(s,h).catch(function(t){u._sessionContext.eventMgr.dispatchEvent(n.InternalEventName.exception,t)})}function s(f){var e,s,h;if(u._disposed){r&&r(f);return}if(n.Log.verbose(1,"presentationRequestResolved"),e=f.sessionContext.commonPresentation,null===e)throw new Error("presentationRequestResolved: unexpected null values");u._updateDuration();s=new Date;e.isLive&&e.minimumUpdatePeriodInSec>0&&u._pendingPresentation<=s&&(h=Math.max(i._minPresentationUpdatePeriodInMSec,e.minimumUpdatePeriodInSec*1e3),u._pendingPresentation.setTime(s.getTime()+h),n.Util.setTimeout(o,h));u._lastPresentation=s;t&&(t(f),t=null)}function h(t){u._disposed||n.Log.error(1,"presentationRequestRejected:  module: "+t.currentModuleId);r&&r(t)}var u=this,f=0,e=Date.now()-u._lastPresentation.getTime();e<i._minPresentationUpdatePeriodInMSec&&(f=i._minPresentationUpdatePeriodInMSec-e);n.Util.setTimeout(o,f)},i.prototype._checkMediaWorkflow=function(){function u(){var c,h,s,o;if(!t._disposed){for(n.Log.verbose(1,"_doCheckMediaWorkflow"),c=[],t._pendingTryMediaRequestCount--,r.videoTag.paused||t._endOfSelectedStreams()||!t._buffersNearEmpty()?t._buffersAbovePreroll()&&(t._dispatchCanPlayThroughEvent(),t._pendingPlay&&t._startPlayback()):(r.eventMgr.dispatchEvent(n.EventName.waiting),t._pendingPlay=!0,r.videoTag.pause()),h=!1,s=0;s<r.commonPresentation.periods[0].streams.length;s++)o=r.commonPresentation.periods[0].streams[s],o.streamingInfo.selected&&0===o.streamingInfo.workflowState&&(!o.streamingInfo.sourceBuffer||t._isBufferAheadOtherStreams(o)||o.streamingInfo.sourceBuffer.bufferFull()||t._buffersAtLiveEdge(o)?h=!0:(n.Log.verbose(1,"starting media workflow "+n.Presentation.StreamType[o.type]),o.streamingInfo.workflowState=1,t._workflowSeq.mediaRequestAsync(o).then(f,e).catch(function(t){r.eventMgr.dispatchEvent(n.InternalEventName.exception,t)})));h&&0===t._pendingTryMediaRequestCount&&(n.Log.verbose(1,"_doCheckMediaWorkflow: schedule try again"),t._pendingTryMediaRequestCount++,n.Util.setTimeout(u,i._mediaSegmentTimeoutInMSec))}}function f(i){var f,s,e,o,u;if(!t._disposed){for(f=i.requestedStream,f.streamingInfo.workflowState=0,1===i.state&&null===f.streamingInfo.pendingSeekPositionInSec&&(n.Log.verbose(1,"mediaRequestResolved: "+n.Presentation.StreamType[f.type]+" end of stream"),f.streamingInfo.workflowState=2,t._endOfSelectedStreams()&&(n.Log.verbose(1,"End of selected streams"),t._mediaSource.endOfStream(),t._dispatchCanPlayThroughEvent(),t._pendingPlay&&t._startPlayback())),u=0;u<i.urlsToRetrieve.length;u++){if(null===i.urlsToRetrieve[u].mediaData)throw new Error("mediaRequestResolved: data is null url: "+i.urlsToRetrieve[u].url);if(f.streamingInfo.selected&&null===f.streamingInfo.pendingSeekPositionInSec)s=i.urlsToRetrieve[u].presTimeInSec+i.urlsToRetrieve[u].durationInSec,n.Log.verbose(1,"mediaRequestResolved appending url: "+i.urlsToRetrieve[u].url+"("+i.urlsToRetrieve[u].httpResposeContentType+", "+i.urlsToRetrieve[u].mediaData.byteLength+" bytes, "+s+" secs)"),f.streamingInfo.sourceBuffer.append(i.urlsToRetrieve[u].mediaData,i.urlsToRetrieve[u].presTimeInSec,i.urlsToRetrieve[u].durationInSec);else{n.Log.verbose(1,"mediaRequestResolved discarding,"+(f.streamingInfo.selected?"seek in progress":"stream no longer selected ")+"url: "+i.urlsToRetrieve[u].url+"("+i.urlsToRetrieve[u].httpResposeContentType+", "+i.urlsToRetrieve[u].mediaData.byteLength+")");break}}if(null!==t._pendingPlaybackPosInSec){for(e=r.videoTag.buffered,o=!1,u=0;u<e.length;u++)if(e.start(u)<=t._pendingPlaybackPosInSec&&t._pendingPlaybackPosInSec<e.end(u)){o=!0;break}o&&(r.videoTag.currentTime=t._pendingPlaybackPosInSec,n.Common.diffTimes(r.videoTag.currentTime,t._pendingPlaybackPosInSec)?n.Log.verbose(1,"mediaRequestResolved failed to update videoTag currentTime: pending="+t._pendingPlaybackPosInSec+", actual="+r.videoTag.currentTime):t._pendingPlaybackPosInSec=null)}t._checkMediaWorkflow();i.dispose()}}function e(i){function f(i){if(!t._disposed){if(n.Log.verbose(1,"refreshPresentationWorkflowResolved"),null===i.sessionContext.commonPresentation)throw new Error("refreshPresentationWorkflowResolved: unexpected null values");u.streamingInfo.workflowState=0;t._checkMediaWorkflow();i.dispose()}}function e(i){t._disposed||(n.Log.error(1,"refreshPresentationWorkflowRejected:  module: "+i.currentModuleId),i.externalFailure&&n.Failure.isExternalError(i.externalFailure.code)&&(t._error=new n.Failure.External(i.externalFailure.code,i.externalFailure.message),n.Log.error(1,"Dispatching error: "+t.error.toString()),i.sessionContext.eventMgr.dispatchEvent(n.EventName.error)),i.dispose())}if(!t._disposed){var u=i.requestedStream;if(n.Log.error(1,"mediaRequestRejected: "+n.Presentation.StreamType[i.requestedStream.type]+" module: "+i.currentModuleId),i.externalFailure){if((2097556===i.externalFailure.code||1===i.externalFailure.code)&&i.sessionContext.commonPresentation.isLive&&0===i.sessionContext.commonPresentation.minimumUpdatePeriodInSec&&i.failTracker.isNone()){t._presentationWorkflowAsync(f,e);return}n.Failure.isExternalError(i.externalFailure.code)&&(t._error=new n.Failure.External(i.externalFailure.code,i.externalFailure.message),n.Log.error(1,"Dispatching error: "+t.error.toString()),r.eventMgr.dispatchEvent(n.EventName.error))}i.dispose()}}var t=this,r=t._sessionContext;this._pendingTryMediaRequestCount++;n.Util.setTimeout(u,0)},i.prototype._updateStartPosition=function(){var t=this._sessionContext,n=t.commonPresentation,r=t.liveStartBufferInSec(),i=Infinity;n&&isNaN(t.startPositionInSec)&&(i=n.isLive?Math.max(n.playableWindow.startInSec,n.playableWindow.endInSec-r):n.playableWindow.startInSec,0!==i&&(this._mediaSource.setStartTime(i),t.startPositionInSec=i))},i.prototype._updateDuration=function(){var n=this._sessionContext.commonPresentation,t;n&&this._mediaSource&&(t=n.isLive?Infinity:this._sessionContext.isLiveToVod?n.playableWindow.endInSec:n.durationInSec,this._mediaSource.durationInSec!==t&&(this._mediaSource.durationInSec=t))},i.prototype._toPresentationTime=function(n){var t=this._sessionContext.commonPresentation.playableWindow.startInSec;return n+t},i.prototype._fromPresentationTime=function(n){var t=this._sessionContext.commonPresentation.playableWindow.startInSec;return n-t},i.prototype._endOfSelectedStreams=function(){var t,n;if(!this._sessionContext.commonPresentation)return!1;for(t=this._sessionContext.commonPresentation.periods[0].streams,n=0;n<t.length;n++)if(t[n].streamingInfo.selected&&2!==t[n].streamingInfo.workflowState)return!1;return!0},i.prototype._buffersAbovePreroll=function(){var i=!0,r=this._sessionContext.videoTag,t,n;if(!this._sessionContext.commonPresentation)return!1;if(t=this._sessionContext.commonPresentation.periods[0].streams,r.readyState<r.HAVE_METADATA)i=!1;else for(n=0;n<t.length;n++)if(t[n].streamingInfo.selected&&t[n].streamingInfo.sourceBuffer.getBufferedAheadOfCurrentTimeInSec()<this._sessionContext.prerollBufferInSec()){i=!1;break}return i},i.prototype._buffersNearEmpty=function(){for(var t=this._sessionContext.commonPresentation.periods[0].streams,n=0;n<t.length;n++)if(t[n].streamingInfo.selected&&t[n].streamingInfo.sourceBuffer.getBufferedAheadOfCurrentTimeInSec()<this._sessionContext.lowBufferInSec())return!0;return!1},i.prototype._isBufferAheadOtherStreams=function(n){for(var t,e=0,f=Infinity,o=null,s=0,u=this._sessionContext.commonPresentation.periods[0].streams,r=0;r<u.length;r++)u[r].streamingInfo.selected&&u[r].type!==2&&u[r].streamingInfo.workflowState!==2&&(e++,t=u[r].streamingInfo.sourceBuffer.buffered,t.length>0&&t.end(t.length-1)<f&&(f=t.end(t.length-1),o=u[r],s=u[r].streamingInfo.sourceBuffer.getBufferedAheadOfCurrentTimeInSec()));return(t=n.streamingInfo.sourceBuffer.buffered,1===e||o===n||t.length===0)?!1:n.streamingInfo.sourceBuffer.getBufferedAheadOfCurrentTimeInSec()>s&&t.end(t.length-1)-f>i._bufferTooFarAheadInSec},i.prototype._buffersAtLiveEdge=function(n){var t=this._sessionContext.commonPresentation,i,r,u;return n.streamingInfo.currentSegment?(i=n.streamingInfo.currentSegment.segmentInfo,r=i.presTimeInSec+i.durationInSec,u=t.playableWindow.endInSec,t.isLive&&t.minimumUpdatePeriodInSec===0&&u<=r):!1},i.prototype._startPlayback=function(){var t=this._sessionContext.videoTag;t.buffered&&t.buffered.length>0&&t.currentTime<t.buffered.start(0)&&(t.currentTime=t.buffered.start(0),n.Log.verbose(1,"_startPlayback: skipping over missing data at the beginning. currentTime: "+t.currentTime+", buffer start: "+t.buffered.start(0)));this._pendingPlay=!1;this._sessionContext.videoTag.play()},i.prototype._dispatchCanPlayThroughEvent=function(){this._prerollMet||(n.Log.verbose(7,"dispatching event: canplaythrough"),this._prerollMet=!0,this._sessionContext.eventMgr.dispatchEvent(n.EventName.canplaythrough))},i.prototype._registerVideoDownloadedEvents=function(){function r(){if(!i._disposed){var r=t.downloadCompleted.mediaDownload.bitrate;r!=this._lastDownloadBitrate&&(this._lastDownloadBitrate=r,this._sessionContext.eventMgr.dispatchEvent(n.EventName.downloadbitratechanged))}}var i=this,t=this._sessionContext.videoBufferData;t.addEventListener(n.BufferDataEventName.downloadcompleted,r,this)},i.prototype._registerVideoTagEvents=function(){function e(){t._disposed||t._pendingPlay&&t._buffersAbovePreroll()&&t._startPlayback()}function o(){if(!t._disposed){var r=t._sessionContext;r.eventMgr.dispatchEvent(n.EventName.durationchange);r.commonPresentation&&r.commonPresentation.isLive&&n.Util.setTimeout(u,i._durationChangeMinIntervalInMSec)}}function u(){if(!t._disposed){var r=t._sessionContext;r.commonPresentation&&r.commonPresentation.isLive&&(t._lastDuration!==t.duration?(t._lastDuration=t.duration,r.eventMgr.dispatchEvent(n.EventName.durationchange),n.Util.setTimeout(u,i._durationChangeMinIntervalInMSec)):0===t._lastDuration&&n.Util.setTimeout(u,i._durationChangeMinIntervalInMSec))}}function f(){t._resetHealthCheckTime()}function s(){if(!t._disposed){var u=t._sessionContext.videoBufferData,i=u.getPlaybackBitrate(r.currentTime);i!=t._lastPlaybackBitrate&&(t._lastPlaybackBitrate=i,t._sessionContext.eventMgr.dispatchEvent(n.EventName.playbackbitratechanged))}}var t=this,r=t._sessionContext.videoTag;r.addEventListener(n.EventName.canplaythrough,e);r.addEventListener(n.EventName.durationchange,o);r.addEventListener(n.EventName.playing,f);r.addEventListener(n.EventName.seeked,f);r.addEventListener(n.EventName.timeupdate,s)},i.prototype._registerInternalEvents=function(t){t?this._sessionContext.eventMgr.addHandler(n.InternalEventName.flushvideo,this._flushVideoToPreroll,this):this._sessionContext.eventMgr.removeHandler(n.InternalEventName.flushvideo,this._flushVideoToPreroll)},i.prototype._periodicHealthCheck=function(t){var r;if(t._sessionContext&&t._sessionContext.videoTag){if(r=t._sessionContext.videoTag,t._healthCheckLastTime&&!r.paused&&!r.seeking&&!r.ended&&t._healthCheckLastTime===r.currentTime){n.Log.verbose(1,"Health Check: currentTime stopped");t._sessionContext.eventMgr.dispatchEvent(n.EventName.playbackstalled);var o=r.currentTime,u=-1,f=new n.Common.TimeRangeSet,e;f.addRanges(r.buffered);e=f.getIndexByInRangeTimestamp(o);e>=0&&(f.beforeDiscontinuity(o,e)?(u=f.start(e+1),n.Log.verbose(1,"Health Check: skipping over discontinuity")):f.atOrAfterDiscontinuity(o,e)&&(u=f.start(e),n.Log.verbose(1,"Health Check: resetting on discontinuity")));u<0&&(u=o+i._healthCheckSkipInSec,n.Log.verbose(1,"Health Check: skipping "+i._healthCheckSkipInSec+" seconds ahead"));n.Log.verbose(1,"Health Check: seeking from "+o+" to "+u);r.currentTime=u}t._healthCheckLastTime=r.currentTime}},i.prototype._resetHealthCheckTime=function(){this._disposed||(this._healthCheckLastTime=0)},i.prototype._flushVideoToPreroll=function(){function f(i,r){var o=r.prerollBufferInSec(),e=r.videoTag.currentTime+o,u=null,f;t.flushStream=!1;f=i.segments.getByInSegmentTimestamp(e);f?u=f.segmentInfo.presTimeInSec:(f=i.segments.getByInDiscontinuityTimestamp(e),f&&(u=f.segmentInfo.presTimeInSec));null!=u&&t.sourceBuffer&&t.sourceBuffer.contains(u)&&(n.Log.verbose(7,"flushing at "+u+" from track selection"),t.sourceBuffer.flushFrom(u),t.pendingSeekPositionInSec=u,2===i.streamingInfo.workflowState&&(i.streamingInfo.workflowState=0))}var u=this._sessionContext.commonPresentation.periods[0].streams,i=u.filter(function(n){return n.streamingInfo.flushStream===!0}),r,t;for(i.length===0&&(i=u),r=0;r<i.length;r++)t=i[r].streamingInfo,i[r].type===0&&t.selected&&f(i[r],this._sessionContext);this._checkMediaWorkflow()},i.prototype._tryTimeUpdateEvent=function(){function r(){t.disposed||t.videoTag.paused&&t.commonPresentation&&t.commonPresentation.isLive&&(t.eventMgr.dispatchEvent(n.EventName.timeupdate),n.Util.setTimeout(r,i._timeupdateLivePausedIntervalInMSec))}if(!this._disposed){var t=this._sessionContext;r()}},i._mediaSegmentTimeoutInMSec=2e3,i._minPresentationUpdatePeriodInMSec=1e3,i._bufferTooFarAheadInSec=4,i._timeupdateLivePausedIntervalInMSec=1e3,i._durationChangeMinIntervalInMSec=1e3,i._healthCheckPeriodInMSec=1e3,i._healthCheckSkipInSec=.5,i}()})(n.Workflow||(n.Workflow={}));var t=n.Workflow}(AzureHtml5JS||(AzureHtml5JS={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){(function(t){"use strict";function r(){return new f}function u(){return new e}t.CreatePresentation=r;t.CreateMedia=u;var i=function(){function t(t){this._eventManager=new n.Events.Manager;this._eventsOrdered=t;this._stepList=[]}return t.prototype.dispose=function(){this._eventManager.dispose();this._eventManager=null;this._eventsOrdered=null;this._stepList=null},t.prototype.addHandler=function(n,t,i){this._eventManager.addHandler(n,t,i)},t.prototype.createSteps=function(){var i=this,r=0,n,t;for(n in this._eventsOrdered)t=this._eventManager.getHandlers(this._eventsOrdered[n]),t.forEach(function(n){i._stepList[r++]=n})},Object.defineProperty(t.prototype,"stepList",{get:function(){return this._stepList},enumerable:!0,configurable:!0}),t}(),f=function(n){function t(){var t=[this.stepEvents.requestBegin,this.stepEvents.requestSend,this.stepEvents.dataRetrieved,this.stepEvents.requestEnd];n.call(this,t)}return __extends(t,n),Object.defineProperty(t.prototype,"stepEvents",{get:function(){return{requestBegin:"requestBegin",requestSend:"requestSend",dataRetrieved:"dataRetrieved",requestEnd:"requestEnd"}},enumerable:!0,configurable:!0}),t}(i),e=function(n){function t(){var t=[this.stepEvents.requestBegin,this.stepEvents.requestSend,this.stepEvents.dataRetrieved,this.stepEvents.requestEnd];n.call(this,t)}return __extends(t,n),Object.defineProperty(t.prototype,"stepEvents",{get:function(){return{requestBegin:"requestBegin",requestSend:"requestSend",dataRetrieved:"dataRetrieved",requestEnd:"requestEnd"}},enumerable:!0,configurable:!0}),t}(i)})(n.Workflow||(n.Workflow={}));var t=n.Workflow}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";function i(n){return new r(n)}t.CreateSequencer=i;var r=function(){function i(t){this._disposed=!1;this._sessionContext=t;this._orderedModules=[new n.DataRetriever.HttpRetryPolicy,new n.SegmentLocator.Dash,new n.Heuristics.InitialBandwidthDataUrlFormatter,new n.Heuristics.WindowSizeRule,new n.Heuristics.StepRule,new n.Heuristics.Engine,new n.UrlBuilder.DashUrlFormatter,new n.DataRetriever.HttpDataRetriever(t),new n.DashPresentation.Parser,new n.ContentProtection.PlayReady,new n.ContentProtection.Widevine,new n.ContentProtection.AesHandler,new n.DashMediaSegment.Parser,new n.Presentation.InitialStreamSelector];this._createWorkflows(t)}return i.prototype.dispose=function(){this._disposed||(this._disposed=!0,this._orderedModules.forEach(function(n){n.dispose()}),this._orderedModules=null,this._sessionContext=null)},i.prototype.presentationRequestAsync=function(){var i=this,t=this;return new Promise(function(r,u){var f=new n.Context.Request(0,t._sessionContext);f.urlsToRetrieve.push(new n.Context.UrlRequest(t._sessionContext.presentationUrl,4));i._processSteps(f,r,u)})},i.prototype.mediaRequestAsync=function(t){var i=this;return new Promise(function(r,u){var f=new n.Context.Request(1,i._sessionContext);f.requestedStream=t;f.heuristicData=new n.Context.HeuristicData(t);i._processSteps(f,r,u)})},i.prototype._processSteps=function(t,i,r){function f(){if(e._disposed||t.disposed||t.sessionContext.disposed){r();return}if(u===t.sessionContext.workflows[t.workflowType].stepList.length){t.workflowType===1?n.Log.verbose(0,"Finished process steps for "+n.Presentation.StreamType[t.requestedStream.type]+" media workflow"):n.Log.verbose(0,"Finished process steps for presentation workflow");i(t);return}var f=t.sessionContext.workflows[t.workflowType].stepList[u],h=f.functionHandler.call(f.callerInstance,t);u++;h.then(o,s)}function o(){switch(t.state){case 0:n.Util.setTimeout(f,0);break;case 2:u=0;n.Util.setTimeout(f,t.retryWaitTimeMSec);t.reset();break;case 1:i(t);break;default:throw new Error("processSteps unexpected state"+t.state);}}function s(i){if(null===t.externalFailure){t.sessionContext.eventMgr.dispatchEvent(n.InternalEventName.exception,i);return}var u="stepRejected: "+t.externalFailure.toString();i&&(u+="err: "+i);n.Log.error(0,u);r(t)}var e=this,u;t.workflowType===1?n.Log.verbose(0,"Starting process steps for "+n.Presentation.StreamType[t.requestedStream.type]+" media workflow"):n.Log.verbose(0,"Starting process steps for presentation workflow");u=0;n.Util.setTimeout(f,0)},i.prototype._createWorkflows=function(n){n.workflows=[t.CreatePresentation(),t.CreateMedia()];this._orderedModules.forEach(function(t){t.init(n)});this._sessionContext.workflows.forEach(function(n){n.createSteps()})},i}()})(n.Workflow||(n.Workflow={}));var t=n.Workflow}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";var i=function(){function t(){this.name="com.microsoft.playready";this.type="PlayReady";this._videoElement=null;this._errorHandler=null;this._session=null;this._active=!1;this._authenticationToken=""}return Object.defineProperty(t.prototype,"systemId",{get:function(){return t.systemId},enumerable:!0,configurable:!0}),t.prototype.isSupported=function(i,r){return i.isEqual(t.systemId)?n.EmeUtil.isTypeSupported(this.name,r):new Promise(function(n,t){t();return})},t.prototype.activate=function(n,t,i){this._videoElement=n;this._errorHandler=t;this._authenticationToken=i;this._active=!0},t.prototype.deactivate=function(){this._active&&(this._active=!1,this._session&&(n.EmeUtil.unlistenToKeyMessage(this._session,this._keyMessageHandler),n.EmeUtil.unlistenKeyError(this._session,this._keyErrorHandler),this._session.close(),this._session=null),this._videoElement=null,this._errorHandler=null,this._authenticationToken="")},t.prototype.initData=function(t,i){function e(n){f._keyMessageHandler(n)}function o(){f._keyErrorHandler()}var f=this,r,u;if(!this._session){if(r=n.EmeUtil.createMediaKeys(this.name),!r){n.Log.error(12,this.name+" createMediaKeys failed");u=new n.Failure.External(5242881,this.name+" createMediaKeys failed");this._reportError(u);return}if(n.EmeUtil.setMediaKeys(this._videoElement,r),this._session=r.createSession(i,t),!this._session){n.Log.error(12,this.name+" createSession failed");u=new n.Failure.External(5242881,this.name+" createSession failed");this._reportError(u);return}n.EmeUtil.listenToKeyMessage(this._session,e);n.EmeUtil.listenKeyError(this._session,o)}},t.prototype._keyMessageHandler=function(n){var t=this,i=new Uint16Array(n.message.buffer),r=String.fromCharCode.apply(null,i),u=n.destinationURL;this._getPlayReadyLicense(r,u).then(function(n){t._active&&t._session&&t._session.update(n)},function(n){t._active&&t._reportError(n)})},t.prototype._keyErrorHandler=function(){if(this._active&&this._session.error){var t="MSMediaKeyError code: "+this._session.error.code+", systemCode: "+n.Common.toHexString(this._session.error.systemCode),i=new n.Failure.External(5242880,t);this._reportError(i)}},t.prototype._getPlayReadyLicense=function(t,i){var r=this;return new Promise(function(u,f){var a=null,h=[],v=new DOMParser,s=v.parseFromString(t,"application/xml"),c,o,l,e;if(s.getElementsByTagName("Challenge")[0])c=s.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue,c&&(a=atob(c));else{n.Log.error(12,"Playready: Can not find Challenge in keyMessage");f(new n.Failure.External(5242886,"No challenge"));return}if(o=s.getElementsByTagName("name"),l=s.getElementsByTagName("value"),o.length!=l.length){n.Log.error(12,"Playready update, invalid header name/value pair in keyMessage");f(new n.Failure.External(5242886,"Invalid headers"));return}for(e=0;e<o.length;e++)h[e]={name:o[e].childNodes[0].nodeValue,value:l[e].childNodes[0].nodeValue};r._authenticationToken&&r._authenticationToken.length>0&&(h[o.length]={name:n.HttpUtil.authorizationHeader,value:r._authenticationToken});n.HttpUtil.httpRequest(i,"POST","arraybuffer",h,a).then(function(n){u(new Uint8Array(n))},function(t){var i=new n.Failure.External(5242886,"Http: "+n.Common.toHexString(t));f(i)})})},t.prototype._reportError=function(n){this._errorHandler&&this._errorHandler(n)},t.systemId=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),t}();t.PlayReady=i})(n.KeySystem||(n.KeySystem={}));var t=n.KeySystem}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";var i=function(){function i(){this.name="com.widevine.alpha";this.type="Widevine";this._videoElement=null;this._errorHandler=null;this._laUrl="";this._session=null;this._active=!1;this._authenticationToken=""}return Object.defineProperty(i.prototype,"systemId",{get:function(){return i.systemId},enumerable:!0,configurable:!0}),i.prototype.isSupported=function(t,r){return t.isEqual(i.systemId)?n.EmeUtil.isTypeSupported(this.name,r):new Promise(function(n,t){t();return})},i.prototype.activate=function(n,t,i){this._videoElement=n;this._errorHandler=t;this._authenticationToken=i;this._active=!0},i.prototype.deactivate=function(){this._active&&(this._active=!1,this._session&&(n.EmeUtil.unlistenToMessage(this._session,this._messageHandler),this._session.close(),this._session=null),this._videoElement&&(this._videoElement.src="",this._videoElement.setMediaKeys(null),this._videoElement=null),this._errorHandler=null,this._laUrl="",this._authenticationToken="")},i.prototype.initData=function(t,i,r){function o(n){return n.createMediaKeys()}function s(i){if(u._session=i.createSession(),!u._session){n.Log.error(12,u.name+" createSession failed");var r=new n.Failure.External(5242881,u.name+" createSession failed");u._reportError(r);return}n.EmeUtil.listenToMessage(u._session,h);u._session.generateRequest("cenc",t).catch(function(){n.Log.error(12,u.name+" generateRequest failed");var t=new n.Failure.External(5242881,u.name+" generateRequest failed");u._reportError(t)});u._videoElement.setMediaKeys(i).catch(function(){n.Log.error(12,u.name+" setMediaKeys failed");var t=new n.Failure.External(5242881,u.name+" setMediaKeys failed");u._reportError(t)})}function h(n){u._messageHandler(n)}var u=this,f,e;r&&!this._laUrl&&(this._laUrl=r,f=n.EmeUtil.createSupportedKeySystem(this.name,i),f.catch(function(){n.Log.error(12,u.name+" createSupportedKeySystem failed");var t=new n.Failure.External(5242882,u.name+" createSupportedKeySystem failed");u._reportError(t)}),e=f.then(o),e.catch(function(){n.Log.error(12,u.name+" createMediaKeys failed");var t=new n.Failure.External(5242882,u.name+" createMediaKeys failed");u._reportError(t)}),e.then(s).catch(function(){n.Log.error(12,u.name+" createKeySession failed");var t=new n.Failure.External(5242882,u.name+" createKeySession failed");u._reportError(t)}))},i.prototype._messageHandler=function(n){var t=this;n.messageType==="license-request"&&this._getWidevineLicense(n.message,this._laUrl).then(function(n){t._active&&t._session&&t._session.update(n)},function(n){t._active&&t._reportError(n)})},i.prototype._getWidevineLicense=function(i,r){var u=this;return new Promise(function(f,e){var o=[];u._authenticationToken&&u._authenticationToken.length>0&&o.push({name:t.WidevineCustomAuthorizationHeader||n.HttpUtil.authorizationHeader,value:u._authenticationToken});n.HttpUtil.httpRequest(r,"POST","arraybuffer",o,i).then(function(n){f(new Uint8Array(n))},function(t){var i=new n.Failure.External(5242886,"Http: "+n.Common.toHexString(t));e(i)})})},i.prototype._reportError=function(n){this._errorHandler&&this._errorHandler(n)},i.systemId=new Uint8Array([237,239,139,169,121,214,74,206,163,200,39,220,213,29,33,237]),i}();t.Widevine=i;t.WidevineCustomAuthorizationHeader=""})(n.KeySystem||(n.KeySystem={}));var t=n.KeySystem}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";var i=function(){function i(i){function e(n){r._needKeyHandler(n)}function o(n){r._encryptedHandler(n)}var r=this,u,f;this._videoElement=i;this._errorHandler=null;this.matchedKeySystem=null;this._codec=null;this._psshBoxes=[];this._keySystems={};this._laUrls={};this._authenticationTokens={};this._disposed=!1;u=new t.PlayReady;this.addKeySystem(u);f=new t.Widevine;this.addKeySystem(f);n.EmeUtil.listenToNeedKey(i,e);n.EmeUtil.listenToEncrypted(i,o)}return i.prototype.reset=function(){this.matchedKeySystem&&(this.matchedKeySystem.deactivate(),this.matchedKeySystem=null);this._psshBoxes=[];this._laUrls={};this._errorHandler=null;this._codec=null;this._authenticationTokens={}},i.prototype.dispose=function(){this._disposed||(this._disposed=!0,this.matchedKeySystem&&(this.matchedKeySystem.deactivate(),this.matchedKeySystem=null),this._psshBoxes=[],this._keySystems={},this._laUrls={},this._videoElement=null,this._errorHandler=null,this._codec=null,this._authenticationTokens=null)},i.prototype.setup=function(n,t){this._errorHandler=n;this._authenticationTokens=t},i.prototype.setCodec=function(n){this._codec=n},i.prototype.addKeySystem=function(t){var i=n.Common.uint8ArrayToHexString(t.systemId);return i&&i.length>0?(this._keySystems[i]&&n.Log.warning(12,"Overwriting "+t.name),this._keySystems[i]=t,t):null},i.prototype.addPsshBoxes=function(n){var t=this;n.forEach(function(n){t._psshBoxes.push(n)})},i.prototype.addLaUrl=function(t,i){var r=n.Common.uint8ArrayToHexString(t);if(!this._keySystems[r]){n.Log.warning(12,"Cannot set license acquisition URL for system ID "+r);return}this._laUrls[r]&&this._laUrls[r]!==i&&n.Log.warning(12,"Overwriting license acquisition URL for "+this._keySystems[r].name);this._laUrls[r]=i},i.prototype._needKeyHandler=function(t){var i=this,r,u;this._disposed||(t.initData&&(r=new DataView(t.initData.buffer),u=n.Mp4Util.GetPsshBoxes(r),this.addPsshBoxes(u)),this._findMatchedKeySystem().then(function(t){var r,u;if(t)for(r=0;r<i._psshBoxes.length;r++)i._psshBoxes[r].systemId.isEqual(t.systemId)&&(u=new Uint8Array(i._psshBoxes[r].serialize()),n.Log.verbose(12,"Sending initData to: "+t.name),t.initData(u,i._codec));else i._reportKeySystemNotFound()},function(){i._reportKeySystemNotFound()}))},i.prototype._encryptedHandler=function(t){var i=this,r,u;this._disposed||(t.initData&&(r=new DataView(t.initData),u=n.Mp4Util.GetPsshBoxes(r),this.addPsshBoxes(u)),this._findMatchedKeySystem().then(function(t){var u,r,f;if(t)for(u=n.Common.uint8ArrayToHexString(t.systemId),r=0;r<i._psshBoxes.length;r++)i._psshBoxes[r].systemId.isEqual(t.systemId)&&(f=new Uint8Array(i._psshBoxes[r].serialize()),n.Log.verbose(12,"Sending initData to: "+t.name),t.initData(f,i._codec,i._laUrls[u]));else i._reportKeySystemNotFound()},function(){i._reportKeySystemNotFound()}))},i.prototype._findMatchedKeySystem=function(){var t=this;return new Promise(function(i,r){function f(){if(u>=t._psshBoxes.length){r();return}var e=n.Common.uint8ArrayToHexString(t._psshBoxes[u].systemId);t._keySystems[e]?t._keySystems[e].isSupported(t._psshBoxes[u].systemId,t._codec).then(function(){t.matchedKeySystem=t._keySystems[e];t.matchedKeySystem.activate(t._videoElement,t._errorHandler,t._authenticationTokens[t.matchedKeySystem.type]);n.Log.verbose(12,"Matched key system found: "+t.matchedKeySystem.name);i(t.matchedKeySystem);return},function(){++u;f()}):(++u,f())}if(t.matchedKeySystem){i(t.matchedKeySystem);return}var u=0;f()})},i.prototype._reportKeySystemNotFound=function(){var t=new n.Failure.External(5242881,"no matching keySystem found");this._errorHandler(t)},i}();t.EmeManager=i})(n.KeySystem||(n.KeySystem={}));var t=n.KeySystem}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";var f=function(){function u(){this._disposed=!1;this._bandwidthTracker=null;this._buffer=null;this._downloadRequested=null;this._downloadCompleted=null;this._downloadFailed=null;this._downloadTracker=null;this._eventMgr=new n.Events.Manager(null,!1)}return u.prototype.dispose=function(){this._disposed||(this._disposed=!0,this._bandwidthTracker=null,this._buffer=null,this._downloadRequested=null,this._downloadCompleted=null,this._downloadFailed=null,this._eventMgr&&(this._eventMgr.dispose(),this._eventMgr=null),this._downloadTracker&&(this._downloadTracker.dispose(),this._downloadTracker=null))},Object.defineProperty(u.prototype,"bufferLevel",{get:function(){return this._disposed||!this._buffer?null:this._buffer.getBufferedAheadOfCurrentTimeInSec()},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"perceivedBandwidth",{get:function(){return this._disposed||!this._bandwidthTracker?null:this._bandwidthTracker.perceivedBandwidth()},enumerable:!0,configurable:!0}),u.prototype.updateBuffer=function(n){this._buffer=n},u.prototype.updateBandwidthTracker=function(n){this._bandwidthTracker=n;this._downloadTracker&&this._downloadTracker.dispose();this._downloadTracker=new t.DownloadTracker},u.prototype.getPlaybackBitrate=function(n){return this._disposed||!this._downloadTracker?-1:this._downloadTracker.findBitrate(n)},Object.defineProperty(u.prototype,"downloadRequested",{get:function(){return this._downloadRequested},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"downloadCompleted",{get:function(){return this._downloadCompleted},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"downloadFailed",{get:function(){return this._downloadFailed},enumerable:!0,configurable:!0}),u.prototype.dispatchDownloadRequested=function(t){this._downloadRequested=t;this._eventMgr.dispatchEvent(n.BufferDataEventName.downloadrequested)},u.prototype.dispatchDownloadCompleted=function(t,r){if(this._downloadCompleted=new i(t,r),this._eventMgr.dispatchEvent(n.BufferDataEventName.downloadcompleted),this._downloadTracker&&null!=t.absoluteTime&&(this._downloadTracker.add(t.absoluteTime,t.bitrate),this._buffer.buffered&&this._buffer.buffered.length>0)){var u=this._buffer.buffered.start(0);this._downloadTracker.cleanup(u)}},u.prototype.dispatchDownloadFailed=function(t,i,u){typeof u=="undefined"&&(u="");this._downloadFailed=new r(t,i,u);this._eventMgr.dispatchEvent(n.BufferDataEventName.downloadfailed)},u.prototype.addEventListener=function(n,t,i){this._eventMgr.addHandler(n,t,i)},u.prototype.removeEventListener=function(n,t){this._eventMgr.removeHandler(n,t)},u}(),u,i,r;t.BufferData=f;u=function(){function n(n,t,i){this._url=n;this._bitrate=t;this._absoluteTime=i}return Object.defineProperty(n.prototype,"url",{get:function(){return this._url},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bitrate",{get:function(){return this._bitrate},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"absoluteTime",{get:function(){return this._absoluteTime},enumerable:!0,configurable:!0}),n}();t.MediaDownload=u;i=function(){function n(n,t){this._mediaDownload=n;this._measuredBw=t.bandwidth*1e3;this._bytes=t.responseLengthInBytes;this._downloadTimeMs=t.totalDownloadTimeMs}return Object.defineProperty(n.prototype,"mediaDownload",{get:function(){return this._mediaDownload},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"measuredBandwidth",{get:function(){return this._measuredBw},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"totalBytes",{get:function(){return this._bytes},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"totalDownloadMs",{get:function(){return this._downloadTimeMs},enumerable:!0,configurable:!0}),n}();t.MediaDownloadCompleted=i;r=function(){function n(n,t,i){this._mediaDownload=n;this._code=t;this._message=i}return Object.defineProperty(n.prototype,"code",{get:function(){return this._code},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"message",{get:function(){return this._message},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"mediaDownload",{get:function(){return this._mediaDownload},enumerable:!0,configurable:!0}),n}();t.MediaDownloadFailed=r})(n.Context||(n.Context={}));var t=n.Context}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";var i=function(){function t(){this._downloads=[]}return t.prototype.dispose=function(){this._downloads=[]},t.prototype.add=function(t,i){var u,r;if(this._downloads.length===0){this._downloads.push({time:t,bitrate:i});return}if(u=this._downloads[this._downloads.length-1],t>u.time){i!=u.bitrate&&this._downloads.push({time:t,bitrate:i});return}r=n.Common.binarySearchTimeline(t,this._downloads,this._compareTime);(-1===r||t>this._downloads[r].time)&&r++;this._downloads.splice(r,this._downloads.length-r);this._downloads.push({time:t,bitrate:i});return},t.prototype.findBitrate=function(t){var i=n.Common.binarySearchTimeline(t,this._downloads,this._compareTime);return i===-1?-1:this._downloads[i].bitrate},t.prototype.cleanup=function(t){if(!(this._downloads.length>0)||!(t<=this._downloads[0].time)){var i=n.Common.binarySearchTimeline(t,this._downloads,this._compareTime);i>0&&this._downloads.splice(0,i)}},t.prototype._compareTime=function(n,t,i){var r=0;return i?(n<t.time?r=-1:n>=i.time&&(r=1),r):t.time<=n?0:-1},t}();t.DownloadTracker=i})(n.Context||(n.Context={}));var t=n.Context}(AzureHtml5JS||(AzureHtml5JS={})),function(n){"use strict";var u=function(){function n(){}return n.volumechange="volumechange",n.ended="ended",n.timeupdate="timeupdate",n.durationchange="durationchange",n.pause="pause",n.play="play",n.playing="playing",n.seeking="seeking",n.seeked="seeked",n.loadstart="loadstart",n.loadedmetadata="loadedmetadata",n.loadeddata="loadeddata",n.fullscreenchange="fullscreenchange",n.waiting="waiting",n.canplaythrough="canplaythrough",n.error="error",n.playbackstalled="playbackstalled",n.downloadbitratechanged="downloadbitratechanged",n.playbackbitratechanged="playbackbitratechanged",n}(),t,i,r,f;n.EventName=u;t=function(){function n(){}return n.trackselected="trackselected",n}();n.StreamEventName=t;i=function(){function n(){}return n.streamselected="streamselected",n.streamindexinvalid="streamindexinvalid",n.streamselectnotsupported="streamselectnotsupported",n}();n.StreamListEventName=i;r=function(){function n(){}return n.downloadrequested="downloadrequested",n.downloadcompleted="downloadcompleted",n.downloadfailed="downloadfailed",n}();n.BufferDataEventName=r,function(n){n[n.abortedErrStart=1048576]="abortedErrStart";n[n.abortedErrUnknown=1048576]="abortedErrUnknown";n[n.abortedErrNotImplemented=1048577]="abortedErrNotImplemented";n[n.abortedErrEnd=2097151]="abortedErrEnd";n[n.networkErrStart=2097152]="networkErrStart";n[n.networkErrUnknown=2097152]="networkErrUnknown";n[n.networkErrHttpResponseBegin=2097552]="networkErrHttpResponseBegin";n[n.networkErrHttpBadUrlFormat=2097552]="networkErrHttpBadUrlFormat";n[n.networkErrHttpUserAuthRequired=2097553]="networkErrHttpUserAuthRequired";n[n.networkErrHttpUserForbidden=2097555]="networkErrHttpUserForbidden";n[n.networkErrHttpUrlNotFound=2097556]="networkErrHttpUrlNotFound";n[n.networkErrHttpNotAllowed=2097557]="networkErrHttpNotAllowed";n[n.networkErrHttpPreconditionFailed=2097564]="networkErrHttpPreconditionFailed";n[n.networkErrHttpInternalServerFailure=2097652]="networkErrHttpInternalServerFailure";n[n.networkErrHttpBadGateway=2097654]="networkErrHttpBadGateway";n[n.networkErrHttpServiceUnavailable=2097655]="networkErrHttpServiceUnavailable";n[n.networkErrHttpGatewayTimeout=2097656]="networkErrHttpGatewayTimeout";n[n.networkErrHttpResponseEnd=2097751]="networkErrHttpResponseEnd";n[n.networkErrTimeout=2097752]="networkErrTimeout";n[n.networkErrEnd=3145727]="networkErrEnd";n[n.decodeErrStart=3145728]="decodeErrStart";n[n.decodeErrUnknown=3145728]="decodeErrUnknown";n[n.decodeErrEnd=4194303]="decodeErrEnd";n[n.srcErrStart=4194304]="srcErrStart";n[n.srcErrUnknown=4194304]="srcErrUnknown";n[n.srcErrParsePresentation=4194305]="srcErrParsePresentation";n[n.srcErrParseSegment=4194306]="srcErrParseSegment";n[n.srcErrUnsupportedPresentation=4194307]="srcErrUnsupportedPresentation";n[n.srcErrInvalidSegment=4194308]="srcErrInvalidSegment";n[n.srcErrEnd=5242879]="srcErrEnd";n[n.encryptErrStart=5242880]="encryptErrStart";n[n.encryptErrUnknown=5242880]="encryptErrUnknown";n[n.encryptErrDecrypterNotFound=5242881]="encryptErrDecrypterNotFound";n[n.encryptErrDecrypterInit=5242882]="encryptErrDecrypterInit";n[n.encryptErrDecrypterNotSupported=5242883]="encryptErrDecrypterNotSupported";n[n.encryptErrKeyAcquire=5242884]="encryptErrKeyAcquire";n[n.encryptErrDecryption=5242885]="encryptErrDecryption";n[n.encryptErrLicenseAcquire=5242886]="encryptErrLicenseAcquire";n[n.encryptErrEnd=6291455]="encryptErrEnd"}(n.ErrorCode||(n.ErrorCode={}));f=n.ErrorCode}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(n){"use strict";var t,i;(function(n){n[n.video=0]="video";n[n.audio=1]="audio";n[n.text=2]="text"})(n.StreamType||(n.StreamType={}));t=n.StreamType,function(n){n[n.playReadySpecificData=0]="playReadySpecificData";n[n.widevineSpecificData=1]="widevineSpecificData";n[n.seaEncryptionSystemId=2]="seaEncryptionSystemId";n[n.seaKeyUri=3]="seaKeyUri";n[n.seaIV=4]="seaIV"}(n.ContentProtectionDataType||(n.ContentProtectionDataType={}));i=n.ContentProtectionDataType})(n.Presentation||(n.Presentation={}));var t=n.Presentation}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(n){"use strict";(function(n){n[n.closed=0]="closed";n[n.open=1]="open";n[n.ended=2]="ended"})(n.ReadyState||(n.ReadyState={}));var t=n.ReadyState})(n.VideoElementAdapter||(n.VideoElementAdapter={}));var t=n.VideoElementAdapter}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(n){"use strict";(function(n){n[n.presentation=0]="presentation";n[n.media=1]="media";n[n.max=2]="max"})(n.Type||(n.Type={}));var t=n.Type})(n.Workflow||(n.Workflow={}));var t=n.Workflow}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";var r=function(){function t(t){this._bandwidthSettings=t;this._averageCalc=new n.Util.AverageCalculator(this._bandwidthSettings.maxBandwidthHistoryCount)}return Object.defineProperty(t.prototype,"averageBandwidthInKbps",{get:function(){return this._averageCalc.average},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"latestInKbps",{get:function(){return this._averageCalc.latest},enumerable:!0,configurable:!0}),t.prototype.perceivedBandwidth=function(){var n=this._averageCalc.average*1e3;return n*this._bandwidthSettings.bandwidthUsabilityPercent},t.prototype.updateBandwidthInfo=function(t){if(t.responseLengthInBytes<this._bandwidthSettings.bandwidthDataSizeThresholdInBytes){n.Log.verbose(5,"Ignoring Bandwidth data as data size :"+t.responseLengthInBytes+" which is less that the limit :"+this._bandwidthSettings.bandwidthDataSizeThresholdInBytes);return}var i=t.totalDownloadTimeMs,r=t.bandwidth;this._averageCalc.addValue(r);n.Log.verbose(5,"updateBandWidthInfo -  currentBw: "+this._averageCalc.latest+" averageBw: "+this._averageCalc.average+" size: "+t.responseLengthInBytes+" time Took:"+i)},t.prototype.reportHeuristicsData=function(t,i){var u=this.perceivedBandwidth(),r,f;if(n.Log.verbose(5,"averageBW reporting is : "+u),!i)throw new Error("reportHeuristicsData failed, invalid chunkDuration");for(r=0;r<t.tracksData.length;r++)t.tracksData[r].selectable&&(f=t.tracksData[r].trackInfo.bitrate*i,t.tracksData[r].dataRetrieverEstimationInSec=u?f/u:Infinity)},t}(),i;t.BandwidthTracker=r;i=function(){function t(){this.requestStartTimeInMS=(new Date).getTime();this.responseStartTimeInMS=null;this.responseEndTimeInMS=null;this.responseLengthInBytes=0}return Object.defineProperty(t.prototype,"totalDownloadTimeMs",{get:function(){return n.assert(this.responseEndTimeInMS>=this.requestStartTimeInMS,"BandwidthInfo.totalDownloadTimeMs: unexpected values:"+this.responseEndTimeInMS+" should not be < "+this.requestStartTimeInMS),this.responseEndTimeInMS-this.requestStartTimeInMS||1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"latencyTimeMs",{get:function(){return n.assert(this.responseStartTimeInMS>=this.requestStartTimeInMS,"BandwidthInfo.latencyTimeMs: unexpected values:"+this.responseStartTimeInMS+" should not be < "+this.requestStartTimeInMS),this.responseStartTimeInMS-this.requestStartTimeInMS||1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bandwidth",{get:function(){return n.assert(this.totalDownloadTimeMs>0,"BandwidthInfo.bandwidth: unexpected value:"+this.totalDownloadTimeMs+" should be > 0"),this.responseLengthInBytes*8/this.totalDownloadTimeMs},enumerable:!0,configurable:!0}),t}();t.BandwidthInfo=i})(n.Heuristics||(n.Heuristics={}));var t=n.Heuristics}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";var r=function(){function t(){this._moduleId="DashMediaSegmentParser"}return t.prototype.dispose=function(){},t.prototype.init=function(n){var t=n.workflows[1];t.addHandler(t.stepEvents.dataRetrieved,this.onGetData,this)},t.prototype.onGetData=function(t){function r(){var a,h,e,c,l,s,o,r,f,v;if(r=t.requestedStream.streamingInfo.currentSegment,f=t.urlsToRetrieve.findFirst(function(n){return n.requestType===0}),!f||!f.mediaData)throw new Error(f.url+": no media segment data found");if(a=new DataView(f.mediaData),h=n.Mp4Util.GetBoxByType(a,"moof"),!h)return new i(4194306,"moof not found");if(e=n.Mp4Util.GetBoxByType(h.data,"traf"),!e)return new i(4194306,"traf not found");if(c=n.Mp4Util.GetTfhdBox(e.data),!c)return new i(4194306,"tfhd not found");if(l=n.Mp4Util.GetTrunBox(e.data),!l)return new i(4194306,"trun not found");if(s=n.Mp4Util.GetTfdtBox(e.data),!s)return new i(4194306,"tfdt not found");if(n.Common.diffTimes(s.baseMediaDecodeTime,r.segmentInfo.mediaTimestamp))throw new Error("Segment mismatch, requested: "+r.segmentInfo.mediaTimestamp+" got: "+s.baseMediaDecodeTime);return(o=u(c,l),0===o)?new i(4194308,"failed to derive segment duration"):(n.Log.verbose(10,"Segment duration: "+o),v=t.requestedStream.segments.updateSegmentDuration(r.segmentInfo.presTimeInSec,o),!v)?new i(4194308,"failed to update segment duration in container"):(r.segmentInfo.mediaDuration=o,f.durationInSec=r.segmentInfo.durationInSec,null)}function u(t,i){var r=0;return i.flags&n.Mp4Util.TrunBox.flags_sampleDurationPresent?i.sampleInfoArray.forEach(function(n){r+=n.sampleDuration}):t.defaultSampleDuration?r=t.defaultSampleDuration*i.sampleCount:n.Log.warning(10,"Cannot calculate segment duration from 'tfhd' and 'trun'"),r}function f(){var r=t.requestedStream,u=r.streamingInfo.currentSegment,i=u.segmentInfo,f=r.segments;i.mediaDuration&&f.addMediaSegmentInfo(i.index+1,n.Timestamp.add(i.mediaTimestampStr,i.mediaDuration),NaN,i.presentationOffset,i.timescale)}return t.currentModuleId=this._moduleId,new Promise(function(i,u){var o,e;if(o=t.requestedStream.streamingInfo.currentSegment,!t.sessionContext.commonPresentation.isLive||t.sessionContext.commonPresentation.minimumUpdatePeriodInSec||o.next){i();return}if(!o.segmentInfo.mediaDuration&&(e=r(),e)){n.Failure.attachFailureToRequest(t,t.currentModuleId,e.errorCode,e.message);u();return}f();i()})},t}(),i;t.Parser=r;i=function(){function n(n,t){this.errorCode=n;this.message=t}return n}()})(n.DashMediaSegment||(n.DashMediaSegment={}));var t=n.DashMediaSegment}(AzureHtml5JS||(AzureHtml5JS={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){(function(t){"use strict";function a(n){var t;if("schemeIdUri"in n)t=n.schemeIdUri;else throw new Error("ContentProtection missing @schemeIdUri");return t.toLowerCase()===r.schemeIdUri?new r(n):t.toLowerCase()===u.schemeIdUri?new u(n):t.toLowerCase()===f.schemeIdUri?new f(n):new c(n)}var l=function(){function t(){this._moduleId="DashPresentationParser"}return t.prototype.dispose=function(){},t.prototype.init=function(n){var t=n.workflows[0];t.addHandler(t.stepEvents.dataRetrieved,this.onParse,this)},t.prototype.onParse=function(i){return i.currentModuleId=this._moduleId,new Promise(function(r,u){var f,s,c,l,o,h;if(!i.urlsToRetrieve[0].presentationData)throw new Error(i.urlsToRetrieve[0].url+": no presentation data found");if(f=i.sessionContext,h=t._getPublishTime(i.urlsToRetrieve[0].presentationData),h&&f.commonPresentation&&f.commonPresentation.publishTime&&f.commonPresentation.publishTime.getTime()>=Date.parse(h)){n.Log.verbose(4,"skipping MPD parse, not newer than last parsed: "+i.urlsToRetrieve[0].url);r();return}if(s=f.presentationUrl,c=s.lastIndexOf("/"),l=s.slice(0,c+1),o=new e(i.urlsToRetrieve[0].presentationData,l),!o||!o.periods){n.Failure.attachFailureToRequest(i,i.currentModuleId,4194305,i.urlsToRetrieve[0].url+": failed to generate DASH presentation");u("failed to generate DASH presentation");return}if(!t._validPresentation(o)){n.Failure.attachFailureToRequest(i,i.currentModuleId,4194307,i.urlsToRetrieve[0].url+": unsupported presentation");u("unsupported presentation");return}f.updatePresentation(o);n.Log.verbose(4,"MPD updated");r()})},t._validPresentation=function(t){return t.periods.length===0||t.periods.length>1?(n.Log.error(4,"invalid period count: "+(t.periods?t.periods.length.toString():"undefined")),!1):t.periods[0].streams?!0:(n.Log.error(4,"no streams found"),!1)},t._getPublishTime=function(n){var t,i,r="";return n&&(t=n.match(/<MPD[^>]*>/i),t&&t.length>0&&(i=t[0].match(/publishTime="[^"]*/i),i&&i.length>0&&(r=i[0].slice(13)))),r},t}(),e,o,s,h,i,r,u,f,c;t.Parser=l;e=function(){function t(n,t){var u=this,i,r=[];if(this._lastRetrievalTime=new Date,i=Dash.dependencies.DashParser(),i.debug=new y,i.errHandler=new p,this._manifest=i.parse(n,t),this._manifest){if("Period_asArray"in this._manifest&&this._manifest.Period_asArray.length>0&&this._manifest.Period_asArray.forEach(function(n){r.push(new o(n,u.publishTime,u.isLive))}),this._periods=r,r.length>1)throw new Error("Error parsing MPD: multiple periods not supported");"dynamic"===this._manifest.type&&0===this._manifest.minimumUpdatePeriod&&(this._timeShiftTracker=new v(r,this._manifest.timeShiftBufferDepth))}}return t.prototype.dispose=function(){this._periods&&(this._periods.forEach(function(n){n.dispose()}),this._periods=[]);this._manifest=null;this._lastRetrievalTime=null},Object.defineProperty(t.prototype,"startTime",{get:function(){var n=null;return"availabilityStartTime"in this._manifest&&(n=new Date(this._manifest.availabilityStartTime)),n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"publishTime",{get:function(){return"publishTime"in this._manifest?new Date(this._manifest.publishTime):this._lastRetrievalTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLive",{get:function(){return this._manifest.type==="dynamic"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minimumUpdatePeriodInSec",{get:function(){return this._manifest.minimumUpdatePeriod},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"durationInSec",{get:function(){var n=0;return"mediaPresentationDuration"in this._manifest&&(n=this._manifest.mediaPresentationDuration),n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeShiftBufferDepth",{get:function(){return this._manifest.timeShiftBufferDepth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"playableWindow",{get:function(){return new n.Common.TimeRange(this._playWindowLeftEdge(),this._playWindowLiveEdge())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"periods",{get:function(){return this._periods},enumerable:!0,configurable:!0}),t.prototype.toJson=function(){return this._manifest},t.prototype.transferPresentationState=function(t){var e=t,i=[],r=[],f,u;for(this._manifest=e._manifest,this._lastRetrievalTime=e._lastRetrievalTime,this._timeShiftTracker=e._timeShiftTracker,this.periods.forEach(function(n){i.push(n)}),e.periods.forEach(function(n){r.push(n)}),f=0;f<r.length;f++)for(u=0;u<i.length;u++)if(i[u]&&r[f].startInSec===i[u].startInSec){i[u].transferPeriodState(r[f]);r[f]=null;i[u]=null;break}i=i.filter(function(n){return!!n});r=r.filter(function(n){return!!n});i.length>0&&n.Log.verbose(4,"Periods removed from MPD: "+i.length);r.length>0&&n.Log.verbose(4,"Periods added to MPD: "+r.length)},t.prototype.adjustPlayableWindow=function(n){this._timeShiftTracker&&this._timeShiftTracker.adjust(n)},t.prototype._playWindowLeftEdge=function(){var t=0,n;return this._timeShiftTracker?this._timeShiftTracker.leftEdge:!this._periods||!this._periods.length?0:(n=this._periods[0].streams,!n||!n.length)?0:(n.forEach(function(n){n.type!==2&&n.segments&&n.segments.first&&(t=Math.max(t,n.segments.first.segmentInfo.presTimeInSec))}),t)},t.prototype._playWindowLiveEdge=function(){var t=Infinity,n;return this._timeShiftTracker?this._timeShiftTracker.liveEdge:!this._periods||!this._periods.length?0:(n=this._periods[0].streams,!n||!n.length)?0:(n.forEach(function(n){if(n.type!==2&&n.segments&&n.segments.last){var i=n.segments.last.segmentInfo;t=Math.min(t,i.presTimeInSec+(i.durationInSec||0))}}),t)},t}();t.Mpd=e;o=function(){function t(n,t,i){var u=this,r=[];this.startInSec="start"in n?n.start:0;"AdaptationSet_asArray"in n&&n.AdaptationSet_asArray.length>0&&n.AdaptationSet_asArray.forEach(function(n){r.push(new s(n,t,i,u.startInSec))});this._streams=r}return Object.defineProperty(t.prototype,"streams",{get:function(){return this._streams},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this._streams&&(this._streams.forEach(function(n){n.dispose()}),this._streams=[])},t.prototype.transferPeriodState=function(t){var i=[],r=[],f,u;for(this.streams.forEach(function(n){i.push(n)}),t.streams.forEach(function(n){r.push(n)}),f=0;f<r.length;f++)for(u=0;u<i.length;u++)if(i[u]&&r[f].id===i[u].id){i[u].transferStreamState(r[f]);r[f]=null;i[u]=null;break}i=i.filter(function(n){return!!n});r=r.filter(function(n){return!!n});i.length>0&&n.Log.verbose(4,"Adaptation Sets removed from period: "+i.length);r.length>0&&n.Log.verbose(4,"Adaptation Sets added to period: "+r.length)},t}();t.Period=o;s=function(){function t(t,i,r,u){var b=[],k=[],s,e,o,v,y,p,c,f,w,l,d;if(this._adaptationSet=t,this.streamingInfo=new n.Presentation.MediaStreamStreamingInfo,"SegmentTemplate"in t&&(this._segmentTemplate=t.SegmentTemplate,"SegmentTimeline"in this._segmentTemplate&&(s=this._segmentTemplate.SegmentTimeline,e=this._segmentTemplate.timescale?this._segmentTemplate.timescale:1,o=u*e,o-=this._segmentTemplate.presentationTimeOffset?this._segmentTemplate.presentationTimeOffset:0,this._normalizedPtoInSec=o/e,v=new n.Presentation.MediaSegmentInfoContainer(e,o,i,r),"S_asArray"in s))){for(y="0",p=this._segmentTemplate.startNumber?this._segmentTemplate.startNumber:0,c=0;c<s.S_asArray.length;c++)f=s.S_asArray[c],w="t"in f?f.t_str:y,l="r"in f?f.r:0,d=new n.Presentation.SegmentRunEntry(p,w,f.d,o,e,l),v.addMediaSegmentRun(d),p+=l+1,y=n.Timestamp.add(w,f.d*(l+1));this.segments=v}"Representation"in t&&t.Representation_asArray.forEach(function(n){b.push(new h(n))});this._tracks=b.sort(function(n,t){return n.bitrate-t.bitrate});"ContentProtection"in t&&t.ContentProtection_asArray.forEach(function(n){k.push(a(n))});this._contentProtections=k}return t.prototype.dispose=function(){this._tracks&&(this._tracks.forEach(function(n){n.dispose()}),this._tracks=[]);this._contentProtections&&(this._contentProtections.forEach(function(n){n.dispose()}),this._contentProtections=[]);this.segments&&(this.segments.dispose(),this.segments=null);this.streamingInfo&&(this.streamingInfo.dispose(),this.streamingInfo=null);this._adaptationSet=null;this._segmentTemplate=null},Object.defineProperty(t.prototype,"codec",{get:function(){var n=this._adaptationSet;return n.mimeType+';codecs="'+n.codecs+'"'},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){var t;switch(this._adaptationSet.contentType){case"video":t=0;break;case"audio":t=1;break;default:n.Log.error(4,"Stream type not supported: "+this._adaptationSet.contentType)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){var n=null;return"id"in this._adaptationSet?n=this._adaptationSet.id.toString():(n=this._adaptationSet.codecs,"lang"in this._adaptationSet&&(n+=this._adaptationSet.lang)),n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"language",{get:function(){var n=null;return"lang"in this._adaptationSet&&(n=this._adaptationSet.lang),n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"initUrlTemplate",{get:function(){var n=null;return"initialization"in this._segmentTemplate&&(n=this._adaptationSet.BaseURL+this._segmentTemplate.initialization),n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mediaUrlTemplate",{get:function(){var n=null;return"media"in this._segmentTemplate&&(n=this._adaptationSet.BaseURL+this._segmentTemplate.media),n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"presentationTimeOffsetInSec",{get:function(){return this._normalizedPtoInSec},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tracks",{get:function(){return this._tracks},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentProtections",{get:function(){return this._contentProtections},enumerable:!0,configurable:!0}),t.prototype.transferStreamState=function(t){var i=[],r=[],f,u;for(this.tracks.forEach(function(n){i.push(n)}),t.tracks.forEach(function(n){r.push(n)}),f=0;f<r.length;f++)for(u=0;u<i.length;u++)if(i[u]&&r[f].id===i[u].id){r[f]=null;i[u]=null;break}i=i.filter(function(n){return!!n});r=r.filter(function(n){return!!n});i.length>0&&n.Log.verbose(4,"Representations removed from MPD: "+i.length);r.length>0&&n.Log.verbose(4,"Representations added to MPD: "+r.length);this.segments.update(t.segments)},t}();t.AdaptationSet=s;h=function(){function t(t){if("id"in t)this._id=t.id;else throw new Error("Representation missing @id");if("bandwidth"in t)this._bitrate=t.bandwidth;else throw new Error("Representation missing @bandwidth");this._height=t.height;this._width=t.width;this.streamingInfo=new n.Presentation.MediaTrackStreamingInfo}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bitrate",{get:function(){return this._bitrate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectable",{get:function(){return this.streamingInfo.selectable},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){},t}();t.Representation=h;i=function(){function n(n){if("schemeIdUri"in n)this.schemeIdUri=n.schemeIdUri;else throw new Error("ContentProtection missing @schemeIdUri");"value_str"in n?this._value=n.value_str:"value"in n&&(this._value=n.value);"id"in n&&(this._id=n.id)}return Object.defineProperty(n.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){},n}();t.BaseContentProtection=i;r=function(n){function t(t){n.call(this,t);"pro"in t&&(this._specificData=t.pro.__text)}return __extends(t,n),t.prototype.data=function(n){return 0===n?this._specificData:null},t.prototype.dispose=function(){},t.schemeIdUri="urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95",t}(i);t.PlayReadyContentProtection=r;u=function(n){function t(t){n.call(this,t);"pssh"in t&&(this._specificData=t.pssh.__text);"laurl"in t&&(this._laUrl=t.laurl.licenseUrl)}return __extends(t,n),Object.defineProperty(t.prototype,"laUrl",{get:function(){return this._laUrl},enumerable:!0,configurable:!0}),t.prototype.data=function(n){return 1===n?this._specificData:null},t.prototype.dispose=function(){},t.schemeIdUri="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",t}(i);t.WidevineContentProtection=u;f=function(n){function t(t){if(n.call(this,t),"SegmentEncryption"in t&&(this._seaEncryptionSystemId=t.SegmentEncryption.schemeIdUri,"CryptoPeriod"in t)){var i=t.CryptoPeriod;"keyUriTemplate"in i&&(this._keyUri=i.keyUriTemplate);"IV"in i&&(this._iv=i.IV)}}return __extends(t,n),t.prototype.data=function(n){switch(n){case 2:return this._seaEncryptionSystemId;case 3:return this._keyUri;case 4:return this._iv;default:return null}},t.prototype.dispose=function(){},t.schemeIdUri="urn:mpeg:dash:sea:2012",t}(i);t.SegmentEncryptionContentProtection=f;c=function(n){function t(t){n.call(this,t)}return __extends(t,n),t.prototype.data=function(){return null},t.prototype.dispose=function(){},t}(i);t.GenericContentProtection=c;var v=function(){function t(t,i){var f,r=0,u=Infinity;t.length&&(f=t[0].streams,f&&f.length)&&(f.forEach(function(n){n.type!==2&&n.segments&&n.segments.first&&n.segments.last&&(r=Math.max(r,n.segments.first.segmentInfo.presTimeInSec),u=Math.min(u,n.segments.last.segmentInfo.presTimeInSec+n.segments.last.segmentInfo.durationInSec))}),n.Log.verbose(4,"TimeShiftBufferTracker: leftEdge: "+r+" liveEdge: "+u+" duration: "+(u-r)),this._dvrWindowLenInSec=i?i:Infinity,this._leftEdgeReferenceInPresentation=r,this._liveEdgeReferenceInPresentation=u,this._liveEdgeReferenceLocalTime=Date.now())}return Object.defineProperty(t.prototype,"liveEdge",{get:function(){var n=(Date.now()-this._liveEdgeReferenceLocalTime)/1e3;return this._liveEdgeReferenceInPresentation+n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftEdge",{get:function(){var t=(Date.now()-this._liveEdgeReferenceLocalTime)/1e3,n=this._liveEdgeReferenceInPresentation+t;return n-this._leftEdgeReferenceInPresentation<this._dvrWindowLenInSec?this._leftEdgeReferenceInPresentation:n-this._dvrWindowLenInSec},enumerable:!0,configurable:!0}),t.prototype.adjust=function(t){var i=this._liveEdgeReferenceInPresentation+t;if(i<=0){n.Log.warning(4,"TimeShiftBufferTracker error, ignoring invalid adjustment: "+t);return}n.Log.verbose(4,"Adjusting TimeShiftBufferTracker: "+t);this._liveEdgeReferenceInPresentation=i},t}(),y=function(){function t(){this.log=function(t){n.Log.verbose(4,t)}}return t}(),p=function(){function t(){this.manifestError=function(t){n.Log.error(4,t)}}return t}()})(n.DashPresentation||(n.DashPresentation={}));var t=n.DashPresentation}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";var i=function(){function t(){this._moduleId="DashUrlFormatter"}return t.prototype.init=function(n){var t=n.workflows[1];t.addHandler(t.stepEvents.requestSend,this.onUrlFormat,this)},t.prototype.dispose=function(){},t.prototype.onUrlFormat=function(t){return t.currentModuleId=this._moduleId,new Promise(function(i){var r,u,f,e,h,o,s,c,l;if(!t.selectedTrack)throw new Error("Selected Track not set");if(r=t.selectedTrack.bitrate,r===null||r===undefined)throw new Error("incorrect bitrate");if(u=t.requestedStream.streamingInfo.currentSegment,!u)throw new Error("current segment not selected.");if(f=u.segmentInfo.presTimeInSec,t.requestedStream.streamingInfo.fetchInitSegment){if(e=t.requestedStream.initUrlTemplate,!e)throw new Error("initialization url template is not set for the stream");h=n.Util.UrlFormatter.FormatDashInitUrl(e,r.toString());t.requestedStream.streamingInfo.fetchInitSegment=!1;o=new n.Context.UrlRequest(h,0,f);o.requestType=1;t.urlsToRetrieve.push(o)}if(s=t.requestedStream.mediaUrlTemplate,!s)throw new Error("media url template is not set for the stream");c=u.segmentInfo.mediaTimestampStr;l=n.Util.UrlFormatter.FormatDashMediaUrl(s,r.toString(),c);t.urlsToRetrieve.push(new n.Context.UrlRequest(l,0,f,u.segmentInfo.durationInSec));i()})},t}();t.DashUrlFormatter=i})(n.UrlBuilder||(n.UrlBuilder={}));var t=n.UrlBuilder}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";var i=function(){function t(){this._moduleId="heuristics.Engine";this._disposed=!1}return t.prototype.dispose=function(){this._disposed=!0},t.prototype.init=function(n){var t=n.workflows[1];t.addHandler(t.stepEvents.requestSend,this.onGetIndex,this)},t.prototype.onGetIndex=function(t){function u(){t.selectedTrack!==t.requestedStream.streamingInfo.lastDownloadedTrack&&(t.requestedStream.streamingInfo.fetchInitSegment=!0)}function f(n){if(!n)throw new Error("findHighestTrack failed, invalid timeEstimationThresholdInSec");for(var i=t.heuristicData.tracksData.length-1;i>=0;i--)if(t.heuristicData.tracksData[i].selectable&&t.heuristicData.tracksData[i].dataRetrieverEstimationInSec<n)return t.heuristicData.tracksData[i].trackInfo;return null}var i=this,r;return n.Log.verbose(8,"OnGetIndex"),t.currentModuleId=this._moduleId,r=this,new Promise(function(r,e){function s(){u();r()}var c,l,h,a,v,o;if(i._disposed){n.Failure.attachFailureToRequest(t,t.currentModuleId,0);e("object is already disposed.");return}if(t.selectedTrack){s();return}if(t.requestedStream.type!==0){t.selectedTrack=t.requestedStream.tracks[0];s();return}if(c=t.heuristicData.tracksData.findFirst(function(n){return n.selectable===!0}),c)t.selectedTrack=c.trackInfo;else{t.selectedTrack=t.heuristicData.tracksData[0].trackInfo;s();return}if(l=t.requestedStream.streamingInfo.sourceBuffer.getBufferedAheadOfCurrentTimeInSec(),h=5,!t.requestedStream.streamingInfo.currentSegment){s();return}h=n.StreamUtil.getSegmentDuration(t);a=t.sessionContext.maxBufferInSec()*t.sessionContext.heuristicSettings.vodStableBufferLevelPercent;v=t.sessionContext.maxBufferInSec()*t.sessionContext.heuristicSettings.vodDowngradeBufferLevelPercent;l<v&&!t.sessionContext.videoTag.paused&&(h*=t.sessionContext.heuristicSettings.belowDowngradeBufferLevelDownloadTimeFactor);o=f(h);(!o||l>a&&o.bitrate<t.requestedStream.streamingInfo.lastDownloadedTrack.bitrate)&&t.heuristicData.tracksData.findFirst(function(n){return n.trackInfo===t.requestedStream.streamingInfo.lastDownloadedTrack&&n.selectable})&&(o=t.requestedStream.streamingInfo.lastDownloadedTrack);o&&(t.selectedTrack=o);s()})},t}();t.Engine=i})(n.Heuristics||(n.Heuristics={}));var t=n.Heuristics}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";var i=function(){function t(){this._moduleId="stepRule";this._disposed=!1;this._currentTrackSegmentCount=0;this._previousTrackSelected=null;this._currentSelectedVideoStream=null}return t.prototype.dispose=function(){this._disposed=!0;this._previousTrackSelected=null;this._currentSelectedVideoStream=null},t.prototype.init=function(n){var t=n.workflows[1];t.addHandler(t.stepEvents.requestBegin,this.onRunStepRule,this)},t.prototype.onRunStepRule=function(t){var r=this,i;return n.Log.verbose(8,"onRunStepRule"),t.currentModuleId=this._moduleId,i=this,new Promise(function(u,f){var e;if(i._disposed){n.Failure.attachFailureToRequest(t,t.currentModuleId,0);f("object is already disposed.");return}if(t.selectedTrack||t.requestedStream.streamingInfo.lastDownloadedTrack===null||t.requestedStream.type!==0){u();return}t.requestedStream!==r._currentSelectedVideoStream&&(i._currentSelectedVideoStream=t.requestedStream,i._previousTrackSelected=null);t.requestedStream.streamingInfo.lastDownloadedTrack===i._previousTrackSelected?i._currentTrackSegmentCount++:(i._previousTrackSelected=t.requestedStream.streamingInfo.lastDownloadedTrack,i._currentTrackSegmentCount=1);var c=i._currentTrackSegmentCount>=t.sessionContext.heuristicSettings.stepRule.minSegmentsBeforeDowngrade,l=i._currentTrackSegmentCount>=t.sessionContext.heuristicSettings.stepRule.minSegmentsBeforeUpgrade,o=t.requestedStream.tracks.indexOf(i._previousTrackSelected),s=o,h=o;for(c&&t.sessionContext.heuristicSettings.stepRule.maxStepDownInQuality>0&&(s=Math.max(0,o-t.sessionContext.heuristicSettings.stepRule.maxStepDownInQuality)),l&&t.sessionContext.heuristicSettings.stepRule.maxStepUpInQuality>0&&(h=Math.min(t.heuristicData.tracksData.length-1,o+t.sessionContext.heuristicSettings.stepRule.maxStepUpInQuality)),e=0;e<t.heuristicData.tracksData.length;e++)(e>h||e<s)&&(t.heuristicData.tracksData[e].selectable=!1);u()})},t}();t.StepRule=i})(n.Heuristics||(n.Heuristics={}));var t=n.Heuristics}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";var i=function(){function t(){this._moduleId="windowSizeRule";this._disposed=!1;this._windowHeight=0;this._windowWidth=0;this._highestTrackIndexAllowed=0;this._currentSelectedVideoStream=null}return t.prototype.dispose=function(){this._disposed=!0;this._currentSelectedVideoStream=null},t.prototype.init=function(n){var t=n.workflows[1];t.addHandler(t.stepEvents.requestBegin,this.onRunWindowSizeRule,this)},t.prototype.onRunWindowSizeRule=function(t){n.Log.verbose(8,"onRunWindowSizeRule");t.currentModuleId=this._moduleId;var r=!1,i=this;return new Promise(function(u,f){var s,h,e,c,o;if(i._disposed){n.Failure.attachFailureToRequest(t,t.currentModuleId,0);f("object is already disposed.");return}if(t.selectedTrack||!t.sessionContext.heuristicSettings.windowSizeHeuristicsEnabled||t.requestedStream.type!==0){u();return}if(t.requestedStream!==i._currentSelectedVideoStream&&(i._currentSelectedVideoStream=t.requestedStream,i._highestTrackIndexAllowed=0),s=Math.max(t.sessionContext.videoTag.scrollWidth,t.sessionContext.videoTag.width),h=Math.max(t.sessionContext.videoTag.scrollHeight,t.sessionContext.videoTag.height),h===0||s===0){n.Log.warning(8,"Ignoring window size heuristic rule, as one of the window dimensions is 0.");u();return}for((i._windowWidth!==s||i._windowHeight!==h)&&((i._windowWidth<s||i._windowHeight<h)&&(r=!0),i._windowWidth=s,i._windowHeight=h,i._highestTrackIndexAllowed=0),e=t.heuristicData.tracksData,c=!1,o=i._highestTrackIndexAllowed;o<e.length;o++)e[o].selectable&&e[o].trackInfo.width>s&&e[o].trackInfo.height>h&&(c?e[o].selectable=!1:(c=!0,i._highestTrackIndexAllowed=o));c||(i._highestTrackIndexAllowed=e.length-1);r&&t.requestedStream.streamingInfo.lastDownloadedTrack&&e[i._highestTrackIndexAllowed].trackInfo.bitrate>t.requestedStream.streamingInfo.lastDownloadedTrack.bitrate&&t.sessionContext.eventMgr.dispatchEvent(n.InternalEventName.flushvideo);u()})},t}();t.WindowSizeRule=i})(n.Heuristics||(n.Heuristics={}));var t=n.Heuristics}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";var i,r,u;(function(n){n[n.success=200]="success";n[n.notFound=404]="notFound";n[n.badGateway=502]="badGateway"})(i||(i={}));r=function(){function t(t){this._moduleId="httpDataRetriever";this._requestList=[];this._disposed=!1;this._bandwidthData=new n.Heuristics.BandwidthTracker(t.heuristicSettings.bandwidth);t.videoBufferData.updateBandwidthTracker(this._bandwidthData)}return t.prototype.dispose=function(){while(this._requestList.length>0){var n=this._requestList.pop();n.request=null;n=null}this._disposed=!0},t.prototype.init=function(n){var t=n.workflows[0],i=n.workflows[1];t.addHandler(t.stepEvents.requestBegin,this.onGetData,this);t.addHandler(t.stepEvents.requestEnd,this.onGetData,this);i.addHandler(i.stepEvents.requestBegin,this.onReportHeuristicData,this);i.addHandler(i.stepEvents.requestSend,this.onGetData,this)},t.prototype.onReportHeuristicData=function(t){n.Log.verbose(5,"onReportHeuristicData");t.currentModuleId=this._moduleId;var i=this;return new Promise(function(r,u){if(i._disposed){n.Failure.attachFailureToRequest(t,t.currentModuleId,0);u("object is already disposed.");return}if(t.requestedStream.type!==0){r();return}i._bandwidthData.reportHeuristicsData(t.heuristicData,n.StreamUtil.getSegmentDuration(t));r()})},t.prototype.onGetData=function(t){n.Log.verbose(5,"onGetData");t.currentModuleId=this._moduleId;var i=this;return new Promise(function(r,f){function o(){var f,s;n.assert(null!=t.urlsToRetrieve[e],"Failed to start the download as urlToRetrieve at index "+e+" is null");n.assert(null!=t.urlsToRetrieve[e].url&&t.urlsToRetrieve[e].url.length>0,"Failed to start the download as urlToRetrieve at index "+e+" is empty");t.urlsToRetrieve[e].responseType===0&&t.urlsToRetrieve[e].mediaData!=null||t.urlsToRetrieve[e].responseType===4&&t.urlsToRetrieve[e].presentationData!=null?(e++,e>=t.urlsToRetrieve.length?r():o()):(t.workflowType===1&&n.StreamUtil.getBufferData(t).dispatchDownloadRequested(h(e)),f=new XMLHttpRequest,f.open("GET",t.urlsToRetrieve[e].url),f.onprogress=c,f.onload=l,f.onerror=a,f.ontimeout=v,t.urlsToRetrieve[e].responseType===0&&(f.responseType=n.Context.ResponseType[0]),f.msCaching&&(f.msCaching="disabled"),f.timeout=t.sessionContext.httpDataRetrieverSettings.timeoutInMSec,s=new u(t.urlsToRetrieve[e],f),t.requestedStream&&t.requestedStream.type==0&&t.selectedTrack?n.Log.verbose(5,"HeuristicInfo: SuggestedBr: "+t.selectedTrack.bitrate+" CurrentBw: "+i._bandwidthData.latestInKbps+" AverageBw: "+i._bandwidthData.averageBandwidthInKbps+" BufferSize: "+t.requestedStream.streamingInfo.sourceBuffer.getBufferedAheadOfCurrentTimeInSec()+" StreamType: "+n.Presentation.StreamType[t.requestedStream.type]+" StreamName: "+t.requestedStream.language+" Index: "+t.requestedStream.streamingInfo.currentSegment.segmentInfo.index+" TimeInMS: "+t.requestedStream.streamingInfo.currentSegment.segmentInfo.presTimeInSec+" MediaTimeStamp: "+t.requestedStream.streamingInfo.currentSegment.segmentInfo.mediaTimestamp+" Index: "+t.requestedStream.streamingInfo.currentSegment.segmentInfo.index+" Duration: "+(t.requestedStream.streamingInfo.currentSegment.segmentInfo.durationInSec||0)+" Url: "+t.urlsToRetrieve[e].url):0===t.workflowType&&n.Log.verbose(5,"Getting "+t.urlsToRetrieve[e].url),i._requestList.push(s),f.send())}function c(t){var f=this,u,r;i._disposed||(u=(new Date).getTime(),r=i._requestList.findFirst(function(n){return n.request===f}),n.assert(null!=r,"cannot find the request in the request queue"),r.bandwidthInfo.responseStartTimeInMS||(!t.lengthComputable||t.lengthComputable&&t.total!=t.loaded)&&(r.bandwidthInfo.responseStartTimeInMS=u))}function l(){var c=this,u,f;if(!i._disposed)if(u=i._requestList.findFirst(function(n){return n.request===c}),n.assert(null!=u,"cannot find the request in the request queue"),u.bandwidthInfo.responseEndTimeInMS=(new Date).getTime(),f=t.urlsToRetrieve.indexOf(u.urlRequest),t.urlsToRetrieve[f].httpResposeContentType=this.getResponseHeader("Content-Type"),t.urlsToRetrieve[f].httpResponseCode=this.status,200===this.status){i._requestList.removeFirst(function(n){return n.request===c});switch(u.urlRequest.responseType){case 0:t.urlsToRetrieve[f].mediaData=this.response;u.bandwidthInfo.responseLengthInBytes=t.urlsToRetrieve[f].mediaData.byteLength;t.workflowType===1&&n.StreamUtil.getBufferData(t).dispatchDownloadCompleted(h(f),u.bandwidthInfo);break;case 4:t.urlsToRetrieve[f].presentationData=this.response;u.bandwidthInfo.responseLengthInBytes=t.urlsToRetrieve[f].presentationData.length;break;default:n.assert(!1,"Unexpected response Type in the request Context")}if(n.Log.verbose(5,"Download Finished for :"+u.urlRequest.url),t.requestedStream&&(i._bandwidthData&&t.requestedStream.type===0&&i._bandwidthData.updateBandwidthInfo(u.bandwidthInfo),t.requestedStream.streamingInfo.lastDownloadedTrack=t.selectedTrack),e++,e>=t.urlsToRetrieve.length){r();return}o()}else n.Log.error(5,u.urlRequest.url+" failed, httpStatus: "+this.status),s.call(this,n.Failure.translateHttpStatusToCode(this.status))}function a(n){i._disposed||s.call(this,2097152,"http: "+n.type)}function v(){i._disposed||s.call(this,2097752,"http timed out")}function s(u,e){var p=this,o=i._requestList.removeFirst(function(n){return n.request===p}),a,s,v,y,c,l;n.assert(null!=o,"cannot find the request in the request queue");a=o.urlRequest.url;e&&(a+=", "+e);s=new n.Failure.Record(t.currentModuleId,u,a);n.Log.error(5,s.toString());t.requestedStream?(t.urlsToRetrieve.findIndexOf(function(n){return n.requestType===1})!==-1&&(t.requestedStream.streamingInfo.fetchInitSegment=!0),v=t.urlsToRetrieve.indexOf(o.urlRequest),t.workflowType===1&&n.StreamUtil.getBufferData(t).dispatchDownloadFailed(h(v),u,e),2097556===u&&t.sessionContext.commonPresentation.isLive&&t.requestedStream.streamingInfo&&t.requestedStream.streamingInfo.currentSegment&&!t.requestedStream.streamingInfo.currentSegment.next?(c=t.requestedStream.streamingInfo.currentSegment.segmentInfo,l=c?c.presTimeInSec:null,t.requestedStream.streamingInfo.currentSegment=t.requestedStream.streamingInfo.currentSegment.prev,t.failTracker.reset(),n.Log.verbose(5,"hit past live edge with 404: "+(e?e+", ":"")+"presTimeInSec: "+l+" "+o.urlRequest.url),t.externalFailure=s,f()):2097564===u&&t.sessionContext.commonPresentation.isLive&&t.requestedStream.streamingInfo&&t.requestedStream.streamingInfo.currentSegment&&!t.requestedStream.streamingInfo.currentSegment.next?(t.state=2,t.retryWaitTimeMSec=t.sessionContext.httpRetryPolicySettings.retryMediaInMSec,t.failTracker.log(s,t.selectedTrack),y=t.sessionContext.httpDataRetrieverSettings.liveEdgeAdjustmentInSec,t.sessionContext.commonPresentation.adjustPlayableWindow(y),c=t.requestedStream.streamingInfo.currentSegment.segmentInfo,l=c?c.presTimeInSec:null,n.Log.verbose(5,"hit past live edge with 412: "+(e?e+", ":"")+"presTimeInSec: "+l+" "+o.urlRequest.url),r()):(t.workflowType!==0&&o&&o.urlRequest&&o.urlRequest.requestType!==2&&(t.state=2,t.failTracker.log(s,t.selectedTrack),t.retryWaitTimeMSec=t.failTracker.isLastServerError()?t.sessionContext.httpRetryPolicySettings.retryMediaServerErrorInMSec:0),n.Log.warning(5,"failed to download: "+(e?e+", ":"")+o.urlRequest.url),r())):0===t.workflowType&&(2097556===u||2097752===u)?(t.state=2,t.retryWaitTimeMSec=2097556===u?t.sessionContext.httpRetryPolicySettings.retryPresentationInMSec:0,t.failTracker.log(s),n.Log.warning(5,"failed to download: "+(e?e+", ":"")+o.urlRequest.url),r()):(t.externalFailure=s,n.Log.warning(5,"failed to download: "+(e?e+", ":"")+o.urlRequest.url),f())}function h(i){var r=t.urlsToRetrieve[i].requestType===1?null:t.requestedStream.streamingInfo.currentSegment.segmentInfo.presTimeInSec;return new n.Context.MediaDownload(t.urlsToRetrieve[i].url,t.selectedTrack.bitrate,r)}if(i._disposed){n.Failure.attachFailureToRequest(t,t.currentModuleId,0);f("object is already disposed.");return}n.assert(t.urlsToRetrieve.length!==0,"Failed to start the download as urlsToRetrieve is empty.");var e=0;o()})},t}();t.HttpDataRetriever=r;u=function(){function t(t,i){this.urlRequest=t;this.request=i;this.bandwidthInfo=new n.Heuristics.BandwidthInfo}return t}()})(n.DataRetriever||(n.DataRetriever={}));var t=n.DataRetriever}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";var i,r;(function(n){n[n.noRetry=0]="noRetry";n[n.nextTrack=1]="nextTrack";n[n.nextSegment=2]="nextSegment";n[n.same=3]="same"})(i||(i={}));r=function(){function t(){this._moduleId="httpRetryPolicy";this._disposed=!1}return t.prototype.dispose=function(){this._disposed||(this._disposed=!0)},t.prototype.init=function(n){var i=n.workflows[0],t=n.workflows[1];i.addHandler(t.stepEvents.requestBegin,this.onPresentationRetry,this);t.addHandler(t.stepEvents.requestBegin,this.onMediaRetry,this)},t.prototype.onPresentationRetry=function(t){var r=this;return n.Log.verbose(5,"onPresentationRetry"),t.currentModuleId=this._moduleId,new Promise(function(u,f){var e,s,o;if(r._disposed){n.Failure.attachFailureToRequest(t,t.currentModuleId,0);f("object is already disposed.");return}if(e=t.failTracker,s=t.sessionContext.httpRetryPolicySettings,e.isNone()){u();return}o=r._getAction(0,s,t);switch(o){case 0:t.externalFailure=e.lastFailure;n.Log.verbose(5,"onPresentationRetry: noRetry, "+t.urlsToRetrieve[0].url);f();return;case 3:e.sameRequestRetried++;break;default:throw new Error("unexpected retry action: "+o);}e.totalRetried++;n.Log.verbose(5,"onPresentationRetry: "+i[o]+" URL: "+t.urlsToRetrieve[0].url);u()})},t.prototype.onMediaRetry=function(t){var r=this;return n.Log.verbose(5,"onMediaRetry"),t.currentModuleId=this._moduleId,new Promise(function(u,f){var s;if(r._disposed){n.Failure.attachFailureToRequest(t,t.currentModuleId,0);f("object is already disposed.");return}if(!t.requestedStream){u();return}var e=t.failTracker,o=t.requestedStream.streamingInfo,h=t.sessionContext.httpRetryPolicySettings;if(e.isNone()||null!==o.pendingSeekPositionInSec){u();return}0===e.totalRetried&&(e.tracksToTry=r._createTrackToTry(h,t.requestedStream,e.lastTrack));s=r._getAction(1,h,t);switch(s){case 0:t.externalFailure=e.lastFailure;n.Log.verbose(5,"onMediaRetry: noRetry,mediaTimestamp: "+o.currentSegment.segmentInfo.mediaTimestamp);f();return;case 1:e.sameRequestRetried++;t.selectedSegment=o.currentSegment;e.trackToTryIdx<e.tracksToTry.length-1?e.trackToTryIdx++:e.trackToTryIdx=0;t.selectedTrack=e.tracksToTry[e.trackToTryIdx];break;case 2:if(o.currentSegment.next)o.currentSegment=o.currentSegment.next,e.segmentsSkipped++,e.resetForSegment(),t.selectedSegment=o.currentSegment,t.selectedTrack=e.tracksToTry[0];else{t.externalFailure=e.lastFailure;n.Log.verbose(5,"onRetry: noRetry, EOS mediaTimestamp: "+o.currentSegment.segmentInfo.mediaTimestamp);f();return}break;case 3:e.sameRequestRetried++;t.selectedSegment=o.currentSegment;t.selectedTrack=e.tracksToTry[0];break;default:throw new Error("unexpected retry action: "+s);}e.totalRetried++;n.Log.verbose(5,"onRetry: "+i[s]+" bitrate: "+t.selectedTrack.bitrate+" mediaTimestamp: "+t.selectedSegment.segmentInfo.mediaTimestamp);u()})},t.prototype._getAction=function(n,t,i){var u=0,f=!1,r=i.failTracker;return i.sessionContext&&i.sessionContext.commonPresentation&&(f=i.sessionContext.commonPresentation.isLive),0===n?u=r.sameRequestRetried>=t.maxRetryPresentation?0:3:r.totalRetried>=t.maxTotalRetries||r.segmentsSkipped>=t.maxSkipSegments&&(r.trackToTryIdx>=r.tracksToTry.length-1||r.sameRequestRetried>=t.maxRetryPerSegment)?u=0:r.isLastNotFound()||r.isLastNotReady()&&f&&!this._isLiveEdge(i)?u=r.trackToTryIdx<r.tracksToTry.length-1&&r.sameRequestRetried<t.maxRetryPerSegment?1:2:f&&this._isLiveEdge(i)&&r.isLastNotReady()?(u=3,r.sameRequestRetried>=t.maxRetryPerSegment&&(u=0)):u=r.isLastServerError()?1:r.isLastNetworkFail()?r.sameRequestRetried<t.maxRetryPerSegment?3:2:0,u},t.prototype._isLiveEdge=function(n){var t;return!n.requestedStream||!n.requestedStream.streamingInfo?!1:(t=n.requestedStream.streamingInfo.currentSegment,t&&!t.next?!0:!1)},t.prototype._createTrackToTry=function(n,t,i){var u=[],f=t.tracks.indexOf(i),e=t.tracks.length,r;for(u.push(t.tracks[f]),r=f-1;r>=0;r--)t.tracks[r].streamingInfo.selectable&&u.push(t.tracks[r]);if(!n.retryLowerBitrateOnly)for(r=f+1;r<e;r++)t.tracks[r].streamingInfo.selectable&&u.push(t.tracks[r]);return u},t}();t.HttpRetryPolicy=r})(n.DataRetriever||(n.DataRetriever={}));var t=n.DataRetriever}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";var i,r;(function(n){n[n.success=200]="success";n[n.notFound=404]="notFound";n[n.badGateway=502]="badGateway"})(i||(i={}));r=function(){function t(){this._moduleId="InitialBandwidthDataUrlFormatter";this._disposed=!1}return t.prototype.dispose=function(){this._disposed=!0},t.prototype.init=function(n){var t=n.workflows[0];t.addHandler(t.stepEvents.requestEnd,this.onPreFetchUrlFormat,this)},t.prototype.onPreFetchUrlFormat=function(t){n.Log.verbose(6,"OnPreFetchUrlFormat");t.currentModuleId=this._moduleId;var i=this;return new Promise(function(r,u){var c,f,e,o,s,l,a,h;if(i._disposed){n.Failure.attachFailureToRequest(t,t.currentModuleId,0);u("object is already disposed.");return}if(!t.sessionContext.heuristicSettings.preFetchDataEnabled){r();return}if(c=t.sessionContext.commonPresentation.periods[0].streams,f=c.findFirst(function(n){return n.type===0}),t.requestedStream=f,e=f.tracks[0].bitrate,e===null||e===undefined)throw new Error("bitrate of first video track not set in presentation");if(o=t.requestedStream.mediaUrlTemplate,!o)throw new Error("media url template is not set for the video stream");s=f.segments;l=t.sessionContext.commonPresentation.isLive?s.last.segmentInfo:s.first.segmentInfo;a=n.Util.UrlFormatter.FormatDashMediaUrl(o,e.toString(),l.mediaTimestampStr);h=new n.Context.UrlRequest(a);h.requestType=2;t.urlsToRetrieve.push(h);t.sessionContext.heuristicSettings.preFetchDataEnabled=!1;r()})},t}();t.InitialBandwidthDataUrlFormatter=r})(n.Heuristics||(n.Heuristics={}));var t=n.Heuristics}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";var i=function(){function t(){this._moduleId="streamSelector";this._disposed=!1;this._initial=!0}return t.prototype.dispose=function(){this._disposed=!0},t.prototype.init=function(n){var t=n.workflows[0];t.addHandler(t.stepEvents.requestEnd,this.onSelectStreams,this)},t.prototype.onSelectStreams=function(t){var i=this;return t.currentModuleId=this._moduleId,new Promise(function(r,u){var o=!1,s=!1,f=t.sessionContext.commonPresentation,e;if(i._disposed){n.Failure.attachFailureToRequest(t,t.currentModuleId,0);u("Disposed");return}if(!i._initial){r();return}if(!f)throw new Error("CommonPresentation is empty");for(f.periods[0].streams.forEach(function(n){n.streamingInfo.selected=!1}),e=f.periods[0].streams.length-1;e>=0;e--)0!==f.periods[0].streams[e].type||o?1!==f.periods[0].streams[e].type||s||(s=!0,f.periods[0].streams[e].streamingInfo.selected=!0):(o=!0,f.periods[0].streams[e].streamingInfo.selected=!0);if(!o||!s){n.Failure.attachFailureToRequest(t,t.currentModuleId,4194307);u("Video or audio streams not found");return}i._initial=!1;r()})},t}();t.InitialStreamSelector=i})(n.Presentation||(n.Presentation={}));var t=n.Presentation}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";var r=function(){function n(n,t,i,r,u){this.index=n;this._timescale=u;this._presentationOffset=r;this._mediaTimestampStr=t;this._mediaTimestamp=parseInt(t);this._presTimeInSec=(this._mediaTimestamp+r)/u;i&&(this._mediaDuration=i,this._durationInSec=i/u)}return Object.defineProperty(n.prototype,"timescale",{get:function(){return this._timescale},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"presentationOffset",{get:function(){return this._presentationOffset},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"mediaTimestampStr",{get:function(){return this._mediaTimestampStr},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"mediaTimestamp",{get:function(){return this._mediaTimestamp},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"mediaDuration",{get:function(){return this._mediaDuration},set:function(n){this._mediaDuration=n;this._durationInSec=n/this._timescale},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"presTimeInSec",{get:function(){return this._presTimeInSec},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"durationInSec",{get:function(){return this._durationInSec},enumerable:!0,configurable:!0}),n.prototype.update=function(n,t){n&&(this.index+=n);this._presentationOffset!==t&&(this._presentationOffset=t,this._presTimeInSec=(this._mediaTimestamp+t)/this._timescale)},n}(),f,i,e,v,u,o,s,h,c,l,a;t.MediaSegmentInfo=r;f=function(){function n(n,t,i,u,f,e){this.firstSegment=new r(n,t,i,u,f);this.repeat=e;this.containerIndex=NaN}return n}();t.SegmentRunEntry=f;i=function(){function t(t,i,u){this._container=t;this._pubTime=t.pubTime;this._runEntry=i;this._runEntryRepeatPosition=u;var f=i.firstSegment.mediaTimestampStr;u&&(f=n.Timestamp.add(f,u*i.firstSegment.mediaDuration));this.segmentInfo=new r(i.firstSegment.index+u,f,i.firstSegment.mediaDuration,t.presentationTimeOffset,t.timescale)}return t.prototype.dispose=function(){this.segmentInfo=null;this._container=null;this._pubTime=null;this._runEntry=null;this._runEntryRepeatPosition=NaN},Object.defineProperty(t.prototype,"next",{get:function(){var i,r,u;if(this._updateIterator(),isNaN(this._runEntryRepeatPosition))return null;if(i=this._runEntry,r=0,this._runEntryRepeatPosition+1>this._runEntry.repeat)if(u=this._runEntry.containerIndex+1,u<this._container.segmentTable.length)i=this._container.segmentTable[u];else return n.Log.verbose(4,"Cannot get next iterator"),null;else r=this._runEntryRepeatPosition+1;return new t(this._container,i,r)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"prev",{get:function(){var i,u,r;if(this._updateIterator(),isNaN(this._runEntryRepeatPosition))return null;if(i=this._runEntry,this._runEntryRepeatPosition===0)if(r=this._runEntry.containerIndex-1,r>=0&&r<this._container.segmentTable.length)i=this._container.segmentTable[r],u=i.repeat;else return n.Log.warning(4,"Cannot get previous iterator"),null;else u=this._runEntryRepeatPosition-1;return new t(this._container,i,u)},enumerable:!0,configurable:!0}),t.prototype._updateIterator=function(){var i,t,r,u;if(this._container.pubTime.getTime()>this._pubTime.getTime()){for(this._pubTime=this._container.pubTime,i=this._runEntry.containerIndex,t=this._container.segmentTable[i];!t&&i>0;)i--,t=this._container.segmentTable[i];if(t){if(t.firstSegment.index<=this.segmentInfo.index&&this.segmentInfo.index<=t.firstSegment.index+t.repeat){this._runEntry=t;this._runEntryRepeatPosition=this.segmentInfo.index-t.firstSegment.index;this._updateInfo();return}if(this.segmentInfo.index>t.firstSegment.index+t.repeat&&this._container.segmentTable.length>i+1&&(r=this._container.segmentTable[i+1],this.segmentInfo.index<=r.firstSegment.index+r.repeat)){this._runEntry=r;this._runEntryRepeatPosition=this.segmentInfo.index-r.firstSegment.index;this._updateInfo();return}}if(u=this._container.getByIndex(this.segmentInfo.index),!u){n.Log.warning(4,"Referenced segment not found in presentation, disposing iterator");this.dispose();return}this._runEntry=u._runEntry;this._runEntryRepeatPosition=u._runEntryRepeatPosition;this._updateInfo()}},t.prototype._updateInfo=function(){var t=this._container.getByIndex(this.segmentInfo.index),n;t&&(n=t.segmentInfo,(this.segmentInfo.mediaTimestampStr!==n.mediaTimestampStr||this.segmentInfo.mediaDuration!==n.mediaDuration)&&(this.segmentInfo=new r(n.index,n.mediaTimestampStr,n.mediaDuration,n.presentationOffset,n.timescale)))},t}();t.MediaSegmentInfoIterator=i;e=function(){function r(n,t,i,r){this.timescale=n;this.presentationTimeOffset=t;this.pubTime=i;this.segmentTable=[];this._isLive=r}return r.prototype.dispose=function(){this.segmentTable.length=0},Object.defineProperty(r.prototype,"first",{get:function(){var n=null;return this.segmentTable.length>0&&(n=new i(this,this.segmentTable[0],0)),n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"last",{get:function(){var n,t=null;return this.segmentTable.length>0&&(n=this.segmentTable[this.segmentTable.length-1],t=new i(this,n,n.repeat)),t},enumerable:!0,configurable:!0}),r.prototype.addMediaSegmentRun=function(t){var i=null,r=0,u;this.segmentTable.length>0&&(i=this.segmentTable[this.segmentTable.length-1],r=i.firstSegment.mediaTimestamp+i.firstSegment.mediaDuration*(i.repeat+1),u=n.Common.timestampDeltaThreshold*this.timescale,r-t.firstSegment.mediaTimestamp>u&&(n.Log.error(4,"Cannot add segment with timestamp "+t.firstSegment.mediaTimestamp+" to middle of table ["+this.segmentTable[0].firstSegment.mediaTimestamp+","+r+"]"),t=null));t&&(t.containerIndex=this.segmentTable.length,this.segmentTable.push(t),n.Log.verbose(4,"Added segment with idx="+t.firstSegment.index+" mt="+t.firstSegment.mediaTimestamp+" pt="+t.firstSegment.presTimeInSec.toFixed(3)+" r="+t.repeat+(t.firstSegment.durationInSec?" d="+t.firstSegment.durationInSec.toFixed(3):"")))},r.prototype.addMediaSegmentInfo=function(n,i,r,u,f){var e;if(this.segmentTable.length>0&&NaN===this.segmentTable[this.segmentTable.length-1].firstSegment.mediaDuration)throw new Error("Failed to add segment: previous entry doesn't have duration");e=new t.SegmentRunEntry(n,i,r,u,f,0);this.addMediaSegmentRun(e)},r.prototype.updateSegmentDuration=function(t,i){var r,u;if(0===this.segmentTable.length)return!1;if(r=this.segmentTable[this.segmentTable.length-1],r.firstSegment.presTimeInSec!==t){if(u=n.Common.binarySearch(t,this.segmentTable,this._compareTimestampInSec),u===-1)return n.Log.verbose(4,"Failed to update segment duration, run entry with presentation time "+t+" not found"),!1;r=this.segmentTable[u]}return r.firstSegment.mediaDuration!==i&&(n.assert(!r.firstSegment.mediaDuration&&0===r.repeat,"Failed to update segment duration, run entry (s:"+r.firstSegment.presTimeInSec+" d:"+r.firstSegment.durationInSec+" r:"+r.repeat+") cannot be overwritten by segment (s:"+t+" d:"+i/this.timescale+")"),r.firstSegment.mediaDuration=i),!0},r.prototype.getByIndex=function(t){var r=null,u,f,e;return 0===this.segmentTable.length?null:(u=n.Common.binarySearch(t,this.segmentTable,this._compareIndex),u!==-1&&(f=this.segmentTable[u],e=t-f.firstSegment.index,r=new i(this,f,e)),r||n.Log.verbose(4,"Entry with index "+t+" not found"),r)},r.prototype.getBySegmentStartTime=function(t,r){var o=null,e,u,f,s;if(0===this.segmentTable.length)return null;if(r||(r=n.Common.timestampDeltaThreshold),Math.abs(t-this.segmentTable[0].firstSegment.presTimeInSec)<r)return this.first;if(e=n.Common.binarySearch(t,this.segmentTable,this._compareTimestampInSec),e!==-1){if(u=this.segmentTable[e],f=0,n.Common.diffTimes(t,u.firstSegment.presTimeInSec)&&(f=Math.round((t-u.firstSegment.presTimeInSec)/u.firstSegment.durationInSec)||0),f>u.repeat)if(e+1<this.segmentTable.length)u=this.segmentTable[e+1],f=0;else return n.Log.verbose(4,"Cannot find match for "+t),null;if(s=u.firstSegment.presTimeInSec+f*u.firstSegment.durationInSec,Math.abs(t-s)>r)return n.Log.verbose(4,"Cannot find match within error range for "+t),null;o=new i(this,u,f)}return o},r.prototype.getByInSegmentTimestamp=function(t){var u=null,f,r,e;return 0===this.segmentTable.length?null:(f=n.Common.binarySearch(t,this.segmentTable,this._compareTimestampInSec),f!==-1&&(r=this.segmentTable[f],e=Math.floor(Math.abs(t-r.firstSegment.presTimeInSec)/r.firstSegment.durationInSec),u=new i(this,r,e)),u||n.Log.verbose(4,"Entry including timestamp "+t+" not found"),u)},r.prototype.getByInDiscontinuityTimestamp=function(t){var r=null,u;return 0===this.segmentTable.length?null:(u=n.Common.binarySearchInGaps(t,this.segmentTable,this._compareTimestampInSecInGaps),u!==-1&&(r=new i(this,this.segmentTable[u],0)),r||n.Log.verbose(4,"Discontinuity including timestamp "+t+" not found"),r)},r.prototype.update=function(t){var o=this,u=t,i=null,f=0;if(!(u.pubTime.getTime()<=this.pubTime.getTime())){if(this.pubTime=u.pubTime,i=this.getBySegmentStartTime(u.first.segmentInfo.presTimeInSec),i&&i.segmentInfo.index!==u.first.segmentInfo.index){if(f=i.segmentInfo.index,n.Common.diffTimes(u.first.segmentInfo.presTimeInSec,i.segmentInfo.presTimeInSec))throw new Error("Segment mismatch during container update");n.Log.verbose(4,"Segment index offset="+f)}if(u._isLive){var r=u.last.segmentInfo,s=r.index,e=r.mediaTimestamp+r.mediaDuration;for(i=this.getBySegmentStartTime(r.presTimeInSec);e&&i&&i.next;){if(i=i.next,i.segmentInfo.mediaTimestamp<e)break;r=i.segmentInfo;e=r.mediaTimestamp+r.mediaDuration;u.addMediaSegmentInfo(++s,r.mediaTimestampStr,r.mediaDuration,r.presentationOffset,r.timescale)}}this._isLive=u._isLive;this.segmentTable.length=0;u.segmentTable.forEach(function(n){n.firstSegment.update(f,o.presentationTimeOffset);o.segmentTable.push(n)})}},r.prototype._compareTimestampInSec=function(t,i){var r=0;return n.Common.diffTimes(t,i.firstSegment.presTimeInSec)>0?r=-1:n.Common.diffTimes(t,i.firstSegment.presTimeInSec)&&n.Common.diffTimes(t,i.firstSegment.presTimeInSec+(i.repeat+1)*(i.firstSegment.durationInSec||0))<=0&&(r=1),r},r.prototype._compareIndex=function(n,t){var i=0;return n<t.firstSegment.index?i=-1:n>=t.firstSegment.index+(t.repeat+1)&&(i=1),i},r.prototype._compareTimestampInSecInGaps=function(n,t,i){var r=0,u=t.firstSegment.presTimeInSec+(t.repeat+1)*(t.firstSegment.durationInSec||0),f=i.firstSegment.presTimeInSec;return n<u?r=-1:n>=f&&(r=1),r},r}();t.MediaSegmentInfoContainer=e,function(n){n[n.needsToBeScheduled=0]="needsToBeScheduled";n[n.inProgress=1]="inProgress";n[n.endOfStream=2]="endOfStream"}(t.WorkflowState||(t.WorkflowState={}));v=t.WorkflowState;u=function(){function n(){this.forge=null;this.webCrypto=null}return n.prototype.dispose=function(){this.forge=null;this.webCrypto=null},n}();t.AesInfo=u;o=function(){function n(){this.selected=!1;this.fetchInitSegment=!0;this.currentSegment=null;this.pendingSeekPositionInSec=null;this.workflowState=0;this.sourceBuffer=null;this.lastDownloadedTrack=null;this.aes=new u;this.flushStream=!1}return n.prototype.dispose=function(){this.currentSegment=null;this.sourceBuffer&&(this.sourceBuffer.dispose(),this.sourceBuffer=null);this.lastDownloadedTrack=null;this.aes&&(this.aes.dispose(),this.aes=null)},n}();t.MediaStreamStreamingInfo=o;s=function(){function n(){this.selectable=!0}return n}();t.MediaTrackStreamingInfo=s;h=function(){function n(n,t){var i,r;for(this._streams=[],i=0;i<t.length;i++)t[i].type==0&&(r=new c(n,t[i]),this._streams.push(r))}return n.prototype.dispose=function(){for(var n=0;n<this._streams.length;n++)this._streams[n].dispose();this._streams=[]},Object.defineProperty(n.prototype,"streams",{get:function(){return this._streams},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectedIndex",{get:function(){for(var t=-1,n=0;n<this._streams.length;n++)if(this._streams[n].commonStream.streamingInfo.selected){t=n;break}return t},enumerable:!0,configurable:!0}),n}();t.VideoStreamList=h;c=function(){function t(t,i){this._commonStream=i;this._eventMgr=new n.Events.Manager(t.azureHtml5,!1);this._sessionContext=t}return t.prototype.dispose=function(){this._commonStream=null;this._sessionContext=null;this._eventMgr&&(this._eventMgr.dispose(),this._eventMgr=null)},Object.defineProperty(t.prototype,"name",{get:function(){return this._commonStream.id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tracks",{get:function(){return this._commonStream.tracks},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"commonStream",{get:function(){return this._commonStream},enumerable:!0,configurable:!0}),t.prototype.selectTrackByIndex=function(t){var r=!1,i,u;for((t<-1||t>=this._commonStream.tracks.length)&&(n.Log.warning(7,"selectTrackByIndex: "+t+" switching back to auto track selection"),t=-1),n.Log.verbose(7,"selectTrackByIndex: "+t),i=0;i<this._commonStream.tracks.length;i++)u=this._commonStream.tracks[i].streamingInfo.selectable,this._commonStream.tracks[i].streamingInfo.selectable=-1===t||i===t?!0:!1,u!=this._commonStream.tracks[i].streamingInfo.selectable&&(r=!0);r&&(this.commonStream.streamingInfo.flushStream=!0,this._eventMgr.dispatchEvent(n.StreamEventName.trackselected),this._sessionContext.eventMgr.dispatchEvent(n.InternalEventName.flushvideo))},t.prototype.addEventListener=function(n,t,i){this._eventMgr.addHandler(n,t,i)},t.prototype.removeEventListener=function(n,t){this._eventMgr.removeHandler(n,t)},t}();l=function(){function t(t,i){var r,u;for(this._streams=[],r=0;r<i.length;r++)i[r].type==1&&(u=new a(t,i[r]),this._streams.push(u));this._eventMgr=new n.Events.Manager(t.azureHtml5,!1);this._sessionContext=t}return t.prototype.dispose=function(){for(var n=0;n<this._streams.length;n++)this._streams[n].dispose();this._sessionContext=null;this._eventMgr&&(this._eventMgr.dispose(),this._eventMgr=null);this._streams=[]},Object.defineProperty(t.prototype,"streams",{get:function(){return this._streams},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enabledIndices",{get:function(){for(var t=[],n=0;n<this._streams.length;n++)if(this._streams[n].enabled){t.push(n);break}return t},enumerable:!0,configurable:!0}),t.prototype.switchIndex=function(t){var i,r,u,f;if(this.enabledIndices.length!=1){n.Log.error(7,"switchIndex failed - only single stream supported: "+this.enabledIndices.length+" streams enabled");this._eventMgr.dispatchEvent(n.StreamListEventName.streamselectnotsupported);return}if(t>=this.streams.length||t<0){n.Log.error(7,"audioChange failed - tried to enable invalid index: "+t);this._eventMgr.dispatchEvent(n.StreamListEventName.streamindexinvalid);return}if(i=this._streams[this.enabledIndices[0]],r=this._streams[t],t===this.enabledIndices[0]){n.Log.verbose(7,"audioChange failed because current stream selected");this._eventMgr.dispatchEvent(n.StreamListEventName.streamselected);return}this._switchEnabledIndex(t);u=this._sessionContext.videoTag.currentTime;f=this._sessionContext.prerollBufferInSec();r.swapBuffersAndCleanUp(i,u,f);this._eventMgr.dispatchEvent(n.StreamListEventName.streamselected)},t.prototype.addEventListener=function(n,t,i){this._eventMgr.addHandler(n,t,i)},t.prototype.removeEventListener=function(n,t){this._eventMgr.removeHandler(n,t)},t.prototype._switchEnabledIndex=function(t){n.assert(this.enabledIndices.length==1,"Current implementation only allows one enabled stream at a time");var i=this.enabledIndices[0];this._streams[i].enabled=!1;this._streams[t].enabled=!0},t}();t.AudioStreamList=l;a=function(){function t(n,t){this._commonStream=t}return t.prototype.dispose=function(){this._commonStream=null},Object.defineProperty(t.prototype,"enabled",{get:function(){return this._commonStream.streamingInfo.selected},set:function(n){this._commonStream.streamingInfo.selected=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){var t=this._commonStream.mediaUrlTemplate.toLowerCase(),i="fragments(",r=t.indexOf(i),u=t.indexOf("=",r);return n.assert(u>r+i.length,"mediaUrlTemplate ("+t+") did not follow expected schema"),this._commonStream.mediaUrlTemplate.substring(r+i.length,u)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"language",{get:function(){return this._commonStream.language},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"codec",{get:function(){var t=this._commonStream.codec,i='codecs="',r=t.indexOf(i),u=t.indexOf('"',r+i.length);return n.assert(u>r+i.length,"codec ("+t+") did not follow expected schema"),t.substring(r+i.length,u)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bitrate",{get:function(){return this._commonStream.tracks[0].bitrate},enumerable:!0,configurable:!0}),t.prototype.swapBuffersAndCleanUp=function(n,t,i){if(n._commonStream.streamingInfo.sourceBuffer){this._commonStream.streamingInfo.sourceBuffer||(this._commonStream.streamingInfo.sourceBuffer=n._commonStream.streamingInfo.sourceBuffer);var r=this._commonStream.streamingInfo.sourceBuffer;this._commonStream.streamingInfo.workflowState=0;n._commonStream.streamingInfo.workflowState=2;this._commonStream.streamingInfo.pendingSeekPositionInSec=t;r.buffered.end(r.buffered.length-1)>t+i&&r.flushFrom(t+i);r.flushUntil(t)}},t}()})(n.Presentation||(n.Presentation={}));var t=n.Presentation}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";var i=function(){function t(){this._moduleId="SegmentLocator.Dash";this._disposed=!1}return t.prototype.init=function(n){var t=n.workflows[1];t.addHandler(t.stepEvents.requestBegin,this.onFindSegment,this)},t.prototype.dispose=function(){this._disposed=!0},t.prototype.onFindSegment=function(i){n.Log.verbose(9,"onFindSegment");i.currentModuleId=this._moduleId;var r=this;return new Promise(function(u,f){var h;if(r._disposed){n.Failure.attachFailureToRequest(i,i.currentModuleId,0);f("object is already disposed.");return}var e=i.requestedStream,o=e.streamingInfo.currentSegment,s=e.segments;if(i.selectedSegment){u();return}if(null!==e.streamingInfo.pendingSeekPositionInSec?(e.streamingInfo.currentSegment=s.getByInSegmentTimestamp(e.streamingInfo.pendingSeekPositionInSec),e.streamingInfo.currentSegment&&(e.streamingInfo.pendingSeekPositionInSec=null,i.requestedStream.streamingInfo.fetchInitSegment=!0)):o?e.streamingInfo.currentSegment=o.next:(h=i.sessionContext,e.streamingInfo.currentSegment=isNaN(h.startPositionInSec)?s.first:s.getByInSegmentTimestamp(h.startPositionInSec)),null===e.streamingInfo.currentSegment)if(i.sessionContext.commonPresentation.isLive&&o&&(o.segmentInfo.mediaTimestamp>=s.last.segmentInfo.mediaTimestamp||e.streamingInfo.pendingSeekPositionInSec))if(e.streamingInfo.currentSegment=o,i.sessionContext.commonPresentation.minimumUpdatePeriodInSec)i.state=2,i.retryWaitTimeMSec=t._retryWaitTimeMSec;else{n.Failure.attachFailureToRequest(i,i.currentModuleId,1);f();return}else i.state=1;u()})},t._retryWaitTimeMSec=2e3,t}();t.Dash=i})(n.SegmentLocator||(n.SegmentLocator={}));var t=n.SegmentLocator}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";var i=function(){function t(){this._moduleId="playReady";this._disposed=!1;this._initial=!0}return t.prototype.dispose=function(){this._disposed=!0},t.prototype.init=function(n){var t=n.workflows[0];t.addHandler(t.stepEvents.requestEnd,this.onContentProtected,this)},t.prototype.onContentProtected=function(t){var i=this;return t.currentModuleId=this._moduleId,new Promise(function(r,u){var f=[],e=t.sessionContext.commonPresentation;if(i._disposed){n.Failure.attachFailureToRequest(t,t.currentModuleId,0);u("Disposed");return}if(!i._initial){r();return}if(!e)throw new Error("CommonPresentation is empty");e.periods[0].streams.forEach(function(t){for(var u,r,i=0;i<t.contentProtections.length;i++)u=t.contentProtections[i].data(0),u&&(r=new n.Mp4Util.PsshBox,r.systemId=n.KeySystem.PlayReady.systemId,r.specificData=n.Common.stringToUint8Array(atob(u)),f.push(r))});f.length>0&&t.sessionContext.emeManager.addPsshBoxes(f);i._initial=!1;r()})},t}();t.PlayReady=i})(n.ContentProtection||(n.ContentProtection={}));var t=n.ContentProtection}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";var i=function(){function t(){this._moduleId="widevine";this._disposed=!1;this._initial=!0}return t.prototype.dispose=function(){this._disposed=!0},t.prototype.init=function(n){var t=n.workflows[0];t.addHandler(t.stepEvents.requestEnd,this.onContentProtected,this)},t.prototype.onContentProtected=function(t){var i=this;return t.currentModuleId=this._moduleId,new Promise(function(r,u){var f=[],e=t.sessionContext.commonPresentation;if(i._disposed){n.Failure.attachFailureToRequest(t,t.currentModuleId,0);u("Disposed");return}if(!i._initial){r();return}if(!e)throw new Error("CommonPresentation is empty");e.periods[0].streams.forEach(function(i){for(var u,r=0;r<i.contentProtections.length;r++){if(u=i.contentProtections[r].data(1),u){var o=n.Common.stringToUint8Array(atob(u)),s=new DataView(o.buffer),e=n.Mp4Util.GetPsshBoxes(s);if(e.length!=1)throw new Error("Each cenc:pssh element should contain a 'pssh' box");f.push(e[0])}i.contentProtections[r].laUrl&&t.sessionContext.emeManager.addLaUrl(n.KeySystem.Widevine.systemId,i.contentProtections[r].laUrl)}});f.length>0&&t.sessionContext.emeManager.addPsshBoxes(f);i._initial=!1;r()})},t}();t.Widevine=i})(n.ContentProtection||(n.ContentProtection={}));var t=n.ContentProtection}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";var i=function(){function t(){this._moduleId="AesHandler";this._disposed=!1;this._decryptor=new n.WebCryptoUtil.Decryptor}return t.prototype.dispose=function(){this._disposed||(this._disposed=!0,this._decryptor&&(this._decryptor.dispose(),this._decryptor=null))},t.prototype.init=function(n){var t=n.workflows[0],i=n.workflows[1];t.addHandler(t.stepEvents.requestEnd,this.onDownloadKey,this);i.addHandler(i.stepEvents.dataRetrieved,this.onDecrypt,this)},t.prototype.onDownloadKey=function(i){var r=this;return i.currentModuleId=this._moduleId,new Promise(function(u,f){function e(){h<s.length?n.Util.setTimeout(c,0,s[h++]):u()}function c(r){var c,a,h,v,p;if(o._disposed){n.Failure.attachFailureToRequest(i,i.currentModuleId,0);f();return}if(o._decryptor.isInitialized(r.streamingInfo.aes)){e();return}if(c=t._getAesContentProtectionIndex(r),isNaN(c)){e();return}var y=r.contentProtections[c],u=y.data(3),l=y.data(4);if(!u||!l){n.Failure.attachFailureToRequest(i,i.currentModuleId,5242883,"Missing IV or keyUrl");f();return}if(a=o._findExistingAesInfo(s,r,u,l),a){r.streamingInfo.aes=a;e();return}if(h=i.sessionContext.authenticationTokens[t._tokenId],!n.AesUtil.verifyKeyUrlWithToken(u,h)){n.Failure.attachFailureToRequest(i,i.currentModuleId,5242883,"verify AMS hostname failed");f();return}v=[];h&&h.length>0&&(v[0]={name:n.HttpUtil.authorizationHeader,value:h});p=Date.now();n.Log.verbose(12,"Starting AES key acquisition");n.HttpUtil.httpRequest(u,"POST","arraybuffer",v).then(function(t){o._decryptor.initialize(r.streamingInfo.aes,t,n.Common.hexStringToUint8Array(l)).then(function(){n.Log.verbose(12,"AES key acquisition in "+(Date.now()-p)+" ms");e();return},function(t){n.Log.error(12,"Failed to initialize decryptor: ");n.Failure.attachFailureToRequest(i,i.currentModuleId,5242882,"AES: "+t);f()})},function(t){n.Log.error(12,"Failed to download AES key url: "+u+", "+n.Common.toHexString(t));n.Failure.attachFailureToRequest(i,i.currentModuleId,5242884,"Http: "+n.Common.toHexString(t));f();return})}var o=r,s=i.sessionContext.commonPresentation.periods[0].streams,h=0;e()})},t.prototype.onDecrypt=function(t){var i=this;return t.currentModuleId=this._moduleId,new Promise(function(r,u){function e(){o<t.urlsToRetrieve.length?n.Util.setTimeout(h,0,t.urlsToRetrieve[o++]):r()}function h(i){if(f._disposed){n.Failure.attachFailureToRequest(t,t.currentModuleId,0);u();return}if(!i.mediaData){e();return}var r=Date.now();f._decryptor.decrypt(s,i.mediaData).then(function(t){n.Log.verbose(12,"AES decrypt data in "+(Date.now()-r)+" ms, bytes: "+i.mediaData.byteLength+" url: "+i.url);i.mediaData=t;e();return},function(){n.Log.error(12,"Failed to AES decrypt url: "+i.url);n.Failure.attachFailureToRequest(t,t.currentModuleId,5242885,"Failed to AES decrypt segment");u();return})}var f=i,o=0,s=t.requestedStream.streamingInfo.aes;if(!f._decryptor.isInitialized(s)){r();return}e()})},t._getAesContentProtectionIndex=function(n){for(var u,r=n.contentProtections,i=0;i<r.length;i++)if(u=r[i].data(2),u===t._aesCbc128SystemId)return i;return NaN},t.prototype._findExistingAesInfo=function(n,t,i,r){for(var e,f,o,s,u=0;u<n.length;u++)if(n[u]!==t)for(e=n[u].contentProtections,f=0;f<e.length;f++)if(o=e[f].data(3),s=e[f].data(4),o===i&&s===r&&this._decryptor.isInitialized(n[u].streamingInfo.aes))return n[u].streamingInfo.aes;return null},t._aesCbc128SystemId="urn:mpeg:dash:sea:aes128-cbc:2013",t._tokenId="AES",t}();t.AesHandler=i})(n.ContentProtection||(n.ContentProtection={}));var t=n.ContentProtection}(AzureHtml5JS||(AzureHtml5JS={}));Object.defineProperty(Array.prototype,"findFirst",{value:function(n){for(var i,t=0;t<this.length;t++)if(i=this[t],n.call(this,i,t,Object(this)))return i;return null},enumerable:!1,configurable:!0});Object.defineProperty(Array.prototype,"findLast",{value:function(n){for(var i,t=this.length-1;t>=0;t--)if(i=this[t],n.call(this,i,t,Object(this)))return i;return null},enumerable:!1,configurable:!0});Object.defineProperty(Array.prototype,"findIndexOf",{value:function(n){for(var i,t=0;t<this.length;t++)if(i=this[t],n.call(this,i,t,Object(this)))return t;return-1},enumerable:!1,configurable:!0});Object.defineProperty(Array.prototype,"removeFirst",{value:function(n){var t=this.findIndexOf(n),i=null;return t!==-1&&(i=this.splice(t,1)[0]),i},enumerable:!1,configurable:!0});Object.defineProperty(Uint8Array.prototype,"isEqual",{value:function(n){if(this.length===n.length){for(var t=0;t<this.length;t++)if(this[t]!==n[t])return!1;return!0}return!1},enumerable:!1,configurable:!0}),function(n){"use strict";function t(n,t){if(!n)throw new Error(t);}n.assert=t}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(n){"use strict";var t=function(){function n(n){if(this._slidingWindow=[],this._sum=0,this._maxWindowLength=n,n<1)throw new Error("window length for average class should be greater than 0");}return n.prototype.dispose=function(){this._slidingWindow=null},Object.defineProperty(n.prototype,"average",{get:function(){return this._slidingWindow.length===0?0:this._sum/this._slidingWindow.length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"latest",{get:function(){return this._slidingWindow.length===0?0:this._slidingWindow[this._slidingWindow.length-1]},enumerable:!0,configurable:!0}),n.prototype.addValue=function(n){if(this._slidingWindow.length>=this._maxWindowLength){var t=this._slidingWindow.splice(0,1);this._sum-=t[0]}this._slidingWindow.push(n);this._sum+=n},n}();n.AverageCalculator=t})(n.Util||(n.Util={}));var t=n.Util}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(n){"use strict";function t(t,i,r){typeof r=="undefined"&&(r=n.timestampDeltaThreshold);var u=i-t;return Math.abs(u)<r&&(u=0),u}function f(n,t,i){for(var u=0,f=t.length-1,r=0,e;u<=f;)if(r=Math.floor((u+f)/2),e=i(n,t[r]),e<0)f=r-1;else if(e>0)u=r+1;else return r;return-1}function e(n,t,i){var f=0,u=t.length-1,r=0,e;if(u<=0)return-1;while(f<=u){if(r=Math.floor((f+u)/2),0===r)return i(n,t[f],t[u])?-1:1;if(e=i(n,t[r-1],t[r]),e<0)u=r-1;else if(e>0)f=r+1;else return r}return-1}function o(n,t,i){var f=0,u=t.length-1,r=0,e;if(u<0)return-1;if(u===0)return i(n,t[0]);while(f<=u){if(r=Math.floor((f+u)/2),0===r)return i(n,t[f],t[u]);if(e=i(n,t[r-1],t[r]),e<0)u=r-1;else if(e>0)f=r+1;else return r-1}return t.length-1}function s(n){for(var t,r="",i=0;i<n.length;i++)t=n[i].toString(16),r+=t.length<2?"0"+t:t;return r}function h(n){var t,r,i,u;if(n.length<=2||n.substr(0,2).toLowerCase()!="0x")throw new Error("Invalid hexString");for(t=n.substr(2),n.length%2!=0&&(t="0"+t),r=new Uint8Array(t.length/2),i=0;i<t.length;i+=2){if(u=parseInt(t.substr(i,2),16),isNaN(u))throw new Error("Invalid hexString");r[i/2]=u}return r}function c(n){return n<0&&(n=4294967295+n+1),"0x"+("00000000"+n.toString(16).toUpperCase()).substr(-8)}function l(n){for(var i="",t=0;t<n.byteLength;t++)i+=String.fromCharCode(n[t]);return i}function a(n){for(var i=new Uint8Array(n.length),t=0;t<i.byteLength;t++)i[t]=n.charCodeAt(t);return i}var i,r,u;n.timestampDeltaThreshold=.0005;n.nearDiscontinuityThreshold=2;n.diffTimes=t;i=function(){function n(n,t){this.startInSec=n;this.endInSec=t}return n}();n.TimeRange=i;r=function(){function r(){this._timeRanges=[]}return r.prototype.dispose=function(){this._timeRanges=null},Object.defineProperty(r.prototype,"length",{get:function(){return this._timeRanges.length},enumerable:!0,configurable:!0}),r.prototype.start=function(n){return this._timeRanges[n].startInSec},r.prototype.end=function(n){return this._timeRanges[n].endInSec},r.prototype.duration=function(n){return this._timeRanges[n].endInSec-this._timeRanges[n].startInSec},r.prototype.extendLast=function(n){this._timeRanges[this._timeRanges.length-1].endInSec=n},r.prototype.addRange=function(n){this._timeRanges.push(n)},r.prototype.addRanges=function(n){if(n)for(var t=0;t<n.length;t++)this.addRange(new i(n.start(t),n.end(t)))},r.prototype.rebase=function(n){this._timeRanges.forEach(function(t){t.startInSec-=n;t.endInSec-=n})},r.prototype.removeGaps=function(n){for(var t=0;t+1<this._timeRanges.length;)this._timeRanges[t+1].startInSec-this._timeRanges[t].endInSec<n?(this._timeRanges[t].endInSec=this._timeRanges[t+1].endInSec,this._timeRanges.splice(t+1,1)):t++},r.prototype.getIndexByInRangeTimestamp=function(n){for(var i,r,t=0;t<this._timeRanges.length;t++){if(i=this._timeRanges[t],i.startInSec<=n&&n<i.endInSec)return t;if(t+1>=this._timeRanges.length)return-1;if(r=this._timeRanges[t+1],i.endInSec<=n&&n<=r.startInSec)return t+1}return-1},r.prototype.beforeDiscontinuity=function(i,r){return r<0||r+1>=this._timeRanges.length||this._timeRanges[r].startInSec>i||i>=this._timeRanges[r].endInSec?!1:0!==t(this._timeRanges[r].endInSec,this._timeRanges[r+1].startInSec)&&this._timeRanges[r].endInSec-i<n.nearDiscontinuityThreshold},r.prototype.atOrAfterDiscontinuity=function(i,r){return r<=0||r>=this._timeRanges.length||this._timeRanges[r-1].endInSec>i||i>=this._timeRanges[r].endInSec?!1:0!==t(this._timeRanges[r-1].endInSec,this._timeRanges[r].startInSec)&&(i<this._timeRanges[r].startInSec||i-this._timeRanges[r].startInSec<n.nearDiscontinuityThreshold)},r}();n.TimeRangeSet=r;u=function(){function n(n,t,i){this.presTimeInSec=t;this.durationInSec=i;this.data=n}return Object.defineProperty(n.prototype,"endTimestampInSec",{get:function(){return this.presTimeInSec+this.durationInSec},enumerable:!0,configurable:!0}),n}();n.SegmentData=u;n.binarySearch=f;n.binarySearchInGaps=e;n.binarySearchTimeline=o;n.uint8ArrayToHexString=s;n.hexStringToUint8Array=h;n.toHexString=c;n.uint8ArrayToString=l;n.stringToUint8Array=a})(n.Common||(n.Common={}));var t=n.Common}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(n){"use strict";var i=function(){function n(n,t){typeof t=="undefined"&&(t=0);this.data=n;this.readPos=t}return n.prototype.getUint8=function(){return this.data.getUint8(this.readPos++)},n.prototype.getUint32=function(){var n=this.data.getUint32(this.readPos);return this.readPos+=4,n},n.prototype.getInt32=function(){var n=this.data.getInt32(this.readPos);return this.readPos+=4,n},n.prototype.getBytes=function(n){for(var i=new Uint8Array(n),t=0;t<n;t++)i[t]=this.getUint8();return i},n.prototype.readString=function(n){for(var t="",i=0;i<n;i++)t+=String.fromCharCode(this.getUint8());return t},n}(),t;n.Reader=i;t=function(){function n(n,t){typeof t=="undefined"&&(t=0);this.data=n;this.writePos=t}return n.prototype.setUint8=function(n){this.data.setUint8(this.writePos++,n)},n.prototype.setUint32=function(n){this.data.setUint32(this.writePos,n);this.writePos+=4},n.prototype.setInt32=function(n){this.data.setInt32(this.writePos,n);this.writePos+=4},n.prototype.setString=function(n){for(var t=0;t<n.length;t++)this.setUint8(n.charCodeAt(t))},n.prototype.setBytes=function(n){for(var t=0;t<n.length;t++)this.setUint8(n[t])},n}();n.Writer=t})(n.DataViewReaderWriter||(n.DataViewReaderWriter={}));var t=n.DataViewReaderWriter}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(n){"use strict";var r=function(){function n(n,t){typeof n=="undefined"&&(n=null);typeof t=="undefined"&&(t=!0);this._azureHtml5=n;this._allowDuplicateHandlers=t;this._registrations={}}return n.prototype.dispose=function(){this._registrations=null},n.prototype.getHandlers=function(n){return n in this._registrations||(this._registrations[n]=[]),this._registrations[n]},n.prototype.addHandler=function(n,t,r){var u=this.getHandlers(n),f;(this._allowDuplicateHandlers||-1===this._findHandlerByFunction(u,t))&&(f=new i(r,t),u[u.length]=f)},n.prototype.removeHandler=function(n,t){for(var i=this.getHandlers(n),r=this._findHandlerByFunction(i,t);r!==-1;)i.splice(r,1),r=this._findHandlerByFunction(i,t)},n.prototype.dispatchEvent=function(n,i){for(var f,e=this,r=0,u=this.getHandlers(n).slice(),r=0;r<u.length;r++)f=new t(n,e._azureHtml5,i),u[r].functionHandler.call(u[r].callerInstance,f)},n.prototype._findHandlerByFunction=function(n,t){for(var r=-1,i=0;i<n.length;i++)if(n[i].functionHandler===t){r=i;break}return r},n}(),t,i;n.Manager=r;t=function(){function n(n,t,i){this.type=n;this.currentDate=new Date;this.azureHtml5=t;this.presentationTimeInSec=t?t.currentTime:0;this.message=i}return n}();n.EventInfo=t;i=function(){function n(n,t){this.callerInstance=n;this.functionHandler=t}return n}();n.Handler=i})(n.Events||(n.Events={}));var t=n.Events}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";function u(n){return n>=400&&n<600?2097152|n:2097152}function f(n){var t="";return n.filename&&(t+=" file: "+n.filename),n.lineno&&(t+=" line: "+n.lineno),n.colno&&(t+=" colno: "+n.colno),n.error&&(t+="error: "+n.error),n.message&&(t+="msg: "+n.message),t}function e(t){if(undefined===t||null===t)return"undefined";var i=s(t.code);return t.msExtendedCode&&(i+=", msErrorCode: "+n.Common.toHexString(t.msExtendedCode)),i}function o(n,t,r,u){var f=new i(t,r,u);null!=n&&(n.externalFailure=f)}function s(n){switch(n){case MediaError.MEDIA_ERR_ABORTED:return"MEDIA_ERR_ABORTED";case MediaError.MEDIA_ERR_NETWORK:return"MEDIA_ERR_NETWORK";case MediaError.MEDIA_ERR_DECODE:return"MEDIA_ERR_DECODE";case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:return"MEDIA_ERR_SRC_NOT_SUPPORTED";default:return n.toString()}}function h(n){return n>1048575}var i=function(){function t(n,t,i){this.originModuleId=n;this.code=t;this.message=i}return t.prototype.dispose=function(){this.originModuleId=null;this.code=null;this.message=null},t.prototype.toString=function(){var t;return t="Module = "+this.originModuleId+" FailureCode = "+n.Common.toHexString(this.code),this.message&&(t+=" "+this.message),t},t}(),r;t.Record=i;t.translateHttpStatusToCode=u;t.errorEventToString=f;t.mediaErrorToString=e;t.attachFailureToRequest=o;t.isExternalError=h;r=function(){function t(n,t){n?(this.code=n,this.message=t):(this.code=0,this.message=null)}return t.prototype.translateMediaError=function(t){this.code=t.code<<20;t.msExtendedCode&&(this.message="msErrorCode: "+n.Common.toHexString(t.msExtendedCode))},t.prototype.toString=function(){var t="code: "+n.Common.toHexString(this.code);return this.message&&(t+=", msg: "+this.message),t},t}();t.External=r})(n.Failure||(n.Failure={}));var t=n.Failure}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(n){"use strict";function l(n,t){u(n,3,t)}function a(n,t){u(n,2,t)}function v(n,t){u(n,1,t)}function y(n){i=n}function p(n){undefined===n||null===n?t.forEach(function(n,t,i){i[t]=!0}):t[n]=!0}function w(n){undefined===n||null===n?t.forEach(function(n,t,i){i[t]=!1}):t[n]=!1}function b(n){typeof n=="undefined"&&(n=!0);h=n}function k(n){typeof n=="undefined"&&(n=!0);var t=e;return n&&(e=""),t}function d(n,t){o=n;c=t}function u(n,u,f){var l,a;if(o&&u<=i){o(c,u,r[n]+": "+f);return}l=new Date(Date.now());u<=i&&t[n]&&(a="["+l.getHours()+":"+l.getMinutes()+":"+(l.getSeconds()+l.getMilliseconds()/1e3).toFixed(3)+"] "+s[u]+": "+r[n]+": "+f,h&&(e+="\n"+a),console.log(a))}var s,r,i,t,f;for(function(n){n[n.none=0]="none";n[n.error=1]="error";n[n.warning=2]="warning";n[n.verbose=3]="verbose"}(n.Level||(n.Level={})),s=n.Level,function(n){n[n.workflowSequencer=0]="workflowSequencer";n[n.workflowCoordinator=1]="workflowCoordinator";n[n.htmlAdapter=2]="htmlAdapter";n[n.videoElementAdapter=3]="videoElementAdapter";n[n.manifestParser=4]="manifestParser";n[n.httpDataRetriever=5]="httpDataRetriever";n[n.dashUrlFormatter=6]="dashUrlFormatter";n[n.azureHTML5=7]="azureHTML5";n[n.heuristics=8]="heuristics";n[n.segmentLocator=9]="segmentLocator";n[n.mediaParser=10]="mediaParser";n[n.mp4Parser=11]="mp4Parser";n[n.encrypted=12]="encrypted";n[n.common=13]="common";n[n.functionalTest=14]="functionalTest";n[n.max=15]="max"}(n.Area||(n.Area={})),r=n.Area,n.verbose=l,n.warning=a,n.error=v,n.setConsoleOutputByLevel=y,n.enableConsoleOutputByArea=p,n.disableConsoleOutputByArea=w,n.enableMemoryLog=b,n.getMemoryLog=k,n.setLoggerFunction=d,i=0,t=[],f=0;f<15;f++)t.push(!1);var h=!1,e="",o=undefined,c=null;n.enableConsoleOutputByArea();n.setConsoleOutputByLevel(1)})(n.Log||(n.Log={}));var t=n.Log}(AzureHtml5JS||(AzureHtml5JS={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){(function(t){"use strict";function r(t,i,r){typeof r=="undefined"&&(r=0);var u,f=r;if(!i||i.length!==4)return n.Log.error(11,"Parameter error, box type must have four characters"),null;if(!t||t.byteLength<8)return n.Log.error(11,"Parameter error, not enough data"),null;while(f<t.byteLength){if(u=c(t,f),!u)break;if(u.type===i)return u;f+=u.size}return null}function c(t,i){if(!t||t.byteLength-i<8)return n.Log.error(11,"MP4 box parsing error, not enough data for box header"),null;var r=new f(t,i);if(r.size=r.getUint32(),r.type=r.readString(4),r.size===1){if(t.byteLength-i<16)return n.Log.error(11,"MP4 box parsing error, not enough data for largesize"),null;if(r.size=r.getUint32()<<32,r.size+=r.getUint32(),r.size>9007199254740991)return n.Log.error(11,"Box size too big for precise representation as Javascript number"),null}else r.size===0&&(r.size=t.byteLength);if(r.size>t.byteLength-i)return null;if(r.type==="uuid"){if(t.byteLength-r.readPosition<16)return n.Log.error(11,"MP4 box parsing error, not enough data for usertype"),null;r.usertype=r.readString(16)}return r.data=new DataView(t.buffer,t.byteOffset+r.readPosition,t.byteLength-r.readPosition),r}function l(t){var i,u=null;return(i=r(t,"tfhd"),!i)?(n.Log.warning(11,"tfhd not found"),null):(u=e.parse(i),u||n.Log.warning(11,"Parsing of tfhd failed"),u)}function a(t){var i,u=null;return(i=r(t,"trun"),!i)?(n.Log.warning(11,"trun not found"),null):(u=o.parse(i),u||n.Log.warning(11,"Parsing of trun failed"),u)}function v(t){var i,u=null;return(i=r(t,"tfdt"),!i)?(n.Log.warning(11,"tfdt not found"),null):(u=h.parse(i),u||n.Log.warning(11,"Parsing of tfdt failed"),u)}function y(t){for(var i,f=[],e=0,o;e<t.byteLength;){if(i=r(t,u.typeStr,e),!i)return n.Log.warning(11,"pssh not found"),f;o=u.parse(i);o?f.push(o):n.Log.warning(11,"Parsing of pssh failed");e+=i.size}return f}var f=function(){function t(t,i){t&&typeof i!="undefined"&&(this.data=t,this.reader=new n.DataViewReaderWriter.Reader(t,i))}return t.prototype.getUint32=function(){return this.reader.getUint32()},t.prototype.getInt32=function(){return this.reader.getInt32()},t.prototype.getUint8=function(){return this.reader.getUint8()},t.prototype.getBytes=function(n){return this.reader.getBytes(n)},t.prototype.readString=function(n){return this.reader.readString(n)},Object.defineProperty(t.prototype,"readPosition",{get:function(){return this.reader.readPos},enumerable:!0,configurable:!0}),t}(),i,e,o,s,h,u;t.Mp4Box=f;i=function(t){function i(i){t.call(this);i&&(this.size=i.size,this.type=i.type,this.usertype=i.usertype,this.data=i.data,this.reader=new n.DataViewReaderWriter.Reader(this.data),this._versionFlags=i._versionFlags)}return __extends(i,t),i.parse=function(t){var r=null;return t.data.byteLength<4?(n.Log.error(11,"Full box parsing error, not enough bytes"),null):(r=new i,r.size=t.size,r.type=t.type,r.usertype=t.usertype,r._versionFlags=t.data.getUint32(0),r.data=new DataView(t.data.buffer,t.data.byteOffset+4,t.data.byteLength-4),r.reader=new n.DataViewReaderWriter.Reader(r.data),r)},i.serialize=function(t,i){var f=(t.type==="uuid"?16:0)+12,u=i+f,e=new ArrayBuffer(u),o=new DataView(e),r=new n.DataViewReaderWriter.Writer(o);if(u>4294967295)throw new Error("Mp4FullBox::serialize, large size is not supported");if(r.setUint32(u),r.setString(t.type),t.type==="uuid"&&r.setString(t.usertype),r.setUint32(t._versionFlags),r.writePos!==f)throw new Error("Mp4FullBox::serialize, inconsistent bytes written");return r},Object.defineProperty(i.prototype,"version",{get:function(){return this._versionFlags>>24},set:function(n){this._versionFlags&=16777215;this._versionFlags|=n<<24},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"flags",{get:function(){return this._versionFlags&16777215},set:function(n){this._versionFlags&=4278190080;this._versionFlags|=n&16777215},enumerable:!0,configurable:!0}),i.prototype.getUint32Cond=function(n){var t;return n&this.flags&&(t=this.reader.getUint32()),t},i}(f);t.Mp4FullBox=i;e=function(t){function r(n){t.call(this,n)}return __extends(r,t),r.parse=function(t){var u=null,f=null;return(f=i.parse(t),!f)?null:(u=new r(f),f.data.byteLength<u._calculatedSize())?(n.Log.error(11,"tfhd box parsing error, not enough data"),null):(u.trackId=u.getUint32(),u.baseDataOffsetHi=u.getUint32Cond(r.flags_baseDataOffsetPresent),u.baseDataOffsetLo=u.getUint32Cond(r.flags_baseDataOffsetPresent),u.sampleDescriptionIndex=u.getUint32Cond(r.flags_sampleDescriptionIndexPresent),u.defaultSampleDuration=u.getUint32Cond(r.flags_defaultSampleDurationPresent),u.defaultSampleSize=u.getUint32Cond(r.flags_defaultSampleSizePresent),u.defaultSampleFlags=u.getUint32Cond(r.flags_defaultSampleFlagsPresent),u)},r.prototype._calculatedSize=function(){var n=4;return n+=this.flags&r.flags_baseDataOffsetPresent?8:0,n+=this.flags&r.flags_sampleDescriptionIndexPresent?4:0,n+=this.flags&r.flags_defaultSampleDurationPresent?4:0,n+=this.flags&r.flags_defaultSampleSizePresent?4:0,n+(this.flags&r.flags_defaultSampleFlagsPresent?4:0)},r.typeStr="tfhd",r.flags_baseDataOffsetPresent=1,r.flags_sampleDescriptionIndexPresent=2,r.flags_defaultSampleDurationPresent=8,r.flags_defaultSampleSizePresent=16,r.flags_defaultSampleFlagsPresent=32,r.flags_durationIsEmpty=65536,r.flags_defaultBaseIsMoof=131072,r}(i);t.TfhdBox=e;o=function(t){function r(n){t.call(this,n)}return __extends(r,t),r.parse=function(t){var u=null,e=null,o,f;if(e=i.parse(t),!e)return null;if((u=new r(e),e.data.byteLength<4)||(u.sampleCount=u.getUint32(),e.data.byteLength<u._calculatedSize()))return n.Log.error(11,"trun box parsing error, not enough data"),null;for(u.dataOffset=u.getUint32Cond(r.flags_dataOffsetPresent),u.firstSampleFlags=u.getUint32Cond(r.flags_firstSampleFlagsPresent),u.sampleInfoArray=[],o=0;o<u.sampleCount;o++)f=new s,f.sampleDuration=u.getUint32Cond(r.flags_sampleDurationPresent),f.sampleSize=u.getUint32Cond(r.flags_sampleSizePresent),f.sampleFlags=u.getUint32Cond(r.flags_sampleFlagsPresent),u.flags&r.flags_sampleCompositionTimeOffsetsPresent&&(f.sampleCompositionTimeOffset=u.version===0?u.getUint32():u.getInt32()),u.sampleInfoArray.push(f);return u},r.prototype._calculatedSize=function(){var t=4,n;return t+=this.flags&r.flags_dataOffsetPresent?4:0,t+=this.flags&r.flags_firstSampleFlagsPresent?4:0,n=this.flags&r.flags_sampleDurationPresent?4:0,n+=this.flags&r.flags_sampleSizePresent?4:0,n+=this.flags&r.flags_sampleFlagsPresent?4:0,n+=this.flags&r.flags_sampleCompositionTimeOffsetsPresent?4:0,t+this.sampleCount*n},r.typeStr="trun",r.flags_dataOffsetPresent=1,r.flags_firstSampleFlagsPresent=4,r.flags_sampleDurationPresent=256,r.flags_sampleSizePresent=512,r.flags_sampleFlagsPresent=1024,r.flags_sampleCompositionTimeOffsetsPresent=2048,r}(i);t.TrunBox=o;s=function(){function n(){}return n}();t.TrunSampleInfo=s;h=function(t){function r(n){t.call(this,n);this.baseMediaDecodeTime=0}return __extends(r,t),r.parse=function(t){var u=null,f=null;return(f=i.parse(t),!f)?null:(u=new r(f),f.data.byteLength<u._calculatedSize())?(n.Log.error(11,"tfdt box parsing error, not enough data"),null):(u.version===1&&(u.baseMediaDecodeTime=u.getUint32()*4294967296),u.baseMediaDecodeTime+=u.getUint32(),u.baseMediaDecodeTime>=9007199254740992&&n.Log.warning(11,"tfdt timestamp greater than 53 bits, possible precision loss"),u)},r.prototype._calculatedSize=function(){return this.version===1?8:4},r.typeStr="tfdt",r}(i);t.TfdtBox=h;u=function(t){function r(n){n?t.call(this,n):this.type=r.typeStr;this._keyIds=[]}return __extends(r,t),r.parse=function(t){var u=null,f=null,e,o,h,s;if(f=i.parse(t),!f)return null;if(u=new r(f),f.data.byteLength<u._calculatedSize())return n.Log.error(11,"pssh box parsing error, not enough data"),null;if(u.systemId=u.getBytes(16),e=0,u.version>0){if(e=u.getUint32(),u._keyIds.length=e,f.data.byteLength<u._calculatedSize())return n.Log.error(11,"pssh box parsing error, not enough data"),null;for(o=0;o<e;o++)h=u.getBytes(16),u._keyIds[o]=h}return(s=u.getUint32(),f.data.byteLength<u._calculatedSize(s))?(n.Log.error(11,"pssh box parsing error, not enough data"),null):(u.specificData=u.getBytes(s),u)},r.prototype.addKeyId=function(n){if(n.length!==16)throw new Error("keyId must be 16 bytes");this.version=1;this._keyIds.push(n)},Object.defineProperty(r.prototype,"keyIds",{get:function(){return this._keyIds},enumerable:!0,configurable:!0}),r.prototype._calculatedSize=function(n){typeof n=="undefined"&&(n=0);var t=20+n;return this.version>0&&(t+=4+this._keyIds.length*16),t},r.prototype.serialize=function(){var n=i.serialize(this,this._calculatedSize(this.specificData.byteLength));if(!this.systemId)throw new Error("systemId is not set");if(n.setBytes(this.systemId),this.version>0&&(n.setUint32(this._keyIds.length),this._keyIds.forEach(function(t){n.setBytes(t)})),!this.specificData)throw new Error("specificData is not set");if(n.setUint32(this.specificData.byteLength),n.setBytes(this.specificData),n.writePos!=n.data.buffer.byteLength)throw new Error("Failed to write to end of buffer");return n.data.buffer},r.typeStr="pssh",r}(i);t.PsshBox=u;t.GetBoxByType=r;t.GetTfhdBox=l;t.GetTrunBox=a;t.GetTfdtBox=v;t.GetPsshBoxes=y})(n.Mp4Util||(n.Mp4Util={}));var t=n.Mp4Util}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";function i(){return n.VideoElementAdapter.supported("video/mp4",'codecs="avc1.4d404f"')}function r(n){var i=!1,t;return n&&n.canPlayType&&(t=n.canPlayType("application/vnd.apple.mpegurl"),(t==="maybe"||t==="probably")&&(i=!0)),i}function u(n){var i=!1,t;return n&&n.canPlayType&&(t=n.canPlayType("video/mp4"),(t==="maybe"||t==="probably")&&(i=!0)),i}(function(n){n[n.type1=1]="type1";n[n.type2=2]="type2";n[n.type3=3]="type3"})(t.Type||(t.Type={}));var f=t.Type;t.MseSupported=i;t.HlsType1Supported=r;t.Mp4Type1Supported=u})(n.PlayerDetector||(n.PlayerDetector={}));var t=n.PlayerDetector}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";function s(n,t){var r;if(n&&n.length>0&&(r=n.trim().toLowerCase(),f[r]))return i(f[r],t)}function h(n,t){var f=n.trim().toLowerCase(),s,h;return f.lastIndexOf(".ism/")>-1&&(s=o(f),r[s])?i(r[s],t):(h=e(f),u[h])?i(u[h],t):null}function e(n){var i=null,t=n.lastIndexOf("."),r=n.indexOf("/",t);return t>-1&&(i=n.substring(t+1,r!==-1?r:n.length)),i}function o(n){var t=null,i=n,e="(format=",o=n.lastIndexOf("?"),r,u,f;return o>-1&&(i=n.substring(0,o)),r=i.lastIndexOf(e),r>-1&&(u=i.lastIndexOf(")"),u>r&&(t=i.substring(r+e.length,u),f=t.indexOf(","),f>-1&&(t=t.substring(0,f)))),t}function i(t,i){var r=null;switch(t){case 1:n.PlayerDetector.HlsType1Supported(i)&&(r=1);break;case 2:n.PlayerDetector.Mp4Type1Supported(i)&&(r=1);break;case 3:n.PlayerDetector.MseSupported(i)&&(r=3)}return r}(function(n){n[n.hls=1]="hls";n[n.mp4=2]="mp4";n[n.dash=3]="dash"})(t.Format||(t.Format={}));var c=t.Format,r={"m3u8-aapl-v3":1,"m3u8-aapl-v4":1,"mpd-time-csf":3},u={mp4:2,m3u8:1},f={"video/mp4":2,"application/dash+xml":3,"application/vnd.apple.mpegurl":1};t.getByPresentationType=s;t.getByUrl=h;t._getFileExtension=e;t._getAzureMediaFormatTag=o;t._getPlayerTypeByFormat=i})(n.PlayerType||(n.PlayerType={}));var t=n.PlayerType}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";function f(n){for(var r,t=0;t<i.length;t++)if(i[t]&&i[t].id&&i[t].id==n)return r=i.splice(t,1),r.length===1?r[0]:null;return null}var r,i,e,u;if(t.setTimeout=window.setTimeout.bind(window),t.clearTimeout=window.clearTimeout.bind(window),!window.Worker||!Blob||!window.URL||!window.URL.createObjectURL){n.Log.verbose(7,"AzureHtml5JS.Util: cannot override setTimeout/clearTimeout");return}r=0;i=[];try{e=new Blob(["'use strict';(function () {var timers = [];onmessage = function (event) {if (!event.data.id) {return;}if (event.data.start) {var internalId = setTimeout(function () {var expiredId = removeTimer(event.data.id);if (expiredId && expiredId.external) {postMessage({ type: 'timeout', id: expiredId.external });}}, event.data.ms || 0);timers.push({ external: event.data.id, internal: internalId });postMessage({ type: 'started', id: event.data.id });}else if (event.data.stop) {var removedId = removeTimer(event.data.id);if (removedId && removedId.internal) {clearTimeout(removedId.internal);}postMessage({ type: 'cancelled', id: event.data.id });}};function removeTimer(timerId) {for (var i = 0; i < timers.length; i++) {if (timers[i] && timers[i].external && timers[i].external == timerId) {var removed = timers.splice(i, 1);return removed.length === 1 ? removed[0] : null;}}return null;}})();"],{type:"text/javascript"});u=new Worker(window.URL.createObjectURL(e));u.onmessage=function(n){if(n.data.type==="timeout"){var t=f(n.data.id);t&&t.callback&&t.callback.apply(t.ctx,t.args)}else n.data.type==="cancelled"&&f(n.data.id)};t.setTimeout=function(n,t){for(var e=[],f=0;f<arguments.length-2;f++)e[f]=arguments[f+2];return r++,i.push({id:r,ctx:this,callback:n,args:e}),u.postMessage({start:!0,id:r,ms:t}),r};t.clearTimeout=function(n){u.postMessage({stop:!0,id:n})}}catch(o){n.Log.verbose(7,"AzureHtml5JS.Util: setTimeout/clearTimeout override failed: "+o)}})(n.Util||(n.Util={}));var t=n.Util}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";function i(n){var t=n.requestedStream.streamingInfo.currentSegment,i=t.segmentInfo.durationInSec;return!i&&n.sessionContext.commonPresentation.isLive&&t.prev&&(i=t.prev.segmentInfo.durationInSec),i}function r(t){return n.assert(t.requestedStream.type===0||t.requestedStream.type===1,"getBufferData: unexpected type"),t.requestedStream.type===0?t.sessionContext.videoBufferData:t.sessionContext.audioBufferData}t.getSegmentDuration=i;t.getBufferData=r})(n.StreamUtil||(n.StreamUtil={}));var t=n.StreamUtil}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(n){"use strict";function r(n,r){var f,u,e="",h,o,s;if(n.length>t?(f=parseInt(n.slice(0,n.length-t),10),u=parseInt(n.slice(n.length-t),10)):(f=0,u=parseInt(n,10)),u+=r,u>=i&&(h=Math.floor(u/i),f+=h,u=u%i),o=u.toString(),f)for(e=f.toString(),s=0;s<t-o.length;s++)e+="0";return e+o}var t=6,i=Math.pow(10,t);n.add=r})(n.Timestamp||(n.Timestamp={}));var t=n.Timestamp}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(n){"use strict";var t=function(){function t(){}return t.FormatDashMediaUrl=function(n,t,i){if(!n)throw new Error("url Template is not set");var r=n;return t!==null&&t!==undefined&&t!==""&&(r=r.replace("$Bandwidth$",t)),i!==null&&i!==undefined&&i!==""&&(r=r.replace("$Time$",i)),r},t.FormatDashInitUrl=function(t,i){return n.UrlFormatter.FormatDashMediaUrl(t,i,null)},t}();n.UrlFormatter=t})(n.Util||(n.Util={}));var t=n.Util}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(n){"use strict";function r(n,r){var e="WebKitMediaKeys"in window,o="MSMediaKeys"in window,s="requestMediaKeySystemAccess"in navigator,u,f;return s?(u=new i(r),f=new t(["cenc"],[u]),navigator.requestMediaKeySystemAccess(n,[f])):new Promise(function(t,i){if(e){window.WebKitMediaKeys.isTypeSupported(n,r)?t():i();return}if(o){window.MSMediaKeys.isTypeSupported(n,r)?t():i();return}i();return})}function u(n,t){var i={initDataTypes:["cenc"],videoCapabilities:[{contentType:t}]},r=[i];return navigator.requestMediaKeySystemAccess(n,r)}function f(n){var t="WebKitMediaKeys"in window,i="MSMediaKeys"in window;if(t)return new window.WebKitMediaKeys(n);if(i)return new window.MSMediaKeys(n);throw new Error("create MediaKeys not supported");}function e(n,t){var i="WebKitSetMediaKeys"in n,r="msSetMediaKeys"in n;if(i)n.WebKitSetMediaKeys(t);else if(r)n.msSetMediaKeys(t);else throw new Error("setMediaKeys not supported");}function o(n,t){n.addEventListener("webkitneedkey",t);n.addEventListener("msneedkey",t)}function s(n,t){n.addEventListener("encrypted",t)}function h(n,t){n.addEventListener("message",t)}function c(n,t){n.addEventListener("webkitkeymessage",t);n.addEventListener("mskeymessage",t)}function l(n,t){n.addEventListener("webkitkeyadded",t);n.addEventListener("mskeyadded",t)}function a(n,t){n.addEventListener("webkitkeyerror",t);n.addEventListener("mskeyerror",t)}function v(n,t){n.removeEventListener("webkitneedkey",t);n.removeEventListener("msneedkey",t)}function y(n,t){n.removeEventListener("encrypted",t)}function p(n,t){n.removeEventListener("message",t)}function w(n,t){n.removeEventListener("webkitkeymessage",t);n.removeEventListener("mskeymessage",t)}function b(n,t){n.removeEventListener("webkitkeyadded",t);n.removeEventListener("mskeyadded",t)}function k(n,t){n.removeEventListener("webkitkeyerror",t);n.removeEventListener("mskeyerror",t)}var t=function(){function n(n,t){this.initDataTypes=n;this.videoCapabilities=t}return n}(),i=function(){function n(n){this.contentType=n}return n}();n.isTypeSupported=r;n.createSupportedKeySystem=u;n.createMediaKeys=f;n.setMediaKeys=e;n.listenToNeedKey=o;n.listenToEncrypted=s;n.listenToMessage=h;n.listenToKeyMessage=c;n.listenToKeyAdded=l;n.listenKeyError=a;n.unlistenToNeedKey=v;n.unlistenToEncrypted=y;n.unlistenToMessage=p;n.unlistenToKeyMessage=w;n.unlistenToKeyAdded=b;n.unlistenKeyError=k})(n.EmeUtil||(n.EmeUtil={}));var t=n.EmeUtil}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";var i=function(){function t(){var t="msCrypto"in window,n=t?window.msCrypto:window.crypto;this._webCryptor=n.subtle||n.webkitSubtle}return t.prototype.dispose=function(){this._webCryptor=null},t.prototype.initialize=function(t,i,r){var f=this,u={name:"aes-cbc",iv:r};return new Promise(function(e,o){f._webCryptoImportKey(i,u).then(function(n){t.webCrypto={importedkey:n,algorithm:u};e()},function(u){var f=forge.cipher.createDecipher("AES-CBC",n.Common.uint8ArrayToString(new Uint8Array(i)));if(!f){o(u);return}t.forge={decipher:f,ivStr:n.Common.uint8ArrayToString(new Uint8Array(r))};e()})})},t.prototype.isInitialized=function(n){return null!=n.forge||null!=n.webCrypto},t.prototype.decrypt=function(n,t){var i=this;return new Promise(function(r,u){n.webCrypto?i._webCryptoDecrypt(n.webCrypto.algorithm,n.webCrypto.importedkey,t).then(function(n){r(n)},function(n){u(n)}):i._forgeDecrypt(n.forge,t).then(function(n){r(n)},function(n){u(n)})})},t.prototype._webCryptoImportKey=function(n,t){var i=this;return new Promise(function(r,u){function e(n){var t=f.result?f.result:n;r(t)}function o(n){u(n)}if(!i._webCryptor){u("Platform doesn't support webCrypto");return}var f=i._webCryptor.importKey("raw",new Uint8Array(n),t,!1,["decrypt"]);"oncomplete"in f?(f.oncomplete=e,f.onerror=o):f.then(function(n){e(n)},function(n){o(n)})})},t.prototype._forgeDecrypt=function(t,i){return new Promise(function(r,u){if(t.decipher.start({iv:t.ivStr}),t.decipher.update(new forge.util.ByteBuffer(i)),t.decipher.finish()){var f=n.Common.stringToUint8Array(t.decipher.output.bytes());r(f.buffer)}else u()})},t.prototype._webCryptoDecrypt=function(n,t,i){var r=this;return new Promise(function(u,f){function s(n){var t=e.result?e.result:n;u(t)}function o(n){f(n)}var e=r._webCryptor.decrypt(n,t,new Uint8Array(i));"oncomplete"in e?(e.oncomplete=s,e.onerror=o,e.onabort=o):e.then(function(n){s(n)},function(n){o(n)})})},t}();t.Decryptor=i})(n.WebCryptoUtil||(n.WebCryptoUtil={}));var t=n.WebCryptoUtil}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){"use strict";function i(t,i,r,u,f){return new Promise(function(e,o){function h(){if(s.status==200){e(s.response);return}n.Log.error(13,"XHR load failed status:"+s.statusText+"("+s.status+"), expected to be 200, readyState:"+s.readyState);o(n.Failure.translateHttpStatusToCode(s.status));return}function c(){n.Log.error(13,"XHR failed status: "+s.statusText+" ("+s.status+"), readyState: "+s.readyState);o(2097152);return}var s=new XMLHttpRequest;s.onload=h;s.onerror=c;s.open(i,t);s.responseType=r;u&&u.forEach(function(n){s.setRequestHeader(n.name,n.value)});s.send(f)})}t.authorizationHeader="Authorization";t.httpRequest=i})(n.HttpUtil||(n.HttpUtil={}));var t=n.HttpUtil}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(t){function i(t,i){var r,h,u,f,s,e,o;if(!i||0===i.length)return!0;try{r=decodeURIComponent(i)}catch(c){return n.Log.error(12,c),!1}return(h="urn:microsoft:azure:mediaservices:keyacquisitionhostname",u=r.indexOf(h),-1===u)?!0:(f=r.indexOf("&",u),-1===f&&(f=r.length),s=r.substring(u,f),e=s.split("="),e.length!=2)?(n.Log.error(12,"AMS hostname token is malformed: "+s),!1):(o=document.createElement("a"),o.href=t,e[1].toLowerCase()!=o.hostname.toLowerCase())?(n.Log.error(12,"AMS hostname mismatch: "+e[1].toLowerCase()+", "+o.hostname.toLowerCase()),!1):!0}t.verifyKeyUrlWithToken=i})(n.AesUtil||(n.AesUtil={}));var t=n.AesUtil}(AzureHtml5JS||(AzureHtml5JS={})),function(n){(function(n){"use strict";function f(n,t){r(n,3,t)}function l(n,t){r(n,2,t)}function a(n,t){r(n,1,t)}function p(n){for(var t,i=[],r=0;r<arguments.length-1;r++)i[r]=arguments[r+1];if(i&&i.length>0){t=Array.prototype.slice.call(i[0]);switch(n){case"warn":l(4,t.join(" "));break;case"error":a(4,t.join(" "));break;case null:f(4,t.join(" "));break;default:f(4,t.join(" "))}}}function w(n){e=n}function b(n){undefined===n||null===n?t.forEach(function(n,t,i){i[t]=!0}):t[n]=!0}function k(n){undefined===n||null===n?t.forEach(function(n,t,i){i[t]=!1}):t[n]=!1}function d(n){typeof n=="undefined"&&(n=!0);u=n}function g(n){if(u=!1,s=!1,n!==undefined&&n.TraceTargets&&!(n.TraceTargets.length<=0)){e=n.maxLogLevel;for(var t=0;t<n.TraceTargets.length;t++)n.TraceTargets[t].target.toLowerCase()==="console"?s=!0:n.TraceTargets[t].target.toLowerCase()==="memory"&&(u=!0,y=n.TraceTargets[t].maxMemoryTraceCount?n.TraceTargets[t].maxMemoryTraceCount:v)}}function nt(n){typeof n=="undefined"&&(n=!0);var t=i;return n&&i.slice(0),t.join("\n")}function r(n,r,f){var o=new Date(Date.now()),l;r<=e&&t[n]&&(l="["+o.getHours()+":"+o.getMinutes()+":"+(o.getSeconds()+o.getMilliseconds()/1e3).toFixed(3)+"] "+h[r]+": "+c[n]+": "+f,u&&(i.length>y&&i.shift(),i.push(l)),s&&console.log(l))}var h,c,o;(function(n){n[n.none=0]="none";n[n.error=1]="error";n[n.warning=2]="warning";n[n.verbose=3]="verbose"})(n.Level||(n.Level={}));h=n.Level,function(n){n[n.functionalTest=0]="functionalTest";n[n.azureHtml5JS=1]="azureHtml5JS";n[n.flashSS=2]="flashSS";n[n.silverlightSS=3]="silverlightSS";n[n.videojs=4]="videojs";n[n.plugin=5]="plugin";n[n.max=6]="max"}(n.Area||(n.Area={}));c=n.Area;n.verbose=f;n.warning=l;n.error=a;n.videoJSLogOverride=p;n.setConsoleOutputByLevel=w;n.enableConsoleOutputByArea=b;n.disableConsoleOutputByArea=k;n.enableMemoryLog=d;n.setLogConfig=g;n.getMemoryLog=nt;n.writeEntry=r;var e=0,t=[];for(o=0;o<6;o++)t.push(!1);var v=5e4,u=!1,i=[],y=v,s=!0;n.enableConsoleOutputByArea();n.setConsoleOutputByLevel(3)})(n.Logger||(n.Logger={}));var t=n.Logger}(AMP||(AMP={}));var ampVersion="1.5.0.4",amp=videojs,ampURL="http://amp.azure.net/libs/amp/";amp.Player.prototype.enterFullscreen=amp.Player.prototype.requestFullScreen;amp.Player.prototype.addEventListener=amp.Player.prototype.on;amp.Player.prototype.removeEventListener=amp.Player.prototype.off;amp.Player.prototype.currentTechName=function(){return this.techName};amp.Player.prototype.currentAbsoluteTime=function(){return this.techGet("currentAbsoluteTime")};amp.Player.prototype.currentVideoStreamList=function(){return this.techGet("currentVideoStreamList")};amp.Player.prototype.currentAudioStreamList=function(){return this.techGet("currentAudioStreamList")};amp.Player.prototype.videoBufferData=function(){return this.techGet("videoBufferData")};amp.Player.prototype.audioBufferData=function(){return this.techGet("audioBufferData")};amp.Player.prototype.currentDownloadBitrate=function(){return this.techGet("currentDownloadBitrate")};amp.Player.prototype.currentPlaybackBitrate=function(){return this.techGet("currentPlaybackBitrate")};amp.Player.prototype.videoWidth=function(){return this.techGet("videoWidth")};amp.Player.prototype.videoHeight=function(){return this.techGet("videoHeight")};amp.Player.prototype.currentProtectionInfo=function(){return this.options_.playbackOptions.protectionInfo};amp.Player.prototype.isLive=function(){return this.techGet("isLive")};amp.Player.prototype.currentHeuristicProfile=function(n){return n===undefined?amp.Heuristics.findProfile(this.player().options_.heuristicProfile).name:(this.options_.heuristicProfile=n,this)};amp.Player.prototype.currentPlayerSettingValue=function(n){var i,t;this.updateCurrentPlayerConfigs();i={};for(t in this.player().options_.currentPlayerConfigs.currentHeuristicConfigs)hasOwnProp.call(amp.Player._availableSettings.heuristicSettings,t)&&(i[t]=this.player().options_.currentPlayerConfigs.currentHeuristicConfigs[t]);return i[n]};amp.Player.getScriptRootURL=function(){var n=document.getElementsByTagName("script"),t=null,i,r,e,u,f;if(n&&n.length>=1)for(i=n.length-1;i>=0;i--)if(r=null,r=n[i].src,e=new RegExp("(.[^?]+)/azuremediaplayer(?:\\.min)?\\.js(?:\\?.*)?$","i"),r&&(u=r.match(e),u&&u.length===2)){t=u[1];break}return f=amp.Player.prototype.getAmpVersion(),!t&&f&&(t=ampURL+f),t};amp.Player.prototype.getAmpVersion=function(){var t=null,i,n;return ampVersion&&(i=new RegExp("([0-9]+.[0-9]+.[0-9]+).[0-9]+"),n=ampVersion.match(i),n&&n.length===2&&(t=n[1])),t};amp.Player.prototype.src=function(n,t){this.one("loadstart",function(){this.techName&&this.techName!=="Html5"||this.removeClass("vjs-loading")});if(this.showPlayerLoad(),t!==undefined&&t.length>0&&(this.options_.tracks=t),n===undefined)throw new Error("Get on src is not supported, please use currentSrc to get the current source.");if(!amp.obj.isArray(n)&&!(n instanceof Object))throw new Error("src is expecting a source object or an array of source objects");n.selected||(this.player().options().sdn={},amp.obj.isArray(n)?this.player().options().sourceList=n:n instanceof Object&&(this.player().options().sourceList=[n]),this.player().trigger(amp.eventName.sourceset));var i=function(){this.techSetupCheck()?n instanceof Object&&n.selected?(this.clearPlaybackOptions(),this.refreshTextTracks(),this.cache_.src=n.src,this.currentType_=n.type||"",this.ready(function(){n.protectionInfo&&(this.options_.playbackOptions.protectionInfo=n.protectionInfo);this.techCall("src",n.src);this.options_.preload=="auto"&&this.load()})):this.sourceList_(UrlRewriter.expandSources(this.player().options().sourceList)):setTimeout(i.bind(this),50)};return i.call(this),this};amp.Player.prototype.techSetupCheck=function(){for(var r,t,n=0,i=this.options_.techOrder;n<i.length;n++)if(r=vjs.capitalize(i[n]),t=window.amp[r],t&&t.setupDone&&!t.setupDone())return!1;return!0};amp.Player.prototype.sourceList_=function(n){var t=this.selectSource(n);t?this.tech&&t.tech===this.techName?t.tech==="FlashSS"&&(JSON.stringify(this.options_.playbackOptions.protectionInfo)!==JSON.stringify(t.source.protectionInfo)||this.tech.isReloadNeeded())?(this.clearPlaybackOptions(),this.refreshTextTracks(),this.loadTech(t.tech,t.source)):(t.source.selected=!0,this.src(t.source)):(this.clearPlaybackOptions(),this.refreshTextTracks(),this.loadTech(t.tech,t.source)):(this.tech&&this.unloadTech(),amp.Player.raiseError.call(this,"amp",amp.Player.getAMPErrorCode.call(this,n)),this.triggerReady())};amp.options.playbackOptions={};amp.Player.prototype.clearPlaybackOptions=function(){this.options_.playbackOptions={}};amp.Player.prototype.getMemoryLog=function(n){return AMP.Logger.getMemoryLog(n)};amp.Player.prototype.updateCurrentPlayerConfigs=function(){var i,n,t,u,r;if(this.player().options_.currentPlayerConfigs||(this.player().options_.currentPlayerConfigs={}),i=amp.Heuristics.findProfile(this.player().options_.heuristicProfile),this.player().options_.heuristicProfile===undefined&&(this.player().options_.heuristicProfile=i.name),n=i?amp.obj.copy(i):{},t=this.player().options_.customPlayerSettings,t&&t.customHeuristicSettings){u={};for(r in t.customHeuristicSettings)hasOwnProp.call(amp.Player._availableSettings.heuristicSettings,r)&&(u[r]=t.customHeuristicSettings[r]);n=amp.obj.merge(n,u)}n.maxBufferInSec<n.preRollInSec&&(n.maxBufferInSec=n.preRollInSec);n.livePlaybackOffsetInSec<n.preRollInSec&&(n.livePlaybackOffsetInSec=n.preRollInSec);this.player().options_.currentPlayerConfigs.currentHeuristicConfigs=n};amp.Player._availableSettings={heuristicSettings:{preRollInSec:0,maxBufferInSec:0,livePlaybackOffsetInSec:0,windowSizeHeuristics:!1}};amp.protectionType={PlayReady:"PlayReady",Widevine:"Widevine",AES:"AES"};amp.StreamingFormatMimeType={Smooth:"application/vnd.ms-sstr+xml",Dash:"application/dash+xml",HLS:"application/vnd.apple.mpegurl"};amp.eventName={canplaythrough:"canplaythrough",durationchange:"durationchange",ended:"ended",error:"error",fullscreenchange:"fullscreenchange",loadstart:"loadstart",loadedmetadata:"loadedmetadata",loadeddata:"loadeddata",pause:"pause",play:"play",playing:"playing",seeked:"seeked",seeking:"seeking",timeupdate:"timeupdate",volumechange:"volumechange",waiting:"waiting",downloadbitratechanged:"downloadbitratechanged",playbackbitratechanged:"playbackbitratechanged",sourceset:"sourceset"};amp.streamEventName={trackselected:"trackselected"};amp.streamListEventName={streamselected:"streamselected",streamindexinvalid:"streamindexinvalid",streamselectnotsupported:"streamselectnotsupported"};amp.errorCode={abortedErrStart:1048576,abortedErrUnknown:1048576,abortedErrNotImplemented:1048577,abortedErrEnd:2097151,networkErrStart:2097152,networkErrUnknown:2097152,networkErrHttpResponseBegin:2097552,networkErrHttpBadUrlFormat:2097552,networkErrHttpUserAuthRequired:2097553,networkErrHttpUserForbidden:2097555,networkErrHttpUrlNotFound:2097556,networkErrHttpNotAllowed:2097557,networkErrHttpPreconditionFailed:2097564,networkErrHttpInternalServerFailure:2097652,networkErrHttpBadGateway:2097654,networkErrHttpServiceUnavailable:2097655,networkErrHttpGatewayTimeout:2097656,networkErrHttpResponseEnd:2097751,networkErrTimeout:2097752,networkErrEnd:3145727,decodeErrStart:3145728,decodeErrUnknown:3145728,decodeErrEnd:4194303,srcErrStart:4194304,srcErrUnknown:4194304,srcErrParsePresentation:4194305,srcErrParseSegment:4194306,srcErrUnsupportedPresentation:4194307,srcErrInvalidSegment:4194308,srcErrEnd:5242879,encryptErrStart:5242880,encryptErrUnknown:5242880,encryptErrDecrypterNotFound:5242881,encryptErrDecrypterInit:5242882,encryptErrDecrypterNotSupported:5242883,encryptErrKeyAcquire:5242884,encryptErrDecryption:5242885,encryptErrLicenseAcquire:5242886,encryptErrEnd:6291455,srcPlayerMismatchStart:6291456,srcPlayerMismatchUnknown:6291456,srcPlayerMismatchFlashNotInstalled:6291457,srcPlayerMismatchSilverlightNotInstalled:6291458,srcPlayerMismatchEnd:7340031,errUnknown:267386880};amp.bufferDataEventName={downloadrequested:"downloadrequested",downloadcompleted:"downloadcompleted",downloadfailed:"downloadfailed"};amp.Player.canSupportFormats=function(n,t){var r=t[n.type],i;if(r){if(!n.protectionInfo)return"maybe";for(i=0;i<n.protectionInfo.length;i++)if(r.indexOf(n.protectionInfo[i].type)!==-1)return"maybe"}return""};amp.Player.prototype.refreshTextTracks=function(){var t,n;if(this.tech){if(this.remoteTextTracks()&&this.remoteTextTracks().tracks_)while(this.remoteTextTracks().tracks_.length>0)this.removeRemoteTextTrack(this.remoteTextTracks().tracks_[0]);for(t=this.options_.tracks||[],n=0;n<t.length;n++)track=t[n],this.player_.addRemoteTextTrack(track);this.options_.tracks.length=0}};amp.Player.raiseError=function(n,t,i){var u=amp.Player.getErrorTechId(n)<<28,r;t&=~4026531840;t|=u;r=new amp.MediaError(t);r.message=i;this.error(r)};amp.Player.getErrorTechId=function(n){switch(n.toLowerCase()){case"amp":return 1;case"azurehtml5js":return 2;case"flashss":return 3;case"silverlightss":return 4;case"html5":return 5;default:return 0}};amp.Player.getErrorUI=function(n){var t=(n.code&267386880)>>20;return 0===t?n.message:6===t?this.options().notSupportedMessage:255===t?"MEDIA_ERR_UNKNOWN":vjs.MediaError.errorTypes[t]||""};amp.ErrorDisplay.prototype.update=function(){var n=this.player().error(),t;n&&(t=amp.Player.getErrorUI.call(this.player(),n),this.contentEl_.innerHTML=vjs.util.htmlEncode(this.localize(t))+"<br>(0x"+n.code.toString(16)+")")};amp.Player.getAMPErrorCode=function(n){for(var t,i,r,e,s,u=amp.errorCode.srcPlayerMismatchUnknown,f=0,o=this.options_.techOrder;f<o.length;f++)if((t=vjs.capitalize(o[f]),i=window.videojs[t],i)&&!i.isSupported())for(r=0,e=n;r<e.length;r++)s=e[r],i.canPlaySource(s)&&(t=="SilverlightSS"?u|=amp.errorCode.srcPlayerMismatchSilverlightNotInstalled:t=="FlashSS"&&(u|=amp.errorCode.srcPlayerMismatchFlashNotInstalled));return u};_logType=AMP.Logger.videoJSLogOverride;amp.Heuristics={};amp.Heuristics.findProfile=function(n){for(var t=[{name:amp.Player.HeuristicProfile.QuickStart,preRollInSec:2,maxBufferInSec:30,livePlaybackOffsetInSec:8,windowSizeHeuristics:!0},{name:amp.Player.HeuristicProfile.HighQuality,preRollInSec:8,maxBufferInSec:30,livePlaybackOffsetInSec:15,windowSizeHeuristics:!1}],i=0;i<t.length;i++)if(t[i].name===n)return t[i];return t[0]};amp.Player.HeuristicProfile={QuickStart:"QuickStart",HighQuality:"HighQuality"};amp.isSilverlightInstalled=function(n){var t,l,f,e,h,o,i,r,s,c,u;n==undefined&&(n=null);t=!1;l=null;try{if(f=null,e=!1,window.ActiveXObject)try{f=new ActiveXObject("AgControl.AgControl");n===null?t=!0:f.IsVersionSupported(n)&&(t=!0);f=null}catch(a){e=!0}else e=!0;if(e&&(h=navigator.plugins["Silverlight Plug-In"],h))if(n===null)t=!0;else{for(o=h.description,o==="1.0.30226.2"&&(o="2.0.30226.2"),i=o.split(".");i.length>3;)i.pop();while(i.length<4)i.push(0);for(r=n.split(".");r.length>4;)r.pop();u=0;do s=parseInt(r[u]),c=parseInt(i[u]),u++;while(u<r.length&&s===c);s<=c&&!isNaN(s)&&(t=!0)}}catch(a){t=!1}return t};amp.SilverlightSS=amp.MediaTechController.extend({init:function(n,t,i){var u=this,s=[],f=[],h=[],e,o,r;n.mediaPlayer=null;this.reset();amp.MediaTechController.call(this,n,t,i);parentEl=t.parentEl;placeHolder=this.el_=amp.createEl("div",{id:n.id()+"_temp_silverlightSS"});objId=n.id()+"_silverlightSS_api";e=n.options_.autoplay;e!==undefined&&f.push("Autoplay="+e);s=amp.obj.merge({id:objId,name:objId,"class":"vjs-tech"},t.attributes);o=amp.Player.getScriptRootURL();!n.options_.silverlightSS.xap&&o&&(n.options_.silverlightSS.xap=o+"/techs/SmoothStreamingPlayer.xap");h=amp.obj.merge({source:n.options_.silverlightSS.xap,onError:"onSilverlightError",minRuntimeVersion:"5.0.61118.0",onload:"silverlightSSLoaded",enableHtmlAccess:!0,width:"100%",height:"100%",windowless:"true",wmode:"opaque",bgcolor:"#000000"},t.params);f.push("ScriptableName=mainPlayer");f.push("IsControlStripVisible=false");r=t.source;amp.insertFirst(placeHolder,parentEl);this.el_=amp.SilverlightSS.embed(placeHolder,s,h,f);silverlightSSLoaded=function(t){var i=document.getElementById(n.id()+"_silverlightSS_api");n.mediaPlayer=i.content.mainPlayer;r&&(r.protectionInfo&&(n.options_.playbackOptions.protectionInfo=r.protectionInfo),u.setSrc(r.src));u.triggerReady();u.setTriggers(t)};onSilverlightError=function(n,t){var f="";n!=null&&n!=0&&(f=n.getHost().Source);var r=t.ErrorType,e=t.ErrorCode,i="Unhandled Error in Silverlight Application "+f+"\n";i+="Code: "+e+"    \n";i+="Category: "+r+"       \n";i+="Message: "+t.ErrorMessage+"     \n";r=="ParserError"?(i+="File: "+t.xamlFile+"     \n",i+="Line: "+t.lineNumber+"     \n",i+="Position: "+t.charPosition+"     \n"):r=="RuntimeError"&&(t.lineNumber!=0&&(i+="Line: "+t.lineNumber+"     \n",i+="Position: "+t.charPosition+"     \n"),i+="MethodName: "+t.methodName+"     \n");amp.Player.raiseError.call(u.player(),"silverlightss",amp.errorCode.errUnknown,i)}}});amp.SilverlightSS.embed=function(n,t,i,r){var f=amp.SilverlightSS.getEmbedCode(t,i,r),u;return obj=amp.createEl("div",{innerHTML:f}).childNodes[0],par=n.parentNode,n.parentNode.replaceChild(obj,n),u=par.childNodes[0],setTimeout(function(){u.style.display="block"},1e3),obj};amp.SilverlightSS.getEmbedCode=function(n,t,i){var r='<object  data="data:application/x-silverlight-2," type="application/x-silverlight-2" ';return amp.obj.each(n,function(n,t){r+=encodeURIComponent(n)+'="'+encodeURIComponent(t)+'" '}),r+=">",t=amp.obj.merge({InitParams:i.join(",")},t),amp.obj.each(t,function(n,t){r+='<param name="'+encodeURIComponent(n)+'" value="'+encodeURI(t)+'" />'}),r+="<\/object>"};amp.SilverlightSS.isSupported=function(){return amp.isSilverlightInstalled("5.0")};amp.SilverlightSS.canPlaySource=function(n){return amp.Player.canSupportFormats(n,this.supportedFormats)};amp.SilverlightSS.supportedFormats={};amp.SilverlightSS.supportedFormats[amp.StreamingFormatMimeType.Smooth]=[amp.protectionType.PlayReady];amp.SilverlightSS._seeking=!1;amp.SilverlightSS._ended=!1;amp.SilverlightSS._opening=!0;amp.SilverlightSS._firstTimeUpdateOccuredAfterOpening=!1;amp.SilverlightSS._adaptiveStreamingError=null;amp.SilverlightSS._networkError="Failed to download";amp.SilverlightSS._licenseError="Unable to acquire license due to a network or protocol error";amp.SilverlightSS._tokenError="Unable to complete operation due to a service specific error coming from a network response";amp.SilverlightSS._parseSegmentError="Too many consecutive chunk parse errors";amp.SilverlightSS._parsePresentationError="Manifest file error";amp.SilverlightSS._unsupportedPresentation="Unrecognized manifest";amp.SilverlightSS._licenseAcquisitionErrorCode="6002";amp.SilverlightSS._licenseAcquisitionServiceSpecificErrorCode="6007";amp.SilverlightSS._downloadBitrate;amp.SilverlightSS._playbackBitrate;amp.SilverlightSS.prototype.autoplay=function(){return this.player().mediaPlayer.AutoPlay};amp.SilverlightSS.prototype.setAutoplay=function(n){this.player().mediaPlayer.AutoPlay=n};amp.SilverlightSS.prototype.isLive=function(){return this.player().mediaPlayer.IsLive};amp.SilverlightSS.prototype.buffered=function(){return amp.createTimeRange(this.currentTime(),this.currentTime())};amp.SilverlightSS.prototype.currentSrc=function(){return this.player().mediaPlayer.MediaSource};amp.SilverlightSS.prototype.setCurrentTime=function(n){try{amp.SilverlightSS._seeking=!0;this.player().trigger(amp.eventName.seeking);this.player().mediaPlayer.SeekToPosition(n)}catch(t){amp.Player.raiseError.call(this.player(),"silverlightss",amp.errorCode.srcErrUnknown,t.message)}};amp.SilverlightSS.prototype.currentTime=function(){return this.player().mediaPlayer.PlaybackPositionSeconds};amp.SilverlightSS.prototype.currentAbsoluteTime=function(){return undefined};amp.SilverlightSS.prototype.currentVideoStreamList=function(){return undefined};amp.SilverlightSS.prototype.currentAudioStreamList=function(){return undefined};amp.SilverlightSS.prototype.videoBufferData=function(){return undefined};amp.SilverlightSS.prototype.audioBufferData=function(){return undefined};amp.SilverlightSS.prototype.currentDownloadBitrate=function(){return amp.SilverlightSS._downloadBitrate};amp.SilverlightSS.prototype.currentPlaybackBitrate=function(){return amp.SilverlightSS._playbackBitrate};amp.SilverlightSS.prototype.duration=function(){return this.player().mediaPlayer.EndPositionSeconds-this.player().mediaPlayer.StartPositionSeconds};amp.SilverlightSS.prototype.ended=function(){return amp.SilverlightSS._ended};amp.SilverlightSS.prototype.error=function(){return this.player().error()};amp.SilverlightSS.prototype.isFullscreen=function(){return this.player().mediaPlayer.isFullscreen};amp.SilverlightSS.prototype.muted=function(){return this.player().mediaPlayer.IsMuted};amp.SilverlightSS.prototype.setMuted=function(n){this.player().mediaPlayer.IsMuted=n};amp.SilverlightSS.prototype.paused=function(){return this.player().mediaPlayer.PlayState===this.SilverlightSSMediaState.Paused||this.player().mediaPlayer.PlayState===this.SilverlightSSMediaState.Buffering};amp.SilverlightSS.prototype.seeking=function(){return amp.SilverlightSS._seeking};amp.SilverlightSS.prototype.src=function(n){if(n===undefined)return this.currentSrc();this.setSrc(n)};amp.SilverlightSS.prototype.volume=function(){return this.player().mediaPlayer.GetVolume()};amp.SilverlightSS.prototype.setVolume=function(n){this.player().mediaPlayer.SetVolume(n)};amp.SilverlightSS.prototype.height=function(n){if(n===undefined)return this.player().mediaPlayer.height;this.player().mediaPlayer.height=n};amp.SilverlightSS.prototype.width=function(n){if(n===undefined)return this.player().mediaPlayer.width;this.player().mediaPlayer.width=n};amp.SilverlightSS.prototype.videoHeight=function(){return this.player().mediaPlayer.VideoHeight};amp.SilverlightSS.prototype.videoWidth=function(){return this.player().mediaPlayer.VideoWidth};amp.SilverlightSS.prototype.play=function(){this.player().mediaPlayer.Play()};amp.SilverlightSS.prototype.pause=function(){this.player().mediaPlayer.Pause()};amp.SilverlightSS.prototype.setSrc=function(n){var u,f,r,t,i;if(this.reset(),this.player().options_.autoplay!==undefined&&(this.player().mediaPlayer.AutoPlay=this.player().options_.autoplay),this.player().updateCurrentPlayerConfigs(),u=this.player().options_.currentPlayerConfigs.currentHeuristicConfigs,this.player().mediaPlayer.BufferingTime=u.preRollInSec,this.player().mediaPlayer.LivePlaybackOffset=u.livePlaybackOffsetInSec,AMP.Logger.setLogConfig(this.player().options_.traceConfig),this.player().mediaPlayer.IsTraceEnabled=this.player().options_.traceConfig&&this.player().options_.traceConfig.maxLogLevel&&this.player().options_.traceConfig.maxLogLevel>0?!0:!1,f=this.player().mediaPlayer.CreatePlaylist(),r=this.player().mediaPlayer.CreatePlaylistItem(n,"","",""),r.DeliveryMethod="AdaptiveStreaming",t=this.player().options_.playbackOptions.protectionInfo,t)for(i=0;i<t.length;i++)t[i].type===amp.protectionType.PlayReady&&t[i].authenticationToken&&(r.BearerToken=t[i].authenticationToken);f.AddPlaylistItem(r);this.player().mediaPlayer.SetPlaylist(f)};amp.SilverlightSS.prototype.load=function(){};amp.SilverlightSS.prototype.supportsFullscreen=function(){return!1};amp.SilverlightSS.prototype.enterFullscreen=function(){};amp.SilverlightSS.prototype.exitFullscreen=function(){};amp.SilverlightSS.prototype.dispose=function(){vjs.MediaTechController.prototype.dispose.call(this)};amp.SilverlightSS.prototype.setTriggers=function(){this.player().mediaPlayer.addEventListener("PlayStateChanged",amp.bind(this,this.playStateChangedHandler));this.player().mediaPlayer.addEventListener("MediaOpened",amp.bind(this,this.onMediaOpened));this.player().mediaPlayer.addEventListener("SeekCompleted",amp.bind(this,this.onSeekCompleted));this.player().mediaPlayer.addEventListener("MediaEnded",amp.bind(this,this.onMediaEnded));this.player().mediaPlayer.addEventListener("PlaybackPositionChanged",amp.bind(this,this.onTimeUpdate));this.player().mediaPlayer.addEventListener("VolumeLevelChanged",amp.bind(this,this.onVolumeChanged));this.player().mediaPlayer.addEventListener("MuteChanged",amp.bind(this,this.onVolumeChanged));this.player().mediaPlayer.addEventListener("MediaFailed",amp.bind(this,this.onMediaFailed));this.player().mediaPlayer.addEventListener("AdaptiveStreamingErrorOccurred",amp.bind(this,this.onAdaptiveStreamingErrorOccurred));this.player().mediaPlayer.addEventListener("ReportDiagTrace",amp.bind(this,this.onReportDiagTrace));this.player().mediaPlayer.addEventListener("DownloadBitrateChanged",amp.bind(this,this.onVideoDownloadBitrateChanged));this.player().mediaPlayer.addEventListener("PlaybackBitrateChanged",amp.bind(this,this.onVideoPlaybackBitrateChanged));this.player().mediaPlayer.addEventListener("FullScreenChanged",amp.bind(this,this.onFullScreenChanged));var n;this.player().mediaPlayer.addEventListener("PlaybackPositionChanged",amp.bind(this,function(){this.duration()!==n&&(n=this.duration(),this.player().trigger(amp.eventName.durationchange));amp.SilverlightSS._firstTimeUpdateOccuredAfterOpening||amp.SilverlightSS._opening||(this.player().trigger(amp.eventName.play),this.player().trigger(amp.eventName.playing),amp.SilverlightSS._firstTimeUpdateOccuredAfterOpening=!0)}))};amp.SilverlightSS.prototype.playStateChangedHandler=function(){switch(this.player().mediaPlayer.PlayState){case this.SilverlightSSMediaState.Playing:amp.SilverlightSS._firstTimeUpdateOccuredAfterOpening&&(this.player().trigger(amp.eventName.play),this.player().trigger(amp.eventName.playing));break;case this.SilverlightSSMediaState.Paused:this.player().trigger(amp.eventName.pause);break;case this.SilverlightSSMediaState.Buffering:amp.SilverlightSS._firstTimeUpdateOccuredAfterOpening||this.player().trigger(amp.eventName.waiting)}};amp.SilverlightSS.prototype.onMediaOpened=function(){amp.SilverlightSS._opening=!1;this.player().trigger(amp.eventName.durationchange);this.player().trigger(amp.eventName.loadstart);this.player().trigger(amp.eventName.loadedmetadata);this.player().trigger(amp.eventName.loadeddata);this.player().trigger(amp.eventName.canplaythrough)};amp.SilverlightSS.prototype.onMediaFailed=function(n,t){var u=t.Result.Message,i=t.Result.Message,r;amp.SilverlightSS._adaptiveStreamingError&&(u+=": "+amp.SilverlightSS._adaptiveStreamingError.Message,i=amp.SilverlightSS._adaptiveStreamingError.Message);r=amp.errorCode.errUnknown;i.indexOf(amp.SilverlightSS._networkError)!=-1?r=amp.errorCode.networkErrUnknown:i.indexOf(amp.SilverlightSS._licenseError)!=-1||i.indexOf(amp.SilverlightSS._licenseAcquisitionErrorCode)!=-1||i.indexOf(amp.SilverlightSS._tokenError)!=-1||i.indexOf(amp.SilverlightSS._licenseAcquisitionServiceSpecificErrorCode)!=-1?r=amp.errorCode.encryptErrLicenseAcquire:i.indexOf(amp.SilverlightSS._parseSegmentError)!=-1?r=amp.errorCode.srcErrParseSegment:i.indexOf(amp.SilverlightSS._parsePresentationError)!=-1?r=amp.errorCode.srcErrParsePresentation:i.indexOf(amp.SilverlightSS._unsupportedPresentation)!=-1&&(r=amp.errorCode.srcErrUnsupportedPresentation);amp.Player.raiseError.call(this.player(),"silverlightss",r,u)};amp.SilverlightSS.prototype.onAdaptiveStreamingErrorOccurred=function(n,t){amp.SilverlightSS._adaptiveStreamingError=t.Result};amp.SilverlightSS.prototype.onSeekCompleted=function(){amp.SilverlightSS._seeking=!1;this.player().trigger(amp.eventName.seeked)};amp.SilverlightSS.prototype.onMediaEnded=function(){amp.SilverlightSS._ended=!0;this.player().trigger(amp.eventName.ended)};amp.SilverlightSS.prototype.onTimeUpdate=function(){this.player().trigger(amp.eventName.timeupdate)};amp.SilverlightSS.prototype.onFullScreenChanged=function(){this.player().trigger(amp.eventName.fullscreenchange)};amp.SilverlightSS.prototype.onVolumeChanged=function(){this.player().trigger(amp.eventName.volumechange)};amp.SilverlightSS.prototype.onReportDiagTrace=function(n,t){AMP.Logger.verbose(AMP.Logger.Area.silverlightSS,t.Result)};amp.SilverlightSS.prototype.onVideoDownloadBitrateChanged=function(n,t){amp.SilverlightSS._downloadBitrate=t.Result;this.player().trigger(amp.eventName.downloadbitratechanged)};amp.SilverlightSS.prototype.onVideoPlaybackBitrateChanged=function(n,t){amp.SilverlightSS._playbackBitrate=t.Result;this.player().trigger(amp.eventName.playbackbitratechanged)};amp.SilverlightSS.prototype.reset=function(){amp.SilverlightSS._seeking=!1;amp.SilverlightSS._ended=!1;amp.SilverlightSS._opening=!0;amp.SilverlightSS._firstTimeUpdateOccuredAfterOpening=!1;amp.SilverlightSS._adaptiveStreamingError=null};amp.SilverlightSS.prototype.SilverlightSSMediaState={Closed:0,Opening:1,Buffering:2,Playing:3,Paused:4,Stopped:5,Individualizing:6,AcquiringLicense:7};amp.options.techOrder.unshift("silverlightSS");amp.options.silverlightSS={};amp.FlashSS=amp.MediaTechController.extend({init:function(n,t,i){var s,o,e;amp.MediaTechController.call(this,n,t,i);s=amp.Player.getScriptRootURL();!n.options_.flashSS.swf&&s&&(n.options_.flashSS.swf=s+"/techs/StrobeMediaPlayback.2.0.swf");var f=t.source,l=t.parentEl,h=this.el_=amp.createEl("div",{id:n.id()+"_temp_flash"}),c=n.id()+"_flashSS_api",u=n.options_,r=amp.obj.merge({playerId:n.id(),controlBarMode:"none",playButtonOverlay:"false",bufferingOverlay:"false",AdaptiveStreamingPlugin_retryLive:"true",autoPlay:!0,preload:u.preload,loop:u.loop,muted:u.muted},t.flashVars),a=amp.obj.merge({menu:!1,wmode:"opaque",bgcolor:"#000000"},t.params),v=amp.obj.merge({id:c,name:c,"class":"vjs-tech"},t.attributes);if(t.swf=u.flashSS.swf,n.flashSS=this,n.flashSS.lastSeekTarget_=NaN,this.reset(),f&&(amp.FlashSS._src=f.src,r.src=amp.getAbsoluteURL(f.src),f.protectionInfo)){for(o=0;o<f.protectionInfo.length;o++)f.protectionInfo[o].type===amp.protectionType.AES&&f.protectionInfo[o].authenticationToken&&(r.AdaptiveStreamingPlugin_encryptionKeyToken=f.protectionInfo[o].authenticationToken);u.playbackOptions.protectionInfo=f.protectionInfo}if(this.player().updateCurrentPlayerConfigs(),e=u.currentPlayerConfigs.currentHeuristicConfigs,r.AdaptiveStreamingPlugin_minimumBufferTimeInSeconds=e.preRollInSec,r.AdaptiveStreamingPlugin_maximumBufferTimeInSeconds=e.maxBufferInSec,r.AdaptiveStreamingPlugin_livePlaybackOffsetInSecond=e.livePlaybackOffsetInSec,amp.FlashSS._heuristicSettings.minimumBufferTimeInSeconds=e.preRollInSec,amp.FlashSS._heuristicSettings.maximumBufferTimeInSeconds=e.maxBufferInSec,amp.FlashSS._heuristicSettings.livePlaybackOffsetInSecond=e.livePlaybackOffsetInSec,amp.FlashSS._isTraceEnabled=u.isTraceEnabled,AMP.Logger.setLogConfig(u.traceConfig),u.traceConfig&&u.traceConfig.maxLogLevel){r.AdaptiveStreamingPlugin_enableOSMFLogging=!0;org.osmf.player.debug.logs=amp.FlashSS.onLogMessage;switch(u.traceConfig.maxLogLevel){case 0:r.AdaptiveStreamingPlugin_minimalLogLevel=0;r.AdaptiveStreamingPlugin_enableOSMFLogging=!1;org.osmf.player.debug.logs=undefined;break;case 1:r.AdaptiveStreamingPlugin_minimalLogLevel=2;break;case 2:r.AdaptiveStreamingPlugin_minimalLogLevel=1;break;case 3:r.AdaptiveStreamingPlugin_minimalLogLevel=0;break;default:r.AdaptiveStreamingPlugin_minimalLogLevel=0}}else r.AdaptiveStreamingPlugin_enableOSMFLogging=!1,org.osmf.player.debug.logs=undefined;amp.FlashSS._traceConfig=u.traceConfig;amp.insertFirst(h,l);t.startTime&&this.ready(function(){this.load();this.play();this.currentTime(t.startTime)});amp.IS_FIREFOX&&this.ready(function(){amp.on(this.el(),"mousemove",amp.bind(this,function(){this.player().trigger({type:"mousemove",bubbles:!1})}))});n.on("stageclick",n.reportUserActivity);this.el_=amp.Flash.embed(t.swf,h,r,a,v)}});typeof org=="undefined"&&(org={});typeof org.osmf=="undefined"&&(org.osmf={});typeof org.osmf.player=="undefined"&&(org.osmf.player={});typeof org.osmf.player.debug=="undefined"&&(org.osmf.player.debug={});amp.FlashSS.onLogMessage=function(n){for(var i=n.split("###"),t=0;t<i.length;t++)AMP.Logger.verbose(AMP.Logger.Area.flashSS,i[t])};amp.FlashSS.isSupported=function(){return amp.Flash.isSupported()};amp.FlashSS.canPlaySource=function(n){return amp.Player.canSupportFormats(n,this.supportedFormats)};amp.FlashSS.supportedFormats={};amp.FlashSS.supportedFormats[amp.StreamingFormatMimeType.Smooth]=[amp.protectionType.AES];amp.FlashSS.prototype.dispose=function(){amp.MediaTechController.prototype.dispose.call(this)};amp.FlashSS.prototype.autoplay=function(){return this.player().options_.autoplay};amp.FlashSS.prototype.setAutoplay=function(){};amp.FlashSS.prototype.isLive=function(){return this.el_.getStreamType()==="dvr"?!0:!1};amp.FlashSS.prototype.buffered=function(){return amp.createTimeRange(this.currentTime(),this.currentTime()+this.el_.getBufferLength())};amp.FlashSS.prototype.setCurrentTime=function(n){n=n<=this.duration()?n:this.duration();n=n>0?n:0;this.lastSeekTarget_=n;this.el_.setCurrentTime(n)};amp.FlashSS.prototype.currentTime=function(){return this.seeking()?this.lastSeekTarget_||0:this.el_.getCurrentTime()};amp.FlashSS.prototype.currentAbsoluteTime=function(){return undefined};amp.FlashSS.prototype.currentVideoStreamList=function(){return amp.FlashSS._currentVideoStreamList};amp.FlashSS.prototype.currentAudioStreamList=function(){return amp.FlashSS._currentAudioStreamList};amp.FlashSS.prototype.videoBufferData=function(){return undefined};amp.FlashSS.prototype.audioBufferData=function(){return undefined};amp.FlashSS.prototype.currentDownloadBitrate=function(){if(amp.FlashSS._currentVideoStreamList){var n=this.el_.getCurrentDynamicStreamIndex();return amp.FlashSS._currentVideoStreamList.streams[0].tracks[n].bitrate}return undefined};amp.FlashSS.prototype.currentPlaybackBitrate=function(){return undefined};amp.FlashSS.prototype.ended=function(){return amp.FlashSS._ended};amp.FlashSS.prototype.isFullscreen=function(){return this.player().isFullscreen()};amp.FlashSS.prototype.src=function(n){if(n===undefined)return this.currentSrc();this.reset();amp.FlashSS._src=n;this.el_.setAutoPlay(!0);this.el_.setMediaResourceURL(amp.getAbsoluteURL(n))},function(){function f(n){var t=n.charAt(0).toUpperCase()+n.slice(1);i["set"+t]=function(n){return this.el_["set"+t](n)}}function u(n){i[n]=function(){var t=n.charAt(0).toUpperCase()+n.slice(1);return this.el_["get"+t]()}}for(var i=amp.FlashSS.prototype,t="controls,muted,volume".split(","),r="currentSrc,duration,paused,seeking,videoHeight,videoWidth".split(","),n=0;n<t.length;n++)u(t[n]),f(t[n]);for(n=0;n<r.length;n++)u(r[n])}();amp.FlashSS.prototype.load=function(){this.el_.load()};amp.FlashSS.prototype.play=function(){this.el_.play2()};amp.FlashSS.prototype.pause=function(){this.el_.pause()};amp.FlashSS.prototype.supportsFullScreen=function(){return!1};amp.FlashSS.prototype.enterFullScreen=function(){return!1};amp.FlashSS.onReady=function(n){AMP.Logger.verbose(AMP.Logger.Area.flashSS,n+" - Ready");var t,i;t=amp.el(n);this.el_=t;i=t&&t.parentNode&&t.parentNode.player;i&&(t.player=i,amp.FlashSS.checkReady(i.flashSS))};amp.FlashSS.checkReady=function(n){return n.el()?n.el().getBufferTime?(n.triggerReady(),!0):(setTimeout(function(){amp.FlashSS.checkReady(n)},50),!1):!1};amp.FlashSS._firstReady=!0;amp.FlashSS._src=null;amp.FlashSS._ended=!1;amp.FlashSS._heuristicSettings={};amp.FlashSS._currentVideoStreamList=undefined;amp.FlashSS._currentAudioStreamList=undefined;amp.FlashSS._traceConfig=undefined;amp.FlashSS._passThroughEvents=["seeking","durationchange","loadstart","waiting","volumechange"];amp.FlashSS.onEvent=function(n,t,i){try{var r=amp.el(n).player;amp.FlashSS._passThroughEvents.indexOf(t)!==-1&&r.trigger(t);switch(t){case"onJavaScriptBridgeCreated":amp.FlashSS.onReady(n);break;case"complete":amp.FlashSS._ended=!0;r.trigger("ended");break;case"emptied":amp.FlashSS._firstReady&&(amp.FlashSS._currentVideoStreamList||(amp.FlashSS._currentVideoStreamList=new AMP.FlashSS.VideoStreamList(r.flashSS.el_),amp.FlashSS._currentAudioStreamList=new AMP.FlashSS.AudioStreamList(r.flashSS.el_),amp.FlashSS._currentAudioStreamList.streams.length==0&&(amp.FlashSS._currentAudioStreamList=undefined)),r.trigger("loadeddata"),r.trigger("loadedmetadata"),amp.FlashSS._firstReady=!1,r.flashSS.el_.setAutoDynamicStreamSwitch(!0));break;case"play":r.options_.autoplay||r.flashSS.firstPlayingOccurredWithAutoplayFalse_?(r.flashSS.firstPlayingOccurredWithAutoplayFalse_||(r.trigger("canplaythrough"),r.flashSS.firstPlayingOccurredWithAutoplayFalse_=!0),r.trigger("play"),r.trigger("playing")):(r.pause(),r.trigger("canplaythrough"),r.flashSS.firstPlayingOccurredWithAutoplayFalse_=!0);break;case"pause":r.flashSS.firstPlayingOccurredWithAutoplayFalse_&&r.trigger("pause");break;case"seeked":r.flashSS.firstPlayingOccurredWithAutoplayFalse_&&r.trigger("seeked");break;case"timeupdate":r.flashSS.firstPlayingOccurredWithAutoplayFalse_&&(!r.flashSS.el_.getPaused()||r.flashSS.isLive())&&r.trigger("timeupdate");break;case"error":r.currentSrc()&&(amp.Player.raiseError.call(r,"flashss",amp.FlashSS.getMediaErrorCode(i.code),amp.FlashSS.getMediaErrorMsg(i.code)),r.flashSS.firstPlayingOccurredWithAutoplayFalse_=!1)}"timeupdate"!==t&&"progress"!==t&&AMP.Logger.verbose(AMP.Logger.Area.flashSS,n+" - Event:"+t)}catch(u){AMP.Logger.error(AMP.Logger.Area.flashSS,n+" - Event:"+t+" - error:"+u);throw u;}};amp.FlashSS.getMediaErrorCode=function(n){switch(n){case amp.FlashSS.errorCodes.OSMF_HTTP_GET_FAILED:case amp.FlashSS.errorCodes.OSMF_NETCONNECTION_REJECTED:case amp.FlashSS.errorCodes.OSMF_NETCONNECTION_APPLICATION_INVALID:case amp.FlashSS.errorCodes.OSMF_NETCONNECTION_FAILED:case amp.FlashSS.errorCodes.FRAGMENT_DOWNLOAD_ERROR:case amp.FlashSS.errorCodes.MANIFEST_DOWNLOAD_ERROR:return amp.errorCode.networkErrUnknown;case amp.FlashSS.errorCodes.OSMF_NETCONNECTION_TIMEOUT:case amp.FlashSS.errorCodes.MANIFEST_DOWNLOAD_TIMEOUT:case amp.FlashSS.errorCodes.FRAGMENT_DOWNLOAD_TIMEOUT:return amp.errorCode.networkErrTimeout;case amp.FlashSS.errorCodes.MANIFEST_NOT_SUPPORTED_ELEMENT:case amp.FlashSS.errorCodes.MANIFEST_NOT_SUPPORTED_AUDIO_TRACK:case amp.FlashSS.errorCodes.MANIFEST_NOT_SUPPORTED_VIDEO_TRACK:case amp.FlashSS.errorCodes.VIDEO_STREAM_MISSING:case amp.FlashSS.errorCodes.MANIFEST_LIVE_DVRWINDOWLENGTH_TOO_SMALL:case amp.FlashSS.errorCodes.TOO_EARLY_TO_JOIN_LIVE_EVENT:return amp.errorCode.srcErrUnsupportedPresentation;case amp.FlashSS.errorCodes.MANIFEST_PARSE_TIMEOUT:case amp.FlashSS.errorCodes.MANIFEST_MAJOR_VERSION_MISSING:case amp.FlashSS.errorCodes.MANIFEST_MINOR_VERSION_MISSING:case amp.FlashSS.errorCodes.MANIFEST_STREAMINDEX_MISSING:case amp.FlashSS.errorCodes.MANIFEST_UNEXPECTED_ROOT_ELEMENT:case amp.FlashSS.errorCodes.MANIFEST_UNEXPECTED_ROOT_ATTRIBUTE:case amp.FlashSS.errorCodes.MANIFEST_STREAMINFO_TYPE_MISSING:case amp.FlashSS.errorCodes.MANIFEST_STREAMINFO_URL_MISSING:case amp.FlashSS.errorCodes.MANIFEST_CHUNK_ATTRIBUTE_MISSING:case amp.FlashSS.errorCodes.MANIFEST_INVALID_ATTRIBUTE_VALUE:case amp.FlashSS.errorCodes.INVALID_SMOOTH_DYNAMIC_RESOURCE:case amp.FlashSS.errorCodes.MANIFEST_AUDIO_QUALITYLEVEL_BITRATE_MISSING:case amp.FlashSS.errorCodes.MANIFEST_AUDIO_QUALITYLEVEL_AUDIOTAG_MISSING:case amp.FlashSS.errorCodes.MANIFEST_VIDEO_QUALITYLEVEL_BITRATE_MISSING:case amp.FlashSS.errorCodes.MANIFEST_VIDEO_QUALITYLEVEL_FOURCC_MISSING:case amp.FlashSS.errorCodes.MANIFEST_VIDEO_QUALITYLEVEL_MAXWIDTH_MISSING:case amp.FlashSS.errorCodes.MANIFEST_VIDEO_QUALITYLEVEL_MAXHEIGHT_MISSING:case amp.FlashSS.errorCodes.MANIFEST_UNEXPECTED_PROTECTION_HEADER:case amp.FlashSS.errorCodes.MANIFEST_LIVE_LOOKAHEADFRAGMENTCOUNT_MISSING:return amp.errorCode.srcErrParsePresentation;case amp.FlashSS.errorCodes.OSMF_NETSTREAM_PLAY_FAILED:case amp.FlashSS.errorCodes.OSMF_NETSTREAM_FILE_STRUCTURE_INVALID:case amp.FlashSS.errorCodes.OSMF_IO_ERROR:case amp.FlashSS.errorCodes.OSMF_SECURITY_ERROR:case amp.FlashSS.errorCodes.OSMF_ASYNC_ERROR:case amp.FlashSS.errorCodes.OSMF_ARGUMENT_ERROR:case amp.FlashSS.errorCodes.OSMF_URL_SCHEME_INVALID:case amp.FlashSS.errorCodes.OSMF_MEDIA_LOAD_FAILED:case amp.FlashSS.errorCodes.OSMF_PLUGIN_VERSION_INVALID:case amp.FlashSS.errorCodes.OSMF_PLUGIN_IMPLEMENTATION_INVALID:case amp.FlashSS.errorCodes.OSMF_SOUND_PLAY_FAILED:case amp.FlashSS.errorCodes.OSMF_NETSTREAM_STREAM_NOT_FOUND:case amp.FlashSS.errorCodes.OSMF_DVRCAST_SUBSCRIBE_FAILED:case amp.FlashSS.errorCodes.OSMF_DVRCAST_CONTENT_OFFLINE:case amp.FlashSS.errorCodes.OSMF_DVRCAST_STREAM_INFO_RETRIEVAL_FAILED:case amp.FlashSS.errorCodes.OSMF_F4M_FILE_INVALID:case amp.FlashSS.errorCodes.CANNOT_SET_AUDIO_STREAM_INDEX:case amp.FlashSS.errorCodes.PLUGIN_INVALID_PARAM:case amp.FlashSS.errorCodes.PLUGIN_NULL_PARAM:return amp.errorCode.srcErrUnknown;case amp.FlashSS.errorCodes.ENCRYPTIONKEY_DOWNLOAD_ERROR:case amp.FlashSS.errorCodes.ENCRYPTIONKEY_DOWNLOAD_AUTH_ERROR:case amp.FlashSS.errorCodes.ENCRYPTIONKEY_DOWNLOAD_TIMEOUT:case amp.FlashSS.errorCodes.ENCRYPTIONKEYURL_TOKEN_VERIFICATION_ERROR:return amp.errorCode.encryptErrKeyAcquire;case amp.FlashSS.errorCodes.FRAGMENT_DECRYPT_ERROR:return amp.errorCode.encryptErrDecryption;default:return amp.errorCode.errUnknown}};amp.FlashSS.errorCodes={OSMF_IO_ERROR:1,OSMF_SECURITY_ERROR:2,OSMF_ASYNC_ERROR:3,OSMF_ARGUMENT_ERROR:4,OSMF_URL_SCHEME_INVALID:5,OSMF_HTTP_GET_FAILED:6,OSMF_MEDIA_LOAD_FAILED:7,OSMF_PLUGIN_VERSION_INVALID:8,OSMF_PLUGIN_IMPLEMENTATION_INVALID:9,OSMF_SOUND_PLAY_FAILED:10,OSMF_NETCONNECTION_REJECTED:11,OSMF_NETCONNECTION_APPLICATION_INVALID:12,OSMF_NETCONNECTION_FAILED:13,OSMF_NETCONNECTION_TIMEOUT:14,OSMF_NETSTREAM_PLAY_FAILED:15,OSMF_NETSTREAM_STREAM_NOT_FOUND:16,OSMF_NETSTREAM_FILE_STRUCTURE_INVALID:17,OSMF_NETSTREAM_NO_SUPPORTED_TRACK_FOUND:18,OSMF_DRM_SYSTEM_UPDATE_ERROR:19,OSMF_DVRCAST_SUBSCRIBE_FAILED:20,OSMF_DVRCAST_CONTENT_OFFLINE:21,OSMF_DVRCAST_STREAM_INFO_RETRIEVAL_FAILED:22,OSMF_F4M_FILE_INVALID:23,MANIFEST_DOWNLOAD_TIMEOUT:1e3,MANIFEST_PARSE_TIMEOUT:1001,MANIFEST_DOWNLOAD_ERROR:1002,MANIFEST_MAJOR_VERSION_MISSING:1003,MANIFEST_MINOR_VERSION_MISSING:1004,MANIFEST_STREAMINDEX_MISSING:1005,MANIFEST_UNEXPECTED_ROOT_ELEMENT:1006,MANIFEST_UNEXPECTED_ROOT_ATTRIBUTE:1007,MANIFEST_STREAMINFO_TYPE_MISSING:1008,MANIFEST_STREAMINFO_URL_MISSING:1009,MANIFEST_AUDIO_QUALITYLEVEL_BITRATE_MISSING:1010,MANIFEST_AUDIO_QUALITYLEVEL_AUDIOTAG_MISSING:1011,MANIFEST_VIDEO_QUALITYLEVEL_BITRATE_MISSING:1012,MANIFEST_VIDEO_QUALITYLEVEL_FOURCC_MISSING:1013,MANIFEST_VIDEO_QUALITYLEVEL_MAXWIDTH_MISSING:1014,MANIFEST_VIDEO_QUALITYLEVEL_MAXHEIGHT_MISSING:1015,MANIFEST_CHUNK_ATTRIBUTE_MISSING:1016,MANIFEST_NOT_SUPPORTED_ELEMENT:1017,MANIFEST_NOT_SUPPORTED_AUDIO_TRACK:1018,MANIFEST_NOT_SUPPORTED_VIDEO_TRACK:1019,MANIFEST_INVALID_ATTRIBUTE_VALUE:1020,INVALID_SMOOTH_DYNAMIC_RESOURCE:1021,FRAGMENT_DOWNLOAD_TIMEOUT:1022,FRAGMENT_DOWNLOAD_ERROR:1023,CANNOT_SET_AUDIO_STREAM_INDEX:1024,VIDEO_STREAM_MISSING:1025,MANIFEST_LIVE_LOOKAHEADFRAGMENTCOUNT_MISSING:1026,PLUGIN_INVALID_PARAM:1027,PLUGIN_NULL_PARAM:1028,MANIFEST_LIVE_DVRWINDOWLENGTH_TOO_SMALL:1029,TOO_EARLY_TO_JOIN_LIVE_EVENT:1030,MANIFEST_UNEXPECTED_PROTECTION_HEADER:1048,ENCRYPTIONKEY_DOWNLOAD_ERROR:1049,ENCRYPTIONKEY_DOWNLOAD_AUTH_ERROR:1050,ENCRYPTIONKEY_DOWNLOAD_TIMEOUT:1051,ENCRYPTIONKEYURL_TOKEN_VERIFICATION_ERROR:1052,FRAGMENT_DECRYPT_ERROR:1053};amp.FlashSS.getMediaErrorMsg=function(n){for(var t in amp.FlashSS.errorCodes)if(amp.FlashSS.errorCodes.hasOwnProperty(t)&&amp.FlashSS.errorCodes[t]===n)return t;return n};amp.FlashSS.prototype.reset=function(){amp.FlashSS._firstReady=!0;amp.FlashSS._ended=!1;amp.FlashSS._src=null;amp.FlashSS._currentVideoStreamList=undefined;amp.FlashSS._currentAudioStreamList=undefined;this.player().flashSS.firstPlayingOccurredWithAutoplayFalse_=!1};amp.FlashSS.prototype.isReloadNeeded=function(){var n=this.player().options_.currentPlayerConfigs;return amp.FlashSS._src==null||!n||!n.currentHeuristicConfigs||amp.FlashSS._heuristicSettings.minimumBufferTimeInSeconds!==n.currentHeuristicConfigs.preRollInSec||amp.FlashSS._heuristicSettings.maximumBufferTimeInSeconds!==n.currentHeuristicConfigs.maxBufferInSec||amp.FlashSS._heuristicSettings.livePlaybackOffsetInSecond!==n.currentHeuristicConfigs.livePlaybackOffsetInSec||amp.FlashSS._traceConfig!==this.player().options_.traceConfig?!0:!1};amp.options.techOrder.unshift("flashSS");amp.options.flashSS={};amp.AzureHtml5JS=amp.MediaTechController.extend({init:function(n,t,i){var r,u;this.movingMediaElementInDOM=!amp.IS_IOS;this.playbackRate=!1;this.fullscreenResize=!0;this.progressEvents=!1;this.volumeControl=!0;r=t.source;amp.MediaTechController.call(this,n,t,i);this.el().controls=!1;AzureHtml5JS.Log.setLoggerFunction(AMP.Logger.writeEntry,AMP.Logger.Area.azureHtml5JS);u=AzureHtml5JS.CreateAzureHtml5(this.el());n.mediaPlayer=u;this.setupTriggers(u);r&&this.src!==r.src&&(r.protectionInfo&&(n.options_.playbackOptions.protectionInfo=r.protectionInfo),this.setSrc(r.src));amp.TOUCH_ENABLED&&n.options().nativeControlsForTouch!==!1&&this.useNativeControls();this.triggerReady()}});amp.AzureHtml5JS.prototype.createEl=function(){var t=this.player_,n=t.tag,e,u,i,r,f;for(n&&this.features.movingMediaElementInDOM!==!1||(n?(e=n.cloneNode(!1),amp.Html5.disposeMediaElement(n),n=e,t.tag=null):(n=amp.createEl("video"),amp.setElementAttributes(n,amp.obj.merge({},{id:t.id()+"_html5_api","class":"vjs-tech"}))),n.player=t,t.tag=n,amp.insertFirst(n,t.el())),amp.setElementAttributes(n,{oncontextmenu:"return false;"}),u=["preload","loop"],i=u.length-1;i>=0;i--)r=u[i],f={},typeof t.options_[r]!="undefined"&&(f[r]=t.options_[r]),amp.setElementAttributes(n,f);return n};amp.AzureHtml5JS.isSupported=function(){return!!window.MediaSource&&!amp.IS_SAFARI};amp.AzureHtml5JS.canPlaySource=function(n){return amp.Player.canSupportFormats(n,this.supportedFormats)};amp.AzureHtml5JS.supportedFormats={};amp.AzureHtml5JS.supportedFormats[amp.StreamingFormatMimeType.Dash]=[amp.protectionType.AES];amp.AzureHtml5JS._playReadyKeySystemName="com.microsoft.playready";amp.AzureHtml5JS._widevineKeySystemName="com.widevine.alpha";amp.AzureHtml5JS._defaultVideoCodecMime="video/mp4";amp.AzureHtml5JS._playReadyCheck=!1;amp.AzureHtml5JS._widevineCheck=!1;AzureHtml5JS.EmeUtil.isTypeSupported(amp.AzureHtml5JS._playReadyKeySystemName,amp.AzureHtml5JS._defaultVideoCodecMime).then(function(){amp.AzureHtml5JS.supportedFormats[amp.StreamingFormatMimeType.Dash].push(amp.protectionType.PlayReady);amp.AzureHtml5JS._playReadyCheck=!0},function(){amp.AzureHtml5JS._playReadyCheck=!0});AzureHtml5JS.EmeUtil.isTypeSupported(amp.AzureHtml5JS._widevineKeySystemName,amp.AzureHtml5JS._defaultVideoCodecMime).then(function(){amp.AzureHtml5JS.supportedFormats[amp.StreamingFormatMimeType.Dash].push(amp.protectionType.Widevine);amp.AzureHtml5JS._widevineCheck=!0},function(){amp.AzureHtml5JS._widevineCheck=!0});amp.AzureHtml5JS.setupDone=function(){return amp.AzureHtml5JS._playReadyCheck&&amp.AzureHtml5JS._widevineCheck};amp.AzureHtml5JS.prototype.useNativeControls=function(){var t,n,i,r,u;t=this;n=this.player();t.setControls(n.controls());i=function(){t.setControls(!0)};r=function(){t.setControls(!1)};n.on("controlsenabled",i);n.on("controlsdisabled",r);u=function(){n.off("controlsenabled",i);n.off("controlsdisabled",r)};t.on("dispose",u);n.on("usingcustomcontrols",u);n.usingNativeControls(!0)};amp.AzureHtml5JS.prototype.autoplay=function(){return this.player().mediaPlayer.autoplay};amp.AzureHtml5JS.prototype.setAutoplay=function(n){this.player().options_.autoplay=n};amp.AzureHtml5JS.prototype.buffered=function(){return this.player().mediaPlayer.buffered};amp.AzureHtml5JS.prototype.currentSrc=function(){return this.src()};amp.AzureHtml5JS.prototype.isLive=function(){return this.player().mediaPlayer.isLive};amp.AzureHtml5JS.prototype.setCurrentTime=function(n){this.player().mediaPlayer.currentTime=n};amp.AzureHtml5JS.prototype.currentTime=function(){return this.player().mediaPlayer.currentTime};amp.AzureHtml5JS.prototype.currentAbsoluteTime=function(){return this.player().mediaPlayer.currentAbsoluteTime};amp.AzureHtml5JS.prototype.currentType=function(){return this.player().mediaPlayer.type};amp.AzureHtml5JS.prototype.currentVideoStreamList=function(){return this.player().mediaPlayer.currentVideoStreamList};amp.AzureHtml5JS.prototype.currentAudioStreamList=function(){return this.player().mediaPlayer.currentAudioStreamList};amp.AzureHtml5JS.prototype.videoBufferData=function(){return this.player().mediaPlayer.videoBufferData};amp.AzureHtml5JS.prototype.audioBufferData=function(){return this.player().mediaPlayer.audioBufferData};amp.AzureHtml5JS.prototype.currentDownloadBitrate=function(){return this.player().mediaPlayer.currentDownloadBitrate};amp.AzureHtml5JS.prototype.currentPlaybackBitrate=function(){return this.player().mediaPlayer.currentPlaybackBitrate};amp.AzureHtml5JS.prototype.duration=function(){return this.player().mediaPlayer.duration};amp.AzureHtml5JS.prototype.ended=function(){return this.player().mediaPlayer.ended};amp.AzureHtml5JS.prototype.error=function(){return this.player().error()};amp.AzureHtml5JS.prototype.isFullScreen=function(){return this.player().mediaPlayer.isFullScreen};amp.AzureHtml5JS.prototype.muted=function(){return this.player().mediaPlayer.volume===0};amp.AzureHtml5JS.prototype.setMuted=function(n){n&&!this.muted()&&this.setVolume(0)};amp.AzureHtml5JS.prototype.paused=function(){return this.player().mediaPlayer.paused};amp.AzureHtml5JS.prototype.seeking=function(){return this.player().mediaPlayer.seeking};amp.AzureHtml5JS.prototype.src=function(n){if(n===undefined)return this.player().mediaPlayer.src;this.setSrc(n)};amp.AzureHtml5JS.prototype.volume=function(){return this.player().mediaPlayer.volume};amp.AzureHtml5JS.prototype.setVolume=function(n){this.player().mediaPlayer.volume=n};amp.AzureHtml5JS.prototype.height=function(n){if(n===undefined)return this.player().mediaPlayer.height;this.player().mediaPlayer.height=n};amp.AzureHtml5JS.prototype.width=function(n){if(n===undefined)return this.player().mediaPlayer.width;this.player().mediaPlayer.width=n};amp.AzureHtml5JS.prototype.videoHeight=function(){return this.player().mediaPlayer.videoHeight};amp.AzureHtml5JS.prototype.videoWidth=function(){return this.player().mediaPlayer.videoWidth};amp.AzureHtml5JS.prototype.play=function(){this.player().mediaPlayer.play()};amp.AzureHtml5JS.prototype.pause=function(){this.player().mediaPlayer.pause()};amp.AzureHtml5JS.prototype.setSrc=function(n){var f={type:this.player().currentType()},r,u,t,e,i;if(this.player().options_.autoplay!==undefined&&(f=amp.obj.merge({autoPlay:this.player().options_.autoplay},f)),this.player().updateCurrentPlayerConfigs(),AMP.Logger.setLogConfig(this.player().options_.traceConfig),this.player().options_.traceConfig&&AzureHtml5JS.Log.setConsoleOutputByLevel(this.player().options_.traceConfig.maxLogLevel),r={},u=this.player().options_.currentPlayerConfigs.currentHeuristicConfigs,r.maxBufferInSec=u.maxBufferInSec,r.prerollPercent=u.preRollInSec/u.maxBufferInSec,r.livePlaybackOffsetPercent=(u.livePlaybackOffsetInSec-u.preRollInSec)/u.maxBufferInSec,r.windowSizeHeuristicsEnabled=u.windowSizeHeuristics,amp.options.azureHtml5JS.maxSkipSegments&&(r.maxSkipSegments=amp.options.azureHtml5JS.maxSkipSegments),this.player().options_.heuristicProfile==="QuickStart"&&(r.preFetchDataEnabled=!1),f.userConfig=r,t=this.player().options_.playbackOptions.protectionInfo,e=null,t){for(i=0;i<t.length;i++)(t[i].type===amp.protectionType.PlayReady||t[i].type===amp.protectionType.Widevine||t[i].type===amp.protectionType.AES)&&t[i].authenticationToken&&(e||(e={}),e[t[i].type]=t[i].authenticationToken);e&&(f=amp.obj.merge({authenticationTokens:e},f))}this.player().mediaPlayer.setSrc(n,f)};amp.AzureHtml5JS.prototype.load=function(){};amp.AzureHtml5JS.prototype.supportsFullScreen=function(){return!0};amp.AzureHtml5JS.prototype.enterFullScreen=function(){this.player().mediaPlayer.requestFullScreen()};amp.AzureHtml5JS.prototype.exitFullScreen=function(){this.player().mediaPlayer.exitFullscreen()};amp.AzureHtml5JS.prototype.dispose=function(){vjs.Html5.disposeMediaElement(this.el_);vjs.MediaTechController.prototype.dispose.call(this);this.player().mediaPlayer.dispose()};amp.AzureHtml5JS.prototype.setupTriggers=function(n){n.addEventListener(AzureHtml5JS.EventName.volumechange,amp.bind(this,amp.AzureHtml5JS.onPassthroughHandler));n.addEventListener(AzureHtml5JS.EventName.ended,amp.bind(this,amp.AzureHtml5JS.onPassthroughHandler));n.addEventListener(AzureHtml5JS.EventName.timeupdate,amp.bind(this,amp.AzureHtml5JS.onPassthroughHandler));n.addEventListener(AzureHtml5JS.EventName.pause,amp.bind(this,amp.AzureHtml5JS.onPassthroughHandler));n.addEventListener(AzureHtml5JS.EventName.play,amp.bind(this,amp.AzureHtml5JS.onPassthroughHandler));n.addEventListener(AzureHtml5JS.EventName.playing,amp.bind(this,amp.AzureHtml5JS.onPassthroughHandler));n.addEventListener(AzureHtml5JS.EventName.seeking,amp.bind(this,amp.AzureHtml5JS.onPassthroughHandler));n.addEventListener(AzureHtml5JS.EventName.seeked,amp.bind(this,amp.AzureHtml5JS.onPassthroughHandler));n.addEventListener(AzureHtml5JS.EventName.loadstart,amp.bind(this,amp.AzureHtml5JS.onPassthroughHandler));n.addEventListener(AzureHtml5JS.EventName.loadedmetadata,amp.bind(this,amp.AzureHtml5JS.onPassthroughHandler));n.addEventListener(AzureHtml5JS.EventName.loadeddata,amp.bind(this,amp.AzureHtml5JS.onPassthroughHandler));n.addEventListener(AzureHtml5JS.EventName.fullscreenchange,amp.bind(this,amp.AzureHtml5JS.onPassthroughHandler));n.addEventListener(AzureHtml5JS.EventName.waiting,amp.bind(this,amp.AzureHtml5JS.onPassthroughHandler));n.addEventListener(AzureHtml5JS.EventName.canplaythrough,amp.bind(this,amp.AzureHtml5JS.onPassthroughHandler));n.addEventListener(AzureHtml5JS.EventName.error,amp.bind(this,amp.AzureHtml5JS.onError));n.addEventListener(AzureHtml5JS.EventName.durationchange,amp.bind(this,amp.AzureHtml5JS.onPassthroughHandler));n.addEventListener(AzureHtml5JS.EventName.downloadbitratechanged,amp.bind(this,amp.AzureHtml5JS.onPassthroughHandler));n.addEventListener(AzureHtml5JS.EventName.playbackbitratechanged,amp.bind(this,amp.AzureHtml5JS.onPassthroughHandler))};amp.AzureHtml5JS.onPassthroughHandler=function(n){this.player().trigger(n)};amp.AzureHtml5JS.onError=function(){var n=this.player().mediaPlayer.error;amp.Player.raiseError.call(this.player(),"azurehtml5js",n.code,n.message)};amp.options.techOrder.unshift("azureHtml5JS");amp.options.azureHtml5JS={},function(n){(function(n){"use strict";var r=function(){function n(n){if(this.streams=[],n.getIsDynamicStream()){var i=new t(n);this.streams.push(i)}this.selectedIndex=this.streams.length>0?0:undefined}return n}(),t,i;n.VideoStreamList=r;t=function(){function n(n){var r,t,u;for(this.name="",this.tracks=[],this._tech=n,this._selectedTrack=-1,r=n.getStreamItems(),t=0;t<r.length;t++)u=new i(r[t]),this.tracks.push(u)}return n.prototype.selectTrackByIndex=function(n){if(this._selectedTrack!=n){-1==n?this._tech.setAutoDynamicStreamSwitch(!0):(this._tech.setAutoDynamicStreamSwitch(!1),this._tech.switchDynamicStreamIndex(n));for(var t=0;t<this.tracks.length;t++)this.tracks[t].selectable=-1===n?!0:n===t;this._selectedTrack=n;this._tech.player.trigger(amp.streamEventName.trackselected)}},n.prototype.addEventListener=function(n,t){this._tech.player.addEventListener(n,t)},n.prototype.removeEventListener=function(n,t){this._tech.player.removeEventListener(n,t)},n}();n.VideoStream=t;i=function(){function n(n){this.selectable=!0;this.width=n.width;this.height=n.height;this.bitrate=n.bitrate*1e3}return n}();n.VideoTrack=i})(n.FlashSS||(n.FlashSS={}));var t=n.FlashSS}(AMP||(AMP={})),function(n){(function(t){"use strict";var r=function(){function t(n){var t,r;for(this._streams=[],this._tech=n,t=0;t<n.getNumAlternativeAudioStreams();t++)r=new i(n,t),this._streams.push(r);this.selectedIndex=this._streams.length>0?n.getCurrentAlternativeAudioStreamIndex():undefined}return Object.defineProperty(t.prototype,"streams",{get:function(){return this._streams},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enabledIndices",{get:function(){for(var t=[],n=0;n<this._streams.length;n++)if(this._streams[n].enabled){t.push(n);break}return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(n){this._streams.length!=0&&(this._selectedIndex!=undefined&&(this._streams[this._selectedIndex].enabled=!1),this._streams[n].enabled=!0,this._selectedIndex=n)},enumerable:!0,configurable:!0}),t.prototype.switchIndex=function(t){if(this._tech.getHasAlternativeAudio()){if(this.enabledIndices.length!=1){n.Logger.error(2,"switchIndex failed - only single stream supported: "+this.enabledIndices.length+" streams enabled");this._tech.player.trigger(amp.streamListEventName.streamselectnotsupported);return}if(t>=this.streams.length||t<0){n.Logger.error(2,"audioChange failed - tried to enable invalid index: "+t);this._tech.player.trigger(amp.streamListEventName.streamindexinvalid);return}if(t===this.enabledIndices[0]){n.Logger.verbose(2,"audioChange failed because current stream selected");this._tech.player.trigger(amp.streamListEventName.streamselected);return}this.selectedIndex=t;this._tech.switchAlternativeAudioIndex(t);this._tech.player.trigger(amp.streamListEventName.streamselected)}else n.Logger.error(2,"No alternative audio streams found")},t.prototype.addEventListener=function(n,t){this._tech.player.addEventListener(n,t)},t.prototype.removeEventListener=function(n,t){this._tech.player.removeEventListener(n,t)},t}(),i;t.AudioStreamList=r;i=function(){function n(n,t){this.enabled=!1;this.language=this.getLanguage(n.getAlternativeAudioItemAt(t).info.attributes.Language);this.codec=n.getAlternativeAudioItemAt(t).info.targetTrack.fourCC;this.bitrate=n.getAlternativeAudioItemAt(t).bitrate*1e3;this.name=this.getName(n,t)}return n.prototype.getName=function(n,t){var i=n.getAlternativeAudioItemAt(t).info.urlTemplate.toLowerCase(),r="fragments(",u=i.indexOf(r),f=i.indexOf("=",u);return n.getAlternativeAudioItemAt(t).info.urlTemplate.substring(u+r.length,f)},n.prototype.getLanguage=function(n){return n?(n.length==3&&(n=vjs.get2LetterLangCode(n)),n):null},n}();t.AudioStream=i})(n.FlashSS||(n.FlashSS={}));var t=n.FlashSS}(AMP||(AMP={})),function(n){"use strict";function a(n){o(n)&&(i=n)}function v(){i=t}function o(n){if(n&&n.length>0){for(var i=0;i<n.length;i++)if(-1===t.indexOf(n[i]))throw new Error('Format "'+n[i]+'" not supported');return!0}return!1}function y(n,t){for(var r=[],i=0;i<t.length;i++)-1!==l[n].indexOf(t[i].type)&&r.push(t[i]);return r}function p(n){for(var f,e,i=[],r,u,o=[],t=0;n&&t<n.length;t++)f=n[t].src,e=n[t].src.indexOf("?"),e!==-1&&(f=n[t].src.substr(0,e).toLowerCase()),f.toLowerCase().lastIndexOf(".ism/manifest")===-1||n[t].disableUrlRewriter?i.push(n[t]):(u=s(n[t].src),o.indexOf(u)===-1&&(o.push(u),r=w(n[t]),r&&(i=i.concat(r))));return i.length>0?i:null}function s(n){var t=n.trim(),i=t.search(/\.ism\/manifest/i);return t.substr(0,i+e.length)}function w(n){var t=n.src.trim(),et=t.search(/format=/i),nt=[],w,a="",l="",ft=t.indexOf("?"),b,k,d,v,p,rt,g,ut;if(ft!==-1&&(l=t.substr(ft),l!=="")){var ot=new RegExp("(\\?|&)protectionType=(.[^&]*)","i"),st=new RegExp("(\\?|&)token=(.[^&]*)","i"),tt=l.match(ot),it=l.match(st);tt&&tt.length===3&&(b=new u,b.type=tt[2],it&&it.length===3&&(b.authenticationToken=decodeURIComponent(it[2])),n.protectionInfo=[b])}for(et>-1&&(t=t.replace(/format=[^,)]*[ ,]*/i,""),t=t.replace(/\(\s*\)/,"")),w=t.match(/\.ism\/manifest\([^)]*\)/i),w&&w.length>0&&(a=w[0].substr(e.length+1).trim()),t=s(n.src.trim()),k=i,n.streamingFormats&&o(n.streamingFormats)&&(k=n.streamingFormats),d=0;d<k.length;d++){if(p="",v=k[d],rt=c[v],v!==f?p="(format="+h[v]+(a?","+a:")"):a&&(p="("+a),n.protectionInfo)if(ut=y(v,n.protectionInfo),ut.length)g=new r(t+p,rt,ut);else continue;else g=new r(t+p,rt);l!==""&&(g.src+=l);nt.push(g)}return nt.length>0?nt:null}var f="SMOOTH",t=[f,"DASH","HLS-V3","HLS-V4"],h={DASH:"mpd-time-csf","HLS-V3":"m3u8-aapl-v3","HLS-V4":"m3u8-aapl-v4"},c={SMOOTH:"application/vnd.ms-sstr+xml",DASH:"application/dash+xml","HLS-V3":"application/vnd.apple.mpegurl","HLS-V4":"application/vnd.apple.mpegurl"},l={SMOOTH:["PlayReady","AES"],DASH:["PlayReady","AES","Widevine"],"HLS-V3":["PlayReady","AES"],"HLS-V4":["PlayReady","AES"]},e=".ism/manifest",i=t,r=function(){function n(n,t,i){this.src=n;this.type=t;this.protectionInfo=i}return n}(),u;n.streamSrc=r;u=function(){function n(){}return n}();n.protectionInfo=u;n.setStreamingFormats=a;n.resetStreamingFormats=v;n.expandSources=p}(UrlRewriter||(UrlRewriter={}));amp.options.languages.cs={Play:"Přehrát",Pause:"Pozastavit","Current Time":"Aktuální čas","Duration Time":"Doba trvání","Remaining Time":"Zbývající čas","Stream Type":"Typ streamu",LIVE:"ŽIVĚ",Loaded:"Načtené",Progress:"Průběh",Fullscreen:"Celá obrazovka","Non-Fullscreen":"Normální zobrazení",Mute:"Ztlumit",Unmuted:"Ztlumení zrušeno","Playback Rate":"Rychlost přehrávání (snímky)",Subtitles:"Titulky","subtitles off":"vypnuté titulky",Captions:"Titulky","captions off":"vypnuté titulky",Chapters:"Kapitoly",Off:"Vypnuto",Quality:"Kvalita",Auto:"Automaticky","Audio Tracks":"Zvukové stopy","default":"výchozí","Cast To Device":"Přetypovat na zařízení",Share:"Sdílet",Volume:"Hlasitost","Playback Speed":"Rychlost přehrávání","Video Quality":"Kvalita videa","Closed Captioning":"Skryté titulky","Share Video":"Sdílet video","Next Track":"Další stopa","Previous Track":"Předchozí stopa","Skip Forward":"Přeskočit vpřed","Skip Backward":"Přeskočit zpět","Fast Forward":"Převinout vpřed",Rewind:"Převinout zpět","Next Frame":"Další snímek","Previous Frame":"Předchozí snímek",Settings:"Nastavení",Options:"Možnosti","More Options":"Další možnosti",Zoom:"Lupa","Zoom In":"Přiblížit","Zoom Out":"Oddálit","Audio Only":"Jenom zvuk","Picture in Picture":"Obraz v obraze","Camera Angle":"Úhel kamery",MEDIA_ERR_ABORTED:"Přehrávání videa se přerušilo.",MEDIA_ERR_NETWORK:"Během stahování videa došlo k chybě kvůli problému se sítí. Zkontrolujte prosím připojení k síti nebo to zkuste znova později.",MEDIA_ERR_DECODE:"Video se nedalo načíst, buď kvůli chybě serveru nebo sítě, nebo nemá podporovaný formát.",MEDIA_ERR_SRC_NOT_SUPPORTED:"Přehrávání videa se přerušilo, protože je video poškozené nebo používá funkce, které váš prohlížeč nepodporuje.",MEDIA_ERR_ENCRYPTED:"Nedá se dešifrovat zašifrovaný zdroj videa.",SRC_PLAYER_MISMATCH:"Nenašel se žádný kompatibilní zdroj pro aktuální prostředí prohlížeče.",MEDIA_ERR_UNKNOWN:"Došlo k neznámé chybě."};amp.options.languages.de={Play:"Spielen",Pause:"Anhalten","Current Time":"Aktuelle Zeit","Duration Time":"Dauer","Remaining Time":"Verbleibende Zeit","Stream Type":"Streamtyp",LIVE:"LIVE",Loaded:"Geladen",Progress:"Status",Fullscreen:"Vollbild","Non-Fullscreen":"Vollbildmodus beenden",Mute:"Ton aus",Unmuted:"Ton an","Playback Rate":"Wiedergabegeschwindigkeit",Subtitles:"Untertitel","subtitles off":"Untertitel aus",Captions:"Beschriftungen","captions off":"Beschriftungen aus",Chapters:"Kapitel",Off:"Aus",Quality:"Qualität",Auto:"Automatisch","Audio Tracks":"Audiotitel","default":"Standard","Cast To Device":"Für Gerät umwandeln",Share:"Freigeben",Volume:"Lautstärke","Playback Speed":"Wiedergabegeschwindigkeit","Video Quality":"Videoqualität","Closed Captioning":"Untertitelung","Share Video":"Video freigeben","Next Track":"Nächster Titel","Previous Track":"Vorheriger Titel","Skip Forward":"Rückwärts","Skip Backward":"Vorwärts","Fast Forward":"Vorlauf",Rewind:"Zurückspulen","Next Frame":"Nächstes Bild","Previous Frame":"Vorheriges Bild",Settings:"Einstellungen",Options:"Optionen","More Options":"Weitere Optionen",Zoom:"Zoom","Zoom In":"Vergrößern","Zoom Out":"Verkleinern","Audio Only":"Nur Audio","Picture in Picture":"Bild-im-Bild","Camera Angle":"Kamerawinkel",MEDIA_ERR_ABORTED:"Videowiedergabe abgebrochen.",MEDIA_ERR_NETWORK:"Beim Herunterladen des Videos ist aufgrund eines Netzwerkfehlers ein Fehler aufgetreten. Prüfen Sie Ihre Internetverbindung, oder versuchen Sie es später erneut.",MEDIA_ERR_DECODE:"Das Video konnte nicht geladen werden. Entweder ist ein Server- oder Netzwerkfehler aufgetreten ist, oder das Format wird nicht unterstützt.",MEDIA_ERR_SRC_NOT_SUPPORTED:"Die Videowiedergabe wurde abgebrochen. Möglicherweise ist das Video beschädigt, oder es verwendet Funktionen, die in Ihrem Browser nicht unterstützt werden.",MEDIA_ERR_ENCRYPTED:"Die verschlüsselte Videoquelle konnte nicht entschlüsselt werden.",SRC_PLAYER_MISMATCH:"Keine kompatible Quelle für die aktuelle Browserumgebung gefunden.",MEDIA_ERR_UNKNOWN:"Unbekannter Fehler."};amp.options.languages.en={MEDIA_ERR_ABORTED:"Video playback aborted.",MEDIA_ERR_NETWORK:"A network error caused the video download to fail part-way. Please check your network connection or try again later.",MEDIA_ERR_DECODE:"The video could not be loaded, either because the server or network failed or because the format is not supported.",MEDIA_ERR_SRC_NOT_SUPPORTED:"The video playback was aborted due to a corruption problem or because the video used features your browser did not support.",MEDIA_ERR_ENCRYPTED:"Unable to decrypt the encrypted video source.",SRC_PLAYER_MISMATCH:"No compatible source found for the current browser environment.",MEDIA_ERR_UNKNOWN:"An unknown error occurred."};amp.options.languages.es={Play:"Reproducir",Pause:"Pausa","Current Time":"Hora actual","Duration Time":"Duración","Remaining Time":"Tiempo restante","Stream Type":"Tipo de secuencia",LIVE:"DIRECTO",Loaded:"Cargado",Progress:"Progreso",Fullscreen:"Pantalla completa","Non-Fullscreen":"Tamaño normal",Mute:"Silenciar",Unmuted:"Audio reactivado","Playback Rate":"Tasa de reproducción",Subtitles:"Subtítulos","subtitles off":"subtítulos desactivados",Captions:"Subtítulos","captions off":"subtítulos desactivados",Chapters:"Capítulos",Off:"Desactivado",Quality:"Calidad",Auto:"Automático","Audio Tracks":"Pistas de audio","default":"predeterminado","Cast To Device":"Emitir en el dispositivo",Share:"Compartir",Volume:"Volumen","Playback Speed":"Velocidad de reproducción","Video Quality":"Calidad de vídeo","Closed Captioning":"Subtítulos (CC)","Share Video":"Compartir vídeo","Next Track":"Pista siguiente","Previous Track":"Pista anterior","Skip Forward":"Saltar adelante","Skip Backward":"Saltar atrás","Fast Forward":"Avanzar rápidamente",Rewind:"Rebobinar","Next Frame":"Fotograma siguiente","Previous Frame":"Fotograma anterior",Settings:"Configuración",Options:"Opciones","More Options":"Más opciones",Zoom:"Zoom","Zoom In":"Acercar","Zoom Out":"Alejar","Audio Only":"Solo audio","Picture in Picture":"Imagen en imagen","Camera Angle":"Ángulo de cámara",MEDIA_ERR_ABORTED:"La reproducción de vídeo se canceló.",MEDIA_ERR_NETWORK:"Un error de red provocó que la descarga de vídeo no se pudiera realizar. Compruebe la conexión de red o inténtelo de nuevo más tarde.",MEDIA_ERR_DECODE:"No se pudo cargar el vídeo porque hubo un error en la red o en el servidor o porque el formato no es compatible.",MEDIA_ERR_SRC_NOT_SUPPORTED:"La reproducción de vídeo se canceló debido a un problema con algún elemento o porque el vídeo contiene características que no son compatibles con el explorador.",MEDIA_ERR_ENCRYPTED:"La fuente de vídeo cifrada no se puede descifrar.",SRC_PLAYER_MISMATCH:"No se encontró ninguna fuente compatible con el entorno de explorador actual.",MEDIA_ERR_UNKNOWN:"Error desconocido."};amp.options.languages.fr={Play:"Lecture",Pause:"Pause","Current Time":"Heure actuelle","Duration Time":"Durée","Remaining Time":"Temps restant","Stream Type":"Type de flux",LIVE:"EN DIRECT",Loaded:"Chargé",Progress:"Progression",Fullscreen:"Plein écran","Non-Fullscreen":"Plein écran désactivé",Mute:"Muet",Unmuted:"Son activé","Playback Rate":"Flux de lecture",Subtitles:"Sous-titres","subtitles off":"sous-titres désactivés",Captions:"Sous-titrage","captions off":"sous-titrage désactivé",Chapters:"Chapitres",Off:"Désactivé",Quality:"Qualité",Auto:"Auto","Audio Tracks":"Pistes audio","default":"par défaut","Cast To Device":"Projeter sur un appareil",Share:"Partager",Volume:"Volume","Playback Speed":"Vitesse de lecture","Video Quality":"Qualité vidéo","Closed Captioning":"Sous-titrage","Share Video":"Partager la vidéo","Next Track":"Piste suivante","Previous Track":"Piste précédente","Skip Forward":"Avance rapide","Skip Backward":"Retour rapide","Fast Forward":"Avance rapide",Rewind:"Retour rapide","Next Frame":"Image suivante","Previous Frame":"Image précédente",Settings:"Paramètres",Options:"Options","More Options":"Autres options",Zoom:"Zoom","Zoom In":"Zoom avant","Zoom Out":"Zoom arrière","Audio Only":"Audio seul","Picture in Picture":"Image dans l'image","Camera Angle":"Angle de caméra",MEDIA_ERR_ABORTED:"Lecture vidéo abandonnée.",MEDIA_ERR_NETWORK:"Une erreur réseau a entraîné l'échec du téléchargement de la vidéo. Vérifiez votre connexion réseau ou réessayez ultérieurement.",MEDIA_ERR_DECODE:"La vidéo n'a pas pu être chargée parce que le serveur ou le réseau ont échoué ou parce que le format n'est pas pris en charge.",MEDIA_ERR_SRC_NOT_SUPPORTED:"La lecture de la vidéo a été abandonnée en raison d'un problème d'endommagement ou parce que la vidéo utilise des fonctionnalités que votre navigateur ne prend pas en charge.",MEDIA_ERR_ENCRYPTED:"Impossible de déchiffrer la source vidéo chiffrée.",SRC_PLAYER_MISMATCH:"Aucune source compatible trouvée dans l'environnement actuel du navigateur.",MEDIA_ERR_UNKNOWN:"Une erreur inconnue s'est produite."};amp.options.languages.hu={Play:"Lejátszás",Pause:"Szüneteltetés","Current Time":"Aktuális idő","Duration Time":"Időtartam","Remaining Time":"Hátralévő idő","Stream Type":"Online tartalom típusa",LIVE:"ÉLŐ",Loaded:"Betöltve",Progress:"Állapot",Fullscreen:"Teljes képernyő","Non-Fullscreen":"Nem teljes képernyős mód",Mute:"Elnémítás",Unmuted:"Elnémítás kikapcsolva","Playback Rate":"Lejátszási sebesség",Subtitles:"Feliratok","subtitles off":"feliratok kikapcsolva",Captions:"Feliratok","captions off":"feliratozás kikapcsolva",Chapters:"Fejezetek",Off:"Kikapcsolva",Quality:"Minőség",Auto:"Automatikus","Audio Tracks":"Zeneszámok","default":"alapértelmezett","Cast To Device":"Átvitel eszközre",Share:"Megosztás",Volume:"Hangerő","Playback Speed":"Lejátszás sebessége","Video Quality":"Videóminőség","Closed Captioning":"Feliratozás","Share Video":"Videó megosztása","Next Track":"Következő szám","Previous Track":"Előző szám","Skip Forward":"Ugrás előre","Skip Backward":"Ugrás vissza","Fast Forward":"Előretekerés",Rewind:"Visszatekerés","Next Frame":"Következő képkocka","Previous Frame":"Előző képkocka",Settings:"Beállítások",Options:"Beállítások","More Options":"További lehetőségek",Zoom:"Nagyítás","Zoom In":"Nagyítás","Zoom Out":"Kicsinyítés","Audio Only":"Csak hang","Picture in Picture":"Kép a képben","Camera Angle":"Kamera látószöge",MEDIA_ERR_ABORTED:"Videolejátszás megszakítva.",MEDIA_ERR_NETWORK:"A videó letöltése hálózati hiba miatt megszakadt. Ellenőrizze a hálózati kapcsolatot, vagy próbálkozzon újra később.",MEDIA_ERR_DECODE:"Nem sikerült betölteni a videót a kiszolgáló vagy a hálózat hibája miatt, vagy mert a formátum nem támogatott.",MEDIA_ERR_SRC_NOT_SUPPORTED:"A videó lejátszása megszakadt adatsérülés miatt, vagy mert a videó olyan funkciókat használ, amelyeket a böngésző nem támogat.",MEDIA_ERR_ENCRYPTED:"Nem lehet visszafejteni a titkosított videoforrást.",SRC_PLAYER_MISMATCH:"Nem található a jelenlegi böngészőkörnyezettel kompatibilis forrás.",MEDIA_ERR_UNKNOWN:"Ismeretlen hiba történt."};amp.options.languages.it={Play:"Riproduci",Pause:"Pausa","Current Time":"Ora corrente","Duration Time":"Durata","Remaining Time":"Tempo residuo","Stream Type":"Tipo di flusso",LIVE:"LIVE",Loaded:"Caricato",Progress:"Stato",Fullscreen:"Schermo intero","Non-Fullscreen":"Schermo normale",Mute:"Disattiva audio",Unmuted:"Audio riattivato","Playback Rate":"Frequenza di riproduzione",Subtitles:"Sottotitoli","subtitles off":"disattiva sottotitoli",Captions:"Didascalie","captions off":"disattiva didascalie",Chapters:"Capitoli",Off:"Disattivato",Quality:"Qualità",Auto:"Automatico","Audio Tracks":"Brani audio","default":"predefinito","Cast To Device":"Cast nel dispositivo",Share:"Condividi",Volume:"Volume","Playback Speed":"Velocità di riproduzione","Video Quality":"Qualità video","Closed Captioning":"Sottotitoli codificati","Share Video":"Condividi video","Next Track":"Brano successivo","Previous Track":"Brano precedente","Skip Forward":"Skip avanti","Skip Backward":"Skip indietro","Fast Forward":"Avanzamento rapido",Rewind:"Riavvolgi","Next Frame":"Fotogramma successivo","Previous Frame":"Fotogramma precedente",Settings:"Impostazioni",Options:"Opzioni","More Options":"Altre opzioni",Zoom:"Zoom","Zoom In":"Zoom avanti","Zoom Out":"Zoom indietro","Audio Only":"Solo audio","Picture in Picture":"Immagine nell'immagine","Camera Angle":"Angolazione",MEDIA_ERR_ABORTED:"Riproduzione video interrotta.",MEDIA_ERR_NETWORK:"Il download del video si è interrotto a causa di un errore di rete. Controllare la connessione di rete o riprovare più tardi.",MEDIA_ERR_DECODE:"Non è stato possibile caricare il video perché si è verificato un errore del server o della rete oppure perché il formato non è supportato.",MEDIA_ERR_SRC_NOT_SUPPORTED:"La riproduzione video è stata interrotta a causa di un problema di danneggiamento oppure perché nel video sono state usate funzionalità non supportate dal browser corrente.",MEDIA_ERR_ENCRYPTED:"Non è possibile decrittografare l'origine video crittografata.",SRC_PLAYER_MISMATCH:"Non sono state trovate origini compatibili per l'ambiente del browser corrente.",MEDIA_ERR_UNKNOWN:"Si è verificato un errore sconosciuto."};amp.options.languages.ja={Play:"再生",Pause:"一時停止","Current Time":"現在の時刻","Duration Time":"継続時間","Remaining Time":"残り時間","Stream Type":"ストリーム タイプ",LIVE:"ライブ",Loaded:"読み込まれました",Progress:"前進",Fullscreen:"全画面表示","Non-Fullscreen":"非全画面表示",Mute:"ミュート",Unmuted:"ミュート解除","Playback Rate":"再生レート",Subtitles:"サブタイトル","subtitles off":"サブタイトル オフ",Captions:"キャプション","captions off":"キャプション オフ",Chapters:"チャプター",Off:"オフ",Quality:"品質",Auto:"自動","Audio Tracks":"オーディオ トラック","default":"既定","Cast To Device":"デバイスへのキャスト",Share:"共有",Volume:"音量","Playback Speed":"再生速度","Video Quality":"ビデオ品質","Closed Captioning":"クローズド キャプション","Share Video":"ビデオの共有","Next Track":"次のトラック","Previous Track":"前のトラック","Skip Forward":"前へスキップ","Skip Backward":"後へスキップ","Fast Forward":"早送り",Rewind:"巻き戻し","Next Frame":"次のフレーム","Previous Frame":"前のフレーム",Settings:"設定",Options:"オプション","More Options":"その他のオプション",Zoom:"ズーム","Zoom In":"拡大","Zoom Out":"縮小","Audio Only":"オーディオのみ","Picture in Picture":"ピクチャ イン ピクチャ","Camera Angle":"カメラ アングル",MEDIA_ERR_ABORTED:"ビデオ再生が中断されました。",MEDIA_ERR_NETWORK:"ネットワーク エラーのためにビデオのダウンロードが途中で失敗しました。ネットワーク接続をチェックするか後でもう一度お試しください。",MEDIA_ERR_DECODE:"ビデオを読み込めませんでした。サーバーまたはネットワークの障害のためか、あるいはフォーマットがサポートされていません。",MEDIA_ERR_SRC_NOT_SUPPORTED:"ビデオが破損しているか、ブラウザーがサポートしていない機能をビデオが使用しているため、ビデオの再生が中断しました。",MEDIA_ERR_ENCRYPTED:"暗号化されたビデオ ソースを暗号化解除できません。",SRC_PLAYER_MISMATCH:"現在のブラウザー環境と互換性のあるソースが見つかりません。",MEDIA_ERR_UNKNOWN:"不明なエラーが発生しました。"};amp.options.languages.ko={Play:"재생",Pause:"일시 중지","Current Time":"현재 시간","Duration Time":"지속 시간","Remaining Time":"남은 시간","Stream Type":"스트림 형식",LIVE:"라이브",Loaded:"로드됨",Progress:"진행률",Fullscreen:"전체 화면","Non-Fullscreen":"전체 화면이 아님",Mute:"음소거",Unmuted:"음소거 해제됨","Playback Rate":"재생 속도",Subtitles:"자막","subtitles off":"자막 끄기",Captions:"캡션","captions off":"캡션 끄기",Chapters:"챕터",Off:"해제",Quality:"품질",Auto:"자동","Audio Tracks":"오디오 트랙","default":"기본값","Cast To Device":"장치로 캐스팅",Share:"공유",Volume:"볼륨","Playback Speed":"재생 속도","Video Quality":"비디오 품질","Closed Captioning":"선택 캡션","Share Video":"비디오 공유","Next Track":"다음 트랙","Previous Track":"이전 트랙","Skip Forward":"앞으로 건너뛰기","Skip Backward":"뒤로 건너뛰기","Fast Forward":"빨리 감기",Rewind:"되감기","Next Frame":"다음 프레임","Previous Frame":"이전 프레임",Settings:"설정",Options:"옵션","More Options":"기타 옵션",Zoom:"확대/축소","Zoom In":"확대","Zoom Out":"축소","Audio Only":"오디오만","Picture in Picture":"화면 속 화면","Camera Angle":"카메라 각도",MEDIA_ERR_ABORTED:"비디오 재생이 중단되었습니다.",MEDIA_ERR_NETWORK:"네트워크 오류 때문에 비디오 다운로드가 도중에 실패했습니다. 네트워크 연결을 확인하거나 나중에 다시 시도하세요.",MEDIA_ERR_DECODE:"서버나 네트워크에서 오류가 발생했거나 형식이 지원되지 않기 때문에 비디오를 로드할 수 없습니다.",MEDIA_ERR_SRC_NOT_SUPPORTED:"손상 문제가 발생했거나 브라우저에서 지원하지 않는 기능이 비디오에 사용되었기 때문에 비디오 재생이 중단되었습니다.",MEDIA_ERR_ENCRYPTED:"암호화된 비디오 소스의 암호를 해독할 수 없습니다.",SRC_PLAYER_MISMATCH:"현재 브라우저 환경의 호환되는 소스를 찾을 수 업습니다.",MEDIA_ERR_UNKNOWN:"알 수 없는 오류가 발생했습니다."};amp.options.languages.nl={Play:"Afspelen",Pause:"Onderbreken","Current Time":"Huidige tijd","Duration Time":"Duur","Remaining Time":"Resterende tijd","Stream Type":"Type stream",LIVE:"LIVE",Loaded:"Geladen",Progress:"Voortgang",Fullscreen:"Volledig scherm","Non-Fullscreen":"Niet-volledig scherm",Mute:"Dempen",Unmuted:"Dempen opgeheven","Playback Rate":"Afspeelsnelheid",Subtitles:"Ondertitels","subtitles off":"ondertitels uit",Captions:"Bijschriften","captions off":"ondertiteling uit",Chapters:"Hoofdstukken",Off:"Uit",Quality:"Kwaliteit",Auto:"Automatisch","Audio Tracks":"Audionummers","default":"standaard","Cast To Device":"Casten naar apparaat",Share:"Delen",Volume:"Volume","Playback Speed":"Afspeelsnelheid","Video Quality":"Videokwaliteit","Closed Captioning":"Ondertiteling","Share Video":"Video delen","Next Track":"Volgend nummer","Previous Track":"Vorig nummer","Skip Forward":"Vooruit springen","Skip Backward":"Terug springen","Fast Forward":"Vooruitspoelen",Rewind:"Terugspoelen","Next Frame":"Volgende frame","Previous Frame":"Vorige frame",Settings:"Instellingen",Options:"Opties","More Options":"Meer opties",Zoom:"In-/uitzoomen","Zoom In":"Inzoomen","Zoom Out":"Uitzoomen","Audio Only":"Alleen audio","Picture in Picture":"Picture in Picture","Camera Angle":"Camerahoek",MEDIA_ERR_ABORTED:"Video afspelen is afgebroken.",MEDIA_ERR_NETWORK:"De video is vanwege een netwerkfout gedeeltelijk gedownload. Controleer uw netwerkverbinding of probeer het later opnieuw.",MEDIA_ERR_DECODE:"De video kan niet worden geladen, omdat er een probleem is met de server of het netwerk of omdat de indeling niet wordt ondersteund.",MEDIA_ERR_SRC_NOT_SUPPORTED:"Het afspelen van de video is afgebroken, omdat deze mogelijk is beschadigd of omdat de video functies gebruikt die niet worden ondersteund door uw browser.",MEDIA_ERR_ENCRYPTED:"Kan de versleutelde videobron niet ontsleutelen.",SRC_PLAYER_MISMATCH:"Er is geen compatibele bron gevonden voor de huidige browseromgeving.",MEDIA_ERR_UNKNOWN:"Er is een onbekende fout opgetreden."};amp.options.languages.pl={Play:"Odtwórz",Pause:"Wstrzymaj","Current Time":"Bieżący czas","Duration Time":"Czas trwania","Remaining Time":"Pozostały czas","Stream Type":"Typ strumienia",LIVE:"NA ŻYWO",Loaded:"Załadowane",Progress:"Postęp",Fullscreen:"Pełny ekran","Non-Fullscreen":"Niepełny ekran",Mute:"Wycisz",Unmuted:"Wyciszenie wyłączone","Playback Rate":"Tempo odtwarzania",Subtitles:"Napisy","subtitles off":"napisy wyłączone",Captions:"Podpisy","captions off":"podpisy wyłączone",Chapters:"Rozdziały",Off:"Wyłączone",Quality:"Jakość",Auto:"Auto","Audio Tracks":"Ścieżki dźwiękowe","default":"domyślne","Cast To Device":"Rzutuj na urządzenie",Share:"Udostępnij",Volume:"Głośność","Playback Speed":"Szybkość odtwarzania","Video Quality":"Jakość wideo","Closed Captioning":"Podpisy kodowane","Share Video":"Udostępnij wideo","Next Track":"Następna ścieżka","Previous Track":"Poprzednia ścieżka","Skip Forward":"Skocz do tyłu","Skip Backward":"Skocz do przodu","Fast Forward":"Przewiń do przodu",Rewind:"Przewiń do tyłu","Next Frame":"Następna klatka","Previous Frame":"Poprzednia klatka",Settings:"Ustawienia",Options:"Opcje","More Options":"Więcej opcji",Zoom:"Powiększenie","Zoom In":"Powiększ","Zoom Out":"Pomniejsz","Audio Only":"Tylko dźwięk","Picture in Picture":"Obraz w obrazie","Camera Angle":"Kąt kamery",MEDIA_ERR_ABORTED:"Przerwano odtwarzanie wideo.",MEDIA_ERR_NETWORK:"Błąd sieci spowodował, że trwające pobieranie wideo zostało przerwane. Sprawdź połączenie sieciowe i spróbuj ponownie.",MEDIA_ERR_DECODE:"Nie można załadować wideo. Wystąpił błąd serwera lub sieci albo format nie jest obsługiwany.",MEDIA_ERR_SRC_NOT_SUPPORTED:"Odtwarzanie wideo zostało przerwane. Dane są uszkodzone lub wideo korzysta z funkcji, których przeglądarka nie obsługuje.",MEDIA_ERR_ENCRYPTED:"Nie można odszyfrować zaszyfrowanego źródła wideo.",SRC_PLAYER_MISMATCH:"Nie znaleziono zgodnego źródła dla bieżącego środowiska przeglądarki.",MEDIA_ERR_UNKNOWN:"Wystąpił nieznany błąd."};amp.options.languages["pt-br"]={Play:"Executar",Pause:"Pausar","Current Time":"Tempo atual","Duration Time":"Tempo de duração","Remaining Time":"Tempo restante","Stream Type":"Tipo de fluxo",LIVE:"AO VIVO",Loaded:"Carregado",Progress:"Progresso",Fullscreen:"Tela cheia","Non-Fullscreen":"Sem tela cheia",Mute:"Sem áudio",Unmuted:"Mudo desativado","Playback Rate":"Taxa de reprodução",Subtitles:"Legendas","subtitles off":"Desativar legendas",Captions:"Legendas","captions off":"desativar legendas",Chapters:"Capítulos",Off:"Desativado",Quality:"Qualidade",Auto:"Automático","Audio Tracks":"Faixas de áudio","default":"padrão","Cast To Device":"Converter para o dispositivo",Share:"Compartilhar",Volume:"Volume","Playback Speed":"Velocidade de reprodução","Video Quality":"Qualidade do vídeo","Closed Captioning":"Legendagem codificada","Share Video":"Compartilhar vídeo","Next Track":"Próxima faixa","Previous Track":"Faixa anterior","Skip Forward":"Próxima faixa","Skip Backward":"Faixa anterior","Fast Forward":"Avançar",Rewind:"Retroceder","Next Frame":"Próximo quadro","Previous Frame":"Quadro anterior",Settings:"Configurações",Options:"Opções","More Options":"Mais Opções",Zoom:"Aplicar zoom","Zoom In":"Ampliar","Zoom Out":"Reduzir","Audio Only":"Apenas áudio","Picture in Picture":"Picture in picture","Camera Angle":"Ângulo da câmera",MEDIA_ERR_ABORTED:"Reprodução de vídeo anulada.",MEDIA_ERR_NETWORK:"Um erro de rede causou a falha do download do vídeo. Verifique sua conexão de rede ou tente novamente mais tarde.",MEDIA_ERR_DECODE:"O vídeo não pôde ser carregado, pois há uma falha na rede ou servidor ou o formato não é suportado.",MEDIA_ERR_SRC_NOT_SUPPORTED:"A reprodução do vídeo foi anulada devido a um problema de corrupção ou porque o vídeo usou recursos que seu navegador não suporta.",MEDIA_ERR_ENCRYPTED:"Não foi possível descriptografar a fonte do vídeo criptogradada.",SRC_PLAYER_MISMATCH:"Nenhuma fonte compatível encontrada para o ambiente do navegador atual.",MEDIA_ERR_UNKNOWN:"Ocorreu um erro desconhecido."};amp.options.languages["pt-pt"]={Play:"Reproduzir",Pause:"Pausa","Current Time":"Tempo Atual","Duration Time":"Tempo de Duração","Remaining Time":"Tempo Restante","Stream Type":"Tipo de Fluxo",LIVE:"EM DIRETO",Loaded:"Carregado",Progress:"Progresso",Fullscreen:"Ecrã Inteiro","Non-Fullscreen":"Sair de Ecrã Inteiro",Mute:"Desativar Som",Unmuted:"Som ativado","Playback Rate":"Taxa de Reprodução",Subtitles:"Legendas","subtitles off":"legendas desativadas",Captions:"Legendas","captions off":"legendas desligadas",Chapters:"Capítulos",Off:"Desligado",Quality:"Qualidade",Auto:"Automático","Audio Tracks":"Faixas de Áudio","default":"predefinição","Cast To Device":"Transmitir em Dispositivo",Share:"Partilhar",Volume:"Volume","Playback Speed":"Velocidade de Reprodução","Video Quality":"Qualidade do Vídeo","Closed Captioning":"Legendagem de Áudio","Share Video":"Partilhar Vídeo","Next Track":"Faixa Seguinte","Previous Track":"Faixa Anterior","Skip Forward":"Para a Frente","Skip Backward":"Para Trás","Fast Forward":"Avançar",Rewind:"Recuar","Next Frame":"Fotograma Seguinte","Previous Frame":"Fotograma Anterior",Settings:"Definições",Options:"Opções","More Options":"Mais Opções",Zoom:"Zoom","Zoom In":"Ampliar","Zoom Out":"Reduzir","Audio Only":"Apenas Áudio","Picture in Picture":"Imagem na Imagem","Camera Angle":"Ângulo da Câmara",MEDIA_ERR_ABORTED:"Reprodução de vídeo abortada.",MEDIA_ERR_NETWORK:"A transferência do vídeo parou a meio devido a um erro de rede. Verifique a ligação de rede ou tente novamente mais tarde.",MEDIA_ERR_DECODE:"Não foi possível carregar o vídeo. Ocorreu uma falha no servidor ou na rede ou o formato não é suportado.",MEDIA_ERR_SRC_NOT_SUPPORTED:"A reprodução do vídeo foi abortada devido a um problema de danificação ou porque o vídeo utiliza funcionalidades que o seu browser não suporta.",MEDIA_ERR_ENCRYPTED:"Não é possível desencriptar a origem de vídeo encriptada.",SRC_PLAYER_MISMATCH:"Não foi encontrada uma origem compatível para o ambiente de browser atual.",MEDIA_ERR_UNKNOWN:"Ocorreu um erro desconhecido."};amp.options.languages.ru={Play:"Воспроизведение",Pause:"Пауза","Current Time":"Текущее время","Duration Time":"Длительность","Remaining Time":"Оставшееся время","Stream Type":"Тип потока",LIVE:"ПРЯМАЯ ТРАНСЛЯЦИЯ",Loaded:"Загружен",Progress:"Прогресс",Fullscreen:"Полный экран","Non-Fullscreen":"Неполный экран",Mute:"Выключить звук",Unmuted:"Микрофон включен","Playback Rate":"Скорость воспроизведения",Subtitles:"Субтитры","subtitles off":"отключить субтитры",Captions:"Подписи","captions off":"отключить подписи",Chapters:"Части",Off:"Выкл.",Quality:"Качество",Auto:"Авто","Audio Tracks":"Звуковые дорожки","default":"по умолчанию","Cast To Device":"Транслировать на устройство",Share:"Общий доступ",Volume:"Звук","Playback Speed":"Скорость воспроизведения","Video Quality":"Качество видео","Closed Captioning":"Кодированные субтитры","Share Video":"Поделиться видео","Next Track":"Следующая дорожка","Previous Track":"Предыдущая дорожка","Skip Forward":"Переход вперед","Skip Backward":"Переход назад","Fast Forward":"Перемотка вперед",Rewind:"Перемотка назад","Next Frame":"Следующий кадр","Previous Frame":"Предыдущий кадр",Settings:"Параметры",Options:"Параметры","More Options":"Дополнительные параметры",Zoom:"Масштаб","Zoom In":"Увеличить","Zoom Out":"Уменьшить","Audio Only":"Только аудио","Picture in Picture":"Картинка в картинке","Camera Angle":"Расположение камеры",MEDIA_ERR_ABORTED:"Воспроизведение видео прервано.",MEDIA_ERR_NETWORK:"Ошибка сети привела к сбою в процессе загрузки видеозаписи. Проверьте сетевое подключение или повторите попытку позднее.",MEDIA_ERR_DECODE:"Не удается загрузить видеозапись из-за неполадок в работе сервера или сети или из-за неподдерживаемого формата.",MEDIA_ERR_SRC_NOT_SUPPORTED:"Воспроизведение видеозаписи было прервано из-за неполадки или в связи с тем, что видеозапись использует функции, которые не поддерживаются в браузере.",MEDIA_ERR_ENCRYPTED:"Не удается расшифровать зашифрованный источник видео.",SRC_PLAYER_MISMATCH:"Для текущей среды браузера совместимый источник не найден.",MEDIA_ERR_UNKNOWN:"Произошла неизвестная ошибка."};amp.options.languages.sv={Play:"Spela upp",Pause:"Pausa","Current Time":"Aktuell tid","Duration Time":"Varaktighet","Remaining Time":"Återstående tid","Stream Type":"Strömtyp",LIVE:"LIVE",Loaded:"Inläst",Progress:"Förlopp",Fullscreen:"Helskärm","Non-Fullscreen":"Ej helskärm",Mute:"Ljud av",Unmuted:"Ljud på","Playback Rate":"Uppspelningshastighet",Subtitles:"Textning","subtitles off":"Textning av",Captions:"Bildtexter","captions off":"Bildtexter av",Chapters:"Kapitel",Off:"Av",Quality:"Kvalitet",Auto:"Auto","Audio Tracks":"Ljudspår","default":"standard","Cast To Device":"Sänd till enhet",Share:"Dela",Volume:"Volym","Playback Speed":"Uppspelningshastighet","Video Quality":"Videokvalitet","Closed Captioning":"Textning","Share Video":"Dela video","Next Track":"Nästa spår","Previous Track":"Föregående spår","Skip Forward":"Hoppa framåt","Skip Backward":"Hoppa bakåt","Fast Forward":"Snabbspola framåt",Rewind:"Bakåt","Next Frame":"Nästa bildruta","Previous Frame":"Föregående bildruta",Settings:"Inställningar",Options:"Alternativ","More Options":"Fler alternativ",Zoom:"Zooma","Zoom In":"Zooma in","Zoom Out":"Zooma ut","Audio Only":"Endast ljud","Picture in Picture":"Bild-i-bild","Camera Angle":"Kameravinkel",MEDIA_ERR_ABORTED:"Videouppspelning avbruten.",MEDIA_ERR_NETWORK:"Ett nätverksfel gjorde att hämtningen av videon avbröts. Kontrollera din nätverksanslutning och försök igen senare.",MEDIA_ERR_DECODE:"Det gick inte att läsa in den här videon. Det kan bero på att servern eller nätverket inte fungerade eller på att formatet inte stöds.",MEDIA_ERR_SRC_NOT_SUPPORTED:"Videouppspelningen avbröts pga att den var skadad eller därför att videon använder funktioner som din webbläsare inte stöder.",MEDIA_ERR_ENCRYPTED:"Det gick inte att dekryptera den krypterade videokällan.",SRC_PLAYER_MISMATCH:"Ingen kompatibel källa har hittats för den aktuella webbläsarmiljön.",MEDIA_ERR_UNKNOWN:"Det har uppstått ett oväntat fel."};amp.options.languages.tr={Play:"Yürüt",Pause:"Duraklat","Current Time":"Geçerli Zaman","Duration Time":"Süre","Remaining Time":"Kalan Süre","Stream Type":"Akış Türü",LIVE:"CANLI",Loaded:"Yüklendi",Progress:"İlerleme Durumu",Fullscreen:"Tam Ekran","Non-Fullscreen":"Tam Ekrandan Çık",Mute:"Sessiz",Unmuted:"Ses Açık","Playback Rate":"Kayıttan Yürütme Hızı",Subtitles:"Alt Yazılar","subtitles off":"alt yazılar kapalı",Captions:"Açıklamalı Alt Yazılar","captions off":"açıklamalı alt yazılar kapalı",Chapters:"Bölümler",Off:"Kapalı",Quality:"Kalite",Auto:"Otomatik","Audio Tracks":"Ses Parçaları","default":"varsayılan","Cast To Device":"Cihazda Yayınla",Share:"Paylaş",Volume:"Ses Düzeyi","Playback Speed":"Kayıttan Yürütme Hızı","Video Quality":"Video Kalitesi","Closed Captioning":"Kapalı Açıklamalı Alt Yazı","Share Video":"Videoyu Paylaş","Next Track":"Sonraki parça","Previous Track":"Önceki Parça","Skip Forward":"İleri Atla","Skip Backward":"Geri Atla","Fast Forward":"İleri Sar",Rewind:"Geri Sar","Next Frame":"Sonraki Kare","Previous Frame":"Önceki Kare",Settings:"Ayarlar",Options:"Seçenekler","More Options":"Tüm Seçenekler",Zoom:"Yakınlaştır","Zoom In":"Yakınlaştır","Zoom Out":"Uzaklaştır","Audio Only":"Yalnızca Ses","Picture in Picture":"Resim İçinde Resim","Camera Angle":"Kamera Açısı",MEDIA_ERR_ABORTED:"Video kayıttan yürütme durduruldu.",MEDIA_ERR_NETWORK:"Video indirme işlemi bir ağ hatası nedeniyle kısmen başarısız oldu. Lütfen ağ bağlantısını kontrol edin veya daha sonra yeniden deneyin.",MEDIA_ERR_DECODE:"Sunucu veya ağ başarısız olduğundan ya da biçim desteklenmediğinden video yüklenemedi.",MEDIA_ERR_SRC_NOT_SUPPORTED:"Bir bozulma sorunu ya da videoda tarayıcınız tarafından desteklenmeyen özelliklerin kullanılması nedeniyle video kayıttan yürütme durduruldu.",MEDIA_ERR_ENCRYPTED:"Şifreli video kaynağının şifresi çözülemedi.",SRC_PLAYER_MISMATCH:"Geçerli tarayıcı ortamıyla uyumlu kaynak bulunamadı.",MEDIA_ERR_UNKNOWN:"Bilinmeyen bir hata oluştu."};amp.options.languages["zh-hans"]={Play:"播放",Pause:"暂停","Current Time":"当前时间","Duration Time":"持续时间","Remaining Time":"剩余时间","Stream Type":"流类型",LIVE:"实时",Loaded:"已加载",Progress:"进度",Fullscreen:"全屏","Non-Fullscreen":"非全屏",Mute:"静音",Unmuted:"取消静音","Playback Rate":"播放速率",Subtitles:"字幕","subtitles off":"关闭字幕",Captions:"描述","captions off":"关闭描述",Chapters:"章节",Off:"关闭",Quality:"质量",Auto:"自动","Audio Tracks":"音频轨道","default":"默认","Cast To Device":"转换到设备",Share:"共享",Volume:"音量","Playback Speed":"播放速度","Video Quality":"视频质量","Closed Captioning":"隐藏式字幕","Share Video":"共享视频","Next Track":"下一曲目","Previous Track":"上一曲目","Skip Forward":"快进","Skip Backward":"快退","Fast Forward":"快进",Rewind:"后退","Next Frame":"下一帧","Previous Frame":"上一帧",Settings:"设置",Options:"选项","More Options":"其他选项",Zoom:"缩放","Zoom In":"放大","Zoom Out":"缩小","Audio Only":"仅音频","Picture in Picture":"画中画","Camera Angle":"照相机角度",MEDIA_ERR_ABORTED:"已中止视频播放。",MEDIA_ERR_NETWORK:"网络错误导致视频下载中途失败。请检查你的网络连接，或稍后再试。",MEDIA_ERR_DECODE:"无法加载视频，原因是服务器或网络故障，或者格式不受支持。",MEDIA_ERR_SRC_NOT_SUPPORTED:"视频播放已中止，原因是视频损坏或浏览器不支持视频使用的功能。",MEDIA_ERR_ENCRYPTED:"无法解密加密的视频源。",SRC_PLAYER_MISMATCH:"找不到与当前浏览器环境兼容的源。",MEDIA_ERR_UNKNOWN:"发生未知错误。"};amp.options.languages["zh-hant"]={Play:"播放",Pause:"暫停","Current Time":"目前的時間","Duration Time":"持續時間","Remaining Time":"剩餘時間","Stream Type":"串流類型",LIVE:"現場",Loaded:"已載入",Progress:"進度",Fullscreen:"全螢幕","Non-Fullscreen":"非全螢幕",Mute:"靜音",Unmuted:"已取消靜音","Playback Rate":"播放速率",Subtitles:"翻譯字幕","subtitles off":"關閉翻譯字幕",Captions:"字幕","captions off":"關閉字幕",Chapters:"段落",Off:"關閉",Quality:"畫質",Auto:"自動","Audio Tracks":"曲目","default":"預設","Cast To Device":"傳送到裝置",Share:"分享",Volume:"音量","Playback Speed":"播放速度","Video Quality":"視訊畫質","Closed Captioning":"隱藏式字幕","Share Video":"分享視訊","Next Track":"下一首曲目","Previous Track":"上一首曲目","Skip Forward":"快轉跳過","Skip Backward":"倒轉跳過","Fast Forward":"向前快轉",Rewind:"倒轉","Next Frame":"下一個畫面","Previous Frame":"上一個畫面",Settings:"設定",Options:"選項","More Options":"更多選項",Zoom:"縮放","Zoom In":"放大","Zoom Out":"縮小","Audio Only":"僅音訊","Picture in Picture":"子母畫面","Camera Angle":"攝影機角度",MEDIA_ERR_ABORTED:"視訊播放已中止。",MEDIA_ERR_NETWORK:"網路發生錯誤，導致視訊下載中斷。請檢查您的網路連接，然後再試一次。",MEDIA_ERR_DECODE:"視訊無法載入。可能是伺服器或網路失敗，或格式不受支援。",MEDIA_ERR_SRC_NOT_SUPPORTED:"因為發生毀損問題，或瀏覽器不支援視訊所使用的功能，導致播放已中止。",MEDIA_ERR_ENCRYPTED:"無法解密加密的視訊來源。",SRC_PLAYER_MISMATCH:"找不到任何來源與目前的瀏覽器環境相容。",MEDIA_ERR_UNKNOWN:"發生未知的錯誤。"},function(n){n.plugin("audioTracks",function(t){function o(n){var r=i.controlBar.audioTracksButton,u=selectedItemIndex,t=r.items.indexOf(n),f=i.currentAudioStreamList();!f||t<0||(f.switchIndex(t),u!==t&&(u<r.items.length&&r.items[u].selected(!1),n.selected(!0),selectedItemIndex=t))}function l(){var t=i.currentAudioStreamList(),r,u,n;if(!t)return[];for(a(),r=[],n=0;n<t.streams.length;n++)u=t.streams[n],k(u.codec)==stereoLabel&&r.push({text:u.title});return r}function a(){var t=i.currentAudioStreamList(),n;if(e){for(n=0;n<t.streams.length;n++)t.streams[n].title=t.streams[n].name;return}var u=r(t.streams,function(n){return w(n.language)}),o=r(t.streams,function(n){return vjs.util.getBitrateByUnit(n.bitrate)}),f=[];for(f=h(u)&&b(u)?u:h(o)?r(t.streams,function(n,t){return"Track"+t+" - "+vjs.util.getBitrateByUnit(n.bitrate)}):r(t.streams,function(n){return n.name}),n=0;n<t.streams.length;n++)t.streams[n].title=f[n]}function v(){var n=i.currentAudioStreamList();n&&n.addEventListener(amp.streamListEventName.streamselected,y);this.refresh();selectedItemIndex=undefined;p()}function y(){var r=i.currentAudioStreamList(),n=i.controlBar.audioTracksButton,t=selectedItemIndex;t!==r.enabledIndices[0]&&(t<n.items.length&&n.items[t].selected(!1),selectedItemIndex=r.enabledIndices[0],selectedItemIndex<n.items.length&&n.items[selectedItemIndex].selected(!0))}function p(){var n=i.currentAudioStreamList(),t,r;n&&(t=i.controlBar.audioTracksButton,r=selectedItemIndex,r!=n.enabledIndices[0]&&o(t.items[n.enabledIndices[0]]))}function w(n){return!n||!u||!u[n]?null:u[n].nativeName}function s(n){return n.filter(function(n,t,i){return i.indexOf(n)===t})}function h(n){return s(n).length>1}function b(n){return s(n).length==n.length}function k(n){return n==null?stereoLabel:(n=n.toLowerCase(),c(["dtse","ac-3","ec-3"],n))?dolbyDigitalLabel:c(["aac","mp4a"],n)?stereoLabel:undefined}function c(n,t){for(var i=0;i<n.length;i++)if(t.indexOf(n[i])>-1)return!0;return!1}function r(n,t){var i=[];return n.forEach(function(n,r){i.push(t(n,r))}),i}var i=this,u=vjs.getIsoLangs(),f,e;menuTitle=!!t&&!!t.menuTitle?t.menuTitle:"Audio Tracks";selectedItemIndex=!!t&&!!t.selectedItem?t.selectedItem:0;controlBarButtonCssClass="amp-audiotracks-control";dolbyDigitalLabel="Dolby Digital";stereoLabel="Stereo";f=!0;e=!1;i.options_.skinConfig&&i.options_.skinConfig.audioTracksMenu&&(typeof i.options_.skinConfig.audioTracksMenu.enabled!="undefined"&&(f=i.options_.skinConfig.audioTracksMenu.enabled),e=i.options_.skinConfig.audioTracksMenu.useManifestForLabel||!1);n.AudioTrackskMenuItem=n.MenuItem.extend({init:function(t,i){var r={label:i.text,selected:i.selected};n.MenuItem.call(this,t,r);this.addClass("amp-menu-item");this.on("click",this.onClick)}});n.AudioTrackskMenuItem.prototype.onClick=function(){o(this)};n.AudioTracksButton=n.MenuButton.extend({init:function(t,i){f&&(i=i||{},i.name="audioTracksButton",n.MenuButton.call(this,t,i),t.addEventListener(amp.eventName.loadedmetadata,amp.bind(this,v)))}});n.AudioTracksButton.prototype.refresh=function(){if(this.removeChild(this.menu),this.menu=this.createMenu(),!this.items||this.items.length<=1){this.hide();return}this.addChild(this.menu);var t=new n.Component(i,{el:vjs.createEl("li",{className:"amp-menu-header",innerHTML:vjs.util.htmlEncode(this.localize(menuTitle)),tabindex:-1})});this.menu.addItem(t);this.show()};n.AudioTracksButton.prototype.buttonText=menuTitle;n.AudioTracksButton.prototype.className=controlBarButtonCssClass;n.AudioTracksButton.prototype.createItems=function(){for(var f,r=l()||[],u=[],t=0;t<r.length;t++)f=new n.AudioTrackskMenuItem(i,r[t]),u.push(f);return u};i.ready(function(){var t=new n.AudioTracksButton(i,{selectedItemIndex:selectedItemIndex});i.controlBar.audioTracksButton=i.controlBar.addChild(t)})})}(window.amp),function(n){n.plugin("castToDevice",function(t){function f(n){var r=i.controlBar.castToDeviceButton,t=u,f=r.items.indexOf(n);t!==f&&(t>=0&&r.items[t].selected(!1),n.selected(!0),u=f)}function e(){return[{text:"Device 1",value:1},{text:"Device 2",value:2},{text:"Device 3",value:3}]}var i=this,r=!!t&&!!t.menuTitle?t.menuTitle:"Cast to Device",u=-1;n.CastToDeviceMenuItem=n.MenuItem.extend({init:function(t,i){var r={label:i.text,value:i.value,selected:i.selected};n.MenuItem.call(this,t,r);this.addClass("amp-menu-item");this.on("click",this.onClick)}});n.CastToDeviceMenuItem.prototype.onClick=function(){f(this)};n.CastToDeviceButton=n.MenuButton.extend({init:function(t,i){if(i=i||{},i.name="castToDeviceButton",n.MenuButton.call(this,t,i),this.items.length>0){var u=new n.Component(t,{el:vjs.createEl("li",{className:"amp-menu-header",innerHTML:vjs.util.htmlEncode(this.localize(r)),tabindex:-1})});this.menu.addItem(u)}else this.hide()}});n.CastToDeviceButton.prototype.buttonText=r;n.CastToDeviceButton.prototype.className="amp-casttodevice-control";n.CastToDeviceButton.prototype.createItems=function(){for(var f,r=e()||[],u=[],t=0;t<r.length;t++)f=new n.CastToDeviceMenuItem(i,r[t]),u.push(f);return u};i.ready(function(){var r=new n.CastToDeviceButton(i,t);i.controlBar.castToDeviceButton=i.controlBar.addChild(r)})})}(window.amp),function(n){n.plugin("closedCaption",function(t){var i=this,r=!!t&&!!t.menuTitle?t.menuTitle:"Closed Captioning";i.addEventListener(amp.eventName.loadedmetadata,function(){i.controlBar.captionsButton.el().className+=" amp-closedcaption-control";i.controlBar.captionsButton.buttonText=r;var t=new n.Component(i,{el:vjs.createEl("li",{className:"amp-menu-header",innerHTML:vjs.util.htmlEncode(this.localize(r)),tabindex:-1})});i.controlBar.captionsButton.menu.addItem(t)})})}(window.amp),function(n){n.plugin("controlBarIcons",function(t){function h(n){for(var t=0;t<r.length;t++)if(n===r[t].name())return r[t];return null}function u(t,r){for(var u,e=new n.Component(i,{el:vjs.createEl("div",{className:r})}),f=0;f<t.length;f++)u=h(t[f]),!u||(e.addChild(u),i.controlBar.removeChild(u));i.controlBar.addChild(e)}var i=this,f=!!t&&!!t.leftIcons?t.leftIcons:[],e=!!t&&!!t.middleIcons?t.middleIcons:[],o=!!t&&!!t.rightIcons?t.rightIcons:[],s=!t?!1:!!t.removeOtherIcons,r=[];i.ready(function(){if(r=i.controlBar.children().slice(),!!s)for(var n=0;n<r.length;n++)i.controlBar.removeChild(r[n]);u(f,"amp-controlbaricons-left");u(e,"amp-controlbaricons-middle");u(o,"amp-controlbaricons-right")})})}(window.amp),function(n){n.plugin("live",function(t){function p(){i.currentTime(i.duration())}function w(){i.isLive()?(i.addEventListener(amp.eventName.seeked,s),i.addEventListener(amp.eventName.seeking,h),i.addEventListener(amp.eventName.timeupdate,o),l(),e()):(i.removeEventListener(amp.eventName.seeked,s),i.removeEventListener(amp.eventName.seeking,h),i.removeEventListener(amp.eventName.timeupdate,o),r(),a())}function b(){i.currentTechName()=="Html5"&&i.isLive()&&(l(),e())}function o(){i.isLive()?f()&&r():(i.removeEventListener(amp.eventName.seeked,s),i.removeEventListener(amp.eventName.seeking,h),i.removeEventListener(amp.eventName.timeupdate,o),r(),a())}function s(){f()?r():e()}function h(){i.isLive()&&(f()?r():e())}function f(){var n=i.currentPlayerSettingValue("livePlaybackOffsetInSec");return i.currentTime()<i.duration()-y-n?!0:!1}function e(){i.controlBar.liveDisplay.addClass(u);i.controlBar.currentTimeDisplay.addClass(u)}function r(){i.controlBar.liveDisplay.removeClass(u);i.controlBar.currentTimeDisplay.removeClass(u)}function l(){i.controlBar.liveDisplay.addClass(c);i.controlBar.liveDisplay.show()}function a(){i.controlBar.liveDisplay.removeClass(c);i.controlBar.liveDisplay.hide()}var i=this,v=!!t&&!!t.controlText?t.controlText:"LIVE",c="amp-live-control",u="amp-live-on",y=5;n.LiveEdgeProgressBar=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t)}});n.LiveEdgeProgressBar.prototype.createEl=function(){return vjs.createEl("div",{className:"amp-live-edge-progress",tabIndex:0})};i.ready(function(){i.addEventListener(amp.eventName.loadedmetadata,w);i.addEventListener(amp.eventName.durationchange,b);i.controlBar.liveDisplay.on("click",function(){f()&&p()});var n=vjs.createEl("div",{className:"amp-livetimeindicator",innerHTML:vjs.util.htmlEncode(this.localize(v))});i.controlBar.currentTimeDisplay.el().appendChild(n)})})}(window.amp),function(n){n.plugin("logo",function(t){function h(n,t){var r=6,u=i.el();return t==="center"&&(r=u.clientWidth/2-n.clientWidth/2),t==="right"&&(r=u.clientWidth-n.clientWidth-6),r}function c(n,t){var r=6,u=i.el();return t==="middle"&&(r=u.clientHeight/2-n.clientHeight/2),t==="bottom"&&(r=u.clientHeight-n.clientHeight-6),r}function l(n,t){var r=i.el();r.clientHeight<t.clientHeight||r.clientWidth<t.clientWidth?(t.style.maxHeight=r.clientHeight+"px",t.style.maxWidth=r.clientWidth+"px"):(t.style.maxHeight="100%",t.style.maxWidth="100%")}function a(n,t){n.style.left=h(t,e)+"px";n.style.top=c(t,o)+"px"}function r(){i.customerLogo.container.style.left="0";i.customerLogo.container.style.top="0";l(i.customerLogo.container,i.customerLogo.el_);a(i.customerLogo.container,i.customerLogo.el_)}var i=this,u=t.enabled,f=t.opacity,e=t.horizontalPosition,o=t.verticalPosition,s="amp-logo";n.Logo=vjs.Component.extend({init:function(n,t){vjs.Component.call(this,n,t)}});n.Logo.prototype.createEl=function(){var n=vjs.Component.prototype.createEl.call(this,"div",{className:s});return n.style.opacity=f,this.container=n,n};i.ready(function(){if(u){var t=new n.Logo(i);i.customerLogo=i.addChild(t);r();i.on("fullscreenchange",r);i.on("resize",r)}})})}(window.amp),function(n){n.plugin("moreOptions",function(t){function e(n){var t;if(n){for(t=0;t<r.length;t++)r[t].control.el().tabIndex=-1,r[t].control.addClass("amp-control-disabled");i.controlBar.moreOptionsButton.el().tabIndex=0;i.controlBar.moreOptionsButton.removeClass("amp-control-disabled")}else{for(t=0;t<r.length;t++)r[t].control.el().tabIndex=0,r[t].control.removeClass("amp-control-disabled"),!r[t].control.menu||(r[t].control.el().style.position="",r[t].control.el().style.left="");i.controlBar.moreOptionsButton.el().tabIndex=-1;i.controlBar.moreOptionsButton.addClass("amp-control-disabled")}}function a(){i.controlBar.moreOptionsButton.menu.el().style.display="";for(var n=0;n<r.length;n++)!r[n].control.menu||(r[n].control.menu.el().style.display="")}function v(){var t,n;for(r=[],t=0;t<s.length;t++)n=i.controlBar[s[t]],!n||!n.el()||r.push({control:n,text:n.buttonText,className:n.el().className});return r}function y(){u=[];for(var n=0;n<r.length;n++)r[n].control.hasClass("vjs-hidden")||u.push(r[n]);u.length>1?c():e(!1)}function c(){var n=window.setTimeout(c,100);u[0].control.el()&&u[0].control.el().clientWidth!==0&&(f=u[0].control.el().clientWidth*(u.length+3)*3,l(),window.clearTimeout(n))}function l(){i.controlBar.width()==0?e(i.width()<f):e(i.controlBar.width()<f)}var i=this,f=0,s=!!t&&!!t.controls?t.controls:[],o=!!t&&!!t.menuTitle?t.menuTitle:"More Options",r=[],u=[],h=Date.now();n.MoreOptionsMenuItem=n.MenuItem.extend({init:function(t,i){var r={label:i.text,value:i.value,selected:i.selected};n.MenuItem.call(this,t,r);this.control=i.control;this.addClass("amp-menu-item");this.addClass(i.className);this.on("click",this.onClick);if(!!this.control.menu)this.control.menu.on("mouseleave",function(){this.el().style.display=""})}});n.MoreOptionsMenuItem.prototype.onClick=function(n){n.stopImmediatePropagation();this.control.onClick(n);h=Date.now()};n.MoreOptionsButton=n.MenuButton.extend({init:function(t,i){i=i||{};i.name="moreOptionsButton";n.MenuButton.call(this,t,i);t.addEventListener(amp.eventName.loadedmetadata,vjs.bind(this,function(){this.refresh()}));this.on("mouseover",a);if(this.items.length>0){var r=new n.Component(t,{el:vjs.createEl("li",{className:"amp-menu-header",innerHTML:vjs.util.htmlEncode(this.localize(o)),tabindex:-1})});this.menu.addItem(r)}else this.hide()}});n.MoreOptionsButton.prototype.buttonText=o;n.MoreOptionsButton.prototype.className="amp-moreoptions-control";n.MoreOptionsButton.prototype.createItems=function(){for(var f,r=v()||[],u=[],t=0;t<r.length;t++)f=new n.MoreOptionsMenuItem(i,r[t]),u.push(f);return u};n.MoreOptionsButton.prototype.refresh=function(){if(this.removeChild(this.menu),this.menu=this.createMenu(),this.addChild(this.menu),this.items.length>0){var t=new n.Component(i,{el:vjs.createEl("li",{className:"amp-menu-header",innerHTML:vjs.util.htmlEncode(this.localize(o)),tabindex:-1})});this.menu.addItem(t)}this.items=this.createItems()};n.MoreOptionsButton.prototype.onClick=function(n){Date.now()-h>500&&vjs.MenuButton.prototype.onClick.call(this,n)};i.ready(function(){var r=new n.MoreOptionsButton(i,t);i.controlBar.moreOptionsButton=i.controlBar.addChild(r);i.addEventListener(amp.eventName.loadedmetadata,y);i.on("resize",function(){l()});i.on("fullscreenchange",function(){e(i.controlBar.width()<f)})})})}(window.amp),function(n){n.plugin("navigation",function(t){function o(){alert("hi")}function s(){}function h(){}function c(){}function l(){}function a(){}function i(t,i,u){var f=new n.Button(r,{el:n.Component.prototype.createEl("div",{className:"vjs-control amp-"+t.toLowerCase(),innerHTML:'<div class="vjs-control-content"><span class="vjs-control-text">'+vjs.util.htmlEncode(this.localize(u))+"<\/span><\/div>",role:"button",id:t}),name:t});return f.onClick=i,f.buttonText=u,f}var r=this,u=t.track||{},f=t.skip||{},e=t.trickPlay||{};r.ready(function(){var n=[],t,v;for(u.hide||(n[0]=i("previousTrackButton",o,"Previous Track"),n[5]=i("nextTrackButton",s,"Next Track")),f.hide||(n[1]=i("skipBackwardButton",h,"Skip Backward"),n[4]=i("skipForwardButton",c,"Skip Forward")),e.hide||(n[2]=i("rewindButton",l,"Rewind"),n[3]=i("fastForwardButton",a,"Fast Forward")),t=0;t<n.length;t++)v=n[t],!v||(r.controlBar[v.id()]=r.controlBar.addChild(v))})})}(window.amp),function(n){n.plugin("playbackSpeed",function(t){function e(){}function o(n){for(var t=0;t<r.length;t++)if(r[t].name===n)return r[t];return null}function s(n){for(var t=0;t<r.length;t++)if(r[t].value===n)return r[t];return null}var i=this,r=[{name:"low",value:.5},{name:"normal",value:1},{name:"fast",value:2}],u=!!t&&!!t.initialSpeed?o(t.initialSpeed):r[1],f=u==="low"?0:u==="normal"?.5:1;n.PlaybackSpeedLevel=n.Component.extend({init:function(n,t){vjs.Component.call(this,n,t)}});n.PlaybackSpeedLevel.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-playbackspeed-level",innerHTML:'<span class="vjs-control-text"><\/span>',tabIndex:0})};n.PlaybackSpeedHandle=n.SliderHandle.extend();n.PlaybackSpeedHandle.prototype.defaultValue=1;n.PlaybackSpeedHandle.prototype.createEl=function(){return n.SliderHandle.prototype.createEl.call(this,"div",{className:"vjs-playbackspeed-handle"})};n.PlaybackSpeedBar=n.Slider.extend({init:function(t,i){n.Slider.call(this,t,i)}});n.PlaybackSpeedBar.prototype.options_={children:{playbackSpeedLevel:{},playbackSpeedHandle:{}},barName:"playbackSpeedLevel",handleName:"playbackSpeedHandle",vertical:!0};n.PlaybackSpeedBar.prototype.playerEvent="playbackspeedchange";n.PlaybackSpeedBar.prototype.createEl=function(){return vjs.Slider.prototype.createEl.call(this,"div",{className:"vjs-playbackspeed-bar","aria-label":"playback speed level"})};n.PlaybackSpeedBar.prototype.onMouseMove=function(n){var t=this.calculateDistance(n);f=t};n.PlaybackSpeedBar.prototype.getPercent=function(){var n=.2;return f<.5-n?0:f>.5+n?1:.5};n.PlaybackSpeedBar.prototype.update=function(){var f=this.handle,t=this.getPercent(),n=t;n=n===1?.9355:n===.5?.4697:0;f.el().style.left=n*100+"%";u=s(t);u===r[1]?(i.controlBar.playbackSpeedButton.addClass("off"),i.controlBar.playbackSpeedButton.removeClass("on")):(i.controlBar.playbackSpeedButton.addClass("on"),i.controlBar.playbackSpeedButton.removeClass("off"));e()};n.PlaybackSpeedButton=n.MenuButton.extend({init:function(t,i){i=i||{};i.name="playbackSpeedButton";n.MenuButton.call(this,t,i)}});n.PlaybackSpeedButton.prototype.createMenu=function(){var t=new n.Menu(this.player_,{contentElType:"div"}),i=new n.PlaybackSpeedBar(this.player_,this.options_);i.on("focus",function(){t.lockShowing()});i.on("blur",function(){t.unlockShowing()});return t.addChild(i),t};n.PlaybackSpeedButton.prototype.buttonText="Playback Speed";n.PlaybackSpeedButton.prototype.className="amp-playbackspeed-control";i.ready(function(){var t=new n.PlaybackSpeedButton(i);i.controlBar.playbackSpeedButton=i.controlBar.addChild(t)})})}(window.amp),function(n){n.plugin("quality",function(t){function e(n){var u=r.controlBar.qualityButton,o=i,f=u.items.indexOf(n);if(o!==f){u.items[o].selected(!1);n.selected(!0);i=f;s(u,f);var t=r.currentVideoStreamList(),e=t.selectedIndex,h=t.streams[e].tracks;i==0?t.streams[e].selectTrackByIndex(-1):t.streams[e].selectTrackByIndex(h.length-i)}}function o(){var f=r.currentVideoStreamList(),n,e;if(f){var o=f.selectedIndex,t=f.streams[o].tracks,u=[];for(u[0]={text:autoMenuItemLabel},n=1;n<=t.length;n++)e=t[t.length-n].bitrate,u[n]={text:t[t.length-n].height+"p-"+h(e)};return i>=0&&i<u.length&&(u[i].selected=!0),u}}function s(n,t){var i,r,u;t==0?r=4:(i=n.items[t].options_.label.split("-")[0].replace("p",""),r=4,r=i>720?4:i<=720&&i>480?3:i<=480&&i>360?2:1);u=n.el().className.match(/quality-\d/);n.el().className=n.el().className.replace(u,"quality-"+r)}function h(n){var t=n;return n>=1e6?(n=f(n/1e6),t=n+"Mbps"):n>=1e3?(n=f(n/1e3),t=n+"Kbps"):t=n+"bps",t}function f(n){return+(Math.round(n+"e+1")+"e-1")}function c(){this.refresh()}var r=this,u=!!t&&!!t.menuTitle?t.menuTitle:"Quality",i=!!t&&!!t.selectedItem?t.selectedItem:0;autoMenuItemLabel=!!t&&!!t.autoMenuItemLabel?t.autoMenuItemLabel:"Auto";n.QualityMenuItem=n.MenuItem.extend({init:function(t,i){var r={label:i.text,value:i.value,selected:i.selected};n.MenuItem.call(this,t,r);this.addClass("amp-menu-item");this.on("click",this.onClick)}});n.QualityMenuItem.prototype.onClick=function(n){n.stopImmediatePropagation();e(this)};n.QualityButton=n.MenuButton.extend({init:function(t,r){if(r=r||{},r.name="qualityButton",n.MenuButton.call(this,t,r),t.addEventListener(amp.eventName.loadedmetadata,amp.bind(this,c)),this.items!=undefined&&this.items.length>0){var f=new n.Component(t,{el:vjs.createEl("li",{className:"amp-menu-header",innerHTML:vjs.util.htmlEncode(this.localize(u)),tabindex:-1})});this.menu.addItem(f);this.el().className+=" quality-"+(4-i)}else this.hide()}});n.QualityButton.prototype.buttonText=u;n.QualityButton.prototype.className="amp-quality-control";n.QualityButton.prototype.createItems=function(){for(var f,i=o()||[],u=[],t=0;t<i.length;t++)f=new n.QualityMenuItem(r,i[t]),u.push(f);return u};r.ready(function(){var t=new n.QualityButton(r,{selectedItemIndex:i});r.controlBar.qualityButton=r.controlBar.addChild(t)});n.QualityButton.prototype.refresh=function(){if(this.removeChild(this.menu),this.menu=this.createMenu(),this.addChild(this.menu),this.items!=undefined&&this.items.length>0){var t=new n.Component(r,{el:vjs.createEl("li",{className:"amp-menu-header",innerHTML:vjs.util.htmlEncode(this.localize(u)),tabindex:-1})});this.menu.addItem(t);this.el().className.match(/quality-\d/)==null&&(this.el().className+=" quality-"+(4-i));this.show()}else this.hide()}})}(window.amp),function(n){n.plugin("share",function(t){function u(){}function f(){return[{text:"Option 1",value:1},{text:"Option 2",value:2},{text:"Option 3",value:3}]}var i=this,r=!!t&&!!t.menuTitle?t.menuTitle:"Share";n.ShareMenuItem=n.MenuItem.extend({init:function(t,i){var r={label:i.text,value:i.value,selected:i.selected};n.MenuItem.call(this,t,r);this.addClass("amp-menu-item");this.on("click",this.onClick)}});n.ShareMenuItem.prototype.onClick=function(){u(this)};n.ShareButton=n.MenuButton.extend({init:function(t,i){if(i=i||{},i.name="shareButton",n.MenuButton.call(this,t,i),this.items.length>0){var u=new n.Component(t,{el:vjs.createEl("li",{className:"amp-menu-header",innerHTML:vjs.util.htmlEncode(this.localize(r)),tabindex:-1})});this.menu.addItem(u)}else this.hide()}});n.ShareButton.prototype.buttonText=r;n.ShareButton.prototype.className="amp-share-control";n.ShareButton.prototype.createItems=function(){for(var e,r=f()||[],u=[],t=0;t<r.length;t++)e=new n.ShareMenuItem(i,r[t]),u.push(e);return u};i.ready(function(){var r=new n.ShareButton(i,t);i.controlBar.shareButton=i.controlBar.addChild(r)})})}(window.amp),function(n){n.plugin("subtitles",function(t){var i=this,r=!!t&&!!t.menuTitle?t.menuTitle:"Subtitles",u=!!t&&!!t.offMenuItemLabel?t.offMenuItemLabel:"Off";i.addEventListener(amp.eventName.loadedmetadata,function(){i.controlBar.subtitlesButton.el().className+=" amp-subtitles-control";i.controlBar.subtitlesButton.menu.children()[0].el().innerHTML=vjs.util.htmlEncode(this.localize(u));var t=new n.Component(i,{el:vjs.createEl("li",{className:"amp-menu-header",innerHTML:vjs.util.htmlEncode(this.localize(r)),tabindex:-1})});i.controlBar.subtitlesButton.menu.addItem(t)})})}(window.amp),function(n){n.plugin("timelineMarkers",function(t){function f(){i.duration()>0&&(s=i.duration(),h(),c())}function h(){for(var n=0;n<u.length;n++)i.controlBar.progressControl.seekBar.removeChild(u[n]);u=[]}function c(){for(var f,t=0;t<r.length;t++)f=new n.Marker(i,r[t]),u.push(f),i.controlBar.progressControl.seekBar.addChild(f)}var i=this,r=!!t&&!!t.markers?t.markers:[],e="#9CD5F4",o="amp-timeline-marker",s=0,u=[];n.Marker=vjs.Component.extend({init:function(n,t){var i=n.duration(),r=t.time>0?t.time:0,u=!t.color?e:t.color;vjs.Component.call(this,n,{el:vjs.Component.prototype.createEl.call(this,"div",{className:o})});this.el_.style.left=r/i*100+"%";this.el_.style.backgroundColor=u}});i.ready(function(){if(!!r&&r.length>0){f();i.on("loadedmetadata",function(){f()});i.on("durationchange",function(){f()})}})})}(window.amp),function(n){n.plugin("outline",function(n){function h(){t.controlBar.removeClass(i)}function u(n){n.classList.add(s);n.addEventListener("click",h)}function c(){for(var i,r=t.controlBar.el().querySelectorAll(e),n=0;n<r.length;n++)u(r[n]);if(!!f)for(i=t.controlBar.el().querySelectorAll(o),n=0;n<i.length;n++)u(i[n])}function l(){t.controlBar.addClass(i);r||(r=!0,c())}var t=this,f=!!n&&!!n.displayOnMenuItems,e=".vjs-control",o=".vjs-menu-item",i="outline-enabled",s="outline-enabled-control",r=!1;t.ready(function(){t.controlBar.on("keydown",l)})})}(window.amp);amp.AmpSkinPlugin=amp.Component.extend({init:function(n){var t=n.options_.logo,i=!!t&&t.enabled!==undefined?t.enabled:!0,r=!!t&&!!t.opacity?t.opacity:.5,u=!!t&&!!t.horizontalPosition?t.horizontalPosition:"left",f=!!t&&!!t.verticalPosition?t.verticalPosition:"top";n.options_.plugins=amp.obj.merge({logo:{enabled:i,opacity:r,horizontalPosition:u,verticalPosition:f},live:{controlText:"LIVE"},audioTracks:{menuTitle:"Audio Tracks"},closedCaption:{menuTitle:"Closed Captioning"},subtitles:{menuTitle:"Subtitles",offMenuItemLabel:"Off"},quality:{menuTitle:"Quality",selectedItem:0},moreOptions:{controls:["qualityButton","captionsButton","subtitlesButton","audioTracksButton","castToDeviceButton","shareButton","playbackSpeedButton","nextTrackButton","skipForwardButton","fastForwardButton","rewindButton","skipBackwardButton","previousTrackButton"]},controlBarIcons:{leftIcons:["playToggle","previousTrackButton","skipBackwardButton","rewindButton","fastForwardButton","skipForwardButton","nextTrackButton","playbackSpeedButton","liveDisplay"],middleIcons:["liveIndicator","currentTimeDisplay","timeDivider","durationDisplay"],rightIcons:["shareButton","castToDeviceButton","audioTracksButton","subtitlesButton","captionsButton","qualityButton","moreOptionsButton","volumeMenuButton","fullscreenToggle"],removeOtherIcons:!1},outline:{displayOnMenuItems:!0}},n.options_.plugins)}});amp.AmpSkinPlugin.prototype.dispose=function(){};amp.ControlBar.prototype.options_={loadEvent:"play",children:{playToggle:{},currentTimeDisplay:{},timeDivider:{},durationDisplay:{},remainingTimeDisplay:{},liveDisplay:{},progressControl:{},fullscreenToggle:{},volumeMenuButton:{volumeBar:{vertical:!0}},playbackRateMenuButton:{},subtitlesButton:{},captionsButton:{},chaptersButton:{},ampSkinPlugin:{}}};vjs.util.getBitrateByUnit=function(n){var t=n+"bps";return n>=1e6?(n=roundToOneDecimal(n/1e6),t=n+"Mbps"):n>=1e3&&(n=vjs.util.roundToOneDecimal(n/1e3),t=n+"Kbps"),t};vjs.util.roundToOneDecimal=function(n){return+(Math.round(n+"e+1")+"e-1")};