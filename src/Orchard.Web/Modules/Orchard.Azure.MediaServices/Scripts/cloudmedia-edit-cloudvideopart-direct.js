/*
** NOTE: This file is generated by Gulp and should not be edited directly!
** Any changes made directly to this file will be overwritten next time its asset group is processed by Gulp.
*/

/// <reference path="Typings/jquery.d.ts" />
/// <reference path="Typings/jqueryui.d.ts" />
/// <reference path="Typings/moment.d.ts" />
var Orchard;
(function (Orchard) {
    var Azure;
    (function (Azure) {
        var MediaServices;
        (function (MediaServices) {
            var CloudVideoEdit;
            (function (CloudVideoEdit) {
                var requiredUploads;
                function uploadCompleted(sender, e, data) {
                    var scope = $(sender).closest(".async-upload");
                    var status = data.errorThrown && data.errorThrown.length > 0 ? data.errorThrown : data.textStatus;
                    scope.find(".progress-bar").hide();
                    scope.find(".progress-text").hide();
                    scope.find(".progress-details").hide();
                    scope.find(".status.preparing").hide();
                    scope.find(".status.uploading").hide();
                    switch (status) {
                        case "error":
                            cleanup(scope, data);
                            alert("The upload of the selected file failed. You may try again after the cleanup has finished.");
                            return;
                        case "abort":
                            cleanup(scope, data);
                            return;
                    }
                    var editedFileName = scope.find("input[name$='.FileName']").val();
                    var statusUploaded = scope.find(".status.uploaded").show();
                    statusUploaded.text(statusUploaded.data("text-template").replace("{filename}", editedFileName));
                    scope.data("upload-isactive", false);
                    scope.data("upload-iscompleted", true);
                    scope.data("upload-start-time", null);
                }
                function cleanup(scope, data) {
                    var wamsAssetInput = scope.find("input[name$='.WamsAssetId']");
                    var fileNameInput = scope.find("input[name$='.FileName']");
                    var assetId = $.trim(wamsAssetInput.val());
                    var fileUploadWrapper = data.fileInput.closest(".file-upload-wrapper");
                    if (assetId.length > 0) {
                        var url = scope.data("delete-asset-url");
                        var antiForgeryToken = scope.closest("form").find("[name='__RequestVerificationToken']").val();
                        var cleanupMessage = scope.find(".status.cleanup");
                        wamsAssetInput.val("");
                        fileNameInput.val("");
                        cleanupMessage.show();
                        $.ajax({
                            url: url,
                            type: "DELETE",
                            data: {
                                id: assetId,
                                __RequestVerificationToken: antiForgeryToken
                            }
                        }).done(function () {
                            scope.data("upload-isactive", false);
                            scope.data("upload-start-time", null);
                            scope.find(".file-upload-wrapper").show();
                            cleanupMessage.hide();
                        }).fail(function () {
                            alert("An error occurred on the server while trying to clean up.");
                        });
                    }
                    fileUploadWrapper.show();
                }
                function pad(value, length) {
                    var str = value.toString();
                    while (str.length < length) {
                        str = "0" + str;
                    }
                    return str;
                }
                function createBlockId(blockIndex) {
                    var blockIdPrefix = "block-";
                    return btoa(blockIdPrefix + pad(blockIndex, 6));
                }
                function commitBlockList(scope, data) {
                    var deferred = $.Deferred();
                    var blockIds = scope.data("block-ids");
                    if (blockIds.length == 0) {
                        // The file was uploaded as a whole, so no manifest to submit.
                        deferred.resolve();
                    }
                    else {
                        // The file was uploaded in chunks.
                        var url = scope.data("sas-locator") + "&comp=blocklist";
                        var requestData = '<?xml version="1.0" encoding="utf-8"?><BlockList>';
                        for (var i = 0; i < blockIds.length; i++) {
                            requestData += '<Latest>' + blockIds[i] + '</Latest>';
                        }
                        requestData += '</BlockList>';
                        $.ajax({
                            url: url,
                            type: "PUT",
                            data: requestData,
                            contentType: "text/plain; charset=UTF-8",
                            crossDomain: true,
                            cache: false,
                            beforeSend: function (xhr) {
                                xhr.setRequestHeader('x-ms-date', new Date().toUTCString());
                                xhr.setRequestHeader('x-ms-blob-content-type', data.files[0].type);
                                xhr.setRequestHeader('x-ms-version', "2012-02-12");
                                xhr.setRequestHeader('Content-Length', requestData.length.toString());
                            },
                            success: function () {
                                deferred.resolve(data);
                            },
                            error: function (xhr, status, error) {
                                data.textStatus = status;
                                data.errorThrown = error;
                                deferred.fail(data);
                            }
                        });
                    }
                    return deferred.promise();
                }
                function hasActiveUploads() {
                    var scope = $(".upload-direct");
                    var flag = false;
                    scope.find(".async-upload").each(function () {
                        if ($(this).data("upload-isactive") == true) {
                            flag = true;
                            return false;
                        }
                    });
                    return flag;
                }
                function hasCompletedUploads() {
                    var scope = $(".upload-direct");
                    var flag = false;
                    scope.find(".async-upload").each(function () {
                        if ($(this).data("upload-iscompleted") == true) {
                            flag = true;
                            return false;
                        }
                    });
                    return flag;
                }
                function isSubmitting() {
                    var scope = $(".upload-direct");
                    return scope.data("is-submitting") == true;
                }
                ;
                function initializeUpload(fileInput) {
                    var scope = fileInput.closest(".async-upload");
                    var fileUploadWrapper = scope.find(".file-upload-wrapper");
                    var acceptFileTypesRegex = new RegExp(scope.data("upload-accept-file-types"));
                    var antiForgeryToken = scope.closest("form").find("[name='__RequestVerificationToken']").val();
                    var selectedFileWrapper = scope.find(".selected-file-wrapper");
                    var filenameInput = scope.find(".filename-input");
                    var resetButton = scope.find(".reset-button");
                    var uploadButton = scope.find(".upload-button");
                    var filenameText = scope.find(".filename-text");
                    var validationText = scope.find(".validation-text");
                    var preparingText = scope.find(".status.preparing");
                    var uploadingContainer = scope.find(".status.uploading");
                    var progressBar = scope.find(".progress-bar");
                    var progressText = scope.find(".progress-text");
                    var progressDetails = scope.find(".progress-details");
                    var cancelLink = scope.find(".cancel-link");
                    fileInput.fileupload({
                        autoUpload: false,
                        acceptFileTypes: acceptFileTypesRegex,
                        type: "PUT",
                        maxChunkSize: 4 * 1024 * 1024,
                        beforeSend: function (xhr, data) {
                            xhr.setRequestHeader("x-ms-date", new Date().toUTCString());
                            xhr.setRequestHeader("x-ms-blob-type", "BlockBlob");
                            xhr.setRequestHeader("content-length", data.data.size.toString());
                        },
                        chunksend: function (e, data) {
                            var blockIndex = scope.data("block-index");
                            var blockIds = scope.data("block-ids");
                            var blockId = createBlockId(blockIndex);
                            var url = scope.data("sas-locator") + "&comp=block&blockid=" + blockId;
                            data.url = url;
                            blockIds.push(blockId);
                            scope.data("block-index", blockIndex + 1);
                        },
                        progressall: function (e, data) {
                            var percentComplete = Math.floor((data.loaded / data.total) * 100);
                            var startTime = new Date(scope.data("upload-start-time"));
                            var elapsedMilliseconds = new Date(Date.now()).getTime() - startTime.getTime();
                            var elapsed = moment.duration(elapsedMilliseconds, "ms");
                            var remaining = moment.duration(elapsedMilliseconds / Math.max(data.loaded, 1) * (data.total - data.loaded), "ms");
                            var kbps = Math.floor(data.bitrate / 8 / 1000);
                            var uploaded = Math.floor(data.loaded / 1000);
                            var total = Math.floor(data.total / 1000);
                            progressBar.show().find(".progress").css("width", percentComplete + "%");
                            progressText.text(progressText.data("text-template").replace("{percentage}", percentComplete)).show();
                            progressDetails.text(progressDetails.data("text-template").replace("{uploaded}", uploaded).replace("{total}", total).replace("{kbps}", kbps).replace("{elapsed}", elapsed.humanize()).replace("{remaining}", remaining.humanize())).show();
                        },
                        done: function (e, data) {
                            var self = this;
                            commitBlockList(scope, data).always(function () {
                                uploadCompleted(self, e, data);
                            });
                        },
                        fail: function (e, data) {
                            uploadCompleted(this, e, data);
                        },
                        processdone: function (e, data) {
                            var selectedFilename = data.files[0].name;
                            scope.data("selected-filename", selectedFilename);
                            window.setTimeout(function () {
                                fileUploadWrapper.hide();
                                validationText.hide();
                                selectedFileWrapper.show();
                                filenameText.text(filenameText.data("text-template").replace("{filename}", selectedFilename));
                            }, 10);
                            scope[0].doReset = function () {
                                fileUploadWrapper.show();
                                filenameInput.val("");
                                filenameText.text("");
                                selectedFileWrapper.hide();
                                validationText.hide();
                            };
                            scope[0].doUpload = function () {
                                var editedFilename = filenameInput.val() || selectedFilename;
                                if (!acceptFileTypesRegex.test(editedFilename)) {
                                    validationText.show();
                                    return;
                                }
                                scope.data("upload-isactive", true);
                                scope.data("upload-start-time", Date.now());
                                var generateAssetUrl = scope.data("generate-asset-url");
                                scope.data("block-index", 0);
                                scope.data("block-ids", new Array());
                                preparingText.show();
                                selectedFileWrapper.hide();
                                validationText.hide();
                                $.ajax({
                                    url: generateAssetUrl,
                                    data: {
                                        filename: editedFilename,
                                        __RequestVerificationToken: antiForgeryToken
                                    },
                                    type: "POST"
                                }).done(function (asset) {
                                    data.url = asset.sasLocator;
                                    data.multipart = false;
                                    scope.data("sas-locator", asset.sasLocator);
                                    scope.find("input[name$='.FileName']").val(editedFilename);
                                    scope.find("input[name$='.WamsAssetId']").val(asset.assetId);
                                    preparingText.hide();
                                    progressText.text(progressText.data("text-template").replace("{percentage}", 0)).show();
                                    uploadingContainer.show();
                                    var xhr = data.submit();
                                    scope.data("xhr", xhr);
                                }).fail(function (xhr, status, error) {
                                    fileUploadWrapper.show();
                                    selectedFileWrapper.show();
                                    preparingText.hide();
                                    uploadingContainer.hide();
                                    scope.data("upload-isactive", false);
                                    scope.data("upload-start-time", null);
                                    alert("An error occurred. Error: " + error);
                                });
                            };
                        },
                        processfail: function (e, data) {
                            validationText.show();
                            filenameInput.val("");
                            filenameText.text("");
                            selectedFileWrapper.hide();
                        },
                        change: function (e, data) {
                            var prompt = fileInput.data("prompt");
                            if (prompt && prompt.length > 0) {
                                if (!confirm(prompt)) {
                                    e.preventDefault();
                                }
                            }
                        }
                    });
                    cancelLink.on("click", function (e) {
                        e.preventDefault();
                        if (confirm($(this).data("cancel-prompt"))) {
                            var xhr = scope.data("xhr");
                            xhr.abort();
                        }
                    });
                }
                function initializeUploadDirect() {
                    var scope = $(".upload-direct").show();
                    scope.find(".reset-button").on("click", function (e) {
                        var doReset = $(this).closest(".async-upload")[0].doReset;
                        if (!!doReset)
                            doReset();
                    });
                    scope.find(".upload-button").on("click", function (e) {
                        var doUpload = $(this).closest(".async-upload")[0].doUpload;
                        if (!!doUpload)
                            doUpload();
                    });
                    requiredUploads = scope.find(".required-upload");
                    scope.find(".async-upload-file-input").each(function () {
                        initializeUpload($(this));
                    });
                    scope.closest("form").on("submit", function (e) {
                        if (hasActiveUploads()) {
                            alert(scope.data("block-submit-prompt"));
                            e.preventDefault();
                            return false;
                        }
                        scope.data("is-submitting", true);
                    });
                    $(window).on("beforeunload", function (e) {
                        if ((hasActiveUploads() || hasCompletedUploads()) && !isSubmitting()) {
                            var message = scope.data("navigate-away-prompt");
                            e.result = message;
                            return message;
                        }
                    });
                }
                CloudVideoEdit.initializeUploadDirect = initializeUploadDirect;
            })(CloudVideoEdit = MediaServices.CloudVideoEdit || (MediaServices.CloudVideoEdit = {}));
        })(MediaServices = Azure.MediaServices || (Azure.MediaServices = {}));
    })(Azure = Orchard.Azure || (Orchard.Azure = {}));
})(Orchard || (Orchard = {}));

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNsb3VkbWVkaWEtZWRpdC1jbG91ZHZpZGVvcGFydC1kaXJlY3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSw0Q0FBNEM7QUFDNUMsOENBQThDO0FBQzlDLDRDQUE0QztBQUU1QyxJQUFPLE9BQU8sQ0FpV2I7QUFqV0QsV0FBTyxPQUFPO0lBQUMsSUFBQSxLQUFLLENBaVduQjtJQWpXYyxXQUFBLEtBQUs7UUFBQyxJQUFBLGFBQWEsQ0FpV2pDO1FBaldvQixXQUFBLGFBQWE7WUFBQyxJQUFBLGNBQWMsQ0FpV2hEO1lBaldrQyxXQUFBLGNBQWM7Z0JBQzdDLElBQUksZUFBdUIsQ0FBQztnQkFFNUIseUJBQXlCLE1BQVcsRUFBRSxDQUFNLEVBQUUsSUFBUztvQkFDbkQsSUFBSSxLQUFLLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQztvQkFDL0MsSUFBSSxNQUFNLEdBQUcsSUFBSSxDQUFDLFdBQVcsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDO29CQUNsRyxLQUFLLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDO29CQUNuQyxLQUFLLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7b0JBQ3BDLEtBQUssQ0FBQyxJQUFJLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztvQkFDdkMsS0FBSyxDQUFDLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDO29CQUN2QyxLQUFLLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7b0JBRXZDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7d0JBQ2IsS0FBSyxPQUFPOzRCQUNSLE9BQU8sQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUM7NEJBQ3JCLEtBQUssQ0FBQywyRkFBMkYsQ0FBQyxDQUFDOzRCQUNuRyxNQUFNLENBQUM7d0JBQ1gsS0FBSyxPQUFPOzRCQUNSLE9BQU8sQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUM7NEJBQ3JCLE1BQU0sQ0FBQztvQkFDZixDQUFDO29CQUVELElBQUksY0FBYyxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsMEJBQTBCLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQztvQkFDbEUsSUFBSSxjQUFjLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDO29CQUUzRCxjQUFjLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsT0FBTyxDQUFDLFlBQVksRUFBRSxjQUFjLENBQUMsQ0FBQyxDQUFDO29CQUNoRyxLQUFLLENBQUMsSUFBSSxDQUFDLGlCQUFpQixFQUFFLEtBQUssQ0FBQyxDQUFDO29CQUNyQyxLQUFLLENBQUMsSUFBSSxDQUFDLG9CQUFvQixFQUFFLElBQUksQ0FBQyxDQUFDO29CQUN2QyxLQUFLLENBQUMsSUFBSSxDQUFDLG1CQUFtQixFQUFFLElBQUksQ0FBQyxDQUFDO2dCQUMxQyxDQUFDO2dCQUVELGlCQUFpQixLQUFhLEVBQUUsSUFBUztvQkFDckMsSUFBSSxjQUFjLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDO29CQUMvRCxJQUFJLGFBQWEsR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLDBCQUEwQixDQUFDLENBQUM7b0JBQzNELElBQUksT0FBTyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUM7b0JBQzNDLElBQUksaUJBQWlCLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsc0JBQXNCLENBQUMsQ0FBQztvQkFFdkUsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO3dCQUNyQixJQUFJLEdBQUcsR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLENBQUM7d0JBQ3pDLElBQUksZ0JBQWdCLEdBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMscUNBQXFDLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQzt3QkFDL0YsSUFBSSxjQUFjLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO3dCQUVuRCxjQUFjLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDO3dCQUN2QixhQUFhLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDO3dCQUV0QixjQUFjLENBQUMsSUFBSSxFQUFFLENBQUM7d0JBRXRCLENBQUMsQ0FBQyxJQUFJLENBQUM7NEJBQ0gsR0FBRyxFQUFFLEdBQUc7NEJBQ1IsSUFBSSxFQUFFLFFBQVE7NEJBQ2QsSUFBSSxFQUFFO2dDQUNGLEVBQUUsRUFBRSxPQUFPO2dDQUNYLDBCQUEwQixFQUFFLGdCQUFnQjs2QkFDL0M7eUJBQ0osQ0FBQyxDQUFDLElBQUksQ0FBQzs0QkFDSixLQUFLLENBQUMsSUFBSSxDQUFDLGlCQUFpQixFQUFFLEtBQUssQ0FBQyxDQUFDOzRCQUNyQyxLQUFLLENBQUMsSUFBSSxDQUFDLG1CQUFtQixFQUFFLElBQUksQ0FBQyxDQUFDOzRCQUN0QyxLQUFLLENBQUMsSUFBSSxDQUFDLHNCQUFzQixDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7NEJBQzFDLGNBQWMsQ0FBQyxJQUFJLEVBQUUsQ0FBQzt3QkFDMUIsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDOzRCQUNKLEtBQUssQ0FBQywyREFBMkQsQ0FBQyxDQUFDO3dCQUN2RSxDQUFDLENBQUMsQ0FBQztvQkFDUCxDQUFDO29CQUVELGlCQUFpQixDQUFDLElBQUksRUFBRSxDQUFDO2dCQUM3QixDQUFDO2dCQUVELGFBQWEsS0FBYSxFQUFFLE1BQWM7b0JBQ3RDLElBQUksR0FBRyxHQUFHLEtBQUssQ0FBQyxRQUFRLEVBQUUsQ0FBQztvQkFDM0IsT0FBTyxHQUFHLENBQUMsTUFBTSxHQUFHLE1BQU0sRUFBRSxDQUFDO3dCQUN6QixHQUFHLEdBQUcsR0FBRyxHQUFHLEdBQUcsQ0FBQztvQkFDcEIsQ0FBQztvQkFDRCxNQUFNLENBQUMsR0FBRyxDQUFDO2dCQUNmLENBQUM7Z0JBRUQsdUJBQXVCLFVBQWtCO29CQUNyQyxJQUFJLGFBQWEsR0FBRyxRQUFRLENBQUM7b0JBQzdCLE1BQU0sQ0FBQyxJQUFJLENBQUMsYUFBYSxHQUFHLEdBQUcsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDcEQsQ0FBQztnQkFFRCx5QkFBeUIsS0FBYSxFQUFFLElBQVM7b0JBQzdDLElBQUksUUFBUSxHQUFHLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQztvQkFDNUIsSUFBSSxRQUFRLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztvQkFFdkMsRUFBRSxDQUFDLENBQUMsUUFBUSxDQUFDLE1BQU0sSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO3dCQUN2Qiw4REFBOEQ7d0JBQzlELFFBQVEsQ0FBQyxPQUFPLEVBQUUsQ0FBQztvQkFDdkIsQ0FBQztvQkFBQyxJQUFJLENBQUMsQ0FBQzt3QkFDSixtQ0FBbUM7d0JBQ25DLElBQUksR0FBRyxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLEdBQUcsaUJBQWlCLENBQUM7d0JBQ3hELElBQUksV0FBVyxHQUFHLG1EQUFtRCxDQUFDO3dCQUN0RSxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFFBQVEsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQzs0QkFDdkMsV0FBVyxJQUFJLFVBQVUsR0FBRyxRQUFRLENBQUMsQ0FBQyxDQUFDLEdBQUcsV0FBVyxDQUFDO3dCQUMxRCxDQUFDO3dCQUNELFdBQVcsSUFBSSxjQUFjLENBQUM7d0JBRTlCLENBQUMsQ0FBQyxJQUFJLENBQUM7NEJBQ0gsR0FBRyxFQUFFLEdBQUc7NEJBQ1IsSUFBSSxFQUFFLEtBQUs7NEJBQ1gsSUFBSSxFQUFFLFdBQVc7NEJBQ2pCLFdBQVcsRUFBRSwyQkFBMkI7NEJBQ3hDLFdBQVcsRUFBRSxJQUFJOzRCQUNqQixLQUFLLEVBQUUsS0FBSzs0QkFDWixVQUFVLEVBQUUsVUFBVSxHQUFHO2dDQUNyQixHQUFHLENBQUMsZ0JBQWdCLENBQUMsV0FBVyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQztnQ0FDNUQsR0FBRyxDQUFDLGdCQUFnQixDQUFDLHdCQUF3QixFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7Z0NBQ25FLEdBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxjQUFjLEVBQUUsWUFBWSxDQUFDLENBQUM7Z0NBQ25ELEdBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxnQkFBZ0IsRUFBRSxXQUFXLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUM7NEJBQzFFLENBQUM7NEJBQ0QsT0FBTyxFQUFFO2dDQUNMLFFBQVEsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7NEJBQzNCLENBQUM7NEJBQ0QsS0FBSyxFQUFFLFVBQVUsR0FBRyxFQUFFLE1BQU0sRUFBRSxLQUFLO2dDQUMvQixJQUFJLENBQUMsVUFBVSxHQUFHLE1BQU0sQ0FBQztnQ0FDekIsSUFBSSxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUM7Z0NBQ3pCLFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7NEJBQ3hCLENBQUM7eUJBQ0osQ0FBQyxDQUFDO29CQUNQLENBQUM7b0JBRUQsTUFBTSxDQUFDLFFBQVEsQ0FBQyxPQUFPLEVBQUUsQ0FBQztnQkFDOUIsQ0FBQztnQkFFRDtvQkFDSSxJQUFJLEtBQUssR0FBRyxDQUFDLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztvQkFDaEMsSUFBSSxJQUFJLEdBQUcsS0FBSyxDQUFDO29CQUVqQixLQUFLLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDLElBQUksQ0FBQzt3QkFDN0IsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUM7NEJBQzFDLElBQUksR0FBRyxJQUFJLENBQUM7NEJBQ1osTUFBTSxDQUFDLEtBQUssQ0FBQzt3QkFDakIsQ0FBQztvQkFDTCxDQUFDLENBQUMsQ0FBQztvQkFFSCxNQUFNLENBQUMsSUFBSSxDQUFDO2dCQUNoQixDQUFDO2dCQUVEO29CQUNJLElBQUksS0FBSyxHQUFHLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO29CQUNoQyxJQUFJLElBQUksR0FBRyxLQUFLLENBQUM7b0JBRWpCLEtBQUssQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsSUFBSSxDQUFDO3dCQUM3QixFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLG9CQUFvQixDQUFDLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQzs0QkFDN0MsSUFBSSxHQUFHLElBQUksQ0FBQzs0QkFDWixNQUFNLENBQUMsS0FBSyxDQUFDO3dCQUNqQixDQUFDO29CQUNMLENBQUMsQ0FBQyxDQUFDO29CQUVILE1BQU0sQ0FBQyxJQUFJLENBQUM7Z0JBQ2hCLENBQUM7Z0JBRUQ7b0JBQ0ksSUFBSSxLQUFLLEdBQUcsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLENBQUM7b0JBQ2hDLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxJQUFJLElBQUksQ0FBQztnQkFDL0MsQ0FBQztnQkFBQSxDQUFDO2dCQUVGLDBCQUEwQixTQUFpQjtvQkFDdkMsSUFBSSxLQUFLLEdBQUcsU0FBUyxDQUFDLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQztvQkFDL0MsSUFBSSxpQkFBaUIsR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLHNCQUFzQixDQUFDLENBQUM7b0JBQzNELElBQUksb0JBQW9CLEdBQUcsSUFBSSxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQywwQkFBMEIsQ0FBQyxDQUFDLENBQUM7b0JBQzlFLElBQUksZ0JBQWdCLEdBQVcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMscUNBQXFDLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQztvQkFFdkcsSUFBSSxtQkFBbUIsR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLHdCQUF3QixDQUFDLENBQUM7b0JBQy9ELElBQUksYUFBYSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsQ0FBQztvQkFDbEQsSUFBSSxXQUFXLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQztvQkFDOUMsSUFBSSxZQUFZLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO29CQUNoRCxJQUFJLFlBQVksR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUM7b0JBRWhELElBQUksY0FBYyxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQztvQkFDcEQsSUFBSSxhQUFhLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO29CQUNwRCxJQUFJLGtCQUFrQixHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsbUJBQW1CLENBQUMsQ0FBQztvQkFDekQsSUFBSSxXQUFXLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQztvQkFDOUMsSUFBSSxZQUFZLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO29CQUNoRCxJQUFJLGVBQWUsR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLENBQUM7b0JBQ3RELElBQUksVUFBVSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7b0JBRXRDLFNBQVUsQ0FBQyxVQUFVLENBQUM7d0JBQ3hCLFVBQVUsRUFBRSxLQUFLO3dCQUNqQixlQUFlLEVBQUUsb0JBQW9CO3dCQUNyQyxJQUFJLEVBQUUsS0FBSzt3QkFDWCxZQUFZLEVBQUUsQ0FBQyxHQUFHLElBQUksR0FBRyxJQUFJO3dCQUM3QixVQUFVLEVBQUUsVUFBQyxHQUFjLEVBQUUsSUFBUzs0QkFDbEMsR0FBRyxDQUFDLGdCQUFnQixDQUFDLFdBQVcsRUFBRSxJQUFJLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUM7NEJBQzVELEdBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxnQkFBZ0IsRUFBRSxXQUFXLENBQUMsQ0FBQzs0QkFDcEQsR0FBRyxDQUFDLGdCQUFnQixDQUFDLGdCQUFnQixFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUM7d0JBQ3RFLENBQUM7d0JBQ0QsU0FBUyxFQUFFLFVBQVUsQ0FBTSxFQUFFLElBQVM7NEJBQ2xDLElBQUksVUFBVSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7NEJBQzNDLElBQUksUUFBUSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7NEJBQ3ZDLElBQUksT0FBTyxHQUFHLGFBQWEsQ0FBQyxVQUFVLENBQUMsQ0FBQzs0QkFDeEMsSUFBSSxHQUFHLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsR0FBRyxzQkFBc0IsR0FBRyxPQUFPLENBQUM7NEJBRXZFLElBQUksQ0FBQyxHQUFHLEdBQUcsR0FBRyxDQUFDOzRCQUNmLFFBQVEsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7NEJBQ3ZCLEtBQUssQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFLFVBQVUsR0FBRyxDQUFDLENBQUMsQ0FBQzt3QkFDOUMsQ0FBQzt3QkFDRCxXQUFXLEVBQUUsVUFBVSxDQUFNLEVBQUUsSUFBUzs0QkFDcEMsSUFBSSxlQUFlLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDOzRCQUNuRSxJQUFJLFNBQVMsR0FBRyxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLENBQUMsQ0FBQzs0QkFDMUQsSUFBSSxtQkFBbUIsR0FBRyxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxPQUFPLEVBQUUsR0FBRyxTQUFTLENBQUMsT0FBTyxFQUFFLENBQUM7NEJBQy9FLElBQUksT0FBTyxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsbUJBQW1CLEVBQUUsSUFBSSxDQUFDLENBQUM7NEJBQ3pELElBQUksU0FBUyxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsbUJBQW1CLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7NEJBQ25ILElBQUksSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE9BQU8sR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUM7NEJBQy9DLElBQUksUUFBUSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsQ0FBQzs0QkFDOUMsSUFBSSxLQUFLLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxDQUFDOzRCQUUxQyxXQUFXLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsZUFBZSxHQUFHLEdBQUcsQ0FBQyxDQUFDOzRCQUN6RSxZQUFZLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsT0FBTyxDQUFDLGNBQWMsRUFBRSxlQUFlLENBQUMsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDOzRCQUN0RyxlQUFlLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsT0FBTyxDQUFDLFlBQVksRUFBRSxRQUFRLENBQUMsQ0FBQyxPQUFPLENBQUMsU0FBUyxFQUFFLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxPQUFPLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsYUFBYSxFQUFFLFNBQVMsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7d0JBQy9PLENBQUM7d0JBQ0QsSUFBSSxFQUFFLFVBQVUsQ0FBTSxFQUFFLElBQVM7NEJBQzdCLElBQUksSUFBSSxHQUFHLElBQUksQ0FBQzs0QkFDaEIsZUFBZSxDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUM7Z0NBQ2hDLGVBQWUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDOzRCQUNuQyxDQUFDLENBQUMsQ0FBQzt3QkFDUCxDQUFDO3dCQUNELElBQUksRUFBRSxVQUFVLENBQU0sRUFBRSxJQUFTOzRCQUM3QixlQUFlLENBQUMsSUFBSSxFQUFFLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQzt3QkFDbkMsQ0FBQzt3QkFDRCxXQUFXLEVBQUUsVUFBVSxDQUFNLEVBQUUsSUFBUzs0QkFDcEMsSUFBSSxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQzs0QkFDMUMsS0FBSyxDQUFDLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDOzRCQUNsRCxNQUFNLENBQUMsVUFBVSxDQUFDO2dDQUNkLGlCQUFpQixDQUFDLElBQUksRUFBRSxDQUFDO2dDQUN6QixjQUFjLENBQUMsSUFBSSxFQUFFLENBQUM7Z0NBQ3RCLG1CQUFtQixDQUFDLElBQUksRUFBRSxDQUFDO2dDQUMzQixZQUFZLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsT0FBTyxDQUFDLFlBQVksRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDLENBQUM7NEJBQ2xHLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQzs0QkFFRCxLQUFLLENBQUMsQ0FBQyxDQUFFLENBQUMsT0FBTyxHQUFHO2dDQUN0QixpQkFBaUIsQ0FBQyxJQUFJLEVBQUUsQ0FBQztnQ0FDekIsYUFBYSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQztnQ0FDdEIsWUFBWSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztnQ0FDdEIsbUJBQW1CLENBQUMsSUFBSSxFQUFFLENBQUM7Z0NBQzNCLGNBQWMsQ0FBQyxJQUFJLEVBQUUsQ0FBQzs0QkFDMUIsQ0FBQyxDQUFDOzRCQUVJLEtBQUssQ0FBQyxDQUFDLENBQUUsQ0FBQyxRQUFRLEdBQUc7Z0NBQ3ZCLElBQUksY0FBYyxHQUFHLGFBQWEsQ0FBQyxHQUFHLEVBQUUsSUFBSSxnQkFBZ0IsQ0FBQztnQ0FDN0QsRUFBRSxDQUFDLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxDQUFDO29DQUM3QyxjQUFjLENBQUMsSUFBSSxFQUFFLENBQUM7b0NBQ3RCLE1BQU0sQ0FBQztnQ0FDWCxDQUFDO2dDQUVELEtBQUssQ0FBQyxJQUFJLENBQUMsaUJBQWlCLEVBQUUsSUFBSSxDQUFDLENBQUM7Z0NBQ3BDLEtBQUssQ0FBQyxJQUFJLENBQUMsbUJBQW1CLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUM7Z0NBQzVDLElBQUksZ0JBQWdCLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO2dDQUN4RCxLQUFLLENBQUMsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDLENBQUMsQ0FBQztnQ0FDN0IsS0FBSyxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsSUFBSSxLQUFLLEVBQUUsQ0FBQyxDQUFDO2dDQUVyQyxhQUFhLENBQUMsSUFBSSxFQUFFLENBQUM7Z0NBQ3JCLG1CQUFtQixDQUFDLElBQUksRUFBRSxDQUFDO2dDQUMzQixjQUFjLENBQUMsSUFBSSxFQUFFLENBQUM7Z0NBRXRCLENBQUMsQ0FBQyxJQUFJLENBQUM7b0NBQ0gsR0FBRyxFQUFFLGdCQUFnQjtvQ0FDckIsSUFBSSxFQUFFO3dDQUNGLFFBQVEsRUFBRSxjQUFjO3dDQUN4QiwwQkFBMEIsRUFBRSxnQkFBZ0I7cUNBQy9DO29DQUNELElBQUksRUFBRSxNQUFNO2lDQUNmLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxLQUFVO29DQUNwQixJQUFJLENBQUMsR0FBRyxHQUFHLEtBQUssQ0FBQyxVQUFVLENBQUM7b0NBQzVCLElBQUksQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFDO29DQUV2QixLQUFLLENBQUMsSUFBSSxDQUFDLGFBQWEsRUFBRSxLQUFLLENBQUMsVUFBVSxDQUFDLENBQUM7b0NBQzVDLEtBQUssQ0FBQyxJQUFJLENBQUMsMEJBQTBCLENBQUMsQ0FBQyxHQUFHLENBQUMsY0FBYyxDQUFDLENBQUM7b0NBQzNELEtBQUssQ0FBQyxJQUFJLENBQUMsNkJBQTZCLENBQUMsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO29DQUU3RCxhQUFhLENBQUMsSUFBSSxFQUFFLENBQUM7b0NBQ3JCLFlBQVksQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQyxPQUFPLENBQUMsY0FBYyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7b0NBQ3hGLGtCQUFrQixDQUFDLElBQUksRUFBRSxDQUFDO29DQUUxQixJQUFJLEdBQUcsR0FBRyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7b0NBQ3hCLEtBQUssQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLEdBQUcsQ0FBQyxDQUFDO2dDQUMzQixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxHQUFRLEVBQUUsTUFBVyxFQUFFLEtBQVU7b0NBQy9DLGlCQUFpQixDQUFDLElBQUksRUFBRSxDQUFDO29DQUN6QixtQkFBbUIsQ0FBQyxJQUFJLEVBQUUsQ0FBQztvQ0FDM0IsYUFBYSxDQUFDLElBQUksRUFBRSxDQUFDO29DQUNyQixrQkFBa0IsQ0FBQyxJQUFJLEVBQUUsQ0FBQztvQ0FFMUIsS0FBSyxDQUFDLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxLQUFLLENBQUMsQ0FBQztvQ0FDckMsS0FBSyxDQUFDLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxJQUFJLENBQUMsQ0FBQztvQ0FDdEMsS0FBSyxDQUFDLDRCQUE0QixHQUFHLEtBQUssQ0FBQyxDQUFDO2dDQUNoRCxDQUFDLENBQUMsQ0FBQzs0QkFDWCxDQUFDLENBQUM7d0JBQ04sQ0FBQzt3QkFDRCxXQUFXLEVBQUUsVUFBVSxDQUFNLEVBQUUsSUFBUzs0QkFDcEMsY0FBYyxDQUFDLElBQUksRUFBRSxDQUFDOzRCQUN0QixhQUFhLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDOzRCQUN0QixZQUFZLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDOzRCQUN0QixtQkFBbUIsQ0FBQyxJQUFJLEVBQUUsQ0FBQzt3QkFDL0IsQ0FBQzt3QkFDRCxNQUFNLEVBQUUsVUFBVSxDQUFNLEVBQUUsSUFBUzs0QkFDL0IsSUFBSSxNQUFNLEdBQUcsU0FBUyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQzs0QkFDdEMsRUFBRSxDQUFDLENBQUMsTUFBTSxJQUFJLE1BQU0sQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQ0FDOUIsRUFBRSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO29DQUNuQixDQUFDLENBQUMsY0FBYyxFQUFFLENBQUM7Z0NBQ3ZCLENBQUM7NEJBQ0wsQ0FBQzt3QkFDTCxDQUFDO3FCQUNKLENBQUMsQ0FBQztvQkFFSCxVQUFVLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxVQUFVLENBQUM7d0JBQzlCLENBQUMsQ0FBQyxjQUFjLEVBQUUsQ0FBQzt3QkFFbkIsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7NEJBQ3pDLElBQUksR0FBRyxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7NEJBQzVCLEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQzt3QkFDaEIsQ0FBQztvQkFDTCxDQUFDLENBQUMsQ0FBQztnQkFDUCxDQUFDO2dCQUVEO29CQUVJLElBQUksS0FBSyxHQUFHLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDO29CQUV2QyxLQUFLLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsVUFBVSxDQUFDO3dCQUMvQyxJQUFJLE9BQU8sR0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsT0FBTyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBRSxDQUFDLE9BQU8sQ0FBQzt3QkFDakUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQzs0QkFDVixPQUFPLEVBQUUsQ0FBQztvQkFDbEIsQ0FBQyxDQUFDLENBQUM7b0JBRUgsS0FBSyxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsVUFBVSxDQUFDO3dCQUNoRCxJQUFJLFFBQVEsR0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsT0FBTyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBRSxDQUFDLFFBQVEsQ0FBQzt3QkFDbkUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQzs0QkFDWCxRQUFRLEVBQUUsQ0FBQztvQkFDbkIsQ0FBQyxDQUFDLENBQUM7b0JBRUgsZUFBZSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQztvQkFFakQsS0FBSyxDQUFDLElBQUksQ0FBQywwQkFBMEIsQ0FBQyxDQUFDLElBQUksQ0FBQzt3QkFDeEMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7b0JBQzlCLENBQUMsQ0FBQyxDQUFDO29CQUVILEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLFFBQVEsRUFBRSxVQUFVLENBQUM7d0JBQzFDLEVBQUUsQ0FBQyxDQUFDLGdCQUFnQixFQUFFLENBQUMsQ0FBQyxDQUFDOzRCQUNyQixLQUFLLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLENBQUM7NEJBQ3pDLENBQUMsQ0FBQyxjQUFjLEVBQUUsQ0FBQzs0QkFDbkIsTUFBTSxDQUFDLEtBQUssQ0FBQzt3QkFDakIsQ0FBQzt3QkFFRCxLQUFLLENBQUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxJQUFJLENBQUMsQ0FBQztvQkFDdEMsQ0FBQyxDQUFDLENBQUM7b0JBRUgsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxjQUFjLEVBQUUsVUFBVSxDQUFDO3dCQUNwQyxFQUFFLENBQUMsQ0FBQyxDQUFDLGdCQUFnQixFQUFFLElBQUksbUJBQW1CLEVBQUUsQ0FBQyxJQUFJLENBQUMsWUFBWSxFQUFFLENBQUMsQ0FBQyxDQUFDOzRCQUNuRSxJQUFJLE9BQU8sR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLHNCQUFzQixDQUFDLENBQUM7NEJBQ2pELENBQUMsQ0FBQyxNQUFNLEdBQUcsT0FBTyxDQUFDOzRCQUNuQixNQUFNLENBQUMsT0FBTyxDQUFDO3dCQUNuQixDQUFDO29CQUNMLENBQUMsQ0FBQyxDQUFDO2dCQUNQLENBQUM7Z0JBdkNlLHFDQUFzQix5QkF1Q3JDLENBQUE7WUFDTCxDQUFDLEVBaldrQyxjQUFjLEdBQWQsNEJBQWMsS0FBZCw0QkFBYyxRQWlXaEQ7UUFBRCxDQUFDLEVBaldvQixhQUFhLEdBQWIsbUJBQWEsS0FBYixtQkFBYSxRQWlXakM7SUFBRCxDQUFDLEVBaldjLEtBQUssR0FBTCxhQUFLLEtBQUwsYUFBSyxRQWlXbkI7QUFBRCxDQUFDLEVBaldNLE9BQU8sS0FBUCxPQUFPLFFBaVdiIiwiZmlsZSI6ImNsb3VkbWVkaWEtZWRpdC1jbG91ZHZpZGVvcGFydC1kaXJlY3QuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiVHlwaW5ncy9qcXVlcnkuZC50c1wiIC8+XHJcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJUeXBpbmdzL2pxdWVyeXVpLmQudHNcIiAvPlxyXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiVHlwaW5ncy9tb21lbnQuZC50c1wiIC8+XHJcblxyXG5tb2R1bGUgT3JjaGFyZC5BenVyZS5NZWRpYVNlcnZpY2VzLkNsb3VkVmlkZW9FZGl0IHtcclxuICAgIHZhciByZXF1aXJlZFVwbG9hZHM6IEpRdWVyeTtcclxuXHJcbiAgICBmdW5jdGlvbiB1cGxvYWRDb21wbGV0ZWQoc2VuZGVyOiBhbnksIGU6IGFueSwgZGF0YTogYW55KSB7XHJcbiAgICAgICAgdmFyIHNjb3BlID0gJChzZW5kZXIpLmNsb3Nlc3QoXCIuYXN5bmMtdXBsb2FkXCIpO1xyXG4gICAgICAgIHZhciBzdGF0dXMgPSBkYXRhLmVycm9yVGhyb3duICYmIGRhdGEuZXJyb3JUaHJvd24ubGVuZ3RoID4gMCA/IGRhdGEuZXJyb3JUaHJvd24gOiBkYXRhLnRleHRTdGF0dXM7XHJcbiAgICAgICAgc2NvcGUuZmluZChcIi5wcm9ncmVzcy1iYXJcIikuaGlkZSgpO1xyXG4gICAgICAgIHNjb3BlLmZpbmQoXCIucHJvZ3Jlc3MtdGV4dFwiKS5oaWRlKCk7XHJcbiAgICAgICAgc2NvcGUuZmluZChcIi5wcm9ncmVzcy1kZXRhaWxzXCIpLmhpZGUoKTtcclxuICAgICAgICBzY29wZS5maW5kKFwiLnN0YXR1cy5wcmVwYXJpbmdcIikuaGlkZSgpO1xyXG4gICAgICAgIHNjb3BlLmZpbmQoXCIuc3RhdHVzLnVwbG9hZGluZ1wiKS5oaWRlKCk7XHJcblxyXG4gICAgICAgIHN3aXRjaCAoc3RhdHVzKSB7XHJcbiAgICAgICAgICAgIGNhc2UgXCJlcnJvclwiOlxyXG4gICAgICAgICAgICAgICAgY2xlYW51cChzY29wZSwgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICBhbGVydChcIlRoZSB1cGxvYWQgb2YgdGhlIHNlbGVjdGVkIGZpbGUgZmFpbGVkLiBZb3UgbWF5IHRyeSBhZ2FpbiBhZnRlciB0aGUgY2xlYW51cCBoYXMgZmluaXNoZWQuXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICBjYXNlIFwiYWJvcnRcIjpcclxuICAgICAgICAgICAgICAgIGNsZWFudXAoc2NvcGUsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGVkaXRlZEZpbGVOYW1lID0gc2NvcGUuZmluZChcImlucHV0W25hbWUkPScuRmlsZU5hbWUnXVwiKS52YWwoKTtcclxuICAgICAgICB2YXIgc3RhdHVzVXBsb2FkZWQgPSBzY29wZS5maW5kKFwiLnN0YXR1cy51cGxvYWRlZFwiKS5zaG93KCk7XHJcblxyXG4gICAgICAgIHN0YXR1c1VwbG9hZGVkLnRleHQoc3RhdHVzVXBsb2FkZWQuZGF0YShcInRleHQtdGVtcGxhdGVcIikucmVwbGFjZShcIntmaWxlbmFtZX1cIiwgZWRpdGVkRmlsZU5hbWUpKTtcclxuICAgICAgICBzY29wZS5kYXRhKFwidXBsb2FkLWlzYWN0aXZlXCIsIGZhbHNlKTtcclxuICAgICAgICBzY29wZS5kYXRhKFwidXBsb2FkLWlzY29tcGxldGVkXCIsIHRydWUpO1xyXG4gICAgICAgIHNjb3BlLmRhdGEoXCJ1cGxvYWQtc3RhcnQtdGltZVwiLCBudWxsKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjbGVhbnVwKHNjb3BlOiBKUXVlcnksIGRhdGE6IGFueSkge1xyXG4gICAgICAgIHZhciB3YW1zQXNzZXRJbnB1dCA9IHNjb3BlLmZpbmQoXCJpbnB1dFtuYW1lJD0nLldhbXNBc3NldElkJ11cIik7XHJcbiAgICAgICAgdmFyIGZpbGVOYW1lSW5wdXQgPSBzY29wZS5maW5kKFwiaW5wdXRbbmFtZSQ9Jy5GaWxlTmFtZSddXCIpO1xyXG4gICAgICAgIHZhciBhc3NldElkID0gJC50cmltKHdhbXNBc3NldElucHV0LnZhbCgpKTtcclxuICAgICAgICB2YXIgZmlsZVVwbG9hZFdyYXBwZXIgPSBkYXRhLmZpbGVJbnB1dC5jbG9zZXN0KFwiLmZpbGUtdXBsb2FkLXdyYXBwZXJcIik7XHJcblxyXG4gICAgICAgIGlmIChhc3NldElkLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgdmFyIHVybCA9IHNjb3BlLmRhdGEoXCJkZWxldGUtYXNzZXQtdXJsXCIpO1xyXG4gICAgICAgICAgICB2YXIgYW50aUZvcmdlcnlUb2tlbiA9IHNjb3BlLmNsb3Nlc3QoXCJmb3JtXCIpLmZpbmQoXCJbbmFtZT0nX19SZXF1ZXN0VmVyaWZpY2F0aW9uVG9rZW4nXVwiKS52YWwoKTtcclxuICAgICAgICAgICAgdmFyIGNsZWFudXBNZXNzYWdlID0gc2NvcGUuZmluZChcIi5zdGF0dXMuY2xlYW51cFwiKTtcclxuXHJcbiAgICAgICAgICAgIHdhbXNBc3NldElucHV0LnZhbChcIlwiKTtcclxuICAgICAgICAgICAgZmlsZU5hbWVJbnB1dC52YWwoXCJcIik7XHJcblxyXG4gICAgICAgICAgICBjbGVhbnVwTWVzc2FnZS5zaG93KCk7XHJcblxyXG4gICAgICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICAgICAgdXJsOiB1cmwsXHJcbiAgICAgICAgICAgICAgICB0eXBlOiBcIkRFTEVURVwiLFxyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBhc3NldElkLFxyXG4gICAgICAgICAgICAgICAgICAgIF9fUmVxdWVzdFZlcmlmaWNhdGlvblRva2VuOiBhbnRpRm9yZ2VyeVRva2VuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pLmRvbmUoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgc2NvcGUuZGF0YShcInVwbG9hZC1pc2FjdGl2ZVwiLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICBzY29wZS5kYXRhKFwidXBsb2FkLXN0YXJ0LXRpbWVcIiwgbnVsbCk7XHJcbiAgICAgICAgICAgICAgICBzY29wZS5maW5kKFwiLmZpbGUtdXBsb2FkLXdyYXBwZXJcIikuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgY2xlYW51cE1lc3NhZ2UuaGlkZSgpO1xyXG4gICAgICAgICAgICB9KS5mYWlsKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGFsZXJ0KFwiQW4gZXJyb3Igb2NjdXJyZWQgb24gdGhlIHNlcnZlciB3aGlsZSB0cnlpbmcgdG8gY2xlYW4gdXAuXCIpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZpbGVVcGxvYWRXcmFwcGVyLnNob3coKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBwYWQodmFsdWU6IG51bWJlciwgbGVuZ3RoOiBudW1iZXIpIHtcclxuICAgICAgICB2YXIgc3RyID0gdmFsdWUudG9TdHJpbmcoKTtcclxuICAgICAgICB3aGlsZSAoc3RyLmxlbmd0aCA8IGxlbmd0aCkge1xyXG4gICAgICAgICAgICBzdHIgPSBcIjBcIiArIHN0cjtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHN0cjtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjcmVhdGVCbG9ja0lkKGJsb2NrSW5kZXg6IG51bWJlcikge1xyXG4gICAgICAgIHZhciBibG9ja0lkUHJlZml4ID0gXCJibG9jay1cIjtcclxuICAgICAgICByZXR1cm4gYnRvYShibG9ja0lkUHJlZml4ICsgcGFkKGJsb2NrSW5kZXgsIDYpKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjb21taXRCbG9ja0xpc3Qoc2NvcGU6IEpRdWVyeSwgZGF0YTogYW55KSB7XHJcbiAgICAgICAgdmFyIGRlZmVycmVkID0gJC5EZWZlcnJlZCgpO1xyXG4gICAgICAgIHZhciBibG9ja0lkcyA9IHNjb3BlLmRhdGEoXCJibG9jay1pZHNcIik7XHJcblxyXG4gICAgICAgIGlmIChibG9ja0lkcy5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICAvLyBUaGUgZmlsZSB3YXMgdXBsb2FkZWQgYXMgYSB3aG9sZSwgc28gbm8gbWFuaWZlc3QgdG8gc3VibWl0LlxyXG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gVGhlIGZpbGUgd2FzIHVwbG9hZGVkIGluIGNodW5rcy5cclxuICAgICAgICAgICAgdmFyIHVybCA9IHNjb3BlLmRhdGEoXCJzYXMtbG9jYXRvclwiKSArIFwiJmNvbXA9YmxvY2tsaXN0XCI7XHJcbiAgICAgICAgICAgIHZhciByZXF1ZXN0RGF0YSA9ICc8P3htbCB2ZXJzaW9uPVwiMS4wXCIgZW5jb2Rpbmc9XCJ1dGYtOFwiPz48QmxvY2tMaXN0Pic7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYmxvY2tJZHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHJlcXVlc3REYXRhICs9ICc8TGF0ZXN0PicgKyBibG9ja0lkc1tpXSArICc8L0xhdGVzdD4nO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJlcXVlc3REYXRhICs9ICc8L0Jsb2NrTGlzdD4nO1xyXG5cclxuICAgICAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgICAgIHVybDogdXJsLFxyXG4gICAgICAgICAgICAgICAgdHlwZTogXCJQVVRcIixcclxuICAgICAgICAgICAgICAgIGRhdGE6IHJlcXVlc3REYXRhLFxyXG4gICAgICAgICAgICAgICAgY29udGVudFR5cGU6IFwidGV4dC9wbGFpbjsgY2hhcnNldD1VVEYtOFwiLFxyXG4gICAgICAgICAgICAgICAgY3Jvc3NEb21haW46IHRydWUsXHJcbiAgICAgICAgICAgICAgICBjYWNoZTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBiZWZvcmVTZW5kOiBmdW5jdGlvbiAoeGhyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ3gtbXMtZGF0ZScsIG5ldyBEYXRlKCkudG9VVENTdHJpbmcoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ3gtbXMtYmxvYi1jb250ZW50LXR5cGUnLCBkYXRhLmZpbGVzWzBdLnR5cGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKCd4LW1zLXZlcnNpb24nLCBcIjIwMTItMDItMTJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ0NvbnRlbnQtTGVuZ3RoJywgcmVxdWVzdERhdGEubGVuZ3RoLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCBzdGF0dXMsIGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YS50ZXh0U3RhdHVzID0gc3RhdHVzO1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuZXJyb3JUaHJvd24gPSBlcnJvcjtcclxuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5mYWlsKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaGFzQWN0aXZlVXBsb2FkcygpIHtcclxuICAgICAgICB2YXIgc2NvcGUgPSAkKFwiLnVwbG9hZC1kaXJlY3RcIik7XHJcbiAgICAgICAgdmFyIGZsYWcgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgc2NvcGUuZmluZChcIi5hc3luYy11cGxvYWRcIikuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICgkKHRoaXMpLmRhdGEoXCJ1cGxvYWQtaXNhY3RpdmVcIikgPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgZmxhZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGZsYWc7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaGFzQ29tcGxldGVkVXBsb2FkcygpIHtcclxuICAgICAgICB2YXIgc2NvcGUgPSAkKFwiLnVwbG9hZC1kaXJlY3RcIik7XHJcbiAgICAgICAgdmFyIGZsYWcgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgc2NvcGUuZmluZChcIi5hc3luYy11cGxvYWRcIikuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICgkKHRoaXMpLmRhdGEoXCJ1cGxvYWQtaXNjb21wbGV0ZWRcIikgPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgZmxhZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGZsYWc7XHJcbiAgICB9IFxyXG5cclxuICAgIGZ1bmN0aW9uIGlzU3VibWl0dGluZygpIHtcclxuICAgICAgICB2YXIgc2NvcGUgPSAkKFwiLnVwbG9hZC1kaXJlY3RcIik7XHJcbiAgICAgICAgcmV0dXJuIHNjb3BlLmRhdGEoXCJpcy1zdWJtaXR0aW5nXCIpID09IHRydWU7XHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIGluaXRpYWxpemVVcGxvYWQoZmlsZUlucHV0OiBKUXVlcnkpIHtcclxuICAgICAgICB2YXIgc2NvcGUgPSBmaWxlSW5wdXQuY2xvc2VzdChcIi5hc3luYy11cGxvYWRcIik7XHJcbiAgICAgICAgdmFyIGZpbGVVcGxvYWRXcmFwcGVyID0gc2NvcGUuZmluZChcIi5maWxlLXVwbG9hZC13cmFwcGVyXCIpO1xyXG4gICAgICAgIHZhciBhY2NlcHRGaWxlVHlwZXNSZWdleCA9IG5ldyBSZWdFeHAoc2NvcGUuZGF0YShcInVwbG9hZC1hY2NlcHQtZmlsZS10eXBlc1wiKSk7XHJcbiAgICAgICAgdmFyIGFudGlGb3JnZXJ5VG9rZW46IHN0cmluZyA9IHNjb3BlLmNsb3Nlc3QoXCJmb3JtXCIpLmZpbmQoXCJbbmFtZT0nX19SZXF1ZXN0VmVyaWZpY2F0aW9uVG9rZW4nXVwiKS52YWwoKTtcclxuXHJcbiAgICAgICAgdmFyIHNlbGVjdGVkRmlsZVdyYXBwZXIgPSBzY29wZS5maW5kKFwiLnNlbGVjdGVkLWZpbGUtd3JhcHBlclwiKTtcclxuICAgICAgICB2YXIgZmlsZW5hbWVJbnB1dCA9IHNjb3BlLmZpbmQoXCIuZmlsZW5hbWUtaW5wdXRcIik7XHJcbiAgICAgICAgdmFyIHJlc2V0QnV0dG9uID0gc2NvcGUuZmluZChcIi5yZXNldC1idXR0b25cIik7XHJcbiAgICAgICAgdmFyIHVwbG9hZEJ1dHRvbiA9IHNjb3BlLmZpbmQoXCIudXBsb2FkLWJ1dHRvblwiKTtcclxuICAgICAgICB2YXIgZmlsZW5hbWVUZXh0ID0gc2NvcGUuZmluZChcIi5maWxlbmFtZS10ZXh0XCIpO1xyXG5cclxuICAgICAgICB2YXIgdmFsaWRhdGlvblRleHQgPSBzY29wZS5maW5kKFwiLnZhbGlkYXRpb24tdGV4dFwiKTtcclxuICAgICAgICB2YXIgcHJlcGFyaW5nVGV4dCA9IHNjb3BlLmZpbmQoXCIuc3RhdHVzLnByZXBhcmluZ1wiKTtcclxuICAgICAgICB2YXIgdXBsb2FkaW5nQ29udGFpbmVyID0gc2NvcGUuZmluZChcIi5zdGF0dXMudXBsb2FkaW5nXCIpO1xyXG4gICAgICAgIHZhciBwcm9ncmVzc0JhciA9IHNjb3BlLmZpbmQoXCIucHJvZ3Jlc3MtYmFyXCIpO1xyXG4gICAgICAgIHZhciBwcm9ncmVzc1RleHQgPSBzY29wZS5maW5kKFwiLnByb2dyZXNzLXRleHRcIik7XHJcbiAgICAgICAgdmFyIHByb2dyZXNzRGV0YWlscyA9IHNjb3BlLmZpbmQoXCIucHJvZ3Jlc3MtZGV0YWlsc1wiKTtcclxuICAgICAgICB2YXIgY2FuY2VsTGluayA9IHNjb3BlLmZpbmQoXCIuY2FuY2VsLWxpbmtcIik7IFxyXG5cclxuICAgICAgICAoPGFueT5maWxlSW5wdXQpLmZpbGV1cGxvYWQoe1xyXG4gICAgICAgICAgICBhdXRvVXBsb2FkOiBmYWxzZSxcclxuICAgICAgICAgICAgYWNjZXB0RmlsZVR5cGVzOiBhY2NlcHRGaWxlVHlwZXNSZWdleCxcclxuICAgICAgICAgICAgdHlwZTogXCJQVVRcIixcclxuICAgICAgICAgICAgbWF4Q2h1bmtTaXplOiA0ICogMTAyNCAqIDEwMjQsIC8vIDQgTUJcclxuICAgICAgICAgICAgYmVmb3JlU2VuZDogKHhocjogSlF1ZXJ5WEhSLCBkYXRhOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKFwieC1tcy1kYXRlXCIsIG5ldyBEYXRlKCkudG9VVENTdHJpbmcoKSk7XHJcbiAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcIngtbXMtYmxvYi10eXBlXCIsIFwiQmxvY2tCbG9iXCIpO1xyXG4gICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJjb250ZW50LWxlbmd0aFwiLCBkYXRhLmRhdGEuc2l6ZS50b1N0cmluZygpKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgY2h1bmtzZW5kOiBmdW5jdGlvbiAoZTogYW55LCBkYXRhOiBhbnkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBibG9ja0luZGV4ID0gc2NvcGUuZGF0YShcImJsb2NrLWluZGV4XCIpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGJsb2NrSWRzID0gc2NvcGUuZGF0YShcImJsb2NrLWlkc1wiKTtcclxuICAgICAgICAgICAgICAgIHZhciBibG9ja0lkID0gY3JlYXRlQmxvY2tJZChibG9ja0luZGV4KTtcclxuICAgICAgICAgICAgICAgIHZhciB1cmwgPSBzY29wZS5kYXRhKFwic2FzLWxvY2F0b3JcIikgKyBcIiZjb21wPWJsb2NrJmJsb2NraWQ9XCIgKyBibG9ja0lkO1xyXG5cclxuICAgICAgICAgICAgICAgIGRhdGEudXJsID0gdXJsO1xyXG4gICAgICAgICAgICAgICAgYmxvY2tJZHMucHVzaChibG9ja0lkKTtcclxuICAgICAgICAgICAgICAgIHNjb3BlLmRhdGEoXCJibG9jay1pbmRleFwiLCBibG9ja0luZGV4ICsgMSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHByb2dyZXNzYWxsOiBmdW5jdGlvbiAoZTogYW55LCBkYXRhOiBhbnkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwZXJjZW50Q29tcGxldGUgPSBNYXRoLmZsb29yKChkYXRhLmxvYWRlZCAvIGRhdGEudG90YWwpICogMTAwKTtcclxuICAgICAgICAgICAgICAgIHZhciBzdGFydFRpbWUgPSBuZXcgRGF0ZShzY29wZS5kYXRhKFwidXBsb2FkLXN0YXJ0LXRpbWVcIikpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGVsYXBzZWRNaWxsaXNlY29uZHMgPSBuZXcgRGF0ZShEYXRlLm5vdygpKS5nZXRUaW1lKCkgLSBzdGFydFRpbWUuZ2V0VGltZSgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGVsYXBzZWQgPSBtb21lbnQuZHVyYXRpb24oZWxhcHNlZE1pbGxpc2Vjb25kcywgXCJtc1wiKTtcclxuICAgICAgICAgICAgICAgIHZhciByZW1haW5pbmcgPSBtb21lbnQuZHVyYXRpb24oZWxhcHNlZE1pbGxpc2Vjb25kcyAvIE1hdGgubWF4KGRhdGEubG9hZGVkLCAxKSAqIChkYXRhLnRvdGFsIC0gZGF0YS5sb2FkZWQpLCBcIm1zXCIpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGticHMgPSBNYXRoLmZsb29yKGRhdGEuYml0cmF0ZSAvIDggLyAxMDAwKTtcclxuICAgICAgICAgICAgICAgIHZhciB1cGxvYWRlZCA9IE1hdGguZmxvb3IoZGF0YS5sb2FkZWQgLyAxMDAwKTtcclxuICAgICAgICAgICAgICAgIHZhciB0b3RhbCA9IE1hdGguZmxvb3IoZGF0YS50b3RhbCAvIDEwMDApO1xyXG5cclxuICAgICAgICAgICAgICAgIHByb2dyZXNzQmFyLnNob3coKS5maW5kKFwiLnByb2dyZXNzXCIpLmNzcyhcIndpZHRoXCIsIHBlcmNlbnRDb21wbGV0ZSArIFwiJVwiKTtcclxuICAgICAgICAgICAgICAgIHByb2dyZXNzVGV4dC50ZXh0KHByb2dyZXNzVGV4dC5kYXRhKFwidGV4dC10ZW1wbGF0ZVwiKS5yZXBsYWNlKFwie3BlcmNlbnRhZ2V9XCIsIHBlcmNlbnRDb21wbGV0ZSkpLnNob3coKTtcclxuICAgICAgICAgICAgICAgIHByb2dyZXNzRGV0YWlscy50ZXh0KHByb2dyZXNzRGV0YWlscy5kYXRhKFwidGV4dC10ZW1wbGF0ZVwiKS5yZXBsYWNlKFwie3VwbG9hZGVkfVwiLCB1cGxvYWRlZCkucmVwbGFjZShcInt0b3RhbH1cIiwgdG90YWwpLnJlcGxhY2UoXCJ7a2Jwc31cIiwga2JwcykucmVwbGFjZShcIntlbGFwc2VkfVwiLCBlbGFwc2VkLmh1bWFuaXplKCkpLnJlcGxhY2UoXCJ7cmVtYWluaW5nfVwiLCByZW1haW5pbmcuaHVtYW5pemUoKSkpLnNob3coKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZG9uZTogZnVuY3Rpb24gKGU6IGFueSwgZGF0YTogYW55KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICBjb21taXRCbG9ja0xpc3Qoc2NvcGUsIGRhdGEpLmFsd2F5cyhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBsb2FkQ29tcGxldGVkKHNlbGYsIGUsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGZhaWw6IGZ1bmN0aW9uIChlOiBhbnksIGRhdGE6IGFueSkge1xyXG4gICAgICAgICAgICAgICAgdXBsb2FkQ29tcGxldGVkKHRoaXMsIGUsIGRhdGEpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBwcm9jZXNzZG9uZTogZnVuY3Rpb24gKGU6IGFueSwgZGF0YTogYW55KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWRGaWxlbmFtZSA9IGRhdGEuZmlsZXNbMF0ubmFtZTtcclxuICAgICAgICAgICAgICAgIHNjb3BlLmRhdGEoXCJzZWxlY3RlZC1maWxlbmFtZVwiLCBzZWxlY3RlZEZpbGVuYW1lKTtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBmaWxlVXBsb2FkV3JhcHBlci5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGlvblRleHQuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkRmlsZVdyYXBwZXIuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZpbGVuYW1lVGV4dC50ZXh0KGZpbGVuYW1lVGV4dC5kYXRhKFwidGV4dC10ZW1wbGF0ZVwiKS5yZXBsYWNlKFwie2ZpbGVuYW1lfVwiLCBzZWxlY3RlZEZpbGVuYW1lKSk7XHJcbiAgICAgICAgICAgICAgICB9LCAxMCk7IFxyXG5cclxuICAgICAgICAgICAgICAgICg8YW55PnNjb3BlWzBdKS5kb1Jlc2V0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZpbGVVcGxvYWRXcmFwcGVyLnNob3coKTtcclxuICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZUlucHV0LnZhbChcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZVRleHQudGV4dChcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEZpbGVXcmFwcGVyLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB2YWxpZGF0aW9uVGV4dC5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICg8YW55PnNjb3BlWzBdKS5kb1VwbG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZWRpdGVkRmlsZW5hbWUgPSBmaWxlbmFtZUlucHV0LnZhbCgpIHx8IHNlbGVjdGVkRmlsZW5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFhY2NlcHRGaWxlVHlwZXNSZWdleC50ZXN0KGVkaXRlZEZpbGVuYW1lKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWxpZGF0aW9uVGV4dC5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmRhdGEoXCJ1cGxvYWQtaXNhY3RpdmVcIiwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuZGF0YShcInVwbG9hZC1zdGFydC10aW1lXCIsIERhdGUubm93KCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBnZW5lcmF0ZUFzc2V0VXJsID0gc2NvcGUuZGF0YShcImdlbmVyYXRlLWFzc2V0LXVybFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS5kYXRhKFwiYmxvY2staW5kZXhcIiwgMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuZGF0YShcImJsb2NrLWlkc1wiLCBuZXcgQXJyYXkoKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHByZXBhcmluZ1RleHQuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkRmlsZVdyYXBwZXIuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhbGlkYXRpb25UZXh0LmhpZGUoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBnZW5lcmF0ZUFzc2V0VXJsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZTogZWRpdGVkRmlsZW5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX1JlcXVlc3RWZXJpZmljYXRpb25Ub2tlbjogYW50aUZvcmdlcnlUb2tlblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIlBPU1RcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0pLmRvbmUoZnVuY3Rpb24gKGFzc2V0OiBhbnkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEudXJsID0gYXNzZXQuc2FzTG9jYXRvcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEubXVsdGlwYXJ0ID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuZGF0YShcInNhcy1sb2NhdG9yXCIsIGFzc2V0LnNhc0xvY2F0b3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuZmluZChcImlucHV0W25hbWUkPScuRmlsZU5hbWUnXVwiKS52YWwoZWRpdGVkRmlsZW5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuZmluZChcImlucHV0W25hbWUkPScuV2Ftc0Fzc2V0SWQnXVwiKS52YWwoYXNzZXQuYXNzZXRJZCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlcGFyaW5nVGV4dC5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9ncmVzc1RleHQudGV4dChwcm9ncmVzc1RleHQuZGF0YShcInRleHQtdGVtcGxhdGVcIikucmVwbGFjZShcIntwZXJjZW50YWdlfVwiLCAwKSkuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBsb2FkaW5nQ29udGFpbmVyLnNob3coKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgeGhyID0gZGF0YS5zdWJtaXQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmRhdGEoXCJ4aHJcIiwgeGhyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSkuZmFpbChmdW5jdGlvbiAoeGhyOiBhbnksIHN0YXR1czogYW55LCBlcnJvcjogYW55KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlVXBsb2FkV3JhcHBlci5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEZpbGVXcmFwcGVyLnNob3coKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXBhcmluZ1RleHQuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBsb2FkaW5nQ29udGFpbmVyLmhpZGUoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5kYXRhKFwidXBsb2FkLWlzYWN0aXZlXCIsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmRhdGEoXCJ1cGxvYWQtc3RhcnQtdGltZVwiLCBudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiQW4gZXJyb3Igb2NjdXJyZWQuIEVycm9yOiBcIiArIGVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBwcm9jZXNzZmFpbDogZnVuY3Rpb24gKGU6IGFueSwgZGF0YTogYW55KSB7XHJcbiAgICAgICAgICAgICAgICB2YWxpZGF0aW9uVGV4dC5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICBmaWxlbmFtZUlucHV0LnZhbChcIlwiKTtcclxuICAgICAgICAgICAgICAgIGZpbGVuYW1lVGV4dC50ZXh0KFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRGaWxlV3JhcHBlci5oaWRlKCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGNoYW5nZTogZnVuY3Rpb24gKGU6IGFueSwgZGF0YTogYW55KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcHJvbXB0ID0gZmlsZUlucHV0LmRhdGEoXCJwcm9tcHRcIik7XHJcbiAgICAgICAgICAgICAgICBpZiAocHJvbXB0ICYmIHByb21wdC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjb25maXJtKHByb21wdCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjYW5jZWxMaW5rLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGNvbmZpcm0oJCh0aGlzKS5kYXRhKFwiY2FuY2VsLXByb21wdFwiKSkpIHtcclxuICAgICAgICAgICAgICAgIHZhciB4aHIgPSBzY29wZS5kYXRhKFwieGhyXCIpO1xyXG4gICAgICAgICAgICAgICAgeGhyLmFib3J0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBleHBvcnQgZnVuY3Rpb24gaW5pdGlhbGl6ZVVwbG9hZERpcmVjdCgpIHtcclxuXHJcbiAgICAgICAgdmFyIHNjb3BlID0gJChcIi51cGxvYWQtZGlyZWN0XCIpLnNob3coKTtcclxuXHJcbiAgICAgICAgc2NvcGUuZmluZChcIi5yZXNldC1idXR0b25cIikub24oXCJjbGlja1wiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICB2YXIgZG9SZXNldCA9ICg8YW55PiQodGhpcykuY2xvc2VzdChcIi5hc3luYy11cGxvYWRcIilbMF0pLmRvUmVzZXQ7XHJcbiAgICAgICAgICAgIGlmICghIWRvUmVzZXQpXHJcbiAgICAgICAgICAgICAgICBkb1Jlc2V0KCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHNjb3BlLmZpbmQoXCIudXBsb2FkLWJ1dHRvblwiKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIHZhciBkb1VwbG9hZCA9ICg8YW55PiQodGhpcykuY2xvc2VzdChcIi5hc3luYy11cGxvYWRcIilbMF0pLmRvVXBsb2FkO1xyXG4gICAgICAgICAgICBpZiAoISFkb1VwbG9hZClcclxuICAgICAgICAgICAgICAgIGRvVXBsb2FkKCk7XHJcbiAgICAgICAgfSk7IFxyXG4gICAgICAgICAgXHJcbiAgICAgICAgcmVxdWlyZWRVcGxvYWRzID0gc2NvcGUuZmluZChcIi5yZXF1aXJlZC11cGxvYWRcIik7XHJcblxyXG4gICAgICAgIHNjb3BlLmZpbmQoXCIuYXN5bmMtdXBsb2FkLWZpbGUtaW5wdXRcIikuZWFjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGluaXRpYWxpemVVcGxvYWQoJCh0aGlzKSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHNjb3BlLmNsb3Nlc3QoXCJmb3JtXCIpLm9uKFwic3VibWl0XCIsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIGlmIChoYXNBY3RpdmVVcGxvYWRzKCkpIHtcclxuICAgICAgICAgICAgICAgIGFsZXJ0KHNjb3BlLmRhdGEoXCJibG9jay1zdWJtaXQtcHJvbXB0XCIpKTtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2NvcGUuZGF0YShcImlzLXN1Ym1pdHRpbmdcIiwgdHJ1ZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgIFxyXG4gICAgICAgICQod2luZG93KS5vbihcImJlZm9yZXVubG9hZFwiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICBpZiAoKGhhc0FjdGl2ZVVwbG9hZHMoKSB8fCBoYXNDb21wbGV0ZWRVcGxvYWRzKCkpICYmICFpc1N1Ym1pdHRpbmcoKSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBzY29wZS5kYXRhKFwibmF2aWdhdGUtYXdheS1wcm9tcHRcIik7XHJcbiAgICAgICAgICAgICAgICBlLnJlc3VsdCA9IG1lc3NhZ2U7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59Il19
