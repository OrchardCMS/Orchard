!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):window.jQuery)}(function(e){"use strict";var t=0;e.ajaxTransport("iframe",function(r){if(r.async){var i,n,o,a=r.initialIframeSrc||"javascript:false;";return{send:function(s,l){i=e('<form style="display:none;"></form>'),i.attr("accept-charset",r.formAcceptCharset),o=/\?/.test(r.url)?"&":"?","DELETE"===r.type?(r.url=r.url+o+"_method=DELETE",r.type="POST"):"PUT"===r.type?(r.url=r.url+o+"_method=PUT",r.type="POST"):"PATCH"===r.type&&(r.url=r.url+o+"_method=PATCH",r.type="POST"),t+=1,n=e('<iframe src="'+a+'" name="iframe-transport-'+t+'"></iframe>').bind("load",function(){var t,o=e.isArray(r.paramName)?r.paramName:[r.paramName];n.unbind("load").bind("load",function(){var t;try{if(t=n.contents(),!t.length||!t[0].firstChild)throw new Error}catch(r){t=void 0}l(200,"success",{iframe:t}),e('<iframe src="'+a+'"></iframe>').appendTo(i),window.setTimeout(function(){i.remove()},0)}),i.prop("target",n.prop("name")).prop("action",r.url).prop("method",r.type),r.formData&&e.each(r.formData,function(t,r){e('<input type="hidden"/>').prop("name",r.name).val(r.value).appendTo(i)}),r.fileInput&&r.fileInput.length&&"POST"===r.type&&(t=r.fileInput.clone(),r.fileInput.after(function(e){return t[e]}),r.paramName&&r.fileInput.each(function(t){e(this).prop("name",o[t]||r.paramName)}),i.append(r.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data"),r.fileInput.removeAttr("form")),i.submit(),t&&t.length&&r.fileInput.each(function(r,i){var n=e(t[r]);e(i).prop("name",n.prop("name")).attr("form",n.attr("form")),n.replaceWith(i)})}),i.append(n).appendTo(document.body)},abort:function(){n&&n.unbind("load").prop("src",a),i&&i.remove()}}}}),e.ajaxSetup({converters:{"iframe text":function(t){return t&&e(t[0].body).text()},"iframe json":function(t){return t&&e.parseJSON(e(t[0].body).text())},"iframe html":function(t){return t&&e(t[0].body).html()},"iframe xml":function(t){var r=t&&t[0];return r&&e.isXMLDoc(r)?r:e.parseXML(r.XMLDocument&&r.XMLDocument.xml||e(r.body).html())},"iframe script":function(t){return t&&e.globalEval(e(t[0].body).text())}}})}),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery.ui.widget"],e):"object"==typeof exports?e(require("jquery"),require("./vendor/jquery.ui.widget")):e(window.jQuery)}(function(e){"use strict";function t(t){var r="dragover"===t;return function(i){i.dataTransfer=i.originalEvent&&i.originalEvent.dataTransfer;var n=i.dataTransfer;n&&-1!==e.inArray("Files",n.types)&&this._trigger(t,e.Event(t,{delegatedEvent:i}))!==!1&&(i.preventDefault(),r&&(n.dropEffect="copy"))}}e.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||e('<input type="file">').prop("disabled")),e.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader),e.support.xhrFormDataFileUpload=!!window.FormData,e.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),e.widget("blueimp.fileupload",{options:{dropZone:e(document),pasteZone:void 0,fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(t,r){return t=this.messages[t]||t.toString(),r&&e.each(r,function(e,r){t=t.replace("{"+e+"}",r)}),t},formData:function(e){return e.serializeArray()},add:function(t,r){return t.isDefaultPrevented()?!1:void((r.autoUpload||r.autoUpload!==!1&&e(this).fileupload("option","autoUpload"))&&r.process().done(function(){r.submit()}))},processData:!1,contentType:!1,cache:!1,timeout:0},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:e.support.blobSlice&&function(){var e=this.slice||this.webkitSlice||this.mozSlice;return e.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(e,t,r){var i=e-this.timestamp;return(!this.bitrate||!r||i>r)&&(this.bitrate=(t-this.loaded)*(1e3/i)*8,this.loaded=t,this.timestamp=e),this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&e.support.xhrFileUpload||e.support.xhrFormDataFileUpload)},_getFormData:function(t){var r;return"function"===e.type(t.formData)?t.formData(t.form):e.isArray(t.formData)?t.formData:"object"===e.type(t.formData)?(r=[],e.each(t.formData,function(e,t){r.push({name:e,value:t})}),r):[]},_getTotal:function(t){var r=0;return e.each(t,function(e,t){r+=t.size||1}),r},_initProgressObject:function(t){var r={loaded:0,total:0,bitrate:0};t._progress?e.extend(t._progress,r):t._progress=r},_initResponseObject:function(e){var t;if(e._response)for(t in e._response)e._response.hasOwnProperty(t)&&delete e._response[t];else e._response={}},_onProgress:function(t,r){if(t.lengthComputable){var i,n=Date.now?Date.now():(new Date).getTime();if(r._time&&r.progressInterval&&n-r._time<r.progressInterval&&t.loaded!==t.total)return;r._time=n,i=Math.floor(t.loaded/t.total*(r.chunkSize||r._progress.total))+(r.uploadedBytes||0),this._progress.loaded+=i-r._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(n,this._progress.loaded,r.bitrateInterval),r._progress.loaded=r.loaded=i,r._progress.bitrate=r.bitrate=r._bitrateTimer.getBitrate(n,i,r.bitrateInterval),this._trigger("progress",e.Event("progress",{delegatedEvent:t}),r),this._trigger("progressall",e.Event("progressall",{delegatedEvent:t}),this._progress)}},_initProgressListener:function(t){var r=this,i=t.xhr?t.xhr():e.ajaxSettings.xhr();i.upload&&(e(i.upload).bind("progress",function(e){var i=e.originalEvent;e.lengthComputable=i.lengthComputable,e.loaded=i.loaded,e.total=i.total,r._onProgress(e,t)}),t.xhr=function(){return i})},_isInstanceOf:function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},_initXHRData:function(t){var r,i=this,n=t.files[0],o=t.multipart||!e.support.xhrFileUpload,a="array"===e.type(t.paramName)?t.paramName[0]:t.paramName;t.headers=e.extend({},t.headers),t.contentRange&&(t.headers["Content-Range"]=t.contentRange),o&&!t.blob&&this._isInstanceOf("File",n)||(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(n.name)+'"'),o?e.support.xhrFormDataFileUpload&&(t.postMessage?(r=this._getFormData(t),t.blob?r.push({name:a,value:t.blob}):e.each(t.files,function(i,n){r.push({name:"array"===e.type(t.paramName)&&t.paramName[i]||a,value:n})})):(i._isInstanceOf("FormData",t.formData)?r=t.formData:(r=new FormData,e.each(this._getFormData(t),function(e,t){r.append(t.name,t.value)})),t.blob?r.append(a,t.blob,n.name):e.each(t.files,function(n,o){(i._isInstanceOf("File",o)||i._isInstanceOf("Blob",o))&&r.append("array"===e.type(t.paramName)&&t.paramName[n]||a,o,o.uploadName||o.name)})),t.data=r):(t.contentType=n.type||"application/octet-stream",t.data=t.blob||n),t.blob=null},_initIframeSettings:function(t){var r=e("<a></a>").prop("href",t.url).prop("host");t.dataType="iframe "+(t.dataType||""),t.formData=this._getFormData(t),t.redirect&&r&&r!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(e){this._isXHRUpload(e)?(this._chunkedUpload(e,!0)||(e.data||this._initXHRData(e),this._initProgressListener(e)),e.postMessage&&(e.dataType="postmessage "+(e.dataType||""))):this._initIframeSettings(e)},_getParamName:function(t){var r=e(t.fileInput),i=t.paramName;return i?e.isArray(i)||(i=[i]):(i=[],r.each(function(){for(var t=e(this),r=t.prop("name")||"files[]",n=(t.prop("files")||[1]).length;n;)i.push(r),n-=1}),i.length||(i=[r.prop("name")||"files[]"])),i},_initFormSettings:function(t){t.form&&t.form.length||(t.form=e(t.fileInput.prop("form")),t.form.length||(t.form=e(this.options.fileInput.prop("form")))),t.paramName=this._getParamName(t),t.url||(t.url=t.form.prop("action")||location.href),t.type=(t.type||"string"===e.type(t.form.prop("method"))&&t.form.prop("method")||"").toUpperCase(),"POST"!==t.type&&"PUT"!==t.type&&"PATCH"!==t.type&&(t.type="POST"),t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var r=e.extend({},this.options,t);return this._initFormSettings(r),this._initDataSettings(r),r},_getDeferredState:function(e){return e.state?e.state():e.isResolved()?"resolved":e.isRejected()?"rejected":"pending"},_enhancePromise:function(e){return e.success=e.done,e.error=e.fail,e.complete=e.always,e},_getXHRPromise:function(t,r,i){var n=e.Deferred(),o=n.promise();return r=r||this.options.context||o,t===!0?n.resolveWith(r,i):t===!1&&n.rejectWith(r,i),o.abort=n.promise,this._enhancePromise(o)},_addConvenienceMethods:function(t,r){var i=this,n=function(t){return e.Deferred().resolveWith(i,t).promise()};r.process=function(t,o){return(t||o)&&(r._processQueue=this._processQueue=(this._processQueue||n([this])).pipe(function(){return r.errorThrown?e.Deferred().rejectWith(i,[r]).promise():n(arguments)}).pipe(t,o)),this._processQueue||n([this])},r.submit=function(){return"pending"!==this.state()&&(r.jqXHR=this.jqXHR=i._trigger("submit",e.Event("submit",{delegatedEvent:t}),this)!==!1&&i._onSend(t,this)),this.jqXHR||i._getXHRPromise()},r.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",i._trigger("fail",null,this),i._getXHRPromise(!1))},r.state=function(){return this.jqXHR?i._getDeferredState(this.jqXHR):this._processQueue?i._getDeferredState(this._processQueue):void 0},r.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===i._getDeferredState(this._processQueue)},r.progress=function(){return this._progress},r.response=function(){return this._response}},_getUploadedBytes:function(e){var t=e.getResponseHeader("Range"),r=t&&t.split("-"),i=r&&r.length>1&&parseInt(r[1],10);return i&&i+1},_chunkedUpload:function(t,r){t.uploadedBytes=t.uploadedBytes||0;var i,n,o=this,a=t.files[0],s=a.size,l=t.uploadedBytes,p=t.maxChunkSize||s,u=this._blobSlice,d=e.Deferred(),f=d.promise();return this._isXHRUpload(t)&&u&&(l||s>p)&&!t.data?r?!0:l>=s?(a.error=t.i18n("uploadedBytes"),this._getXHRPromise(!1,t.context,[null,"error",a.error])):(n=function(){var r=e.extend({},t),f=r._progress.loaded;r.blob=u.call(a,l,l+p,a.type),r.chunkSize=r.blob.size,r.contentRange="bytes "+l+"-"+(l+r.chunkSize-1)+"/"+s,o._initXHRData(r),o._initProgressListener(r),i=(o._trigger("chunksend",null,r)!==!1&&e.ajax(r)||o._getXHRPromise(!1,r.context)).done(function(i,a,p){l=o._getUploadedBytes(p)||l+r.chunkSize,f+r.chunkSize-r._progress.loaded&&o._onProgress(e.Event("progress",{lengthComputable:!0,loaded:l-r.uploadedBytes,total:l-r.uploadedBytes}),r),t.uploadedBytes=r.uploadedBytes=l,r.result=i,r.textStatus=a,r.jqXHR=p,o._trigger("chunkdone",null,r),o._trigger("chunkalways",null,r),s>l?n():d.resolveWith(r.context,[i,a,p])}).fail(function(e,t,i){r.jqXHR=e,r.textStatus=t,r.errorThrown=i,o._trigger("chunkfail",null,r),o._trigger("chunkalways",null,r),d.rejectWith(r.context,[e,t,i])})},this._enhancePromise(f),f.abort=function(){return i.abort()},n(),f):!1},_beforeSend:function(e,t){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(t),this._initProgressObject(t),t._progress.loaded=t.loaded=t.uploadedBytes||0,t._progress.total=t.total=this._getTotal(t.files)||1,t._progress.bitrate=t.bitrate=0,this._active+=1,this._progress.loaded+=t.loaded,this._progress.total+=t.total},_onDone:function(t,r,i,n){var o=n._progress.total,a=n._response;n._progress.loaded<o&&this._onProgress(e.Event("progress",{lengthComputable:!0,loaded:o,total:o}),n),a.result=n.result=t,a.textStatus=n.textStatus=r,a.jqXHR=n.jqXHR=i,this._trigger("done",null,n)},_onFail:function(e,t,r,i){var n=i._response;i.recalculateProgress&&(this._progress.loaded-=i._progress.loaded,this._progress.total-=i._progress.total),n.jqXHR=i.jqXHR=e,n.textStatus=i.textStatus=t,n.errorThrown=i.errorThrown=r,this._trigger("fail",null,i)},_onAlways:function(e,t,r,i){this._trigger("always",null,i)},_onSend:function(t,r){r.submit||this._addConvenienceMethods(t,r);var i,n,o,a,s=this,l=s._getAJAXSettings(r),p=function(){return s._sending+=1,l._bitrateTimer=new s._BitrateTimer,i=i||((n||s._trigger("send",e.Event("send",{delegatedEvent:t}),l)===!1)&&s._getXHRPromise(!1,l.context,n)||s._chunkedUpload(l)||e.ajax(l)).done(function(e,t,r){s._onDone(e,t,r,l)}).fail(function(e,t,r){s._onFail(e,t,r,l)}).always(function(e,t,r){if(s._onAlways(e,t,r,l),s._sending-=1,s._active-=1,l.limitConcurrentUploads&&l.limitConcurrentUploads>s._sending)for(var i=s._slots.shift();i;){if("pending"===s._getDeferredState(i)){i.resolve();break}i=s._slots.shift()}0===s._active&&s._trigger("stop")})};return this._beforeSend(t,l),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(o=e.Deferred(),this._slots.push(o),a=o.pipe(p)):(this._sequence=this._sequence.pipe(p,p),a=this._sequence),a.abort=function(){return n=[void 0,"abort","abort"],i?i.abort():(o&&o.rejectWith(l.context,n),p())},this._enhancePromise(a)):p()},_onAdd:function(t,r){var i,n,o,a,s=this,l=!0,p=e.extend({},this.options,r),u=r.files,d=u.length,f=p.limitMultiFileUploads,c=p.limitMultiFileUploadSize,h=p.limitMultiFileUploadSizeOverhead,g=0,m=this._getParamName(p),_=0;if(!d)return!1;if(c&&void 0===u[0].size&&(c=void 0),(p.singleFileUploads||f||c)&&this._isXHRUpload(p))if(p.singleFileUploads||c||!f)if(!p.singleFileUploads&&c)for(o=[],i=[],a=0;d>a;a+=1)g+=u[a].size+h,(a+1===d||g+u[a+1].size+h>c||f&&a+1-_>=f)&&(o.push(u.slice(_,a+1)),n=m.slice(_,a+1),n.length||(n=m),i.push(n),_=a+1,g=0);else i=m;else for(o=[],i=[],a=0;d>a;a+=f)o.push(u.slice(a,a+f)),n=m.slice(a,a+f),n.length||(n=m),i.push(n);else o=[u],i=[m];return r.originalFiles=u,e.each(o||u,function(n,a){var p=e.extend({},r);return p.files=o?a:[a],p.paramName=i[n],s._initResponseObject(p),s._initProgressObject(p),s._addConvenienceMethods(t,p),l=s._trigger("add",e.Event("add",{delegatedEvent:t}),p)}),l},_replaceFileInput:function(t){var r=t.fileInput,i=r.clone(!0),n=r.is(document.activeElement);t.fileInputClone=i,e("<form></form>").append(i)[0].reset(),r.after(i).detach(),n&&i.focus(),e.cleanData(r.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(e,t){return t===r[0]?i[0]:t}),r[0]===this.element[0]&&(this.element=i)},_handleFileTreeEntry:function(t,r){var i,n=this,o=e.Deferred(),a=function(e){e&&!e.entry&&(e.entry=t),o.resolve([e])},s=function(e){n._handleFileTreeEntries(e,r+t.name+"/").done(function(e){o.resolve(e)}).fail(a)},l=function(){i.readEntries(function(e){e.length?(p=p.concat(e),l()):s(p)},a)},p=[];return r=r||"",t.isFile?t._file?(t._file.relativePath=r,o.resolve(t._file)):t.file(function(e){e.relativePath=r,o.resolve(e)},a):t.isDirectory?(i=t.createReader(),l()):o.resolve([]),o.promise()},_handleFileTreeEntries:function(t,r){var i=this;return e.when.apply(e,e.map(t,function(e){return i._handleFileTreeEntry(e,r)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){t=t||{};var r=t.items;return r&&r.length&&(r[0].webkitGetAsEntry||r[0].getAsEntry)?this._handleFileTreeEntries(e.map(r,function(e){var t;return e.webkitGetAsEntry?(t=e.webkitGetAsEntry(),t&&(t._file=e.getAsFile()),t):e.getAsEntry()})):e.Deferred().resolve(e.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){t=e(t);var r,i,n=t.prop("webkitEntries")||t.prop("entries");if(n&&n.length)return this._handleFileTreeEntries(n);if(r=e.makeArray(t.prop("files")),r.length)void 0===r[0].name&&r[0].fileName&&e.each(r,function(e,t){t.name=t.fileName,t.size=t.fileSize});else{if(i=t.prop("value"),!i)return e.Deferred().resolve([]).promise();r=[{name:i.replace(/^.*\\/,"")}]}return e.Deferred().resolve(r).promise()},_getFileInputFiles:function(t){return t instanceof e&&1!==t.length?e.when.apply(e,e.map(t,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(t)},_onChange:function(t){var r=this,i={fileInput:e(t.target),form:e(t.target.form)};this._getFileInputFiles(i.fileInput).always(function(n){i.files=n,r.options.replaceFileInput&&r._replaceFileInput(i),r._trigger("change",e.Event("change",{delegatedEvent:t}),i)!==!1&&r._onAdd(t,i)})},_onPaste:function(t){var r=t.originalEvent&&t.originalEvent.clipboardData&&t.originalEvent.clipboardData.items,i={files:[]};r&&r.length&&(e.each(r,function(e,t){var r=t.getAsFile&&t.getAsFile();r&&i.files.push(r)}),this._trigger("paste",e.Event("paste",{delegatedEvent:t}),i)!==!1&&this._onAdd(t,i))},_onDrop:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var r=this,i=t.dataTransfer,n={};i&&i.files&&i.files.length&&(t.preventDefault(),this._getDroppedFiles(i).always(function(i){n.files=i,r._trigger("drop",e.Event("drop",{delegatedEvent:t}),n)!==!1&&r._onAdd(t,n)}))},_onDragOver:t("dragover"),_onDragEnter:t("dragenter"),_onDragLeave:t("dragleave"),_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave}),this._on(this.options.pasteZone,{paste:this._onPaste})),e.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragenter dragleave dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(t,r){var i=-1!==e.inArray(t,this._specialOptions);i&&this._destroyEventHandlers(),this._super(t,r),i&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;void 0===t.fileInput?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof e||(t.fileInput=e(t.fileInput)),t.dropZone instanceof e||(t.dropZone=e(t.dropZone)),t.pasteZone instanceof e||(t.pasteZone=e(t.pasteZone))},_getRegExp:function(e){var t=e.split("/"),r=t.pop();return t.shift(),new RegExp(t.join("/"),r)},_isRegExpOption:function(t,r){return"url"!==t&&"string"===e.type(r)&&/^\/.*\/[igm]{0,3}$/.test(r)},_initDataAttributes:function(){var t=this,r=this.options,i=this.element.data();e.each(this.element[0].attributes,function(e,n){var o,a=n.name.toLowerCase();/^data-/.test(a)&&(a=a.slice(5).replace(/-[a-z]/g,function(e){return e.charAt(1).toUpperCase()}),o=i[a],t._isRegExpOption(a,o)&&(o=t._getRegExp(o)),r[a]=o)})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(t){var r=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(e){t.files=e,r._onAdd(null,t)}):(t.files=e.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var r,i,n=this,o=e.Deferred(),a=o.promise();return a.abort=function(){return i=!0,r?r.abort():(o.reject(null,"abort","abort"),a)},this._getFileInputFiles(t.fileInput).always(function(e){if(!i){if(!e.length)return void o.reject();t.files=e,r=n._onSend(null,t),r.then(function(e,t,r){o.resolve(e,t,r)},function(e,t,r){o.reject(e,t,r)})}}),this._enhancePromise(a)}if(t.files=e.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})});