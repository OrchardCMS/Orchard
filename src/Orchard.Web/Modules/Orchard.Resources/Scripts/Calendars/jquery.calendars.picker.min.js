!function(e){var t="calendarsPicker";e.JQPlugin.createPlugin({name:t,defaultRenderer:{picker:'<div class="calendars"><div class="calendars-nav">{link:prev}{link:today}{link:next}</div>{months}{popup:start}<div class="calendars-ctrl">{link:clear}{link:close}</div>{popup:end}<div class="calendars-clear-fix"></div></div>',monthRow:'<div class="calendars-month-row">{months}</div>',month:'<div class="calendars-month"><div class="calendars-month-header">{monthHeader}</div><table><thead>{weekHeader}</thead><tbody>{weeks}</tbody></table></div>',weekHeader:"<tr>{days}</tr>",dayHeader:"<th>{day}</th>",week:"<tr>{days}</tr>",day:"<td>{day}</td>",monthSelector:".calendars-month",daySelector:"td",rtlClass:"calendars-rtl",multiClass:"calendars-multi",defaultClass:"",selectedClass:"calendars-selected",highlightedClass:"calendars-highlight",todayClass:"calendars-today",otherMonthClass:"calendars-other-month",weekendClass:"calendars-weekend",commandClass:"calendars-cmd",commandButtonClass:"",commandLinkClass:"",disabledClass:"calendars-disabled"},commands:{prev:{text:"prevText",status:"prevStatus",keystroke:{keyCode:33},enabled:function(e){var t=e.curMinDate();return!t||-1!==e.drawDate.newDate().add(1-e.options.monthsToStep-e.options.monthsOffset,"m").day(e.options.calendar.minDay).add(-1,"d").compareTo(t)},date:function(e){return e.drawDate.newDate().add(-e.options.monthsToStep-e.options.monthsOffset,"m").day(e.options.calendar.minDay)},action:function(e){a.changeMonth(this,-e.options.monthsToStep)}},prevJump:{text:"prevJumpText",status:"prevJumpStatus",keystroke:{keyCode:33,ctrlKey:!0},enabled:function(e){var t=e.curMinDate();return!t||-1!==e.drawDate.newDate().add(1-e.options.monthsToJump-e.options.monthsOffset,"m").day(e.options.calendar.minDay).add(-1,"d").compareTo(t)},date:function(e){return e.drawDate.newDate().add(-e.options.monthsToJump-e.options.monthsOffset,"m").day(e.options.calendar.minDay)},action:function(e){a.changeMonth(this,-e.options.monthsToJump)}},next:{text:"nextText",status:"nextStatus",keystroke:{keyCode:34},enabled:function(e){var t=e.get("maxDate");return!t||1!==e.drawDate.newDate().add(e.options.monthsToStep-e.options.monthsOffset,"m").day(e.options.calendar.minDay).compareTo(t)},date:function(e){return e.drawDate.newDate().add(e.options.monthsToStep-e.options.monthsOffset,"m").day(e.options.calendar.minDay)},action:function(e){a.changeMonth(this,e.options.monthsToStep)}},nextJump:{text:"nextJumpText",status:"nextJumpStatus",keystroke:{keyCode:34,ctrlKey:!0},enabled:function(e){var t=e.get("maxDate");return!t||1!==e.drawDate.newDate().add(e.options.monthsToJump-e.options.monthsOffset,"m").day(e.options.calendar.minDay).compareTo(t)},date:function(e){return e.drawDate.newDate().add(e.options.monthsToJump-e.options.monthsOffset,"m").day(e.options.calendar.minDay)},action:function(e){a.changeMonth(this,e.options.monthsToJump)}},current:{text:"currentText",status:"currentStatus",keystroke:{keyCode:36,ctrlKey:!0},enabled:function(e){var t=e.curMinDate(),a=e.get("maxDate"),n=e.selectedDates[0]||e.options.calendar.today();return!(t&&-1===n.compareTo(t)||a&&1===n.compareTo(a))},date:function(e){return e.selectedDates[0]||e.options.calendar.today()},action:function(e){var t=e.selectedDates[0]||e.options.calendar.today();a.showMonth(this,t.year(),t.month())}},today:{text:"todayText",status:"todayStatus",keystroke:{keyCode:36,ctrlKey:!0},enabled:function(e){var t=e.curMinDate(),a=e.get("maxDate");return!(t&&-1===e.options.calendar.today().compareTo(t)||a&&1===e.options.calendar.today().compareTo(a))},date:function(e){return e.options.calendar.today()},action:function(e){a.showMonth(this)}},clear:{text:"clearText",status:"clearStatus",keystroke:{keyCode:35,ctrlKey:!0},enabled:function(e){return!0},date:function(e){return null},action:function(e){a.clear(this)}},close:{text:"closeText",status:"closeStatus",keystroke:{keyCode:27},enabled:function(e){return!0},date:function(e){return null},action:function(e){a.hide(this)}},prevWeek:{text:"prevWeekText",status:"prevWeekStatus",keystroke:{keyCode:38,ctrlKey:!0},enabled:function(e){var t=e.curMinDate();return!t||-1!==e.drawDate.newDate().add(-e.options.calendar.daysInWeek(),"d").compareTo(t)},date:function(e){return e.drawDate.newDate().add(-e.options.calendar.daysInWeek(),"d")},action:function(e){a.changeDay(this,-e.options.calendar.daysInWeek())}},prevDay:{text:"prevDayText",status:"prevDayStatus",keystroke:{keyCode:37,ctrlKey:!0},enabled:function(e){var t=e.curMinDate();return!t||-1!==e.drawDate.newDate().add(-1,"d").compareTo(t)},date:function(e){return e.drawDate.newDate().add(-1,"d")},action:function(e){a.changeDay(this,-1)}},nextDay:{text:"nextDayText",status:"nextDayStatus",keystroke:{keyCode:39,ctrlKey:!0},enabled:function(e){var t=e.get("maxDate");return!t||1!==e.drawDate.newDate().add(1,"d").compareTo(t)},date:function(e){return e.drawDate.newDate().add(1,"d")},action:function(e){a.changeDay(this,1)}},nextWeek:{text:"nextWeekText",status:"nextWeekStatus",keystroke:{keyCode:40,ctrlKey:!0},enabled:function(e){var t=e.get("maxDate");return!t||1!==e.drawDate.newDate().add(e.options.calendar.daysInWeek(),"d").compareTo(t)},date:function(e){return e.drawDate.newDate().add(e.options.calendar.daysInWeek(),"d")},action:function(e){a.changeDay(this,e.options.calendar.daysInWeek())}}},defaultOptions:{calendar:e.calendars.instance(),pickerClass:"",showOnFocus:!0,showTrigger:null,showAnim:"show",showOptions:{},showSpeed:"normal",popupContainer:null,alignment:"bottom",fixedWeeks:!1,firstDay:null,calculateWeek:null,monthsToShow:1,monthsOffset:0,monthsToStep:1,monthsToJump:12,useMouseWheel:!0,changeMonth:!0,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,defaultDate:null,selectDefaultDate:!1,minDate:null,maxDate:null,dateFormat:null,autoSize:!1,rangeSelect:!1,rangeSeparator:" - ",multiSelect:0,multiSeparator:",",onDate:null,onShow:null,onChangeMonthYear:null,onSelect:null,onClose:null,altField:null,altFormat:null,constrainInput:!0,commandsAsDateFormat:!1,commands:{}},regionalOptions:{"":{renderer:{},prevText:"&lt;Prev",prevStatus:"Show the previous month",prevJumpText:"&lt;&lt;",prevJumpStatus:"Show the previous year",nextText:"Next&gt;",nextStatus:"Show the next month",nextJumpText:"&gt;&gt;",nextJumpStatus:"Show the next year",currentText:"Current",currentStatus:"Show the current month",todayText:"Today",todayStatus:"Show today's month",clearText:"Clear",clearStatus:"Clear all the dates",closeText:"Close",closeStatus:"Close the datepicker",yearStatus:"Change the year",earlierText:"&#160;&#160;▲",laterText:"&#160;&#160;▼",monthStatus:"Change the month",weekText:"Wk",weekStatus:"Week of the year",dayStatus:"Select DD, M d, yyyy",defaultStatus:"Select a date",isRTL:!1}},_getters:["getDate","isDisabled","isSelectable","retrieveDate"],_disabled:[],_popupClass:"calendars-popup",_triggerClass:"calendars-trigger",_disableClass:"calendars-disable",_monthYearClass:"calendars-month-year",_curMonthClass:"calendars-month-",_anyYearClass:"calendars-any-year",_curDoWClass:"calendars-dow-",_init:function(){this.defaultOptions.commands=this.commands,this.regionalOptions[""].renderer=this.defaultRenderer,this._super()},_instSettings:function(t,a){return{selectedDates:[],drawDate:null,pickingRange:!1,inline:e.inArray(t[0].nodeName.toLowerCase(),["div","span"])>-1,get:function(t){return e.inArray(t,["defaultDate","minDate","maxDate"])>-1?this.options.calendar.determineDate(this.options[t],null,this.selectedDates[0],this.get("dateFormat"),this.getConfig()):"dateFormat"===t?this.options.dateFormat||this.options.calendar.local.dateFormat:this.options[t]},curMinDate:function(){return this.pickingRange?this.selectedDates[0]:this.get("minDate")},getConfig:function(){return{dayNamesShort:this.options.dayNamesShort,dayNames:this.options.dayNames,monthNamesShort:this.options.monthNamesShort,monthNames:this.options.monthNames,calculateWeek:this.options.calculateWeek,shortYearCutoff:this.options.shortYearCutoff}}}},_postAttach:function(t,n){n.inline?(n.drawDate=a._checkMinMax((n.selectedDates[0]||n.get("defaultDate")||n.options.calendar.today()).newDate(),n),n.prevDate=n.drawDate.newDate(),this._update(t[0]),e.fn.mousewheel&&t.mousewheel(this._doMouseWheel)):(this._attachments(t,n),t.on("keydown."+n.name,this._keyDown).on("keypress."+n.name,this._keyPress).on("keyup."+n.name,this._keyUp),t.attr("disabled")&&this.disable(t[0]))},_optionsChanged:function(t,a,n){if(n.calendar&&n.calendar!==a.options.calendar){var s=function(e){return"object"==typeof a.options[e]?null:a.options[e]};n=e.extend({defaultDate:s("defaultDate"),minDate:s("minDate"),maxDate:s("maxDate")},n),a.selectedDates=[],a.drawDate=null}var o=a.selectedDates;e.extend(a.options,n),this.setDate(t[0],o,null,!1,!0),a.pickingRange=!1;var r=a.options.calendar,i=a.get("defaultDate");a.drawDate=this._checkMinMax((i?i:a.drawDate)||i||r.today(),a).newDate(),a.inline||this._attachments(t,a),(a.inline||a.div)&&this._update(t[0])},_attachments:function(t,n){t.off("focus."+n.name),n.options.showOnFocus&&t.on("focus."+n.name,this.show),n.trigger&&n.trigger.remove();var s=n.options.showTrigger;n.trigger=s?e(s).clone().removeAttr("id").addClass(this._triggerClass)[n.options.isRTL?"insertBefore":"insertAfter"](t).click(function(){a.isDisabled(t[0])||a[a.curInst===n?"hide":"show"](t[0])}):e([]),this._autoSize(t,n);var o=this._extractDates(n,t.val());o&&this.setDate(t[0],o,null,!0);var r=n.get("defaultDate");n.options.selectDefaultDate&&r&&0===n.selectedDates.length&&this.setDate(t[0],(r||n.options.calendar.today()).newDate())},_autoSize:function(e,t){if(t.options.autoSize&&!t.inline){var a=t.options.calendar,n=a.newDate(2009,10,20),s=t.get("dateFormat");if(s.match(/[DM]/)){var o=function(e){for(var t=0,a=0,n=0;n<e.length;n++)e[n].length>t&&(t=e[n].length,a=n);return a};n.month(o(a.local[s.match(/MM/)?"monthNames":"monthNamesShort"])+1),n.day(o(a.local[s.match(/DD/)?"dayNames":"dayNamesShort"])+20-n.dayOfWeek())}t.elem.attr("size",n.formatDate(s).length)}},_preDestroy:function(t,a){a.trigger&&a.trigger.remove(),t.empty().off("."+a.name),a.inline&&e.fn.mousewheel&&t.unmousewheel(),!a.inline&&a.options.autoSize&&t.removeAttr("size")},multipleEvents:function(e){var t=arguments;return function(e){for(var a=0;a<t.length;a++)t[a].apply(this,arguments)}},enable:function(t){if(t=e(t),t.hasClass(this._getMarker())){var a=this._getInst(t);a.inline?t.children("."+this._disableClass).remove().end().find("button,select").prop("disabled",!1).end().find("a").attr("href","javascript:void(0)"):(t.prop("disabled",!1),a.trigger.filter("button."+this._triggerClass).prop("disabled",!1).end().filter("img."+this._triggerClass).css({opacity:"1.0",cursor:""})),this._disabled=e.map(this._disabled,function(e){return e===t[0]?null:e})}},disable:function(t){if(t=e(t),t.hasClass(this._getMarker())){var a=this._getInst(t);if(a.inline){var n=t.children(":last"),s=n.offset(),o={left:0,top:0};n.parents().each(function(){return"relative"===e(this).css("position")?(o=e(this).offset(),!1):void 0});var r=t.css("zIndex");r=("auto"===r?0:parseInt(r,10))+1,t.prepend('<div class="'+this._disableClass+'" style="width: '+n.outerWidth()+"px; height: "+n.outerHeight()+"px; left: "+(s.left-o.left)+"px; top: "+(s.top-o.top)+"px; z-index: "+r+'"></div>').find("button,select").prop("disabled",!0).end().find("a").removeAttr("href")}else t.prop("disabled",!0),a.trigger.filter("button."+this._triggerClass).prop("disabled",!0).end().filter("img."+this._triggerClass).css({opacity:"0.5",cursor:"default"});this._disabled=e.map(this._disabled,function(e){return e===t[0]?null:e}),this._disabled.push(t[0])}},isDisabled:function(t){return t&&e.inArray(t,this._disabled)>-1},show:function(t){t=e(t.target||t);var n=a._getInst(t);if(a.curInst!==n&&(a.curInst&&a.hide(a.curInst,!0),!e.isEmptyObject(n))){n.lastVal=null,n.selectedDates=a._extractDates(n,t.val()),n.pickingRange=!1,n.drawDate=a._checkMinMax((n.selectedDates[0]||n.get("defaultDate")||n.options.calendar.today()).newDate(),n),n.prevDate=n.drawDate.newDate(),a.curInst=n,a._update(t[0],!0);var s=a._checkOffset(n);n.div.css({left:s.left,top:s.top});var o=n.options.showAnim,r=n.options.showSpeed;if(r="normal"===r&&e.ui&&parseInt(e.ui.version.substring(2))>=8?"_default":r,e.effects&&(e.effects[o]||e.effects.effect&&e.effects.effect[o])){var i=n.div.data();for(var l in i)l.match(/^ec\.storage\./)&&(i[l]=n._mainDiv.css(l.replace(/ec\.storage\./,"")));n.div.data(i).show(o,n.options.showOptions,r)}else n.div[o||"show"](o?r:0)}},_extractDates:function(e,t){if(t!==e.lastVal){e.lastVal=t,t=t.split(e.options.multiSelect?e.options.multiSeparator:e.options.rangeSelect?e.options.rangeSeparator:"\x00");for(var a=[],n=0;n<t.length;n++)try{var s=e.options.calendar.parseDate(e.get("dateFormat"),t[n]);if(s){for(var o=!1,r=0;r<a.length;r++)if(0===a[r].compareTo(s)){o=!0;break}o||a.push(s)}}catch(i){}return a.splice(e.options.multiSelect||(e.options.rangeSelect?2:1),a.length),e.options.rangeSelect&&1===a.length&&(a[1]=a[0]),a}},_update:function(t,n){t=e(t.target||t);var s=a._getInst(t);if(!e.isEmptyObject(s))if((s.inline||a.curInst===s)&&(!e.isFunction(s.options.onChangeMonthYear)||s.prevDate&&s.prevDate.year()===s.drawDate.year()&&s.prevDate.month()===s.drawDate.month()||s.options.onChangeMonthYear.apply(t[0],[s.drawDate.year(),s.drawDate.month()])),s.inline){var o=e("a, :input",t).index(e(":focus",t));t.html(this._generateContent(t[0],s));var r=t.find("a, :input");r.eq(Math.max(Math.min(o,r.length-1),0)).focus()}else a.curInst===s&&(s.div||(s.div=e("<div></div>").addClass(this._popupClass).css({display:n?"none":"static",position:"absolute",left:t.offset().left,top:t.offset().top+t.outerHeight()}).appendTo(e(s.options.popupContainer||"body")),e.fn.mousewheel&&s.div.mousewheel(this._doMouseWheel)),s.div.html(this._generateContent(t[0],s)),t.focus())},_updateInput:function(t,a){var n=this._getInst(t);if(!e.isEmptyObject(n)){for(var s="",o="",r=n.options.multiSelect?n.options.multiSeparator:n.options.rangeSeparator,i=n.options.calendar,l=n.get("dateFormat"),d=n.options.altFormat||l,c=0;c<n.selectedDates.length;c++)s+=a?"":(c>0?r:"")+i.formatDate(l,n.selectedDates[c]),o+=(c>0?r:"")+i.formatDate(d,n.selectedDates[c]);n.inline||a||e(t).val(s),e(n.options.altField).val(o),!e.isFunction(n.options.onSelect)||a||n.inSelect||(n.inSelect=!0,n.options.onSelect.apply(t,[n.selectedDates]),n.inSelect=!1)}},_getBorders:function(e){var t=function(e){return{thin:1,medium:3,thick:5}[e]||e};return[parseFloat(t(e.css("border-left-width"))),parseFloat(t(e.css("border-top-width")))]},_checkOffset:function(t){var a=t.elem.is(":hidden")&&t.trigger?t.trigger:t.elem,n=a.offset(),s=e(window).width(),o=e(window).height();if(0===s)return n;var r=!1;e(t.elem).parents().each(function(){return r|="fixed"===e(this).css("position"),!r});var i=document.documentElement.scrollLeft||document.body.scrollLeft,l=document.documentElement.scrollTop||document.body.scrollTop,d=n.top-(r?l:0)-t.div.outerHeight(),c=n.top-(r?l:0)+a.outerHeight(),p=n.left-(r?i:0),h=n.left-(r?i:0)+a.outerWidth()-t.div.outerWidth(),u=n.left-i+t.div.outerWidth()>s,m=n.top-l+t.elem.outerHeight()+t.div.outerHeight()>o;t.div.css("position",r?"fixed":"absolute");var f=t.options.alignment;return n="topLeft"===f?{left:p,top:d}:"topRight"===f?{left:h,top:d}:"bottomLeft"===f?{left:p,top:c}:"bottomRight"===f?{left:h,top:c}:"top"===f?{left:t.options.isRTL||u?h:p,top:d}:{left:t.options.isRTL||u?h:p,top:m?d:c},n.left=Math.max(r?0:i,n.left),n.top=Math.max(r?0:l,n.top),n},_checkExternalClick:function(t){if(a.curInst){var n=e(t.target);0!==n.closest("."+a._popupClass+",."+a._triggerClass).length||n.hasClass(a._getMarker())||a.hide(a.curInst)}},hide:function(t,n){if(t){var s=this._getInst(t);if(e.isEmptyObject(s)&&(s=t),s&&s===a.curInst){var o=n?"":s.options.showAnim,r=s.options.showSpeed;r="normal"===r&&e.ui&&parseInt(e.ui.version.substring(2))>=8?"_default":r;var i=function(){s.div&&(s.div.remove(),s.div=null,a.curInst=null,e.isFunction(s.options.onClose)&&s.options.onClose.apply(t,[s.selectedDates]))};if(s.div.stop(),e.effects&&(e.effects[o]||e.effects.effect&&e.effects.effect[o]))s.div.hide(o,s.options.showOptions,r,i);else{var l="slideDown"===o?"slideUp":"fadeIn"===o?"fadeOut":"hide";s.div[l](o?r:"",i)}o||i()}}},_keyDown:function(t){var n=t.data&&t.data.elem||t.target,s=a._getInst(n),o=!1;if(s.inline||s.div)if(9===t.keyCode)a.hide(n);else if(13===t.keyCode)a.selectDate(n,e("a."+s.options.renderer.highlightedClass,s.div)[0]),o=!0;else{var r=s.options.commands;for(var i in r){var l=r[i];if(l.keystroke.keyCode===t.keyCode&&!!l.keystroke.ctrlKey==!(!t.ctrlKey&&!t.metaKey)&&!!l.keystroke.altKey===t.altKey&&!!l.keystroke.shiftKey===t.shiftKey){a.performAction(n,i),o=!0;break}}}else{var l=s.options.commands.current;l.keystroke.keyCode===t.keyCode&&!!l.keystroke.ctrlKey==!(!t.ctrlKey&&!t.metaKey)&&!!l.keystroke.altKey===t.altKey&&!!l.keystroke.shiftKey===t.shiftKey&&(a.show(n),o=!0)}return s.ctrlKey=t.keyCode<48&&32!==t.keyCode||t.ctrlKey||t.metaKey,o&&(t.preventDefault(),t.stopPropagation()),!o},_keyPress:function(t){var n=a._getInst(t.data&&t.data.elem||t.target);if(!e.isEmptyObject(n)&&n.options.constrainInput){var s=String.fromCharCode(t.keyCode||t.charCode),o=a._allowedChars(n);return t.metaKey||n.ctrlKey||" ">s||!o||o.indexOf(s)>-1}return!0},_allowedChars:function(e){for(var t=e.options.multiSelect?e.options.multiSeparator:e.options.rangeSelect?e.options.rangeSeparator:"",a=!1,n=!1,s=e.get("dateFormat"),o=0;o<s.length;o++){var r=s.charAt(o);if(a)"'"===r&&"'"!==s.charAt(o+1)?a=!1:t+=r;else switch(r){case"d":case"m":case"o":case"w":t+=n?"":"0123456789",n=!0;break;case"y":case"@":case"!":t+=(n?"":"0123456789")+"-",n=!0;break;case"J":t+=(n?"":"0123456789")+"-.",n=!0;break;case"D":case"M":case"Y":return null;case"'":"'"===s.charAt(o+1)?t+="'":a=!0;break;default:t+=r}}return t},_keyUp:function(t){var n=t.data&&t.data.elem||t.target,s=a._getInst(n);if(!e.isEmptyObject(s)&&!s.ctrlKey&&s.lastVal!==s.elem.val())try{var o=a._extractDates(s,s.elem.val());o.length>0&&a.setDate(n,o,null,!0)}catch(t){}return!0},_doMouseWheel:function(t,n){var s=a.curInst&&a.curInst.elem[0]||e(t.target).closest("."+a._getMarker())[0];if(!a.isDisabled(s)){var o=a._getInst(s);o.options.useMouseWheel&&(n=0>n?-1:1,a.changeMonth(s,-o.options[t.ctrlKey?"monthsToJump":"monthsToStep"]*n)),t.preventDefault()}},clear:function(t){var a=this._getInst(t);if(!e.isEmptyObject(a)){a.selectedDates=[],this.hide(t);var n=a.get("defaultDate");a.options.selectDefaultDate&&n?this.setDate(t,(n||a.options.calendar.today()).newDate()):this._updateInput(t)}},getDate:function(t){var a=this._getInst(t);return e.isEmptyObject(a)?[]:a.selectedDates},setDate:function(t,a,n,s,o){var r=this._getInst(t);if(!e.isEmptyObject(r)){e.isArray(a)||(a=[a],n&&a.push(n));var i=r.get("minDate"),l=r.get("maxDate"),d=r.selectedDates[0];r.selectedDates=[];for(var c=0;c<a.length;c++){var p=r.options.calendar.determineDate(a[c],null,d,r.get("dateFormat"),r.getConfig());if(p&&!(i&&-1===p.compareTo(i)||l&&1===p.compareTo(l))){for(var h=!1,u=0;u<r.selectedDates.length;u++)if(0===r.selectedDates[u].compareTo(p)){h=!0;break}h||r.selectedDates.push(p)}}if(r.selectedDates.splice(r.options.multiSelect||(r.options.rangeSelect?2:1),r.selectedDates.length),r.options.rangeSelect){switch(r.selectedDates.length){case 1:r.selectedDates[1]=r.selectedDates[0];break;case 2:r.selectedDates[1]=1===r.selectedDates[0].compareTo(r.selectedDates[1])?r.selectedDates[0]:r.selectedDates[1]}r.pickingRange=!1}r.prevDate=r.drawDate?r.drawDate.newDate():null,r.drawDate=this._checkMinMax((r.selectedDates[0]||r.get("defaultDate")||r.options.calendar.today()).newDate(),r),o||(this._update(t),this._updateInput(t,s))}},isSelectable:function(t,a){var n=this._getInst(t);return e.isEmptyObject(n)?!1:(a=n.options.calendar.determineDate(a,n.selectedDates[0]||n.options.calendar.today(),null,n.options.dateFormat,n.getConfig()),this._isSelectable(t,a,n.options.onDate,n.get("minDate"),n.get("maxDate")))},_isSelectable:function(t,a,n,s,o){var r="boolean"==typeof n?{selectable:n}:e.isFunction(n)?n.apply(t,[a,!0]):{};return r.selectable!==!1&&(!s||a.toJD()>=s.toJD())&&(!o||a.toJD()<=o.toJD())},performAction:function(t,a){var n=this._getInst(t);if(!e.isEmptyObject(n)&&!this.isDisabled(t)){var s=n.options.commands;s[a]&&s[a].enabled.apply(t,[n])&&s[a].action.apply(t,[n])}},showMonth:function(t,a,n,s){var o=this._getInst(t);if(!e.isEmptyObject(o)&&(null!=s||o.drawDate.year()!==a||o.drawDate.month()!==n)){o.prevDate=o.drawDate.newDate();var r=o.options.calendar,i=this._checkMinMax(null!=a?r.newDate(a,n,1):r.today(),o);o.drawDate.date(i.year(),i.month(),null!=s?s:Math.min(o.drawDate.day(),r.daysInMonth(i.year(),i.month()))),this._update(t)}},changeMonth:function(t,a){var n=this._getInst(t);if(!e.isEmptyObject(n)){var s=n.drawDate.newDate().add(a,"m");this.showMonth(t,s.year(),s.month())}},changeDay:function(t,a){var n=this._getInst(t);if(!e.isEmptyObject(n)){var s=n.drawDate.newDate().add(a,"d");this.showMonth(t,s.year(),s.month(),s.day())}},_checkMinMax:function(e,t){var a=t.get("minDate"),n=t.get("maxDate");return e=a&&-1===e.compareTo(a)?a.newDate():e,e=n&&1===e.compareTo(n)?n.newDate():e},retrieveDate:function(t,a){var n=this._getInst(t);return e.isEmptyObject(n)?null:n.options.calendar.fromJD(parseFloat(a.className.replace(/^.*jd(\d+\.5).*$/,"$1")))},selectDate:function(t,a){var n=this._getInst(t);if(!e.isEmptyObject(n)&&!this.isDisabled(t)){var s=this.retrieveDate(t,a);if(n.options.multiSelect){for(var o=!1,r=0;r<n.selectedDates.length;r++)if(0===s.compareTo(n.selectedDates[r])){n.selectedDates.splice(r,1),o=!0;break}!o&&n.selectedDates.length<n.options.multiSelect&&n.selectedDates.push(s)}else n.options.rangeSelect?(n.pickingRange?n.selectedDates[1]=s:n.selectedDates=[s,s],n.pickingRange=!n.pickingRange):n.selectedDates=[s];n.prevDate=n.drawDate=s.newDate(),this._updateInput(t),n.inline||n.pickingRange||n.selectedDates.length<(n.options.multiSelect||(n.options.rangeSelect?2:1))?this._update(t):this.hide(t)}},_generateContent:function(t,n){function s(){(n.inline?e(this).closest("."+f._getMarker()):n.div).find(n.options.renderer.daySelector+" a").removeClass(n.options.renderer.highlightedClass)}var o=n.options.monthsToShow;o=e.isArray(o)?o:[1,o],n.drawDate=this._checkMinMax(n.drawDate||n.get("defaultDate")||n.options.calendar.today(),n);for(var r=n.drawDate.newDate().add(-n.options.monthsOffset,"m"),i="",l=0;l<o[0];l++){for(var d="",c=0;c<o[1];c++)d+=this._generateMonth(t,n,r.year(),r.month(),n.options.calendar,n.options.renderer,0===l&&0===c),r.add(1,"m");i+=this._prepare(n.options.renderer.monthRow,n).replace(/\{months\}/,d)}var p=this._prepare(n.options.renderer.picker,n).replace(/\{months\}/,i).replace(/\{weekHeader\}/g,this._generateDayHeaders(n,n.options.calendar,n.options.renderer)),h=function(e,a,s,o,r){if(-1!==p.indexOf("{"+e+":"+o+"}")){var i=n.options.commands[o],l=n.options.commandsAsDateFormat?i.date.apply(t,[n]):null;p=p.replace(new RegExp("\\{"+e+":"+o+"\\}","g"),"<"+a+(i.status?' title="'+n.options[i.status]+'"':"")+' class="'+n.options.renderer.commandClass+" "+n.options.renderer.commandClass+"-"+o+" "+r+(i.enabled(n)?"":" "+n.options.renderer.disabledClass)+'">'+(l?l.formatDate(n.options[i.text]):n.options[i.text])+"</"+s+">")}};for(var u in n.options.commands)h("button",'button type="button"',"button",u,n.options.renderer.commandButtonClass),h("link",'a href="javascript:void(0)"',"a",u,n.options.renderer.commandLinkClass);if(p=e(p),o[1]>1){var m=0;e(n.options.renderer.monthSelector,p).each(function(){var t=++m%o[1];e(this).addClass(1===t?"first":0===t?"last":"")})}var f=this;p.find(n.options.renderer.daySelector+" a").hover(function(){s.apply(this),e(this).addClass(n.options.renderer.highlightedClass)},s).click(function(){f.selectDate(t,this)}).end().find("select."+this._monthYearClass+":not(."+this._anyYearClass+")").change(function(){var a=e(this).val().split("/");f.showMonth(t,parseInt(a[1],10),parseInt(a[0],10))}).end().find("select."+this._anyYearClass).click(function(){e(this).css("visibility","hidden").next("input").css({left:this.offsetLeft,top:this.offsetTop,width:this.offsetWidth,height:this.offsetHeight}).show().focus()}).end().find("input."+f._monthYearClass).change(function(){try{var a=parseInt(e(this).val(),10);a=isNaN(a)?n.drawDate.year():a,f.showMonth(t,a,n.drawDate.month(),n.drawDate.day())}catch(s){alert(s)}}).keydown(function(t){13===t.keyCode?e(t.elem).change():27===t.keyCode&&(e(t.elem).hide().prev("select").css("visibility","visible"),n.elem.focus())});var y={elem:n.elem[0]};p.keydown(y,this._keyDown).keypress(y,this._keyPress).keyup(y,this._keyUp),p.find("."+n.options.renderer.commandClass).click(function(){if(!e(this).hasClass(n.options.renderer.disabledClass)){var s=this.className.replace(new RegExp("^.*"+n.options.renderer.commandClass+"-([^ ]+).*$"),"$1");a.performAction(t,s)}}),n.options.isRTL&&p.addClass(n.options.renderer.rtlClass),o[0]*o[1]>1&&p.addClass(n.options.renderer.multiClass),n.options.pickerClass&&p.addClass(n.options.pickerClass),e("body").append(p);var D=0;return p.find(n.options.renderer.monthSelector).each(function(){D+=e(this).outerWidth()}),p.width(D/o[0]),e.isFunction(n.options.onShow)&&n.options.onShow.apply(t,[p,n.options.calendar,n]),p},_generateMonth:function(t,a,n,s,o,r,i){var l=o.daysInMonth(n,s),d=a.options.monthsToShow;d=e.isArray(d)?d:[1,d];var c=a.options.fixedWeeks||d[0]*d[1]>1,p=a.options.firstDay;p=null==p?o.local.firstDay:p;var h=(o.dayOfWeek(n,s,o.minDay)-p+o.daysInWeek())%o.daysInWeek(),u=c?6:Math.ceil((h+l)/o.daysInWeek()),m=a.options.selectOtherMonths&&a.options.showOtherMonths,f=a.pickingRange?a.selectedDates[0]:a.get("minDate"),y=a.get("maxDate"),D=r.week.indexOf("{weekOfYear}")>-1,g=o.today(),v=o.newDate(n,s,o.minDay);v.add(-h-(c&&(v.dayOfWeek()===p||v.daysInMonth()<o.daysInWeek())?o.daysInWeek():0),"d");for(var k=v.toJD(),w="",_=0;u>_;_++){for(var C=D?'<span class="jd'+k+'">'+(e.isFunction(a.options.calculateWeek)?a.options.calculateWeek(v):v.weekOfYear())+"</span>":"",x="",b=0;b<o.daysInWeek();b++){var S=!1;if(a.options.rangeSelect&&a.selectedDates.length>0)S=-1!==v.compareTo(a.selectedDates[0])&&1!==v.compareTo(a.selectedDates[1]);else for(var M=0;M<a.selectedDates.length;M++)if(0===a.selectedDates[M].compareTo(v)){S=!0;break}var T=e.isFunction(a.options.onDate)?a.options.onDate.apply(t,[v,v.month()===s]):{},I=(m||v.month()===s)&&this._isSelectable(t,v,T.selectable,f,y);x+=this._prepare(r.day,a).replace(/\{day\}/g,(I?'<a href="javascript:void(0)"':"<span")+' class="jd'+k+" "+(T.dateClass||"")+(S&&(m||v.month()===s)?" "+r.selectedClass:"")+(I?" "+r.defaultClass:"")+(v.weekDay()?"":" "+r.weekendClass)+(v.month()===s?"":" "+r.otherMonthClass)+(0===v.compareTo(g)&&v.month()===s?" "+r.todayClass:"")+(0===v.compareTo(a.drawDate)&&v.month()===s?" "+r.highlightedClass:"")+'"'+(T.title||a.options.dayStatus&&I?' title="'+(T.title||v.formatDate(a.options.dayStatus))+'"':"")+">"+(a.options.showOtherMonths||v.month()===s?T.content||v.day():"&#160;")+(I?"</a>":"</span>")),v.add(1,"d"),k++}w+=this._prepare(r.week,a).replace(/\{days\}/g,x).replace(/\{weekOfYear\}/g,C)}var O=this._prepare(r.month,a).match(/\{monthHeader(:[^\}]+)?\}/);O=O[0].length<=13?"MM yyyy":O[0].substring(13,O[0].length-1),O=i?this._generateMonthSelection(a,n,s,f,y,O,o,r):o.formatDate(O,o.newDate(n,s,o.minDay));var W=this._prepare(r.weekHeader,a).replace(/\{days\}/g,this._generateDayHeaders(a,o,r));return this._prepare(r.month,a).replace(/\{monthHeader(:[^\}]+)?\}/g,O).replace(/\{weekHeader\}/g,W).replace(/\{weeks\}/g,w)},_generateDayHeaders:function(e,t,a){var n=e.options.firstDay;n=null==n?t.local.firstDay:n;for(var s="",o=0;o<t.daysInWeek();o++){var r=(o+n)%t.daysInWeek();s+=this._prepare(a.dayHeader,e).replace(/\{day\}/g,'<span class="'+this._curDoWClass+r+'" title="'+t.local.dayNames[r]+'">'+t.local.dayNamesMin[r]+"</span>")}return s},_generateMonthSelection:function(e,t,a,n,s,o,r){if(!e.options.changeMonth)return r.formatDate(o,r.newDate(t,a,1));for(var i=r.local["monthNames"+(o.match(/mm/i)?"":"Short")],l=o.replace(/m+/i,"\\x2E").replace(/y+/i,"\\x2F"),d='<select class="'+this._monthYearClass+'" title="'+e.options.monthStatus+'">',c=r.monthsInYear(t)+r.minMonth,p=r.minMonth;c>p;p++)n&&-1===r.newDate(t,p,r.daysInMonth(t,p)-1+r.minDay).compareTo(n)||s&&1===r.newDate(t,p,r.minDay).compareTo(s)||(d+='<option value="'+p+"/"+t+'"'+(a===p?' selected="selected"':"")+">"+i[p-r.minMonth]+"</option>");d+="</select>",l=l.replace(/\\x2E/,d);var h=e.options.yearRange;if("any"===h)d='<select class="'+this._monthYearClass+" "+this._anyYearClass+'" title="'+e.options.yearStatus+'"><option>'+t+'</option></select><input class="'+this._monthYearClass+" "+this._curMonthClass+a+'" value="'+t+'">';else{h=h.split(":");var u=r.today().year(),m=h[0].match("c[+-].*")?t+parseInt(h[0].substring(1),10):(h[0].match("[+-].*")?u:0)+parseInt(h[0],10),f=h[1].match("c[+-].*")?t+parseInt(h[1].substring(1),10):(h[1].match("[+-].*")?u:0)+parseInt(h[1],10);d='<select class="'+this._monthYearClass+'" title="'+e.options.yearStatus+'">',m=r.newDate(m+1,r.firstMonth,r.minDay).add(-1,"d"),f=r.newDate(f,r.firstMonth,r.minDay);var y=function(e,n){(0!==e||r.hasYearZero)&&(d+='<option value="'+Math.min(a,r.monthsInYear(e)-1+r.minMonth)+"/"+e+'"'+(t===e?' selected="selected"':"")+">"+(n||e)+"</option>")};if(m.toJD()<f.toJD()){m=(n&&1===n.compareTo(m)?n:m).year(),f=(s&&-1===s.compareTo(f)?s:f).year();var D=Math.floor((f-m)/2);(!n||n.year()<m)&&y(m-D,e.options.earlierText);for(var g=m;f>=g;g++)y(g);(!s||s.year()>f)&&y(f+D,e.options.laterText)}else{m=(s&&-1===s.compareTo(m)?s:m).year(),f=(n&&1===n.compareTo(f)?n:f).year();var D=Math.floor((m-f)/2);(!s||s.year()>m)&&y(m+D,e.options.earlierText);for(var g=m;g>=f;g--)y(g);(!n||n.year()<f)&&y(f-D,e.options.laterText)}d+="</select>"}return l=l.replace(/\\x2F/,d)},_prepare:function(e,t){var a=function(t,a){for(;;){var n=e.indexOf("{"+t+":start}");if(-1===n)return;var s=e.substring(n).indexOf("{"+t+":end}");s>-1&&(e=e.substring(0,n)+(a?e.substr(n+t.length+8,s-t.length-8):"")+e.substring(n+s+t.length+6))}};a("inline",t.inline),a("popup",!t.inline);for(var n=/\{l10n:([^\}]+)\}/,s=null;s=n.exec(e);)e=e.replace(s[0],t.options[s[1]]);return e}});var a=e.calendarsPicker;e(function(){e(document).on("mousedown."+t,a._checkExternalClick).on("resize."+t,function(){a.hide(a.curInst)})})}(jQuery);