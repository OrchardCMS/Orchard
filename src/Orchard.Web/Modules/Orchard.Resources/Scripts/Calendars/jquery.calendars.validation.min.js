!function(e){function a(a,t){var r=e.calendarsPicker._getInst(t),n=r.options.multiSelect?a.split(r.options.multiSeparator):r.options.rangeSelect?a.split(r.options.rangeSeparator):[a],i=r.options.multiSelect&&n.length<=r.options.multiSelect||!r.options.multiSelect&&r.options.rangeSelect&&2===n.length||!r.options.multiSelect&&!r.options.rangeSelect&&1===n.length;if(i)try{var o=r.get("dateFormat"),l=r.get("minDate"),c=r.get("maxDate"),s=e(t);e.each(n,function(e,a){n[e]=r.options.calendar.parseDate(o,a),i=i&&(!n[e]||s.calendarsPicker("isSelectable",n[e])&&(!l||-1!==n[e].compareTo(l))&&(!c||1!==n[e].compareTo(c)))})}catch(d){i=!1}return i&&r.options.rangeSelect&&(i=1!==n[0].compareTo(n[1])),i}function t(a){if("string"==typeof a)a=a.split(" ");else if(!e.isArray(a)){var t=[];for(var r in a)t[0]=r,t[1]=a[r];a=t}return a}function r(a,t,r){if(t.newDate&&t.extraInfo)return[t];var n=e.calendarsPicker._getInst(a),i=null;try{"string"==typeof t&&"today"!==t&&(i=n.options.calendar.parseDate(n.get("dateFormat"),t))}catch(o){}return i=i?[i]:"today"===t?[n.options.calendar.today()]:r?[]:e(t).calendarsPicker("getDate")}if(e.fn.validate){e.calendarsPicker.selectDateOrig=e.calendarsPicker.selectDate,e.extend(e.calendarsPicker.regionalOptions[""],{validateDate:"Please enter a valid date",validateDateMin:"Please enter a date on or after {0}",validateDateMax:"Please enter a date on or before {0}",validateDateMinMax:"Please enter a date between {0} and {1}",validateDateCompare:"Please enter a date {0} {1}",validateDateToday:"today",validateDateOther:"the other date",validateDateEQ:"equal to",validateDateNE:"not equal to",validateDateLT:"before",validateDateGT:"after",validateDateLE:"not after",validateDateGE:"not before"}),e.extend(e.calendarsPicker.defaultOptions,e.calendarsPicker.regionalOptions[""]),e.extend(e.calendarsPicker,{selectDate:function(a,t){this.selectDateOrig(a,t);var r=e.calendarsPicker._getInst(a);if(!r.inline&&e.fn.validate){var n=e(a).parents("form").validate();n&&n.element("#"+a.id)}},errorPlacement:function(a,t){var r=e.calendarsPicker._getInst(t);r?a[r.options.isRTL?"insertBefore":"insertAfter"](r.trigger.length>0?r.trigger:t):a.insertAfter(t)},errorFormat:function(a,t){var r=e.calendarsPicker.curInst?e.calendarsPicker.curInst.get("dateFormat"):e.calendarsPicker.defaultOptions.dateFormat;return e.each(t,function(e,t){a=a.replace(new RegExp("\\{"+e+"\\}","g"),t.formatDate(r)||"nothing")}),a}});var n=null;e.validator.addMethod("cpDate",function(e,t){return n=t,this.optional(t)||a(e,t)},function(a){var t=e.calendarsPicker._getInst(n),r=t.get("minDate"),i=t.get("maxDate"),o=e.calendarsPicker.defaultOptions;return r&&i?e.calendarsPicker.errorFormat(o.validateDateMinMax,[r,i]):r?e.calendarsPicker.errorFormat(o.validateDateMin,[r]):i?e.calendarsPicker.errorFormat(o.validateDateMax,[i]):o.validateDate}),e.validator.addClassRules("cpDate",{cpDate:!0});var i={equal:"eq",same:"eq",notEqual:"ne",notSame:"ne",lessThan:"lt",before:"lt",greaterThan:"gt",after:"gt",notLessThan:"ge",notBefore:"ge",notGreaterThan:"le",notAfter:"le"};e.validator.addMethod("cpCompareDate",function(a,o,l){if(this.optional(o))return!0;l=t(l);var c=e(o).calendarsPicker("getDate"),s=r(o,l[1]);if(0===c.length||0===s.length)return!0;n=o;for(var d=!0,f=0;f<c.length;f++){var p=c[f].compareTo(s[0]);switch(i[l[0]]||l[0]){case"eq":d=0===p;break;case"ne":d=0!==p;break;case"lt":d=0>p;break;case"gt":d=p>0;break;case"le":d=0>=p;break;case"ge":d=p>=0;break;default:d=!0}if(!d)break}return d},function(a){var o=e.calendarsPicker.defaultOptions;a=t(a);var l=r(n,a[1],!0);return l="today"===a[1]?o.validateDateToday:l.length?l[0].formatDate():o.validateDateOther,o.validateDateCompare.replace(/\{0\}/,o["validateDate"+(i[a[0]]||a[0]).toUpperCase()]).replace(/\{1\}/,l)})}}(jQuery);